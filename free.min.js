void function(){function Mt(t){function r(s,r,u,d){if("undefined"!=typeof e.app_url_vars){for(var p in e.app_url_vars)delete e.app_url_vars[p];c(e.app_url_vars,s)}var t=o(s,{record_undefined_values:!1});"undefined"!=typeof r&&("undefined"!=typeof r.title&&(e.title=r.title),"undefined"!=typeof r.url&&(e.url=r.url),"undefined"!=typeof r.callback&&(e.callback=r.callback),"undefined"==typeof e.url&&(e.url=location.protocol+"//"+location.host+location.pathname+e.base_filename,e.url+=t)),1==u?(n[t]={},n[t].title=e.title,n[t].url=e.url,n[t].callback=e.callback):e[i]=s[i];var h=n[t].title,f=n[t].url,l=n[t].callback;delete e.url,delete e.callback,document.title="undefined"!=typeof h?h:"",(1==u||d)&&history[(a?"replace":"push")+"State"](s,h,f),e.current_state=s,1==a&&(a=!1),d||("undefined"!=typeof e.onstatechange?e.onstatechange(s,function(){"undefined"!=typeof l&&l()}):"undefined"!=typeof l&&l())}function o(i,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.record_undefined_values&&(t.record_undefined_values=!0);var e="";for(var n in i)("undefined"!=typeof i[n]||1==t.record_undefined_values)&&(e+="&"+n+"="+i[n]);return""!=e&&(e="?"+e.slice(1,e.length)),e}function l(e){if("object"!=typeof e||null==e)var e={};for(var n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=n.length,t=0;r>t;t++){var i=n[t].split("=");"undefined"!=typeof i[1]&&(e[i[0]]=decodeURIComponent(i[1]))}return e}function c(e,t){if("undefined"==typeof t)return e;for(var i in t)e[i]=t[i];return e}function s(e){if("object"!=typeof e||null==e)return e;var i=e instanceof Array?[]:{};for(var n in e){var t=e[n];i[n]="object"==typeof t&&t instanceof Array?t.slice():t}return i}var e=this;"undefined"==typeof t&&(t={}),e.overwrite_first_state="undefined"!=typeof t.overwrite_first_state&&0==t.overwrite_first_state?!1:!0;var i="undefined"!=typeof t.var_name?t.var_name:"page";e.base_filename="undefined"!=typeof t.base_filename?t.base_filename:"",e.onbeforestatechange=t.onbeforestatechange,e.onstatechange=t.onstatechange,e.initial_page=t.initial_page,e.app_url_vars=t.app_url_vars,e.can_do_popstate=t.can_do_popstate,e.current_state={};var n={},a=!0;window.addEventListener("popstate",function(t){return"undefined"==typeof e.can_do_popstate||e.can_do_popstate(t.state)?void(null!=t.state&&r(t.state,void 0,!1)):void r(e.current_state,void 0,!1,!0)}),e.load_page=function(t,n){"undefined"==typeof t&&(t={}),"undefined"==typeof n&&(n={}),t=s(t),n=s(n),1==a&&1==e.overwrite_first_state&&(l(t),"undefined"==typeof e[i]&&(e[i]=e.initial_page)),"undefined"==typeof t[i]&&(t[i]=e[i]),"undefined"!=typeof e.onbeforestatechange?e.onbeforestatechange(t,n,function(){r(t,n,!0)}):r(t,n,!0)}}function Y(e){return e.which?3==e.which:e.button?2==e.button:!1}function At(e){return e.detail?-1*e.detail:e.wheelDelta/40}function R(e){function n(t){0!=i&&"undefined"!=typeof e.end_effect&&e.end_effect(t)}function r(n){if(n.touches.length<2)return void(i=!1);if("touchmove"==n.type){if(0==i)return;var p=i}else if("undefined"!=typeof e.start_condition&&e.start_condition(n)===!1)return;var u=c(n.touches[0],t),r=u[0],o=u[1],d=c(n.touches[1],t),l=d[0],h=d[1];return(e.always_recalculate_zoom_target===!0||0==i)&&(a=(r+l)/2,s=(o+h)/2),i=Math.sqrt(Math.pow(Math.abs(r-l),2)+Math.pow(Math.abs(o-h),2)),"touchstart"==n.type?void("undefined"!=typeof e.start_effect&&e.start_effect(n,r,o,l,h)):(e.result_function(i/p,a,s),void("undefined"!=typeof e.move_effect&&e.move_effect(n)))}if("undefined"==typeof this||this===window)return new R(e);var t=e.target,i=!1,a=void 0,s=void 0;t.addEventListener("touchend",n),t.addEventListener("touchcancel",n),t.addEventListener("touchleave",n),t.addEventListener("touchstart",r),t.addEventListener("touchmove",r)}function s(e){if("object"!=typeof e||null==e)return e;var t=e instanceof Array?[]:{};for(var i in e)t[i]=e[i];return t}function C(t){if("object"!=typeof t||null==t)return t;var i=t instanceof Array?[]:{};for(var n in t){var e=t[n];if("object"==typeof e)if(e instanceof Array){i[n]=[];for(var r=0,a=e.length;a>r;r++)i[n].push("object"==typeof e[r]?C(e[r]):e[r])}else i[n]=C(e);else i[n]=e}return i}function c(e,t){"undefined"==typeof t&&(t=e.target);var i=t.getBoundingClientRect();return[e.clientX-i.left,e.clientY-i.top]}function n(e){function n(){var n=i.responseText;if(200!=i.status&&0==o)n={error:!0,errormessage:n};else if(1!=r&&""!=n)try{n=JSON.parse(n)}catch(a){return n={error:!0,errormessage:n},0==t?n:void(e.error&&e.error(n))}{if(""==n||1!=n.error)return 0==t?n:void("undefined"!=typeof e.success&&e.success(n));if("undefined"!=typeof e.error)return 0==t?n:e.error(n)}}var r=e.send_data_as_plaintext||e.plaintext||!1,t=!0;"undefined"!=typeof e.is_asynchronous&&(t=e.is_asynchronous),"undefined"!=typeof e.async&&(t=e.async);var a="undefined"!=typeof e.charset?e.charset:"",s="undefined"!=typeof e.data?e.data:"",o="undefined"!=typeof e.ignore_request_status?e.ignore_request_status:!1,l=Ct(e.file,s,r,a,t,void 0,void 0,e.request_method),i=l.http_request;return 0==t?n():void(i.onreadystatechange=function(){4==i.readyState&&n()})}function Ct(s,t,n,i,r,o,l,a){("undefined"==typeof n||n!==!0)&&(n=!1),("undefined"==typeof r||0!=r)&&(r=!0),i="undefined"==typeof i?"":"; charset="+i;var e=new XMLHttpRequest;if(e||alert("Cannot create an XMLHTTP instance for some reason. Please try reloading the page."),"undefined"==typeof a)var a=null===t?"GET":"POST";return"GET"==a&&(s+="undefined"!=typeof t?"?"+t:"",t=null),e.open(a,s,r),"undefined"!=typeof o&&(e.responseType=o),n===!0?(e.setRequestHeader("Content-type","application/x-www-form-urlencoded"+i),"undefined"!=typeof e.overrideMimeType&&e.overrideMimeType("text/plain; charset=x-user-defined")):e.setRequestHeader("Content-type","application/x-www-form-urlencoded"+i),e.send(t),{http_request:e}}function Et(){var e=document.createElement("input");document.body.appendChild(e),e.focus(),document.body.removeChild(e),e=null}function I(i,t){var e=window.getComputedStyle(i),r=""!=e.boxSizing?e.boxSizing:e.mozBoxSizing;if("border-box"!=r)var n=0;else var n=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);return"undefined"!=typeof t&&"undefined"!=typeof t.margin&&1==t.margin&&(n+=parseFloat(e.marginLeft)+parseFloat(e.marginRight)),i.clientWidth+n+parseFloat(e.borderLeftWidth)+parseFloat(e.borderRightWidth)}function l(i,t){var e=window.getComputedStyle(i),r=""!=e.boxSizing?e.boxSizing:e.mozBoxSizing;if("border-box"!=r)var n=0;else var n=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom);return"undefined"!=typeof t&&"undefined"!=typeof t.margin&&1==t.margin&&(n+=parseFloat(e.marginTop)+parseFloat(e.marginBottom)),i.clientHeight+n+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)}function k(i,e){if("undefined"==typeof i)var e=e.primary,i=e.secondary;var n={};for(var t in i)n[t]=i[t];for(var t in e)n[t]=e[t];return n}function a(e){e.setAttribute("unselectable","on"),e.style.WebkitTapHighlightColor="rgba(255, 255, 255, 0)",e.style.WebkitHighlightColor="transparent",e.style.MozUserSelect="none",e.style.OUserSelect="none",e.style.KhtmlUserSelect="none",e.style.WebkitUserSelect="none",e.style.MsUserSelect="none",e.style.userSelect="none"}function h(e){e.setAttribute("unselectable","off"),e.style.WebkitTapHighlightColor="",e.style.WebkitHighlightColor="",e.style.MozUserSelect="text",e.style.OUserSelect="text",e.style.KhtmlUserSelect="text",e.style.WebkitUserSelect="text",e.style.MsUserSelect="text",e.style.userSelect="text"}function d(e){("object"!=typeof e||null==e)&&(e={});for(var n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=n.length,t=0;r>t;t++){var i=n[t].split("=");"undefined"!=typeof i[1]&&(e[i[0]]=decodeURIComponent(i[1]))}return e}function Tt(i,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.record_undefined_values&&(t.record_undefined_values=!0);var e="";for(var n in i)("undefined"!=typeof i[n]||1==t.record_undefined_values)&&(e+="&"+n+"="+i[n]);return""!=e&&(e="?"+e.slice(1,e.length)),e}function wt(e){var t=e.indexOf("://");if(-1==t)return e;t=-1==t?0:t+3;var i=e.indexOf("/",t)+1;return 0==i?e:e.substring(i)}function bt(e){var s=/^https?:\/\/[a-z\:0-9.]+/,r="",a=s.exec(e);null!=a&&(r=a[0]),r.length>0&&(e=e.replace(r,"").substr(1));var i=document.getElementsByTagName("head");if(i=i[i.length-1],null!=i){var t=document.getElementsByTagName("base");if(t=t[t.length-1],null!=t){var n=t.getAttribute("href");n=n.substr(n.indexOf("/")+1)+"/",e=e.replace(n,"")}}return e}function T(i,t){if("undefined"==typeof t&&(t={}),t.play_howl)return new O(i,t);if("undefined"!=typeof t.container&&"undefined"!=typeof t.container[i]&&!t.force_refresh){var e=t.container[i];return e.loop=t.loop||!1,e.volume=t.volume||1,e.start="undefined"!=typeof t.start?t.start:!0,e.stopped=!1,1==e.start?(e.audio.play(),1==e.loop&&e.addEventListener("ended",e.play)):1==e.loop&&(e.audio.loop=!0),e}if("undefined"==typeof this||this==window)return new T(i,t);var e=this;if("undefined"!=typeof t.container&&(t.container[i]=e),Object.defineProperty(e,"duration",{get:function(){return e.audio.duration}}),Object.defineProperty(e,"currentTime",{get:function(){return e.audio.currentTime},set:function(t){function i(){e.audio.removeEventListener("loadedmetadata",i),e.audio.currentTime=t}return 0!=e.audio.readyState?void(e.audio.currentTime=t):void e.audio.addEventListener("loadedmetadata",i)}}),Object.defineProperty(e,"volume",{get:function(){return e.audio.volume},set:function(t){e.audio.volume=t}}),Object.defineProperty(e,"paused",{get:function(){return e.audio.paused}}),e.addEventListener=function(){return e.audio.addEventListener(arguments[0],arguments[1],!1||arguments[2])},e.removeEventListener=function(){return e.audio.removeEventListener(arguments[0],arguments[1],!1||arguments[2])},e.play=e.play_track=function(){e.audio.play()},e.stop=function(){e.stopped=!0,e.audio.pause(),0!=e.audio.readyState&&(e.audio.currentTime=0),e.removeEventListener("ended",e.play_track)},e.pause=function(){e.stopped=!0,e.audio.pause(),e.removeEventListener("ended",e.play)},e.play=function(){e.resume()},e.resume=function(){1==e.stopped?(e.stopped=!1,e.play()):e.audio.play(),1==e.loop&&(e.audio.loop=!0,e.audio.addEventListener("ended",e.play))},e.set_loop=function(t){1==t?(e.loop=!0,e.audio.loop=!0,e.addEventListener("ended",e.play)):(e.loop=!1,e.audio.loop=!1,e.removeEventListener("ended",e.play))},e.restart=function(){e.play()},e.set_volume=function(t){e.volume=t},e.loop=t.loop,"undefined"==typeof e.loop&&(e.loop=!1),e.start=t.start,"undefined"==typeof e.start&&(e.start=!0),e.loaded=!0,e.filename=i,e.stopped=!1,e.audio=new Audio,"undefined"!=typeof t.no_source_tags&&1==t.no_source_tags||".ogg"!=r&&".mp3"!=r&&".wav"!=r)e.audio.src=e.filename;else{var r=e.filename.slice(-4),n=document.createElement("source");switch(r){case".ogg":n.type="audio/ogg";break;case".mp3":n.type="audio/mpeg";break;case".wav":n.type="audio/wav"}n.src=e.filename,e.audio.appendChild(n)}return e.volume=t.volume||1,1==e.start?(e.audio.play(),1==e.loop&&e.addEventListener("ended",e.play)):1==e.loop&&(e.audio.loop=!0),e}function O(n,t){if("undefined"==typeof t&&(t={}),"undefined"!=typeof t.container&&"undefined"!=typeof t.container[n]&&!t.force_refresh){var e=t.container[n];return e.volume=t.volume||1,("undefined"==typeof t.start||1==t.start)&&e.play(),e}if("undefined"==typeof this||this==window)return new O(n,t);var e=this;"undefined"!=typeof t.container&&(t.container[n]=e),Object.defineProperty(e,"duration",{get:function(){return e.audio.duration}}),Object.defineProperty(e,"currentTime",{get:function(){return e.audio.position},set:function(t){function i(){e.audio.position=t,e.removeEventListener("load",i)}return e.loaded?void(e.audio.position=t):void e.addEventListener("load",i)}}),Object.defineProperty(e,"volume",{get:function(){return e.audio.volume},set:function(t){e.audio.volume=t}}),e.pause=function(){e.audio.pause(),e.paused=!0},e.play=function(){e.audio.play(),e.paused=!1},e.stop=function(){e.audio.pause(),e.paused=!0,e.currentTime=0},e.loaded=!1,e.src=n,e.paused=!0;var i=[];return e.addEventListener=function(){i.push([arguments[0],arguments[1],arguments[2]||!1])},e.removeEventListener=function(){var e=arguments,t=i.findIndex(function(t){return t[0]!==e[0]?!1:t[1]!==e[1]?!1:t[2]!==(e[2]||!1)?!1:!0});-1!=t&&i.splice(t,1)},e.audio=new Howl({src:e.src,buffersize:t.preload_buffer_size,bufferfile:t.preload_buffer_file,autoplay:"undefined"==typeof t.start||1==t.start,onend:function(){e.paused=!0,i.forEach(function(e){"ended"==e[0]&&e[1]()})},onload:function(){e.loaded=!0,i.forEach(function(e){"load"==e[0]&&e[1]()})},onloaderror:function(){e.paused=!0,i.forEach(function(e){"loaderror"==e[0]&&e[1]()})},onpause:function(){e.paused=!0,i.forEach(function(e){"pause"==e[0]&&e[1]()})},onplay:function(){e.paused=!1,i.forEach(function(e){"play"==e[0]&&e[1]()})}}),e.volume=t.volume||1,e}function z(t,i){var n=window.getComputedStyle(t).textShadow,e=n.split("rgb");e.shift(),e.forEach(function(e,t,n){var r=e.slice(0,e.length-2).split(") ")[1];n[t]=i+" "+r}),t.style.textShadow=e}function w(l){var e=l.element,s=e.innerHTML,i=l.size,n=l.color;"string"==typeof i&&(i=[i]),"string"==typeof n&&(n=[n]);var c=window.getComputedStyle(e).lineHeight;if("normal"==c)var d=0;else{var o=parseInt(c);Number.isNaN(o)&&(o=0);var t=document.createElement("div");t.style.whiteSpace="nowrap",t.style.fontSize="100px",t.innerHTML=e.innerHTML,document.body.appendChild(t),t.style.fontFamily=window.getComputedStyle(e).fontFamily;var h=e.style.lineHeight;e.style.lineHeight=t.getBoundingClientRect().height/100,document.body.removeChild(t);var d=(parseFloat(window.getComputedStyle(e).lineHeight)-o)/2;e.style.lineHeight=h}e.innerHTML="";for(var a=0,u=s.length;u>a;a++){var r=document.createElement("span");r.style.position="relative",e.appendChild(r),r.innerHTML='<span style="position:relative; z-index:'+i.length+'"/>'+s[a]+"</span>",i.forEach(function(t,o){var l=t.substr(t.match(/([A-Z])/i).index,t.length),e=document.createElement("div");e.style.position="absolute",e.style.left=0,e.style.top=d+"px",e.style.zIndex=i.length-o-1,e.style.color=n[o],e.style.WebkitTextStrokeColor=n[o],e.style.WebkitTextStrokeWidth=2*parseFloat(t)+l,e.innerHTML=s[a],r.appendChild(e)})}}function N(e){function r(e,i){function t(){if("undefined"!=typeof e.naturalWidth&&0!=e.complete&&0!=e.naturalWidth)e.width=e.naturalWidth,e.height=e.naturalHeight,i();else{setTimeout(t,20)}}t()}function i(){var i=document.createElement("canvas"),s=i.getContext("2d");if(e.image instanceof HTMLImageElement&&e.fix_ie_bug?(i.width=t.naturalWidth,i.height=t.naturalHeight):(i.width=t.width,i.height=t.height),s.fillStyle=e.color,s.fillRect(0,0,i.width,i.height),"undefined"==typeof e.image||e.image instanceof HTMLImageElement||"undefined"!=typeof e.create_new&&1==e.create_new){var r=document.createElement("canvas"),a=r.getContext("2d");e.image instanceof HTMLImageElement&&e.fix_ie_bug?(r.width=t.naturalWidth,r.height=t.naturalHeight):(r.width=t.width,r.height=t.height),a.globalCompositeOperation="source-over",a.drawImage(t,0,0)}if(e.image instanceof HTMLCanvasElement&&("undefined"==typeof e.create_new||1!=e.create_new))var r=e.image,a=r.getContext("2d");return a.globalCompositeOperation="source-in",a.drawImage(i,0,0),"undefined"!=typeof e.callback&&e.callback(r),1==n?r:void 0}var n="undefined"!=typeof e.return_result&&1==e.return_result?!0:!1;if("undefined"==typeof e.image){var t=new Image;if(t.src=e.image_src,1==n)return i();e.fix_ie_bug?r(t,i):t.addEventListener("load",i)}else{var t=e.image;if(e.image instanceof HTMLImageElement){if("undefined"!=typeof e.image_src&&(t.src=e.image_src),1==n)return i();e.fix_ie_bug?r(t,i):t.addEventListener("load",i)}if(e.image instanceof HTMLCanvasElement){if(1==n)return i();i()}}}function y(e){function i(a,s){var i=s.getContext("2d");"undefined"!=typeof e.lineWidth&&(i.lineWidth=e.lineWidth),"undefined"!=typeof e.strokeStyle&&(i.strokeStyle=e.strokeStyle),"undefined"!=typeof e.lineJoin&&(i.lineJoin=e.lineJoin),"undefined"!=typeof e.lineCap&&(i.lineCap=e.lineCap),i.beginPath(),i.translate(e.x*t,e.y*t);for(var r=0;r<a.length;r++){var o=a[r].command,n=a[r].points;switch(o){case"L":i.lineTo(n[0],n[1]);break;case"M":i.moveTo(n[0],n[1]);break;case"C":i.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]);break;case"z":i.closePath()}}if(("undefined"==typeof e.lineWidth||0!=e.lineWidth)&&i.stroke(),"undefined"!=typeof e.fillPatternImage||"undefined"!=typeof e.fillStyle){if("undefined"!=typeof e.fillPatternImage){var l=i.createPattern(e.fillPatternImage,"no-repeat");"undefined"!=typeof e.fillPatternOffset&&(i.save(),i.translate(-e.fillPatternOffset[0]*t,0),i.translate(0,-e.fillPatternOffset[1]*t)),i.fillStyle=l}else i.fillStyle=e.fillStyle;i.fill()}"undefined"!=typeof e.fillPatternOffset&&i.restore()}function n(f){var s=f,u=["M","L","C"];s=s.replace(new RegExp(" ","g"),",");for(var n=0;n<u.length;n++)s=s.replace(new RegExp(u[n],"g"),"|"+u[n]);var d=s.split("|"),h=[],a=0,r=0;for(n=1;n<d.length;n++){var i=d[n],o=i.charAt(0);i=i.slice(1),i=i.replace(new RegExp(",-","g"),"-"),i=i.replace(new RegExp("-","g"),",-"),i=i.replace(new RegExp("e,-","g"),"e-");var e=i.split(",");e.length>0&&""===e[0]&&e.shift();for(var c=0;c<e.length;c++)e[c]=parseFloat(e[c])*t;for(;e.length>0&&!isNaN(e[0]);){var p=null,l=[],_=a,m=r;switch(o){case"L":a=e.shift(),r=e.shift(),l.push(a,r);break;case"M":a=e.shift(),r=e.shift(),p="M",l.push(a,r),o="L";break;case"C":l.push(e.shift(),e.shift(),e.shift(),e.shift()),a=e.shift(),r=e.shift(),l.push(a,r)}h.push({command:p||o,points:l,start:{x:_,y:m}})}("z"===o||"Z"===o)&&h.push({command:"z",points:[],start:void 0})}return h}var t=(e.x||0,e.y||0,e.scale||1),r=e.data,a=e.canvas,s=n(r);i(s,a)}function xt(t){function i(o,r,i){function a(){s.forEach(function(e){e.classList[i](n)})}for(var t=o.target,l="*"+("add"==i?":hover":"."+n),c=Array.prototype.slice.call(document.body.querySelectorAll(l)),s=[];;){if(null==t||t==document.documentElement)break;-1!=c.indexOf(t)&&s.push(t),t=t.parentNode}e[r]&&e[r][i]?setTimeout(a,e[r][i]):a()}var t=t||{},r=t.handle_touch_events||!0,a=t.handle_mouse_events||!0,n=t.hover_class||"hover",e=t.delay_preferences||{};a&&(document.body.addEventListener("mouseover",function(e){i(e,"mouse","add")}),document.body.addEventListener("mouseout",function(e){i(e,"mouse","remove")})),r&&(document.body.addEventListener("touchstart",function(e){i(e,"touch","add")}),document.body.addEventListener("touchend",function(e){i(e,"touch","remove")}),document.body.addEventListener("touchmove",function(i){function a(n,r){for(var t=[],i=[];;){var e=document.elementFromPoint(n,r);if(null==e||e==document.documentElement)break;t.push(e),i.push(e.style.pointerEvents),e.style.pointerEvents="none"}return t.forEach(function(e,t){e.style.pointerEvents=i[t]}),t}var t=i.target,s=Array.prototype.slice.call(document.body.querySelectorAll("*.hover")),r=null;i=i.changedTouches[0];for(var o=a(i.pageX,i.pageY);;){if(null==t||t==document.documentElement)break;-1!=s.indexOf(t)&&-1==o.indexOf(t)&&(r=t),t=t.parentNode}null!=r&&(e.touch&&e.touch.remove?setTimeout(function(){r.classList.remove(n)},e.touch.remove):r.classList.remove(n))}))}function vt(e){var t=navigator.userAgent.toLowerCase();e.is_iphone=null!=t.match(/iphone/i),e.is_ipad=null!=t.match(/ipad/i),e.is_idevice=e.is_iphone||e.is_ipad,e.is_android=null!=t.match(/android/i),e.is_chromium=null!=t.match(/chrome/i),e.is_windows_phone=null!=t.match(/Windows Phone/i),e.is_phone_or_tablet="ontouchstart"in window||e.is_idevice||e.is_android||e.is_windows_phone}function yt(t,n){function r(){return s<t.length?void(o=setTimeout(r,30)):void n()}function a(e){if(e.offsetWidth!=e.original_width)s+=1,e.parentNode.removeChild(e),e=null;else{setTimeout(function(){a(e)},30)}}for(var s=0,i=0;i<t.length;i++){var e=document.createElement("span");e.innerHTML="giItT1WQy@!-/#",e.style.fontFamily="sans-serif",e.style.position="absolute",e.style.left="-10000px",e.style.top="-10000px",e.style.fontSize="300px",e.style.fontVariant="normal",e.style.fontWeight="normal",e.style.letterSpacing="0",document.body.appendChild(e),e.original_width=e.getBoundingClientRect().width,e.style.fontFamily=t[i],a(e)}if("undefined"!=typeof n){var o=null;r()}}function L(t,e,i){function n(s,u,d){var e=+((u+s)/2).toFixed(2);t.style.fontSize=e+c;var a=t.getBoundingClientRect(),p=t.scrollHeight+(parseInt(a.height/i)-a.height/i),f=t.scrollWidth+(parseInt(a.width/i)-a.width/i);if(s===e||u===e)return d;if(h>r){if(p>o||f>l)return r+=1,n(s,e,d);if(o>=p&&l>=f)return r+=1,n(e,u,e)}return d}"undefined"==typeof e&&(e={});var c="undefined"!=typeof e.unit_type?e.unit_type:"px",i="undefined"!=typeof e.transform_scale?e.transform_scale:1,h="undefined"!=typeof e.iteration_max?e.iteration_max:200,s=t.parentNode.getBoundingClientRect(),o=s.height/i,l=s.width/i,r=0,a=n("undefined"!=typeof e.min_size?e.min_size:0,"undefined"!=typeof e.max_size?e.max_size:120,"undefined"!=typeof e.best_size?e.best_size:0);"undefined"!=typeof e.min_size&&a<e.min_size&&(a=e.min_size),t.style.fontSize=a+c}function x(){function c(){var t=this;this.DEBUG=!1,"undefined"!=typeof IS_DEBUG_MODE&&(this.DEBUG=IS_DEBUG_MODE),this.errormessage=function(e,i,t){"undefined"==typeof t&&(t={}),i=i||t.callback||function(){},"string"!=typeof e&&(e=e.errormessage),smoke.alert(e,i,t)},this.log_user_action=function(i){var e="undefined"!=typeof window.device?window.device:e;if("undefined"==typeof e.model&&(e.model=""),"undefined"==typeof e.uuid&&(e.uuid=""),"undefined"!=typeof t.account.user_id)var r="&user_id="+t.account.user_id+"&internal_access_token="+t.account.internal_access_token;else var r="";n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(t.DEBUG?"-beta":"")+".php?action=log_user_action"+r+"&message="+encodeURIComponent(i)+"&device_model="+e.model+"&device_uuid="+e.uuid,success:function(){},error:function(){},request_method:"GET"})},vt(this),this.contact_info="info@flyingsoftgames.com",this.is_kiosk="true"==d().is_kiosk?!0:!1,this.use_mini_images="false"==d().use_mini_images?!0:!0,this.events={},this.IS_COCOONJS=!!window.CocoonJS,this.IS_CORDOVA=!!o,this.IS_WEBVIEW=!!window.CocoonJS||!!o,this["/"]=t.IS_WEBVIEW?"":"/",this.events.POINT=this.is_phone_or_tablet?"touchstart":"click",this.events.POINT_START=this.is_phone_or_tablet?"touchstart":"mousedown",this.events.POINT_MOVE=this.is_phone_or_tablet?"touchmove":"mousemove",this.events.POINT_END=this.is_phone_or_tablet?"touchend":"mouseup",this.collision_scale=.5,this.audio_dir=t["/"]+"audio",this.ad_removal_price=27,this.service_name="google_play",this.google_play_store_package_name="com.flyingsoft.safari.jigsaw.free",this.google_play_store_url="details?id="+t.play_store_package_name,this.google_play_store_url=t.IS_CORDOVA?"market://"+this.play_store_url:"http://play.google.com/store/apps/"+this.play_store_url,this.get_gem_count_from_server=function(e){var e=e||{},r=e.success||function(){},i=e.error||t.errormessage;return"undefined"==typeof t.account.internal_access_token?void i():void n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(t.DEBUG?"-beta":"")+".php?action=get_gem_count&internal_access_token="+t.account.internal_access_token+"&user_id="+t.account.user_id,error:i,request_method:"POST",async:!0,success:function(e){r(+e)}})},t.IS_CORDOVA&&"undefined"!=typeof window.plugins.AppVersion&&window.plugins.AppVersion.getVersionCode({success:function(e){t.version_code=e}}),this.android={},this.account={},this.open_url=function(e){return t.IS_COCOONJS?void CocoonJS.App.openURL(e):t.IS_CORDOVA?void window.open(e,"_system"):void(window.location.href=e)},t.jigsaw_get_scaled_piece_margin=function(){return t.jigsaw_piece_margin};var r={};r.jigsaw_colored_borders=function(e,i){switch(t.jigsaw_piece_margin=8,t.jigsaw_piece_margin_style=e?"rgba(0,0,127,1)":void 0,i){case"margin":return t.jigsaw_piece_margin;case"margin_style":return t.jigsaw_piece_margin_style}},r.music_on=function(){t.ambient_music&&t.ambient_music[t.music_on&&t.ambient_music_on?"play":"pause"]()},r.ambient_music_on=function(){t.ambient_music&&t.ambient_music[t.music_on&&t.ambient_music_on?"play":"pause"]()},void function(){function e(e,i,n){for(var r in e){var t=e[r];t[i]&&(t.volume=n/10)}}r.sound_effects_volume=function(i){e(t.audio_container,"is_sound_effect",i)},r.music_volume=function(i){e(t.audio_container,"is_music",i)},r.ambient_music_volume=function(i){e(t.audio_container,"is_ambient_music",i)}}();var l=[{name:"account.purchased_ad_removal","default":!1,resettable:!1},{name:"challenge_code_processed","default":!1,resettable:!1},{name:"game_type","default":""},{name:"gem_amount","default":0},{name:"run_audio_in_background","default":!1},{name:"sound_effects_on","default":!0},{name:"music_on","default":!0},{name:"ambient_music_on","default":!0},{name:"ambient_music_playlist_name","default":void 0},{name:"sound_effects_volume","default":10},{name:"music_volume","default":10},{name:"ambient_music_volume","default":10},{name:"ambient_music_on_question_asked","default":!1,resettable:!1},{name:"jigsaw_colored_borders_question_asked","default":!1,resettable:!1},{name:"jigsaw_use_3d_effect_question_asked","default":!1,resettable:!1},{name:"challenge_code_request_asked","default":!1,resettable:!1},{name:"thank_you_screen_mentioned","default":!1,resettable:!1},{name:"jigsaw_pinch_controls_not_run","default":!0,resettable:!1},{name:"gem_screen_not_opened","default":!0,resettable:!1},{name:"use_categories","default":!1},{name:"freestyle_mode","default":!0},{name:"show_timer","default":!0},{name:"show_ad_counter","default":-1,resettable:!1},{name:"own_ad_shown","default":!1,resettable:!1},{name:"account.game_was_rated","default":!1,resettable:!1},{name:"select_menu_sort_index","default":{}},{name:"select_menu_sort_direction","default":{}},{name:"select_menu_current_page","default":{}},{name:"select_menu_current_category","default":{}},{name:"select_packs_menu_current_page","default":{}},{name:"gray-filter_incomplete_images","default":!0},{name:"gray-filter_unacquired_packs","default":!0},{name:"jigsaw_center_piece_on_move","default":!1},{name:"jigsaw_arrange_pieces_on_entire_area","default":2},{name:"jigsaw_use_large_square_images","default":!0},{name:"jigsaw_show_hint_image","default":!0},{name:"jigsaw_show_hint_rect","default":!0},{name:"jigsaw_minimal_ui","default":!0},{name:"jigsaw_image_size_type","default":1},{name:"jigsaw_piece_scale_to_actual_index","default":0},{name:"jigsaw_piece_scale_to_actual","default":.75},{name:"jigsaw_required_precision","default":5},{name:"jigsaw_use_3d_effect","default":!0},{name:"jigsaw_combine_pieces","default":!0},{name:"jigsaw_colored_borders","default":!0},{name:"jigsaw_piece_margin","default":function(){return r.jigsaw_colored_borders(t.jigsaw_colored_borders,"margin")}},{name:"jigsaw_piece_margin_style","default":function(){return r.jigsaw_colored_borders(t.jigsaw_colored_borders,"margin_style")}},{name:"jigsaw_animate_piece_placement","default":!0},{name:"jigsaw_heat_seeking_color_index","default":1},{name:"jigsaw_reduce_texture_size","default":0},{name:"show_trophy_ribbon","default":!0}];if(t.jigsaw_piece_scale_to_actual_options=[.5,.6,.75,1],t.jigsaw_heat_seeking_color_options=[void 0,"cyan","red"],l.forEach(function(n){var e=n.name,i=e.indexOf(".");if(-1!=i)var s=e.substr(0,i),o=e.substr(i+1);if("undefined"!=typeof localStorage["settings."+e]&&"undefined"!=localStorage["settings."+e])var a=t[e]=JSON.parse(localStorage["settings."+e]);else if(t[e]in t||(t[e]="function"==typeof n.default?n.default():n.default),-1!=i)var a=t[s][o];else var a=t[e];Object.defineProperty(t,e,{get:function(){return a},set:function(t){a=t,r[e]&&r[e](t),localStorage["settings."+e]=JSON.stringify(t)}}),-1!=i?t[s][o]=a:t[e]=a}),t.reset_default_settings=function(){l.forEach(function(e){if(!e.resettable||0!=e.resettable){var i=e.name,n=i.indexOf(".");if(-1!=n){var r=i.substr(0,n),a=i.substr(n+1);t[r][a]="function"==typeof e.default?e.default():e.default}else t[i]="function"==typeof e.default?e.default():e.default}})},this.try_requesting_fullscreen=!1,this.use_jpeg_if_available=!0,this.image_ext=this.use_jpeg_if_available?"jpg":"png","undefined"!=typeof smoke&&(smoke.point_event=this.events.POINT,smoke.autofocus=t.IS_CORDOVA?!1:!0),this.use_social_media_buttons=!1,this.skip_set_selection_screen=!0,this.get_root_directory=function(){return o?"/android_asset/www":""},this.get_set_directory=function(e,i){return i?"cdvfile://localhost/persistent/sets/"+e:(f?"content://"+P+".free.expansion/":t["/"])+"sets/"+e},this.get_image_url_from_server=function(a,n,e){if("trophy"==e)return"http://www.flyingsoftgames.com/mr_jigtato/sets/"+a+"/trophies/"+n+".png";var r=i.game_data.entry_list[n].category;return"undefined"!=typeof t.account.user_id&&(t.account.user_id>606||1==t.account.user_id)&&"mini-grey"==e&&(e="mini"),"http://www.flyingsoftgames.com/mr_jigtato/resources/puzzle/"+r+"/"+n+("mini"==e?"-mini.jpg":"mini-grey"==e?"-mini-grey.png":".jpg")+"?"+("undefined"!=typeof t.account.user_id?"&user_id="+t.account.user_id:"")+("undefined"!=typeof t.account.internal_access_token?"&internal_access_token="+t.account.internal_access_token:"")+"&category_name="+r},this.get_image_url_from_local=function(s,e,n){if("trophy"!=n)var a=i.game_data.entry_list[e].category;var r=(f?"content://"+P+".free.expansion/":t["/"])+"sets/"+s;switch("undefined"!=typeof t.account.user_id&&(t.account.user_id>606||1==t.account.user_id)&&"mini-grey"==n&&(n="mini"),n){case"trophy":return r+"/puzzle/trophies/"+e+".png";case"mini":return r+"/puzzle/categories/"+a+"/mini/"+e+"-mini.jpg";case"mini-grey":return r+"/puzzle/categories/"+a+"/mini-grey/"+e+"-mini.png";case"default":default:return r+"/puzzle/categories/"+a+"/"+e+".jpg"}},this.get_image=function(i,r,n,e){function a(){i.removeEventListener("error",a);var s=JSON.parse(localStorage["image_is_not_local_cache."+e]);s[n]=!0,localStorage["image_is_not_local_cache."+e]=JSON.stringify(s),i.src=t.get_image_url_from_server(r,n,e)}"undefined"==typeof e&&(e="default"),"undefined"==typeof localStorage["image_is_not_local_cache."+e]&&(localStorage["image_is_not_local_cache."+e]=JSON.stringify({}));var s=JSON.parse(localStorage["image_is_not_local_cache."+e]);return s[n]?void(i.src=t.get_image_url_from_server(r,n,e)):(i.src=t.get_image_url_from_local(r,n,e),void i.addEventListener("error",a))},t.jigsaw_piece_margin=8,this.audio_container={},this.select_mode_visited_count=0,t.ambient_music=function(){var e={};return e.load_ambient_music=function(n,l){var r=l.split(","),a=r[0].trim().toLowerCase(),s=r[1].trim().toLowerCase();if(!e.loaded){if(e.loaded=!0,e.playlist_list=n,"undefined"!=typeof t.ambient_music_playlist_name)var o=n.find(function(e){return e.name.toLowerCase()==t.ambient_music_playlist_name.toLowerCase()});else{if("{random}"==a)var o=n[Math.floor(Math.random()*i.length)];else var o=n[n.findIndex(function(e){return e.name.trim().toLowerCase()==a})||0];t.ambient_music_playlist_name=o.name}var i=o.list;e.playlist=i,e.current_track_index="{random}"==s?Math.floor(Math.random()*i.length):i.findIndex(function(e){return e.title.trim().toLowerCase()==s})||0,e.current_track_index=(e.current_track_index+i.length-1)%i.length,e.play_next_track()}},e.play_next_track=function(){e.pause(),e.current_track=null,e.current_track&&e.playlist.length>1&&e.release&&e.release();var n=e.playlist;e.current_track_index=(e.current_track_index+1)%n.length,e.current_track=t.playAudio(t.get_set_directory(i.set_name)+"/audio/"+n[e.current_track_index].file,{audio_type:"ambient_music",restart:!0,blocking:!1}),e.current_track&&(e.current_track.addEventListener("ended",e.play_next_track),t.music_on&&t.ambient_music_on||e.pause(),"undefined"!=typeof t.set_audio_menu_title&&t.set_audio_menu_title())},e.play_next_playlist=function(){e.pause(),e.current_track&&e.release&&e.release();var i=e.playlist_list,a=i.findIndex(function(e){return e.name.toLowerCase()==t.ambient_music_playlist_name.toLowerCase()}),r=i[(a+1)%i.length];t.ambient_music_playlist_name=r.name;var n=e.playlist=r.list;e.current_track_index=Math.floor(Math.random()*n.length),e.current_track_index=(e.current_track_index+n.length-1)%n.length,e.play_next_track()},e.play=function(){return e.current_track?void e.current_track.play():(e.current_track_index=(e.current_track_index+e.playlist.length-1)%e.playlist.length,void e.play_next_track())},e.pause=function(){e.current_track&&e.current_track.pause()},e}(),t.playAudio=function(n,e){function a(){i.paused||i.pause(),c&&clearInterval(c),i.removeEventListener("ended",a),t.music_on&&t.ambient_music_on&&t.ambient_music&&t.ambient_music.current_track&&t.ambient_music.current_track.play()}var e=s(e||{});e.container=t.audio_container;var r=e.audio_type||"sound_effect",o=t[r+("sound_effect"==r?"s":"")+"_on"];if(e.play_howl=!1,e.play_howl&&"ambient_music"==r&&(e.preload_buffer_file=n.substr(0,n.length-4)+"-preview"+n.substr(-4)),o||"undefined"!=typeof e.start&&0==e.start)if(e.element)var l=e.element,i=l.playAudio(n,e);else var i=T(n,e);if(!o)return i;switch(e.restart&&(i.currentTime=0),r){case"sound_effect":i.volume=t.sound_effects_volume/10;break;case"music":i.volume=t.music_volume/10;break;case"ambient_music":i.volume=t.ambient_music_volume/10}if(i["is_"+r]=!0,"undefined"==typeof e.blocking||1==e.blocking){var c=void 0;if(t.music_on&&t.ambient_music_on&&t.ambient_music&&t.ambient_music.current_track&&t.ambient_music.current_track.pause(),i.addEventListener("ended",a),e.element)var l=e.element,c=setInterval(function(){l.isAttached()||a()},200)}return i},void function(n,r){function t(i){if(!r()){var a=e;if(e=!("blur"==i.type)&&"visible"==document.visibilityState,a!=e)for(var s in n){var t=n[s];0==e?(t.stored_paused_state=t.paused,t.stored_paused_state||t.pause()):t.stored_paused_state||t.play()}}}var i;["","moz","ms","webkit"].some(function(e){return"undefined"!=typeof document[""==e?"hidden":e+"Hidden"]?(i=e+"visibilitychange",!0):void 0}),"undefined"!=typeof i&&document.addEventListener(i,t),window.addEventListener("blur",t),window.addEventListener("focus",t);var e=!0}(t.audio_container,function(){return t.run_audio_in_background}),t.is_phone_or_tablet||xt({handle_mouse_events:!0,handle_touch_events:!1}),!t.IS_WEBVIEW){var a=document.getElementsByTagName("head")[0].querySelector("base");if(null==a){var a=document.createElement("base");a.href="/",document.getElementsByTagName("head")[0].appendChild(a)}}if(t.is_phone_or_tablet&&(document.body.addEventListener("touchstart",function(e){e.target.classList.contains("hoverable")&&e.target.classList.add("hover")}),document.body.addEventListener("touchend",function(e){e.target.classList.contains("hoverable")&&e.target.classList.remove("hover")}),document.body.addEventListener("touchleave",function(e){e.target.classList.contains("hoverable")&&e.target.classList.remove("hover")}),document.body.addEventListener("touchcancel",function(e){e.target.classList.contains("hoverable")&&e.target.classList.remove("hover")})),void function(){function e(){i.save_player_data_to_server(),setTimeout(e,t)}var t=72e5;setTimeout(e,t)}(),(t.IS_COCOONJS||t.IS_CORDOVA)&&document.addEventListener(t.events.POINT,function(i){var e=i.target;if("a"==e.tagName.toLowerCase()||null!=e.parentNode&&"undefined"!=typeof e.parentNode.tagName&&"a"==e.parentNode.tagName.toLowerCase()){i.preventDefault();var n=e.href||e.parentNode.href;return n&&t.open_url(n),!1}}),window.gs=t,t.IS_CORDOVA){!t.account.purchased_ad_removal&&t.IS_WEBVIEW&&"undefined"!=typeof m&&(t.ad_control_list=[],t.ad_control_list.destroy=function(){t.ad_control_list.forEach(function(e){e.destroy()}),t.ad_control_list=[],delete t.ad_control,delete t.ad_control_list},t.ad_control_list_weights={admob:50,adbuddiz:50},Object.keys(t.ad_control_list_weights).forEach(function(n){var e=m({gs:t,ad_network:n});e.init(),t.ad_control_list.push(e),void function(){e.disabled_ad_timeout={},e.onrun=function(){e.disabled_ad_timeout.ad_wait&&(clearTimeout(e.disabled_ad_timeout.ad_wait),delete e.disabled_ad_timeout.ad_wait),e.disabled_ad_timeout.ad_wait=setTimeout(function(){V({gs:t,mr_jigtato:i})},8e3)},e.ondisplay=function(){clearTimeout(e.disabled_ad_timeout.ad_wait),delete e.disabled_ad_timeout.ad_wait}}()}));var c=window.plugins.GooglePlayQuery;c.getURI({success:function(e){t.android.INSTALL_REFERRER=e}})}return t.IS_CORDOVA&&(t.smoke_window_list=[],smoke.window_opened=function(e){t.smoke_window_list.push(e)},smoke.window_closed=function(e){t.smoke_window_list.splice(t.smoke_window_list.indexOf(e),1)}),t.IS_CORDOVA||(t.gps={},t.gps.initialize=function(t){var t=t||function(){};e.init({google:"694160809438-53in4hb7cbnp732jei4g4lm5omgl2jgm.apps.googleusercontent.com"}),e("google").login({display:"popup",scope:"basic"}).then(t.success,t.error)},t.gps.getPlayerId=function(t){e("google").api("userinfo/v2/me").then(function(e){t.success(e.id)},t.error)},t.gps.getAccessToken=function(t){var i=e("google").getAuthResponse();t.success(i.access_token)}),t.IS_CORDOVA||window.addEventListener("beforeunload",i.save_player_data_to_server),t.get_google_play_access_token=function(e){function n(){i(t.google_play_access_token)}var e=e||function(){},i="undefined"!=typeof e.callback?e.callback:function(){};if("undefined"!=typeof t.google_play_access_token)return void i(t.google_play_access_token);if(t.IS_CORDOVA)var r=window.plugins.GooglePlayToken||window.plugins.GooglePlayServices;else var r=t.gps;r.getAccessToken({error:n,success:function(e){t.google_play_access_token=e,i(t.google_play_access_token)}})},this}function h(i,e){function t(e){return e.charAt(0).toUpperCase()+e.slice(1)}return document.original_title+("undefined"==typeof e.title?"":": "+t(e.title))}window.onerror=function(t,i,a,s){var e="undefined"!=typeof window.device?window.device:e;"undefined"==typeof e.model&&(e.model=""),"undefined"==typeof e.uuid&&(e.uuid=""),n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=send_javascript_error&errormessage="+encodeURIComponent(t)+"&url="+encodeURIComponent(i)+"&line_number="+a+"&column_number="+s+"&device_model="+encodeURIComponent(e.model)+"&device_uuid="+e.uuid,success:function(){},error:function(){},request_method:"GET"})},"undefined"==typeof o&&(o=!1),"undefined"==typeof f&&(f=!1);var p=1420276045;"undefined"==typeof localStorage.app_version_date&&(localStorage.app_version_date=JSON.stringify(+p)),o&&window.plugins&&window.plugins.AppVersion&&window.plugins.AppVersion.getVersionCode&&window.plugins.AppVersion.getVersionCode({error:function(){},success:function(e){function t(){"undefined"!=typeof r&&(r.version_code=e,clearInterval(i))}var e=+e;156>e&&alert("Please update Safari Jigsaw to the latest version!");var i=setInterval(t,50)}}),"undefined"==typeof window.device&&(window.device={version:"",uuid:"",model:""}),o&&st();var i={};i.load_game_data=function(c){function a(e){"undefined"==typeof e&&(e=1),s-=1,0==s&&h()}function h(){if(i.game_data=t,i.game_data.trophy_list=n,void function(){var i=t.entry_list,a=0;for(var n in i){var e=i[n];if("undefined"==typeof e.puzzle_position&&(e.puzzle_position=a),a+=1,"undefined"!=typeof e.template){var s=i[e.template];for(var r in s)"undefined"==typeof e[r]&&(e[r]=C(s[r]));delete e.is_only_template}}for(var n in i)i[n].is_only_template&&delete i[n]}(),"undefined"!=typeof t.web_font_list){var a=[];t.web_font_list.forEach(function(t){a.push(r.get_set_directory(e)+"/"+t)}),yt(a)}i.update_game_data_from_server(c)}var e="undefined"!=typeof A?A:"default";localStorage.set_name=i.set_name=e;var s=2,o=!1,l=!1,n=void 0;j({gs:r,IS_DEBUG_MODE:o,DO_NOT_USE_REMOTE_FILE:l,remote_dir:"http://animals.jigtato.com/sets/"+e,initial_local_dir:r.get_set_directory(e),persistent_local_dir:r.get_set_directory(e,!0),target_filename:e+"-trophies.json",error:r.errormessage,success:function(t){n=t.trophy_list;for(var e in n)n[e].filename=e;a()}});var t=void 0;j({gs:r,IS_DEBUG_MODE:o,DO_NOT_USE_REMOTE_FILE:l,remote_dir:"http://animals.jigtato.com/sets/"+e,initial_local_dir:r.get_set_directory(e),persistent_local_dir:r.get_set_directory(e,!0),target_filename:e+".json",error:r.errormessage,success:function(e){t=e,a()}})},i.update_game_data_from_server=function(t){function e(e){"undefined"==typeof e&&(e=1),a-=1,0==a&&s()}function s(){var t=i.game_data.entry_list,e=[];"undefined"!=typeof r.free_puzzles&&e.push(r.free_puzzles),"undefined"!=typeof r.paid_puzzles&&e.push(r.paid_puzzles),e.forEach(function(e){"undefined"!=typeof e&&e.forEach(function(e){"undefined"!=typeof t[e]&&(t[e].enabled=!0)})}),l()}var t=t||{},o=t.new_state_page||"",l=t.callback||function(){},a=3;n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=get_global_data",error:e,request_method:"POST",async:!0,success:function(t){return null==t?void e():("undefined"!=typeof t.ad_removal_price&&(r.ad_removal_price=t.ad_removal_price),"undefined"!=typeof t.puzzle_pack_list&&(r.puzzle_pack_list=t.puzzle_pack_list),r.free_puzzles=t.free_puzzles,void e())}}),"jigsaw"==o?e():u({gs:r,success:e,error:e});i.load_set_css(e)},i.reset_player_data=function(){if("undefined"!=typeof i.player_data)var e=i.player_data;else var e={};for(var n in e)delete e[n];e.selected_difficulty=0,e.jigsaw={},e.jigsaw.trophies=[],e.jigsaw.ranks={},e.jigsaw.best_times=[{},{}],i.player_data=e,localStorage.player_data=JSON.stringify(i.player_data);var t=localStorage["puzzle_states.$keys"];if("undefined"!=typeof t){t=JSON.parse(t);for(var n in t)localStorage.removeItem("puzzle_states."+n)}localStorage["puzzle_states.$keys"]=JSON.stringify({})},i.save_player_data_to_server=function(e){{var e=e||{};e.error||function(){},e.success||function(){}}if("undefined"!=typeof r.account.internal_access_token){var a={};a.player_data=i.player_data;var o=localStorage["puzzle_states.$keys"],l=a.puzzle_states={};if("undefined"!=typeof o){var c=a.puzzle_states_keys=JSON.parse(o);for(var s in c)"undefined"!=typeof localStorage["puzzle_states."+s]&&(l[s]=JSON.parse(localStorage["puzzle_states."+s]))}n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=save_player_data&user_id="+r.account.user_id+"&internal_access_token="+r.account.internal_access_token,data:"&player_data="+t.compressToBase64(JSON.stringify(a)),error:r.errormessage,request_method:"POST",async:!0,success:e.success})}},i.load_player_data_from_server=function(e){function s(o){i.reset_player_data();var e=JSON.parse(t.decompressFromBase64(o.replace(/ /g,"+")));if(null==e)return void a();i.player_data=e.player_data,localStorage.player_data=JSON.stringify(i.player_data);var n=e.puzzle_states_keys,l=e.puzzle_states;if("undefined"!=typeof n&&(localStorage["puzzle_states.$keys"]=JSON.stringify(n)),"undefined"!=typeof n)for(var r in n){var s=JSON.stringify(l[r]);"undefined"!=typeof s&&(localStorage["puzzle_states."+r]=s)}a()}var e=e||{},a=("function"==typeof e.error?e.error:function(){},"function"==typeof e.success?e.success:function(){});"undefined"!=typeof r.account.internal_access_token&&n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=load_player_data&user_id="+r.account.user_id+"&internal_access_token="+r.account.internal_access_token,error:r.errormessage,request_method:"POST",async:!0,success:s})};{var l=90;+localStorage.game_version}+localStorage.game_version!=l&&(localStorage.game_version=l),"undefined"!=typeof localStorage.player_data&&"true"!=d().force_reset&&"true"!=d().hard_reset?i.player_data=JSON.parse(localStorage.player_data):("undefined"==typeof localStorage.player_data&&(i.first_run=!0),i.reset_player_data()),i.set_name=localStorage.set_name;var r=i.gs=new c;i.parent=document.body,document.original_title=document.title,document.original_title=document.original_title.substring(0,document.original_title.indexOf(":")),r.url_vars={};var _=i.history_control=new Mt({onbeforestatechange:function(e,t,n){r.try_requesting_fullscreen&&!r.IS_WEBVIEW&&r.is_phone_or_tablet&&U(document.documentElement),"jigsaw"==e.page&&"undefined"==typeof e.level&&(e.page="select_jigsaw"),"undefined"==typeof localStorage.set_name&&(e.page="select_mode"),(""==e.page||"index.php"==e.page||"index.html"==e.page.substr(e.page.lastIndexOf("/")+1))&&(e.page="select_mode"),"jigsaw"!=e.page&&"undefined"!=typeof e.level&&delete e.level,"undefined"==typeof t.url&&(t.url=e.page);var a=1==r.is_kiosk?!0:void 0;switch(t.url=e.page+Tt({testmode:e.testmode,is_kiosk:a,level:e.level,use_mini_images:e.use_mini_images},{record_undefined_values:!1}),r.kiip_loaded||(r.kiip_loaded=!0,void function(){"undefined"!=typeof window.Kiip&&(window.kiipInstance=new Kiip("600a5666aef46ed6adfcd04c39888721"),"true"==e.testmode&&(console.log("window.kiipInstance.setTestMode ()"),window.kiipInstance.setTestMode()),window.kiipInstance&&window.kiipInstance.setContainer("content_div"))}()),e.page){case"select_mode":t.title="Select Mode";break;case"select_jigsaw":t.title="Select Jigsaw";break;case"jigsaw":t.title="Jigsaw";break;case"mixnmatch":t.title="Mix N' Match"}t.title=h(e,t),"undefined"!=typeof i.game_data?n():i.load_game_data({new_state_page:e.page,callback:n})},can_do_popstate:function(){if("undefined"==typeof r||!r.IS_CORDOVA)return!0;if(0==r.smoke_window_list.length)return!0;var e=r.smoke_window_list[r.smoke_window_list.length-1];return e.close?e.close():e.cancel?e.cancel():e.ok&&e.ok(),!1},onstatechange:function(e,t){if(a.cleanup){a.cleanup()}switch(e.page){case"select_mode":if(r.IS_CORDOVA&&(r.select_mode_visited_count+=1,r.select_mode_visited_count>1&&r.is_android))return r.ad_control_list&&r.ad_control_list.destroy(),void i.save_player_data_to_server({success:navigator.app.exitApp,error:navigator.app.exitApp});ut({content_div:a,mr_jigtato:i,global_settings:r});break;case"select_jigsaw":dt({content_div:a,mr_jigtato:i,global_settings:r,callback:function(){}});break;case"jigsaw":ft({content_div:a,mr_jigtato:i,global_settings:r,level_id:e.level}),!r.account.purchased_ad_removal&&r.IS_WEBVIEW&&"undefined"!=typeof m&&_t({gs:r,mr_jigtato:i});break;case"mixnmatch":play_mixnmatch_screen({content_div:a,mr_jigtato:i,global_settings:r,level_id:e.level})}t()},initial_page:function(){var e=bt(window.location.href);return"/"==e[e.length-1]&&(e=e.substr(1,e.length-1)),-1!=e.indexOf("?")&&(e=e.substr(0,e.indexOf("?"))),e}(),var_name:"page",app_url_vars:r.url_vars}),a=document.createElement("div");if(a.className="jt-content_div",a.id="content_div",i.parent=document.body,i.parent.appendChild(a),smoke.parent=a,r.is_phone_or_tablet){smoke.custom_css={"buttons.ok":"hoverable"};var g=smoke.prompt;smoke.prompt=function(t,i,n){var e=g(t,i,n);return e.dialog.classList.add("smoke-dialog-at_the_top"),setTimeout(function(){e.prompt.input.focus()},500),e}}return ot({content_div:a,is_mobile:r.is_phone_or_tablet}),Et(),i.play_intro_audio=function(a){var h=a.level_id,s=a.count,t=i.game_data,o=t.entry_list[h],e="undefined"!=typeof o.audio_template?t.audio_template_list[o.audio_template]:o.audio;if("undefined"!=typeof e){if("object"!=typeof e)var n=e;else if("undefined"==typeof s)var n=Math.weightedSample(e);else{var l=0;for(var u in e)l+=1;s%=l;var c=0;for(var u in e){if(c==s)break;c+=1}var n=u}if("undefined"==typeof t.entry_audio_directory)var n=r.get_set_directory(i.set_name)+"/audio/"+n+".ogg";else var n=r.get_set_directory(i.set_name)+"/"+t.entry_audio_directory+"/"+n+".ogg";r.sound_effects_on&&(i.last_intro_audio=n,r.playAudio(n,{element:a.parent,restart:!0}))}},i.load_set_css=function(t){function s(n){var s=r.get_set_directory(a)+"/";n=n.replace(/url\('/g,"url('"+s),n=n.replace(/url\(\"/g,'url("'+s),e.innerHTML=n,e.charset="utf-8",e.media="screen",e.type="text/css",e.rel="stylesheet",o.insertBefore(e,o.lastChild),i.unload_set_css(),i.custom_css_div=e,t&&t(e)}var a=localStorage.set_name;if(i.custom_css_div)return t&&t(i.custom_css_div),i.custom_css_div;var o=document.getElementsByTagName("head")[0],l=n({success:s,error:function(e){r.errormessage(e,init.callback)},file:r.get_set_directory(a)+"/"+a+".css",charset:"utf-8",plaintext:!0,request_method:"GET",async:"undefined"!=typeof t}),e=document.createElement("style");return"undefined"==typeof t&&s(l),e},i.unload_set_css=function(){if("undefined"!=typeof i.custom_css_div){var e=i.custom_css_div;e.disabled="disabled",e.parentNode.removeChild(e),delete i.custom_css_div}},Object.defineProperty(i,"background_image_url",{get:function(){for(var e in i.game_data.background_list){var t=i.game_data.background_list[e];break}return r.get_set_directory(i.set_name)+"/"+t}}),i.get_trophy_item=function(e){var t=e.game_type,n=e.level_id,r=e.difficulty_level;switch(t){case"jigsaw":default:var a=i.game_data.entry_list[n].trophies[r]}return i.game_data.trophy_list[a]},i.menu={},i.menu.generic={},i.menu.generic.about={text:"About & Credit List",action:function(n,e,t){X({mr_jigtato:i,gs:i.gs,callback:e,menu:t})}},i.menu.generic.ogle_trophies={text:"Ogle Trophies",action:function(n,e,t){W({mr_jigtato:i,gs:i.gs,callback:e,menu:t})}},i.menu.generic.share={text:"Share",action:function(n,e,t){J({mr_jigtato:i,gs:i.gs,callback:e,menu:t})}},i.menu.generic.open_audio_settings_menu={text:"Audio Settings",action:et},i.menu.jigsaw={},i.menu.jigsaw.open_visual_settings_menu={text:"Visual Settings",action:tt},i.menu.jigsaw.toggle_freestyle_mode={text:function(){return"Freestyle Mode "+(i.gs.freestyle_mode?"On":"Off")},action:function(t,n){var e=t.currentTarget;i.gs.freestyle_mode=!i.gs.freestyle_mode,e.innerHTML=e.text(),n()}},i.menu.jigsaw.toggle_categories={text:function(){return"Categories "+(i.gs.use_categories?"Enabled":"Disabled")},action:function(n,r,a){var e=n.currentTarget;i.gs.use_categories=!i.gs.use_categories,e.innerHTML=e.text();var t=a.init.current_game;t&&t.game_title.autoshow_title({duration:500}),r()}},i.menu.jigsaw.open_misc_config_menu={text:"Misc. Config",action:it},i.menu.jigsaw.show_mini_hint_image={text:"Show Hint Image",action:nt},_.load_page(),i}function _t(i){function r(){e.own_ad_shown=!0,e.ad_control&&(e.ad_control.running=!0);var r="<p> Like this game?</p>";r+='<p>This game is an independent developer production -- made by 1 developer. If you like this game, please rate it. The more good ratings this game has, the easier it will be for others to find! You can also email me with questions or comments at: <a href="mailto:'+e.contact_info+'">'+e.contact_info+"</a>.</p>";var t=smoke.confirm(r,function(t){e.ad_control&&(e.ad_control.running=!1),0!=t&&("undefined"!=typeof e.google_play_access_token&&n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new.php?action=set_game_was_rated&internal_access_token="+e.account.internal_access_token+"&user_id="+e.account.user_id+"service_name="+e.service_name}),e.account.game_was_rated=!1,e.open_url(e.google_play_store_url))}),i=t.dialog.text.childNodes[1];t.dialog.text.childNodes[0].classList.add("jt-common-instruction_text-title"),i.classList.add("jt-common-instruction_text"),i.style.fontSize="55px",i.style.lineHeight="150%",i.style.height="auto",t.dialog.text.style.height=window.getComputedStyle(t.dialog.text).maxHeight,t.buttons.ok.innerHTML="Rate it.",t.buttons.cancel.innerHTML="Don't rate it.",a(t.buttons),t.buttons.ok.classList.add("hoverable"),t.buttons.cancel.classList.add("hoverable")}var e=i.gs,s=i.mr_jigtato,o=s.game_data.jigsaw.difficulty_levels[s.player_data.selected_difficulty],l=o.tile_x,c=o.tile_y,t=(e.show_ad_counter,Math.sqrt(l*c)/12);t>1&&(t=1),e.show_ad_counter+=t,console.log(e.ad_control_list_weights),e.ad_control=e.ad_control_list[Object.keys(e.ad_control_list_weights).indexOf(Math.weightedSample(e.ad_control_list_weights))],e.ad_control_list.forEach(function(t){t.is_active=t==e.ad_control}),e.show_ad_counter>=1?(e.show_ad_counter=e.show_ad_counter-parseInt(e.show_ad_counter),Math.random()>.1?e.ad_control&&e.ad_control.run():0==e.account.game_was_rated?r():e.ad_control.run()):Math.random()<=.1&&0==e.account.game_was_rated&&r()}function V(n){{var t=n.gs;n.mr_jigtato}t.own_ad_shown=!0,t.ad_control&&(t.ad_control.running=!0);var r="<p> Like this game?</p>";r+="<p>This game is an independent developer production -- made by 1 developer. It is supported by ads, puzzle pack purchases, and an ad removal purchase. Please consider purchasing some gems or upgrades to feed Tiny Tim. This window will self-destruct in 12 seconds.";var e=smoke.alert(r,function(){});e.buttons.ok.parentNode.removeChild(e.buttons.ok);var i=e.dialog.text.childNodes[1];e.dialog.text.childNodes[0].classList.add("jt-common-instruction_text-title"),i.classList.add("jt-common-instruction_text"),i.style.fontSize="55px",i.style.lineHeight="150%",i.style.height=i.style.maxHeight="862px",e.dialog.text.style.height=window.getComputedStyle(e.dialog.text).maxHeight,setTimeout(function(){t.ad_control&&(t.ad_control.running=!1),null!=e.parentNode&&e.parentNode.removeChild(e)},12e3)}function ot(n){var e=n.content_div,t=n.is_mobile;if(e.original_width=e.clientWidth,e.original_height=e.clientHeight,e.desired_scale=1,e.set_scale=function(t){"undefined"==typeof t&&(t=e.content_scale);var i=e;i.style.WebkitTransform=i.style.MSTransform=i.style.transform="scale("+t+", "+t+") rotate(360deg)";var n=I(e),r=l(e);e.style.marginLeft=Math.round((window.innerWidth-n)/2)+"px",e.style.marginTop=Math.round((window.innerHeight-r)/2)+"px",e.content_scale=t,e.draw_area&&e.draw_area.reposition_and_resize(),window.scrollTo(window.scrollX,0)},e.resize_to_page=function(n){if("undefined"==typeof n&&(n={}),"undefined"==typeof n.evt&&(n.evt={}),null==e.parentNode)return void clearInterval(o);if(t&&h())if(Math.abs(window.orientation)!=Math.abs(c))var p=s,f=a-i*!r;else var p=a,f=s-i*r;var g=e.original_width,_=e.original_height,y="undefined"!=typeof p?p:window.innerWidth,m="undefined"!=typeof f?f:window.innerHeight,l=y/g,u=m/_,d=l;d*_>m&&(d=u),(e.desired_scale_x!=l||e.desired_scale_y!=u)&&(e.desired_scale_x=l,e.desired_scale_y=u,e.desired_scale=d,e.set_scale(e.desired_scale))},!t)var o=setInterval(function(){e.resize_to_page()},50);if(t){var i=Math.abs(window.innerWidth/window.outerWidth*(window.outerHeight-window.screen.availHeight)),r=window.innerWidth>window.innerHeight,c=window.orientation,a=window.innerWidth,s=window.innerHeight+i,h=function(){return!!document.querySelector(".smoke-base > .smoke-dialog_wrapper > .smoke-dialog > .smoke-prompt")};window.addEventListener("resize",function(t){e.resize_to_page({evt:t})})}e.resize_to_page(),window.scrollTo(0,0)}function at(n){function i(t){e.isAttached()||e.destroy(),r=!("blur"==t.type)&&"visible"==document.visibilityState}var a=n.parent,e=document.createElement("div");e.direction="undefined"!=typeof n.direction?n.direction:1,e.counter="undefined"!=typeof n.counter?n.counter:0,e.do_stop_on_next_tick=!1,e.className="jt-play-timer",e.style.visibility="hidden",a.appendChild(e),e.progress=function(t){if(!t){if(1==e.do_stop_on_next_tick)return e.do_stop_on_next_tick=!1,void e.stop();r&&(e.counter+=e.direction)}e.display(),e.interval=setTimeout(e.progress,1e3)},e.stop=function(){0!=e.interval&&(clearTimeout(e.interval),e.interval=0),e.display()},e.stop_on_next_tick=function(){e.do_stop_on_next_tick=!0},e.start=function(){0!=e.interval&&(clearTimeout(e.interval),e.interval=0),e.counter=0,e.resume()},e.resume=function(){e.display(),0==e.interval&&e.progress(!0)},e.display=function(){e.style.visibility="visible";var t=Math.floor(e.counter/60);9>=t&&(t="0"+t);var i=e.counter%60;9>=i&&(i="0"+i),e.innerHTML=t+":"+i,e.setAttribute("current_text",e.innerHTML)},e.destroy=function(){document.removeEventListener(t,i),window.removeEventListener("blur",i),window.removeEventListener("focus",i)},e.interval=0;var t;"undefined"!=typeof document.hidden?t="visibilitychange":"undefined"!=typeof document.mozHidden?t="mozvisibilitychange":"undefined"!=typeof document.msHidden?t="msvisibilitychange":"undefined"!=typeof document.webkitHidden&&(t="webkitvisibilitychange"),"undefined"!=typeof t&&window.addEventListener(t,i),window.addEventListener("blur",i),window.addEventListener("focus",i);var r=!0;return e}function rt(t){var u=t.parent,p=t.menu_class,r=t.sort_attributes,c=t.entry_list,d=t.level_array,h=t.level_id,s=t.set_name,o=t.gs,i=t.sort_index[s],n=t.sort_direction[s],l=r[i].attribute_name,e=document.createElement("div");return e.className=p,e.classList.add("hoverable"),u.appendChild(e),a(e),e.refresh_text=function(){var t=r[i];e.innerHTML=0==n?t.up:t.down},e.advance_sort_mode=function(){r[i];0==n?n=1:(n=0,i=(i+1)%r.length,l=r[i].attribute_name),t.sort_direction[s]=n,t.sort_index[s]=i,o.select_menu_sort_direction=o.select_menu_sort_direction,o.select_menu_sort_index=o.select_menu_sort_index,e.refresh_text(),e.sort_levels()},e.sort_levels=function(){var i=r[t.sort_index[s]].default_sort_direction;d.sort(function(r,a){var e=c[r[h]][l],t=c[a[h]][l];return i-n==0?e>t?1:t>e?-1:0:t>e?1:e>t?-1:0}),e.onsort&&e.onsort()},e.refresh_text(),e.addEventListener(o.events.POINT,e.advance_sort_mode),e}function B(t){for(var n in t.init)t[n]=t.init[n];var a=t.parent,r=t.global_settings,i=t.menu_class,e=document.createElement("div");return e.classList.add("hoverable"),"string"==typeof i&&(i=[i]),i.forEach(function(t){e.classList.add(t)}),a.appendChild(e),("undefined"==typeof t.use_menu_button||1==t.use_menu_button)&&(e.morph_to_menu_button=function(){e.is_menu=!0,e.classList.remove("jt-common-back_button"),e.classList.add("jt-common-menu_button"),e.innerHTML="M",e.setAttribute("current_text","M")}),("undefined"==typeof t.use_back_button||1==t.use_back_button)&&(e.morph_to_back_button=function(){e.is_menu=!1,e.classList.add("jt-common-back_button"),e.classList.remove("jt-common-menu_button"),e.innerHTML="B",e.setAttribute("current_text","B")}),"undefined"==typeof t.start_with_back_button||0==t.start_with_back_button?e.morph_to_menu_button():e.morph_to_back_button(),e.addEventListener(r.events.POINT,function(){t.current_game;return 1==e.is_menu?void t.target.open():void(r.IS_WEBVIEW?window.history.back():t.mr_jigtato.history_control.load_page({page:"undefined"!=typeof t.back_button_page?t.back_button_page:"select_jigsaw"}))}),e}function _(t){var e=document.createElement("div");e.className="smoke-base";for(var l in t.init)l in t||(t[l]=t.init[l]);var u=t.parent,n=t.global_settings,r=t.current_game,h=t.menu_item_list;e.init=t,u.appendChild(e),e.style.display="none";var o=document.createElement("div");o.className="smoke-dialog_wrapper",e.appendChild(o);var s=document.createElement("div");s.className="smoke-dialog jt-play-settings_menu",o.appendChild(s),"undefined"!=typeof t.title&&(e.title_div=document.createElement("div"),e.title_div.className="jt-button jt-play-settings_menu-title",s.appendChild(e.title_div),e.title_div.innerHTML=t.title);var i=document.createElement("div");i.className="jt-play-settings_menu-grid",s.appendChild(i),e.settings_div_grid=i,"undefined"!=typeof h&&h.forEach(function(t){var r=document.createElement("div");r.text=t.text,r.innerHTML="function"==typeof t.text?t.text():t.text,i.appendChild(r),r.addEventListener(n.events.POINT,function(i){e.style.display="none",t.action(i,function(){e.style.display=""},e)})}),e.refresh=function(){i.children.forEach(function(e){e.children.forEach(function(e){"undefined"!=typeof e.text&&(e.innerHTML="function"==typeof e.text?e.text():e.text)})})};var c=e.back_button=document.createElement("div");return c.innerHTML="Back",i.appendChild(c),c.addEventListener(n.events.POINT,function(){e.close({callback:t.callback})}),e.open=function(){n.IS_CORDOVA&&n.smoke_window_list.push(e),r&&r.timer_obj&&r.timer_obj.stop_on_next_tick(),e.style.display="",i.style.height="auto",i.style.bottom="-100%",TweenMax.to(i,0,{ease:Linear.ease,css:{bottom:"0"}})},e.close=function(t){n.IS_CORDOVA&&void function(){var t=n.smoke_window_list.indexOf(e);-1!=t&&n.smoke_window_list.splice(t,1)}(),TweenMax.to(i,0,{ease:Linear.ease,css:{bottom:"-100%"}}),setTimeout(function(){r&&!e.parent_menu&&r.timer_obj&&r.timer_obj.resume(),e.style.display="none","undefined"!=typeof t&&"undefined"!=typeof t.callback&&t.callback(e)},0)},e.position_buttons=function(){var r=Math.ceil(i.children.length/t.column_size),e=0,a=0,n=null;i.children.forEach(function(s){0==e&&(n=document.createElement("div"),t.column_width&&(n.style.width=t.column_width),i.appendChild(n)),e+=1,e==r&&(e=0,a+=1),s.classList.add("jt-button"),s.classList.add("hoverable"),n.appendChild(s)})},a(e),e}function Z(t){function s(){switch(e.game_type){case"jigsaw":i.push(n.menu.jigsaw.toggle_freestyle_mode),i.push({text:function(){return"Center On Move "+(e.jigsaw_center_piece_on_move?"On":"Off")},action:function(i,n){var t=i.currentTarget;e.jigsaw_center_piece_on_move=!e.jigsaw_center_piece_on_move,t.innerHTML=t.text(),n()}}),i.push({text:function(){return'"Arrange Pieces" Places Pieces '+(1==e.jigsaw_arrange_pieces_on_entire_area?"On Entire Area":0==e.jigsaw_arrange_pieces_on_entire_area?"On Either Side":"Using Best Fit")},action:function(i,n){var t=i.currentTarget;e.jigsaw_arrange_pieces_on_entire_area=(e.jigsaw_arrange_pieces_on_entire_area+1)%3,t.innerHTML=t.text(),r&&(2!=e.jigsaw_arrange_pieces_on_entire_area&&(r.game_instance.jigsaw_arrange_pieces_on_entire_area=e.jigsaw_arrange_pieces_on_entire_area),r.refresh_gui_display()),n()}}),i.push({text:function(){return"Reduce Texture Size "+(4==e.jigsaw_reduce_texture_size?"Off":">= Difficulty "+(1+e.jigsaw_reduce_texture_size))},action:function(i,n){var t=i.currentTarget;e.jigsaw_reduce_texture_size=(e.jigsaw_reduce_texture_size+1)%5,t.innerHTML=t.text(),n()}})}i.push({text:"Reset Default Settings",action:function(t,e){H({current_game:r,mr_jigtato:n,callback:e})}}),i.push({text:"Load Player Data From Server",action:function(){smoke.confirm('<span style="color:red; weight:bold">Warning</span>: this will overwrite you current local data with data from the server. Proceed?',function(i){0!=i&&n.load_player_data_from_server({error:e.errormessage,success:function(){if("undefined"!=typeof t.select_screen){var e=t.select_screen;e.create_puzzle_selection_array(),e.refresh_puzzle_list(),e.create_selection_tab_container(),e.sort_button.sort_levels()}}})})}}),i.push({text:"Save Player Data to Server",action:function(){n.save_player_data_to_server({error:e.errormessage,success:function(){smoke.alert("Player data saved to server.")}})}}),i.push({text:"Reset Player Data",action:function(i,e){ht({current_game:r,select_screen:t.select_screen,mr_jigtato:n,callback:e})}})}var n=t.mr_jigtato,e=t.gs,r=t.current_game;"undefined"==typeof t.menu_item_list&&(t.menu_item_list=[]);var i=t.menu_item_list;s();{var a=new _(t);a.settings_div_grid}return a.position_buttons(),a}function Q(n){function a(){i.push({text:function(){return"Timer "+(e.show_timer?"Visible":"Hidden")},action:function(n,r,a){var t=n.currentTarget;e.show_timer=!e.show_timer,t.innerHTML=t.text();var i=a.init.current_game;i&&(i.timer_obj.style.display=e.show_timer?"":"none"),r()}}),n.show_hint_image_options&&i.push({text:function(){return"Hint Image "+(e.jigsaw_show_hint_rect?e.jigsaw_show_hint_image?"Transparent":"Blank":"Off")},action:function(n,r){var i=n.currentTarget;e.jigsaw_show_hint_rect?e.jigsaw_show_hint_image?e.jigsaw_show_hint_image=!1:e.jigsaw_show_hint_rect=!1:(e.jigsaw_show_hint_rect=!0,e.jigsaw_show_hint_image=!0),i.innerHTML=i.text(),t&&(t.game_instance.jigsaw_show_hint_image=e.jigsaw_show_hint_image,t.game_instance.jigsaw_show_hint_rect=e.jigsaw_show_hint_rect,t.refresh_gui_display(),t.save_puzzle_state()),r()}}),i.push({text:function(){return"(Normal UI) Trophy Ribbon "+(e.show_trophy_ribbon?"Visible":"Hidden")},action:function(n,r){var i=n.currentTarget;e.show_trophy_ribbon=!e.show_trophy_ribbon,i.innerHTML=i.text(),t&&t.refresh_gui_display(),r()}}),i.push({text:function(){return"Minimal UI "+(e.jigsaw_minimal_ui?"On":"Off")},action:function(n,r){var i=n.currentTarget;if(e.jigsaw_minimal_ui=!e.jigsaw_minimal_ui,i.innerHTML=i.text(),r(),t){var a=t.main_image.base_image.width;t.set_base_image_size();var s=t.main_image.base_image.width;t.refresh_gui_display(),t.redraw_main_image_and_pieces({piece_rescale:s/a,callback:function(){t.refresh_gui_display(),t.save_puzzle_state()}})}}}),i.push({text:function(){return(0==e.jigsaw_image_size_type?"Compact":1==e.jigsaw_image_size_type?"Large":"Larger")+" Images "},action:function(n,r){var i=n.currentTarget;if(e.jigsaw_image_size_type=(e.jigsaw_image_size_type+1)%3,i.innerHTML=i.text(),r(),t){var a=t.main_image.base_image.width;t.set_base_image_size();var s=t.main_image.base_image.width;t.refresh_gui_display(),t.redraw_main_image_and_pieces({piece_rescale:s/a,callback:function(){t.refresh_gui_display(),t.save_puzzle_state()}})}}}),i.push({text:function(){return"Piece scale at: "+parseInt(100*+e.jigsaw_piece_scale_to_actual)+"%"},action:function(n,r){var i=n.currentTarget;e.jigsaw_piece_scale_to_actual_index=(e.jigsaw_piece_scale_to_actual_index+1)%e.jigsaw_piece_scale_to_actual_options.length,e.jigsaw_piece_scale_to_actual=e.jigsaw_piece_scale_to_actual_options[e.jigsaw_piece_scale_to_actual_index],i.innerHTML=i.text(),t&&(t.category_deck.container.children.forEach(function(e){t.size_pieces(e.piece_container.children)}),t.screen_refresh()),r()}}),i.push({text:function(){return"2.5D Pieces "+(e.jigsaw_use_3d_effect?"On":"Off")},action:function(n,r){var i=n.currentTarget;e.jigsaw_use_3d_effect=!e.jigsaw_use_3d_effect,i.innerHTML=i.text(),r(),t&&(t.game_instance.piece_margin=e.jigsaw_get_scaled_piece_margin(t.game_instance),t.game_instance.piece_margin_style=e.jigsaw_piece_margin_style,t.redraw_main_image_and_pieces())}}),i.push({text:function(){return"Combine Pieces "+(e.jigsaw_combine_pieces?"On":"Off")},action:function(n,r){r();var i=n.currentTarget;e.jigsaw_combine_pieces=!e.jigsaw_combine_pieces,i.innerHTML=i.text(),t&&t.redraw_main_image_and_pieces()}}),i.push({text:function(){return"Colored Borders "+(e.jigsaw_colored_borders?"On":"Off")},action:function(n,r){var i=n.currentTarget;e.jigsaw_colored_borders=!e.jigsaw_colored_borders,i.innerHTML=i.text(),r(),t&&(t.game_instance.piece_margin=e.jigsaw_get_scaled_piece_margin(t.game_instance),t.game_instance.piece_margin_style=e.jigsaw_piece_margin_style,t.redraw_main_image_and_pieces())}}),i.push({text:function(){return"Animate Placement "+(e.jigsaw_animate_piece_placement?"On":"Off")},action:function(i,n){var t=i.currentTarget;e.jigsaw_animate_piece_placement=!e.jigsaw_animate_piece_placement,t.innerHTML=t.text(),n()}}),i.push({text:function(){var t=e.jigsaw_heat_seeking_color_options[e.jigsaw_heat_seeking_color_index];return"Heat Seeking Color "+("undefined"==typeof t?"Off":t.capitalize())},action:function(i,n){var t=i.currentTarget;e.jigsaw_do_heat_seeking=!e.jigsaw_do_heat_seeking,e.jigsaw_heat_seeking_color_index=(e.jigsaw_heat_seeking_color_index+1)%e.jigsaw_heat_seeking_color_options.length,t.innerHTML=t.text(),n()}})}var e=n.gs,t=n.current_game;"undefined"==typeof n.menu_item_list&&(n.menu_item_list=[]);var i=n.menu_item_list;a();{var r=new _(n);r.settings_div_grid}return r.position_buttons(),r}function $(i){function a(){t.push({text:function(){return"Sound FX "+(e.sound_effects_on?"Enabled":"Disabled")},action:function(i,n){var t=i.currentTarget;e.sound_effects_on=!e.sound_effects_on,t.innerHTML=t.text(),n()}}),t.push({text:function(){return"Music "+(e.music_on?"Enabled":"Disabled")},action:function(i,n){var t=i.currentTarget;e.music_on=!e.music_on,t.innerHTML=t.text(),n()}}),t.push({text:function(){return"Ambient Music "+(e.ambient_music_on?"Enabled":"Disabled")},action:function(n,t){var i=n.currentTarget;e.ambient_music_on=!e.ambient_music_on,i.innerHTML=i.text(),e.ambient_music_on?smoke.alert('Note: ambient music won\'t play if the "music" setting is set to "disabled."',t):t()}}),t.push({text:"Play Next Music Track",action:function(i,t){e.ambient_music.play_next_track(),r(),t()}}),t.push({text:function(){return(e.run_audio_in_background?"Do":"Don't")+" Run Audio In Background"},action:function(i,n){var t=i.currentTarget;e.run_audio_in_background=!e.run_audio_in_background,t.innerHTML=t.text(),n()}}),t.push({text:function(){return"Sound Volume: "+e.sound_effects_volume},action:function(n,t){var i=n.currentTarget;e.sound_effects_volume=(e.sound_effects_volume+1)%11+(10==e.sound_effects_volume),i.innerHTML=i.text(),t(),t()}}),t.push({text:function(){return"Music Volume: "+e.music_volume},action:function(n,t){var i=n.currentTarget;e.music_volume=(e.music_volume+1)%11+(10==e.music_volume),i.innerHTML=i.text(),t(),t()}}),t.push({text:function(){return"Ambient Music Volume: "+e.ambient_music_volume},action:function(i,n){var t=i.currentTarget;e.ambient_music_volume=(e.ambient_music_volume+1)%11+(10==e.ambient_music_volume),t.innerHTML=t.text(),n()}}),t.push({text:function(){return"Current Playlist: "+e.ambient_music_playlist_name},action:function(n,t){var i=n.currentTarget;t(),e.ambient_music.play_next_playlist(),i.innerHTML=i.text(),t()}})}{var e=i.gs;i.current_game}"undefined"==typeof i.menu_item_list&&(i.menu_item_list=[]);var t=i.menu_item_list;a();var n=new _(i),r=(n.settings_div_grid,e.set_audio_menu_title=function(){var t=e.ambient_music.playlist,i=e.ambient_music.current_track_index;n.title_div.innerHTML='"'+t[i].title+'", by '+t[i].author});return r(),n.position_buttons(),n}function F(t){var e=(t.parent,t.gs),o=t.current_game,s=t.menu_item_list;s.push({text:function(){return"Music "+(e.music_on?"Enabled":"Disabled")},action:function(i,n){var t=i.currentTarget;e.music_on=!e.music_on,t.innerHTML=t.text(),n()}}),e.challenge_code_processed||s.push({text:"Challenge Code",action:function(t,i){var n=t.currentTarget;u({gs:e,error:function(){smoke.alert("You must log in to Google Play to use this feature!")},success:function(){v({gs:e,callback:function(){e.challenge_code_processed&&(n.style.display="none"),i()}})}})}});var i=new _(t),r=i.settings_div_grid,n=document.createElement("div");if(n.innerHTML="How to Play",n.addEventListener(e.events.POINT,function(){function o(){n.back.style.visibility=0==r?"hidden":"visible",n.next.style.visibility=r==a.length-1?"hidden":"visible",s.text.innerHTML=a[r],s.text.classList.add("jt-common-instruction_text")}var a=t.mr_jigtato.game_data.jigsaw.instructions;i.style.display="none";var r=0,s=smoke.alert("",function(){i.style.display=""}),n=s.buttons;n.back=s.buttons.ok.cloneNode(!0),n.back.style.cssFloat="left",n.back.innerHTML="< Back",n.appendChild(n.back),n.next=s.buttons.ok.cloneNode(!0),n.next.style.cssFloat="right",n.next.innerHTML="Next >",n.appendChild(n.next),n.back.addEventListener(e.events.POINT,function(){r=(r+a.length-1)%a.length,o(r)}),n.next.addEventListener(e.events.POINT,function(){r=(r+a.length+1)%a.length,o(r)}),o(r),h(s)}),!e.is_kiosk&&e.use_social_media_buttons){var a=document.createElement("div");a.innerHTML=(1==t.social_media_hidden?"Show":"Hide")+" Social Buttons",r.insertBefore(n,i.back_button),a.addEventListener(e.events.POINT,function(){t.social_media_hidden=!t.social_media_hidden,o.social_sharing_button_container.style.display=t.social_media_hidden?"none":"",a.innerHTML=(1==t.social_media_hidden?"Show":"Hide")+" Social Buttons"})}return r.insertBefore(n,r.childNodes[0]),i.position_buttons(),i}function q(e){e.audio_list.forEach(function(t){e.parent.playAudio(e.dir+t,{start:!1,volume:e.volume||1,audio_type:e.type})})}function ht(e){"undefined"==typeof e.callback&&(e.callback=function(){});var t=smoke.confirm('<span style="color: #cc0000; font-weight: bold">Warning:</span> This will clear/reset all player data: progress, trophies, trophies, best times, etc. Continue?',function(t){return 0==t?void e.callback():(e.mr_jigtato.reset_player_data(),e.current_game&&e.current_game.trophy_ribbon&&e.current_game.trophy_ribbon.update(),e.select_screen&&e.select_screen.refresh_puzzle_list(),void smoke.alert("All player data has been reset.",e.callback))});h(t)}function H(e){function t(){e.mr_jigtato.gs.reset_default_settings(),smoke.alert("Settings have been reset to default.",i)}"undefined"==typeof e.callback&&(e.callback=function(){});var i=e.callback;if("undefined"!=typeof e.current_game){i=function(){e.mr_jigtato.gs.IS_WEBVIEW?window.history.back():e.mr_jigtato.history_control.load_page({page:"select_jigsaw"}),e.callback()};var n=!1;n?smoke.alert("Resetting will send you back to the puzzle selection screen.",t):t()}else t()}function X(i){function l(){e.back.style.visibility=0==t?"hidden":"visible",e.next.style.visibility=t==r.length-1?"hidden":"visible",s.text.innerHTML=r[t],s.text.parentNode.classList[1==t?"add":"remove"]("jt-play-show_credits-dialog")}"undefined"==typeof i.callback&&(i.callback=function(){});var a=i.gs,c=i.mr_jigtato,o=c.game_data,u=c.set_name,r=[],d=i.gs.is_kiosk?a.contact_info:'<a href="mailto:'+a.contact_info+'">'+a.contact_info+"</a>";r[0]=o.about_text+d+". </p>",i.callback,r[1]="Loading...",n({error:function(e){a.errormessage(e,i.callback)},file:a.get_set_directory(u)+"/"+u+"-credits.txt",charset:"utf-8",plaintext:!0,request_method:"GET",success:function(t){var n=i.menu.init.current_game;if(n){var s=n.game_instance,e=i.menu.init.level_id,l=s.difficulty_level,c=o.entry_list[e].name,h=o.entry_list[e].credit,a=o.trophy_list[o.entry_list[e].trophies[l]],u=a.display_name.capitalizeFirstLetter(),d=a.credit;r[1]=t+'<span style="width: 1rem; height: .5rem; display: block"></span><h2> Puzzle image credits </h2><p><b>'+c+"</b>: "+h+'</p><span style="width: 1rem; height: .5rem; display: block"></span><h2> Trophy image credits </h2><p><b>'+u+"</b>: "+d+"</p>"}else r[1]=t}});var s=smoke.alert(o.about_text+a.contact_info+". </p>",i.callback),e=s.buttons;e.back=s.buttons.ok.cloneNode(!0),e.back.style.cssFloat="left",e.back.innerHTML="< Back",e.appendChild(e.back),e.next=s.buttons.ok.cloneNode(!0),e.next.style.cssFloat="right",e.next.innerHTML="Next >",e.appendChild(e.next),e.back.addEventListener(a.events.POINT,function(){t=(t+r.length-1)%r.length,l(t)}),e.next.addEventListener(a.events.POINT,function(){t=(t+r.length+1)%r.length,l(t)});var t=0;l(t),h(s),a.is_phone_or_tablet&&(s.dialog.text.style.backgroundColor="transparent")}function W(a){function o(l){var o=l.currentTarget,a=o.trophy_item,s=i.game_data.entry_list[o.level_id];t.innerHTML="";var e=document.createElement("span");e.className="jt-play-trophy_room-item_name",e.style.color=a.text_color,e.innerHTML=a.display_name.capitalizeFirstLetter(),t.appendChild(e),n.is_chromium||n.is_android?(e.style.textShadow="none",e.style.WebkitTextStrokeColor=a.text_outline_color.split(",")[0].trim(),w({element:e,size:"3px",color:""})):z(e,a.text_outline_color||"black");var c=document.createTextNode(".. earned for completing the puzzle ");t.appendChild(c);var r=document.createElement("span");r.className="jt-play-trophy_room-puzzle_name",r.style.color=s.title_color,r.innerHTML='"'+s.name+'"',t.appendChild(r),n.is_chromium||n.is_android?(r.style.textShadow="none",r.style.WebkitTextStrokeColor=s.border_color.split(",")[0].trim(),w({element:r,size:"3px",color:""})):z(r,s.border_color||"black");var h=document.createTextNode(' on difficulty level "'+i.game_data.jigsaw.difficulty_levels[o.trophy_index].name+'".');t.appendChild(h)}var n=a.gs;"undefined"==typeof a.callback&&(a.callback=function(){});var d=smoke.alert("",a.callback);h(d);var e=d.childNodes[0].childNodes[0].childNodes[0],u=e.nextSibling;e.parentNode.classList.add("jt-play-trophy_room-dialog");var r=document.createElement("div");r.className="smoke-dialog-text jt-play-trophy_room-title",e.parentNode.insertBefore(r,e);var l=document.createElement("div");l.className="jt-play-trophy_room-title-image",r.appendChild(l);var s=document.createElement("div");s.className="jt-play-trophy_room-title-text",s.innerHTML="Trophy Room",r.appendChild(s);var c=document.createElement("div");c.className="jt-play-trophy_room-title-image",r.appendChild(c),u.classList.add("jt-play-trophy_room-dialog-buttons"),r.appendChild(u);var t=document.createElement("div");t.className="smoke-dialog-text jt-play-trophy_room-description",e.parentNode.insertBefore(t,e.nextSibling),t.innerHTML="Touch, click, or hover over a trophy to see details!",e.classList.add("jt-play-trophy_room-container");var i=a.mr_jigtato,p=(i.game_data.jigsaw,i.player_data),f=p.jigsaw.trophies,_=i.set_name;return f.forEach(function(s){var r=s.split("|")[0],a=s.split("|")[1],l=i.get_trophy_item({game_type:"jigsaw",level_id:r,difficulty_level:a}),t=S({mr_jigtato:i,gs:n,set_name:_,level_id:r,difficulty_level:a,trophy_class:"jt-play-main_image_border_width"});e.appendChild(t),t.trophy_item=l,t.level_id=r,t.trophy_index=a,t.addEventListener(n.events.POINT,o),t.addEventListener("mouseover",o)}),e}function J(e){"undefined"==typeof e.callback&&(e.callback=function(){});var t=smoke.alert("<p>If you liked this game, share it!</p>",e.callback).text;G({parent:t,button_class:"jt-social_button"})}function G(n){var e=window.location.toString(),r=e.indexOf("//")+1,r=e.indexOf("/",r+1)+1,e=e.substr(0,r),s={},a={twitter:'<a count="none" href="https://twitter.com/share" class="twitter-share-button" data-url="'+e+'" data-size="large" data-count="none"></a>',facebook:'<div style="left:0; top:0; width:20px; height:20px" class="fb-share-button" data-href="'+e+'" data-width="100" data-type="icon"></div>',googleplus:'<g:plusone count="false" style="width:80px; height: 80px" data-size="tall" expandTo="top" data-href="'+e+'"></g:plusone>'};for(var i in a){var t=document.createElement("div");t.className=n.button_class+" jt-social_button-"+i,t.button_name=i,s[i]=t,t.innerHTML=a[i],n.parent.appendChild(t)}"undefined"!=typeof twttr&&twttr.widgets.load(),"undefined"!=typeof FB&&FB.XFBML.parse(document.getElementsByClassName("fb-share-button")[0].parentNode),"undefined"!=typeof gapi&&gapi.plusone.go()}function U(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function K(){var e="true"==d().is_kiosk?!0:!1;e||void function(e,n){var t,r=e.getElementsByTagName(n)[0],a=e.createDocumentFragment(),i=function(r,i){e.getElementById(i)||(t=e.createElement(n),t.src=r,i&&(t.id=i),a.appendChild(t))};i("http://apis.google.com/js/plusone.js"),i("//platform.twitter.com/widgets.js"),i("//connect.facebook.net/en_US/all.js#xfbml=1&appId=1484397078438785"),r.parentNode.insertBefore(a,r)}(document,"script")}function S(t){var n=t.gs,a=t.set_name,s=t.level_id,r=t.mr_jigtato,o=("undefined"!=typeof t.game_type?t.game_type:"jigsaw",r.game_data.jigsaw),i=r.get_trophy_item({game_type:o,level_id:s,difficulty_level:t.difficulty_level}),e=document.createElement("img");e.className=t.trophy_class;var l="undefined"!=typeof t.parent?t.parent:document.body;e.style.backgroundColor=i.background_color,"undefined"!=typeof i.link&&(e.style.cursor="pointer",e.a=document.createElement("a"),e.a.target="_blank",e.a.href=i.link,e.addEventListener(n.events.POINT,function(){e.a[n.events.POINT]()})),l.appendChild(e);var c=e.getBoundingClientRect().width;return"undefined"!=typeof i.trophy_image_padding&&(e.style.padding=parseFloat(i.trophy_image_padding)*c/356+"px"),"undefined"!=typeof i.trophy_image_border_color&&(e.style.borderColor=i.trophy_image_border_color),n.get_image(e,a,i.filename,"trophy"),e}function et(r,a,i){var e=i.init.parent;if("undefined"==typeof e.audio_settings_menu||null==e.audio_settings_menu.parentNode){var t=s(i.init);delete t.menu_item_list,e.audio_settings_menu=$({callback:function(e){e.style.display="none",e.parent_menu.style.display="",e.parent_menu.refresh()},parent:e,mr_jigtato:t.mr_jigtato,gs:t.gs,current_game:t.current_game,column_size:2,title:"",column_width:"760px",init:t})}var n=e.audio_settings_menu;n.refresh(),i.style.display="none",n.style.display="",n.parent_menu=i}function tt(r,a,i){var t=i.init.parent;if("undefined"==typeof t.visual_settings_menu||null==t.visual_settings_menu.parentNode){var e=s(i.init);delete e.menu_item_list,t.visual_settings_menu=Q({callback:function(e){e.style.display="none",e.parent_menu.style.display="",e.parent_menu.refresh()},parent:t,mr_jigtato:e.mr_jigtato,gs:e.gs,current_game:e.current_game,show_hint_image_options:e.show_hint_image_options,column_size:2,init:e})}var n=t.visual_settings_menu;n.refresh(),i.style.display="none",n.style.display="",n.parent_menu=i}function it(r,a,t){var i=t.init.parent;if("undefined"==typeof i.misc_config_menu||null==i.misc_config_menu.parentNode){var e=s(t.init);delete e.menu_item_list,i.misc_config_menu=Z({callback:function(e){e.style.display="none",e.parent_menu.style.display="",e.parent_menu.refresh()},mr_jigtato:e.mr_jigtato,gs:e.gs,current_game:e.current_game,column_size:2,show_hint_image_options:e.show_hint_image_options,init:e})}var n=i.misc_config_menu;n.refresh(),t.style.display="none",n.style.display="",n.parent_menu=t}function nt(p,h,t){t.style.display="none";var i=(t.init.current_game.main_image.base_image.src,smoke.alert("",function(){}));i.innerHTML="";var d=t.init.mr_jigtato.gs,o=t.init.content_div,e=document.createElement("img"),s=t.init.current_game.main_image;e.style.position="absolute",e.style.padding=0,e.src=s.base_image.src,e.className="smoke-dialog",i.appendChild(e);var u=s.width/s.height,a=1e3*u,r=1e3,l=(parseFloat(window.getComputedStyle(o).width)-a)/2,c=(parseFloat(window.getComputedStyle(o).height)-r)/2,n=parseFloat(window.getComputedStyle(e).borderLeftWidth);e.style.cursor="pointer",e.style.left=l-n+.1*a+"px",e.style.top=c-n+.1*r+"px",e.style.width=.8*a+"px",e.style.height=.8*r+"px",TweenMax.to(e,.5,{ease:Linear.easeIn,css:{left:l-n+"px",top:c-n+"px",width:a+"px",height:r+"px"}}),i.addEventListener(d.events.POINT,function(){i.parentNode.removeChild(i),t.style.display="",h()})}function u(t){var e=t.gs;if("undefined"!=typeof e.account.internal_access_token)return void t.success();if(e.IS_CORDOVA)var i=window.plugins.GooglePlayToken||window.plugins.GooglePlayServices;else var i=e.gps;i.initialize({error:t.error,success:function(i){e.IS_CORDOVA?(e.google_play_access_token=i,D(t)):e.get_google_play_access_token({callback:function(){D(t)}})}})}function D(t){var e=t.gs;return"undefined"==typeof e.google_play_access_token?void("undefined"!=typeof t.error&&t.error()):void n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=login&access_token="+e.google_play_access_token+"&service_name="+e.service_name+"&device_model="+device.model+"&device_uuid="+device.uuid,error:t.error,request_method:"POST",async:!0,success:function(n){if(null==n)return void t.error();if("undefined"!=typeof n.user_data){lt({gs:e});var i=n.user_data;"undefined"!=typeof i.game_was_rated&&(e.account.game_was_rated=i.game_was_rated),"undefined"!=typeof i.user_id&&(e.account.user_id=i.user_id),"undefined"!=typeof i.gem_amount&&(e.account.gem_amount=i.gem_amount),"undefined"!=typeof i.internal_access_token&&(e.account.internal_access_token=i.internal_access_token),"undefined"!=typeof i.email_address&&(e.account.email_address=i.email_address),"undefined"!=typeof i.users_to_puzzle_packs&&(e.account.users_to_puzzle_packs=i.users_to_puzzle_packs),"undefined"!=typeof i.purchased_ad_removal&&(e.account.purchased_ad_removal=1==i.purchased_ad_removal),e.IS_CORDOVA&&e.account.purchased_ad_removal&&e.ad_control_list&&e.ad_control_list.destroy()}void function(){function t(){e.get_google_play_access_token(),setTimeout(t,i)}var i=27e5;setTimeout(t,i)}(),e.paid_puzzles=n.paid_puzzles,"undefined"!=typeof n.message&&(e.pending_message=n.message),t.success()}})}function st(){function t(){e.registerDevice(function(e){console.log(e)},function(e){console.log(e)})}var e=window.plugins.pushNotification;"undefined"!=typeof e&&(document.addEventListener("push-notification",function(e){e.notification.title,e.notification.userdata}),e.onDeviceReady({projectid:"694160809438",appid:"D2CCB-D24E6"}),e.unregisterDevice(t,t))}function j(t){function a(t,e){"undefined"==typeof e&&(e=s.errormessage),n({file:t,request_method:"GET",async:!0,error:e,success:d})}function r(){if(s.IS_CORDOVA){a(c+"/"+e,function(){a(l+"/"+e)})}else a(o+"/"+e)}function m(){if(s.IS_CORDOVA){var t=new FileTransfer,i=encodeURI(o+"/"+e);t.download(i,c+"/"+e,r,r,!1,{headers:{}})}else r()}var s=t.gs,_=(t.IS_DEBUG_MODE,t.DO_NOT_USE_REMOTE_FILE),o=t.remote_dir,l=t.initial_local_dir,c=t.persistent_local_dir,e=t.target_filename,u=t.error,d=t.success;if(s.IS_DEBUG_MODE){var p=e.substr(0,split),f=e.substr(split+1);e=p+"-beta."+f}if(_)return void a(l+"/"+e,u);var h=1420082059;"undefined"==typeof localStorage.json_file_version_date&&(localStorage.json_file_version_date=JSON.stringify(+h));var i=new XMLHttpRequest;i.open("HEAD",o+"/"+e,!0),i.onreadystatechange=function(){if(4==i.readyState){if(200!=i.status)return void r();var s=i.getResponseHeader("Last-Modified"),t=s.split(" "),n=+new Date(t[2]+" "+t[1]+" "+t[3]+" "+t[4]+" "+t[5])/1e3,o="undefined"==typeof localStorage.json_file_version_date?0:JSON.parse(localStorage.json_file_version_date);h>=n?a(l+"/"+e,u):n>o?(localStorage.json_file_version_date=JSON.stringify(+n),m()):r()}},i.send(null)}function lt(a){function s(){for(var n in i){{i[n],e.google_play_store.product_list.ad_removal}t.when(n).approved(function(e){e.verify()}),t.when(n).verified(function(e){console.log("Verified: "+e.id+"."),console.log("Purchase complete: "+e.id+"."),e.finish()})}}var e=a.gs;if(e.IS_CORDOVA&&window.store){var t=window.store;t.validator=function(i,r){n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new.php?action=check_purchase&internal_access_token="+e.account.internal_access_token+"&user_id="+e.account.user_id+"&signature="+encodeURIComponent(i.transaction.signature)+"&receipt="+encodeURIComponent(i.transaction.receipt),success:function(t){console.dir(t),"undefined"!=typeof t&&("undefined"!=typeof t.purchased_ad_removal&&(e.ad_control_list&&e.ad_control_list.destroy(),e.purchased_ad_removal=!0),"undefined"!=typeof t.gem_amount&&(console.log("Gem purchase complete: "+(t.gem_amount-e.account.gem_amount)+" gems."),e.account.gem_amount=t.gem_amount)),i.finish_single_use_callback&&(i.finish_single_use_callback(i),delete i.finish_single_use_callback),r(!0)},error:function(e){r(!1,{error:{code:t.PURCHASE_EXPIRED,errormessage:e}})}})},t.error(function(t){e.errormessage("Google Play Store error "+t.code+": "+t.message)}),e.google_play_store={};var i=e.google_play_store.product_list={ad_removal:{consumable:!1},gems_10:{consumable:!0},gems_30:{consumable:!0},gems_50:{consumable:!0},gems_100:{consumable:!0}};for(var r in i)t.register({id:r,alias:r,type:t[i[r].consumable?"CONSUMABLE":"NON_CONSUMABLE"]}),i[r]=t.get(r);s(),console.dir(i),t.refresh()}}function ct(){function t(e,t){arguments.length>0&&this.init(e,t)}function n(e,t){arguments.length>0&&this.init(e,t)}function e(){this.init(arguments)}var r={};return t.prototype.init=function(e,t){this.x=e,this.y=t},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.multiply=function(e){return new t(this.x*e,this.y*e)},n.prototype.init=function(e,t){this.x=e,this.y=t},e.TOLERANCE=1e-6,e.ACCURACY=6,e.prototype.init=function(t){this.coefs=new Array;for(var e=t.length-1;e>=0;e--)this.coefs.push(t[e])},e.prototype.eval=function(i){for(var e=0,t=this.coefs.length-1;t>=0;t--)e=e*i+this.coefs[t];return e},e.prototype.simplify=function(){for(var t=this.getDegree();t>=0&&Math.abs(this.coefs[t])<=e.TOLERANCE;t--)this.coefs.pop()},e.prototype.bisection=function(i,n){var t,r=this.eval(i),s=this.eval(n);if(Math.abs(r)<=e.TOLERANCE)t=i;else if(Math.abs(s)<=e.TOLERANCE)t=n;else if(0>=r*s)for(var l=Math.log(n-i),c=Math.log(10)*e.ACCURACY,h=Math.ceil((l+c)/Math.log(2)),o=0;h>o;o++){t=.5*(i+n);var a=this.eval(t);if(Math.abs(a)<=e.TOLERANCE)break;0>a*r?(n=t,s=a):(i=t,r=a)}return t},e.prototype.getDegree=function(){return this.coefs.length-1},e.prototype.getDerivative=function(){for(var i=new e,t=1;t<this.coefs.length;t++)i.coefs.push(t*this.coefs[t]);return i},e.prototype.getRoots=function(){var e;switch(this.simplify(),this.getDegree()){case 0:e=new Array;break;case 1:e=this.getLinearRoot();break;case 2:e=this.getQuadraticRoots();break;case 3:e=this.getCubicRoots();break;case 4:e=this.getQuarticRoots();break;default:e=new Array}return e},e.prototype.getRootsInInterval=function(r,a){var e,n=new Array;if(1==this.getDegree())e=this.bisection(r,a),null!=e&&n.push(e);else{var s=this.getDerivative(),t=s.getRootsInInterval(r,a);if(t.length>0){for(e=this.bisection(r,t[0]),null!=e&&n.push(e),i=0;i<=t.length-2;i++)e=this.bisection(t[i],t[i+1]),null!=e&&n.push(e);e=this.bisection(t[t.length-1],a),null!=e&&n.push(e)}else e=this.bisection(r,a),null!=e&&n.push(e)}return n},e.prototype.getLinearRoot=function(){var e=new Array,t=this.coefs[1];return 0!=t&&e.push(-this.coefs[0]/t),e},e.prototype.getQuadraticRoots=function(){var t=new Array;if(2==this.getDegree()){var n=this.coefs[2],e=this.coefs[1]/n,a=this.coefs[0]/n,i=e*e-4*a;if(i>0){var r=Math.sqrt(i);t.push(.5*(-e+r)),t.push(.5*(-e-r))}else 0==i&&t.push(.5*-e)}return t},e.prototype.getCubicRoots=function(){var i=new Array;if(3==this.getDegree()){var c=this.coefs[3],n=this.coefs[2]/c,p=this.coefs[1]/c,y=this.coefs[0]/c,l=(3*p-n*n)/3,h=(2*n*n*n-9*p*n+27*y)/27,a=n/3,s=h*h/4+l*l*l/27,r=h/2;if(Math.abs(s)<=e.TOLERANCE&&(disrim=0),s>0){var t,o,f=Math.sqrt(s);t=-r+f,o=t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3),t=-r-f,t>=0?o+=Math.pow(t,1/3):o-=Math.pow(-t,1/3),i.push(o-a)}else if(0>s){var u=Math.sqrt(-l/3),_=Math.atan2(Math.sqrt(-s),-r)/3,d=Math.cos(_),m=Math.sin(_),g=Math.sqrt(3);i.push(2*u*d-a),i.push(-u*(d+g*m)-a),i.push(-u*(d-g*m)-a)}else{var t;t=r>=0?-Math.pow(r,1/3):Math.pow(-r,1/3),i.push(2*t-a),i.push(-t-a)}}return i},e.prototype.getQuarticRoots=function(){var n=new Array;if(4==this.getDegree()){var l=this.coefs[4],t=this.coefs[3]/l,s=this.coefs[2]/l,h=this.coefs[1]/l,c=this.coefs[0]/l,m=new e(1,-s,t*h-4*c,-t*t*c+4*s*c-h*h).getCubicRoots(),_=m[0],o=t*t/4-s+_;if(Math.abs(o)<=e.TOLERANCE&&(o=0),o>0){var a=Math.sqrt(o),r=3*t*t/4-a*a-2*s,i=(4*t*s-8*h-t*t*t)/(4*a),u=r+i,d=r-i;if(Math.abs(u)<=e.TOLERANCE&&(u=0),Math.abs(d)<=e.TOLERANCE&&(d=0),u>=0){var p=Math.sqrt(u);n.push(-t/4+(a+p)/2),n.push(-t/4+(a-p)/2)}if(d>=0){var p=Math.sqrt(d);n.push(-t/4+(p-a)/2),n.push(-t/4-(p+a)/2)}}else if(0>o);else{var i=_*_-4*c;if(i>=-e.TOLERANCE){if(0>i&&(i=0),i=2*Math.sqrt(i),r=3*t*t/4-2*s,r+i>=e.TOLERANCE){var f=Math.sqrt(r+i);n.push(-t/4+f/2),n.push(-t/4-f/2)}if(r-i>=e.TOLERANCE){var f=Math.sqrt(r-i);n.push(-t/4+f/2),n.push(-t/4-f/2)}}}}return n},r.testCurveCurveIntersection=function(D,B,G,Q,z,N,W,H){var I,O,E,j,i,r,a,h,o,c,l,s,D=new t(D[0],D[1]),B=new t(B[0],B[1]),G=new t(G[0],G[1]),Q=new t(Q[0],Q[1]),z=new t(z[0],z[1]),N=new t(N[0],N[1]),W=new t(W[0],W[1]),H=new t(H[0],H[1]);I=D.multiply(-1),O=B.multiply(3),E=G.multiply(-3),j=I.add(O.add(E.add(Q))),i=new n(j.x,j.y),I=D.multiply(3),O=B.multiply(-6),E=G.multiply(3),j=I.add(O.add(E)),r=new n(j.x,j.y),I=D.multiply(-3),O=B.multiply(3),E=I.add(O),a=new n(E.x,E.y),h=new n(D.x,D.y),I=z.multiply(-1),O=N.multiply(3),E=W.multiply(-3),j=I.add(O.add(E.add(H))),o=new n(j.x,j.y),I=z.multiply(3),O=N.multiply(-6),E=W.multiply(3),j=I.add(O.add(E)),c=new n(j.x,j.y),I=z.multiply(-3),O=N.multiply(3),E=I.add(O),l=new n(E.x,E.y),s=new n(z.x,z.y);for(var R=h.x*h.x,it=h.x*h.x*h.x,T=h.y*h.y,rt=h.y*h.y*h.y,g=a.x*a.x,F=a.x*a.x*a.x,y=a.y*a.y,U=a.y*a.y*a.y,f=r.x*r.x,L=r.x*r.x*r.x,p=r.y*r.y,b=r.y*r.y*r.y,d=i.x*i.x,m=i.x*i.x*i.x,u=i.y*i.y,_=i.y*i.y*i.y,A=s.x*s.x,ot=s.x*s.x*s.x,S=s.y*s.y,st=s.y*s.y*s.y,w=l.x*l.x,Z=l.x*l.x*l.x,x=l.y*l.y,k=c.x*c.x,tt=c.x*c.x*c.x,v=c.y*c.y,C=o.x*o.x,lt=o.x*o.x*o.x,M=o.y*o.y,et=o.y*o.y*o.y,nt=new e(-m*et+_*lt-3*i.x*u*C*o.y+3*d*i.y*o.x*M,-6*i.x*c.x*u*o.x*o.y+6*d*i.y*c.y*o.x*o.y+3*c.x*_*C-3*m*c.y*M-3*i.x*u*c.y*C+3*d*c.x*i.y*M,-6*l.x*i.x*u*o.x*o.y-6*i.x*c.x*u*c.y*o.x+6*d*c.x*i.y*c.y*o.y+3*l.x*_*C+3*k*_*o.x+3*l.x*d*i.y*M-3*i.x*l.y*u*C-3*i.x*k*u*o.y+d*i.y*o.x*(6*l.y*o.y+3*v)+m*(-l.y*M-2*v*o.y-o.y*(2*l.y*o.y+v)),a.x*r.y*i.x*i.y*o.x*o.y-a.y*r.x*i.x*i.y*o.x*o.y+6*l.x*c.x*_*o.x+3*a.x*r.x*i.x*i.y*M+6*h.x*i.x*u*o.x*o.y-3*a.x*r.x*u*o.x*o.y-3*a.y*r.y*i.x*i.y*C-6*h.y*d*i.y*o.x*o.y-6*s.x*i.x*u*o.x*o.y+3*a.y*r.y*d*o.x*o.y-2*r.x*p*i.x*o.x*o.y-6*l.x*i.x*c.x*u*o.y-6*l.x*i.x*u*c.y*o.x-6*i.x*l.y*c.x*u*o.x+6*l.x*d*i.y*c.y*o.y+2*f*r.y*i.y*o.x*o.y+tt*_-3*h.x*_*C+3*h.y*m*M+3*s.x*_*C+b*i.x*C-L*i.y*M-3*h.x*d*i.y*M+3*h.y*i.x*u*C-2*a.x*r.y*d*M+a.x*r.y*u*C-a.y*r.x*d*M+2*a.y*r.x*u*C+3*s.x*d*i.y*M-r.x*p*i.y*C-3*s.y*i.x*u*C+f*r.y*i.x*M-3*i.x*k*u*c.y+d*i.y*o.x*(6*s.y*o.y+6*l.y*c.y)+d*c.x*i.y*(6*l.y*o.y+3*v)+m*(-2*l.y*c.y*o.y-s.y*M-c.y*(2*l.y*o.y+v)-o.y*(2*s.y*o.y+2*l.y*c.y)),6*a.x*r.x*i.x*i.y*c.y*o.y+a.x*r.y*i.x*c.x*i.y*o.y+a.x*r.y*i.x*i.y*c.y*o.x-a.y*r.x*i.x*c.x*i.y*o.y-a.y*r.x*i.x*i.y*c.y*o.x-6*a.y*r.y*i.x*c.x*i.y*o.x-6*h.x*c.x*_*o.x+6*s.x*c.x*_*o.x+6*h.y*m*c.y*o.y+2*b*i.x*c.x*o.x-2*L*i.y*c.y*o.y+6*h.x*i.x*c.x*u*o.y+6*h.x*i.x*u*c.y*o.x+6*h.y*i.x*c.x*u*o.x-3*a.x*r.x*c.x*u*o.y-3*a.x*r.x*u*c.y*o.x+2*a.x*r.y*c.x*u*o.x+4*a.y*r.x*c.x*u*o.x-6*h.x*d*i.y*c.y*o.y-6*h.y*d*c.x*i.y*o.y-6*h.y*d*i.y*c.y*o.x-4*a.x*r.y*d*c.y*o.y-6*s.x*i.x*c.x*u*o.y-6*s.x*i.x*u*c.y*o.x-2*a.y*r.x*d*c.y*o.y+3*a.y*r.y*d*c.x*o.y+3*a.y*r.y*d*c.y*o.x-2*r.x*p*i.x*c.x*o.y-2*r.x*p*i.x*c.y*o.x-2*r.x*p*c.x*i.y*o.x-6*s.y*i.x*c.x*u*o.x-6*l.x*i.x*l.y*u*o.x-6*l.x*i.x*c.x*u*c.y+6*s.x*d*i.y*c.y*o.y+2*f*r.y*i.x*c.y*o.y+2*f*r.y*c.x*i.y*o.y+2*f*r.y*i.y*c.y*o.x+3*l.x*k*_+3*w*_*o.x-3*i.x*l.y*k*u-3*w*i.x*u*o.y+d*c.x*i.y*(6*s.y*o.y+6*l.y*c.y)+d*i.y*o.x*(6*s.y*c.y+3*x)+l.x*d*i.y*(6*l.y*o.y+3*v)+m*(-2*s.y*c.y*o.y-o.y*(2*s.y*c.y+x)-l.y*(2*l.y*o.y+v)-c.y*(2*s.y*o.y+2*l.y*c.y)),a.x*l.x*r.y*i.x*i.y*o.y+a.x*r.y*i.x*l.y*i.y*o.x+a.x*r.y*i.x*c.x*i.y*c.y-a.y*r.x*l.x*i.x*i.y*o.y-a.y*r.x*i.x*l.y*i.y*o.x-a.y*r.x*i.x*c.x*i.y*c.y-6*a.y*l.x*r.y*i.x*i.y*o.x-6*h.x*l.x*_*o.x+6*s.x*l.x*_*o.x+2*l.x*b*i.x*o.x+6*h.x*l.x*i.x*u*o.y+6*h.x*i.x*l.y*u*o.x+6*h.x*i.x*c.x*u*c.y+6*h.y*l.x*i.x*u*o.x-3*a.x*r.x*l.x*u*o.y-3*a.x*r.x*l.y*u*o.x-3*a.x*r.x*c.x*u*c.y+2*a.x*l.x*r.y*u*o.x+4*a.y*r.x*l.x*u*o.x-6*h.y*l.x*d*i.y*o.y-6*h.y*d*l.y*i.y*o.x-6*h.y*d*c.x*i.y*c.y-6*s.x*l.x*i.x*u*o.y-6*s.x*i.x*l.y*u*o.x-6*s.x*i.x*c.x*u*c.y+3*a.y*l.x*r.y*d*o.y-3*a.y*r.y*i.x*k*i.y+3*a.y*r.y*d*l.y*o.x+3*a.y*r.y*d*c.x*c.y-2*r.x*l.x*p*i.x*o.y-2*r.x*l.x*p*i.y*o.x-2*r.x*p*i.x*l.y*o.x-2*r.x*p*i.x*c.x*c.y-6*s.y*l.x*i.x*u*o.x-6*l.x*i.x*l.y*c.x*u+6*s.y*d*l.y*i.y*o.x+2*f*l.x*r.y*i.y*o.y+2*f*r.y*l.y*i.y*o.x+2*f*r.y*c.x*i.y*c.y-3*h.x*k*_+3*s.x*k*_+3*w*c.x*_+b*i.x*k+3*h.y*i.x*k*u+a.x*r.y*k*u+2*a.y*r.x*k*u-r.x*p*k*i.y-3*s.y*i.x*k*u-3*w*i.x*u*c.y+f*r.y*i.x*(2*l.y*o.y+v)+a.x*r.x*i.x*i.y*(6*l.y*o.y+3*v)+l.x*d*i.y*(6*s.y*o.y+6*l.y*c.y)+L*i.y*(-2*l.y*o.y-v)+h.y*m*(6*l.y*o.y+3*v)+a.y*r.x*d*(-2*l.y*o.y-v)+a.x*r.y*d*(-4*l.y*o.y-2*v)+h.x*d*i.y*(-6*l.y*o.y-3*v)+d*c.x*i.y*(6*s.y*c.y+3*x)+s.x*d*i.y*(6*l.y*o.y+3*v)+m*(-2*s.y*l.y*o.y-c.y*(2*s.y*c.y+x)-s.y*(2*l.y*o.y+v)-l.y*(2*s.y*o.y+2*l.y*c.y)),-h.x*a.x*r.y*i.x*i.y*o.y+h.x*a.y*r.x*i.x*i.y*o.y+6*h.x*a.y*r.y*i.x*i.y*o.x-6*h.y*a.x*r.x*i.x*i.y*o.y-h.y*a.x*r.y*i.x*i.y*o.x+h.y*a.y*r.x*i.x*i.y*o.x+a.x*a.y*r.x*r.y*i.x*o.y-a.x*a.y*r.x*r.y*i.y*o.x+a.x*s.x*r.y*i.x*i.y*o.y+a.x*s.y*r.y*i.x*i.y*o.x+a.x*l.x*r.y*i.x*i.y*c.y+a.x*r.y*i.x*l.y*c.x*i.y-s.x*a.y*r.x*i.x*i.y*o.y-6*s.x*a.y*r.y*i.x*i.y*o.x-a.y*r.x*s.y*i.x*i.y*o.x-a.y*r.x*l.x*i.x*i.y*c.y-a.y*r.x*i.x*l.y*c.x*i.y-6*a.y*l.x*r.y*i.x*c.x*i.y-6*h.x*s.x*_*o.x-6*h.x*l.x*c.x*_-2*h.x*b*i.x*o.x+6*s.x*l.x*c.x*_+2*s.x*b*i.x*o.x+2*l.x*b*i.x*c.x+2*h.y*L*i.y*o.y-6*h.x*h.y*i.x*u*o.x+3*h.x*a.x*r.x*u*o.y-2*h.x*a.x*r.y*u*o.x-4*h.x*a.y*r.x*u*o.x+3*h.y*a.x*r.x*u*o.x+6*h.x*h.y*d*i.y*o.y+6*h.x*s.x*i.x*u*o.y-3*h.x*a.y*r.y*d*o.y+2*h.x*r.x*p*i.x*o.y+2*h.x*r.x*p*i.y*o.x+6*h.x*s.y*i.x*u*o.x+6*h.x*l.x*i.x*u*c.y+6*h.x*i.x*l.y*c.x*u+4*h.y*a.x*r.y*d*o.y+6*h.y*s.x*i.x*u*o.x+2*h.y*a.y*r.x*d*o.y-3*h.y*a.y*r.y*d*o.x+2*h.y*r.x*p*i.x*o.x+6*h.y*l.x*i.x*c.x*u-3*a.x*s.x*r.x*u*o.y+2*a.x*s.x*r.y*u*o.x+a.x*a.y*p*i.x*o.x-3*a.x*r.x*s.y*u*o.x-3*a.x*r.x*l.x*u*c.y-3*a.x*r.x*l.y*c.x*u+2*a.x*l.x*r.y*c.x*u+4*s.x*a.y*r.x*u*o.x+4*a.y*r.x*l.x*c.x*u-2*h.x*f*r.y*i.y*o.y-6*h.y*s.x*d*i.y*o.y-6*h.y*s.y*d*i.y*o.x-6*h.y*l.x*d*i.y*c.y-2*h.y*f*r.y*i.x*o.y-2*h.y*f*r.y*i.y*o.x-6*h.y*d*l.y*c.x*i.y-a.x*a.y*f*i.y*o.y-2*a.x*y*i.x*i.y*o.x+3*s.x*a.y*r.y*d*o.y-2*s.x*r.x*p*i.x*o.y-2*s.x*r.x*p*i.y*o.x-6*s.x*s.y*i.x*u*o.x-6*s.x*l.x*i.x*u*c.y-6*s.x*i.x*l.y*c.x*u+3*a.y*s.y*r.y*d*o.x+3*a.y*l.x*r.y*d*c.y+3*a.y*r.y*d*l.y*c.x-2*r.x*s.y*p*i.x*o.x-2*r.x*l.x*p*i.x*c.y-2*r.x*l.x*p*c.x*i.y-2*r.x*p*i.x*l.y*c.x-6*s.y*l.x*i.x*c.x*u-y*r.x*r.y*i.x*o.x+2*s.x*f*r.y*i.y*o.y+6*s.y*d*l.y*c.x*i.y+2*g*a.y*i.x*i.y*o.y+g*r.x*r.y*i.y*o.y+2*f*s.y*r.y*i.y*o.x+2*f*l.x*r.y*i.y*c.y+2*f*r.y*l.y*c.x*i.y+Z*_+3*R*_*o.x-3*T*m*o.y+3*A*_*o.x+U*d*o.x-F*u*o.y-a.x*y*d*o.y+g*a.y*u*o.x-3*R*i.x*u*o.y+3*T*d*i.y*o.x-g*p*i.x*o.y+y*f*i.y*o.x-3*w*i.x*l.y*u-3*A*i.x*u*o.y+3*S*d*i.y*o.x+a.x*r.x*i.x*i.y*(6*s.y*o.y+6*l.y*c.y)+L*i.y*(-2*s.y*o.y-2*l.y*c.y)+h.y*m*(6*s.y*o.y+6*l.y*c.y)+a.y*r.x*d*(-2*s.y*o.y-2*l.y*c.y)+f*r.y*i.x*(2*s.y*o.y+2*l.y*c.y)+a.x*r.y*d*(-4*s.y*o.y-4*l.y*c.y)+h.x*d*i.y*(-6*s.y*o.y-6*l.y*c.y)+s.x*d*i.y*(6*s.y*o.y+6*l.y*c.y)+l.x*d*i.y*(6*s.y*c.y+3*x)+m*(-2*s.y*l.y*c.y-S*o.y-l.y*(2*s.y*c.y+x)-s.y*(2*s.y*o.y+2*l.y*c.y)),-h.x*a.x*r.y*i.x*i.y*c.y+h.x*a.y*r.x*i.x*i.y*c.y+6*h.x*a.y*r.y*i.x*c.x*i.y-6*h.y*a.x*r.x*i.x*i.y*c.y-h.y*a.x*r.y*i.x*c.x*i.y+h.y*a.y*r.x*i.x*c.x*i.y+a.x*a.y*r.x*r.y*i.x*c.y-a.x*a.y*r.x*r.y*c.x*i.y+a.x*s.x*r.y*i.x*i.y*c.y+a.x*s.y*r.y*i.x*c.x*i.y+a.x*l.x*r.y*i.x*l.y*i.y-s.x*a.y*r.x*i.x*i.y*c.y-6*s.x*a.y*r.y*i.x*c.x*i.y-a.y*r.x*s.y*i.x*c.x*i.y-a.y*r.x*l.x*i.x*l.y*i.y-6*h.x*s.x*c.x*_-2*h.x*b*i.x*c.x+2*s.x*b*i.x*c.x+2*h.y*L*i.y*c.y-6*h.x*h.y*i.x*c.x*u+3*h.x*a.x*r.x*u*c.y-2*h.x*a.x*r.y*c.x*u-4*h.x*a.y*r.x*c.x*u+3*h.y*a.x*r.x*c.x*u+6*h.x*h.y*d*i.y*c.y+6*h.x*s.x*i.x*u*c.y-3*h.x*a.y*r.y*d*c.y+2*h.x*r.x*p*i.x*c.y+2*h.x*r.x*p*c.x*i.y+6*h.x*s.y*i.x*c.x*u+6*h.x*l.x*i.x*l.y*u+4*h.y*a.x*r.y*d*c.y+6*h.y*s.x*i.x*c.x*u+2*h.y*a.y*r.x*d*c.y-3*h.y*a.y*r.y*d*c.x+2*h.y*r.x*p*i.x*c.x-3*a.x*s.x*r.x*u*c.y+2*a.x*s.x*r.y*c.x*u+a.x*a.y*p*i.x*c.x-3*a.x*r.x*s.y*c.x*u-3*a.x*r.x*l.x*l.y*u+4*s.x*a.y*r.x*c.x*u-2*h.x*f*r.y*i.y*c.y-6*h.y*s.x*d*i.y*c.y-6*h.y*s.y*d*c.x*i.y-6*h.y*l.x*d*l.y*i.y-2*h.y*f*r.y*i.x*c.y-2*h.y*f*r.y*c.x*i.y-a.x*a.y*f*i.y*c.y-2*a.x*y*i.x*c.x*i.y+3*s.x*a.y*r.y*d*c.y-2*s.x*r.x*p*i.x*c.y-2*s.x*r.x*p*c.x*i.y-6*s.x*s.y*i.x*c.x*u-6*s.x*l.x*i.x*l.y*u+3*a.y*s.y*r.y*d*c.x+3*a.y*l.x*r.y*d*l.y-2*r.x*s.y*p*i.x*c.x-2*r.x*l.x*p*i.x*l.y-y*r.x*r.y*i.x*c.x+2*s.x*f*r.y*i.y*c.y-3*a.y*w*r.y*i.x*i.y+6*s.y*l.x*d*l.y*i.y+2*g*a.y*i.x*i.y*c.y+g*r.x*r.y*i.y*c.y+2*f*s.y*r.y*c.x*i.y+2*f*l.x*r.y*l.y*i.y-3*h.x*w*_+3*s.x*w*_+3*R*c.x*_-3*T*m*c.y+3*A*c.x*_+w*b*i.x+U*d*c.x-F*u*c.y+3*h.y*w*i.x*u-a.x*y*d*c.y+a.x*w*r.y*u+2*a.y*r.x*w*u+g*a.y*c.x*u-r.x*w*p*i.y-3*s.y*w*i.x*u-3*R*i.x*u*c.y+3*T*d*c.x*i.y-g*p*i.x*c.y+y*f*c.x*i.y-3*A*i.x*u*c.y+3*S*d*c.x*i.y+f*r.y*i.x*(2*s.y*c.y+x)+a.x*r.x*i.x*i.y*(6*s.y*c.y+3*x)+L*i.y*(-2*s.y*c.y-x)+h.y*m*(6*s.y*c.y+3*x)+a.y*r.x*d*(-2*s.y*c.y-x)+a.x*r.y*d*(-4*s.y*c.y-2*x)+h.x*d*i.y*(-6*s.y*c.y-3*x)+s.x*d*i.y*(6*s.y*c.y+3*x)+m*(-2*s.y*x-S*c.y-s.y*(2*s.y*c.y+x)),-h.x*a.x*r.y*i.x*l.y*i.y+h.x*a.y*r.x*i.x*l.y*i.y+6*h.x*a.y*l.x*r.y*i.x*i.y-6*h.y*a.x*r.x*i.x*l.y*i.y-h.y*a.x*l.x*r.y*i.x*i.y+h.y*a.y*r.x*l.x*i.x*i.y-a.x*a.y*r.x*l.x*r.y*i.y+a.x*a.y*r.x*r.y*i.x*l.y+a.x*s.x*r.y*i.x*l.y*i.y+6*a.x*r.x*s.y*i.x*l.y*i.y+a.x*s.y*l.x*r.y*i.x*i.y-s.x*a.y*r.x*i.x*l.y*i.y-6*s.x*a.y*l.x*r.y*i.x*i.y-a.y*r.x*s.y*l.x*i.x*i.y-6*h.x*s.x*l.x*_-2*h.x*l.x*b*i.x+6*h.y*s.y*m*l.y+2*s.x*l.x*b*i.x+2*h.y*L*l.y*i.y-2*L*s.y*l.y*i.y-6*h.x*h.y*l.x*i.x*u+3*h.x*a.x*r.x*l.y*u-2*h.x*a.x*l.x*r.y*u-4*h.x*a.y*r.x*l.x*u+3*h.y*a.x*r.x*l.x*u+6*h.x*h.y*d*l.y*i.y+6*h.x*s.x*i.x*l.y*u-3*h.x*a.y*r.y*d*l.y+2*h.x*r.x*l.x*p*i.y+2*h.x*r.x*p*i.x*l.y+6*h.x*s.y*l.x*i.x*u+4*h.y*a.x*r.y*d*l.y+6*h.y*s.x*l.x*i.x*u+2*h.y*a.y*r.x*d*l.y-3*h.y*a.y*l.x*r.y*d+2*h.y*r.x*l.x*p*i.x-3*a.x*s.x*r.x*l.y*u+2*a.x*s.x*l.x*r.y*u+a.x*a.y*l.x*p*i.x-3*a.x*r.x*s.y*l.x*u+4*s.x*a.y*r.x*l.x*u-6*h.x*s.y*d*l.y*i.y-2*h.x*f*r.y*l.y*i.y-6*h.y*s.x*d*l.y*i.y-6*h.y*s.y*l.x*d*i.y-2*h.y*f*l.x*r.y*i.y-2*h.y*f*r.y*i.x*l.y-a.x*a.y*f*l.y*i.y-4*a.x*s.y*r.y*d*l.y-2*a.x*y*l.x*i.x*i.y+3*s.x*a.y*r.y*d*l.y-2*s.x*r.x*l.x*p*i.y-2*s.x*r.x*p*i.x*l.y-6*s.x*s.y*l.x*i.x*u-2*a.y*r.x*s.y*d*l.y+3*a.y*s.y*l.x*r.y*d-2*r.x*s.y*l.x*p*i.x-y*r.x*l.x*r.y*i.x+6*s.x*s.y*d*l.y*i.y+2*s.x*f*r.y*l.y*i.y+2*g*a.y*i.x*l.y*i.y+g*r.x*r.y*l.y*i.y+2*f*s.y*l.x*r.y*i.y+2*f*s.y*r.y*i.x*l.y+3*R*l.x*_-3*T*m*l.y+3*A*l.x*_+U*l.x*d-F*l.y*u-3*S*m*l.y-a.x*y*d*l.y+g*a.y*l.x*u-3*R*i.x*l.y*u+3*T*l.x*d*i.y-g*p*i.x*l.y+y*f*l.x*i.y-3*A*i.x*l.y*u+3*S*l.x*d*i.y,h.x*h.y*a.x*r.y*i.x*i.y-h.x*h.y*a.y*r.x*i.x*i.y+h.x*a.x*a.y*r.x*r.y*i.y-h.y*a.x*a.y*r.x*r.y*i.x-h.x*a.x*s.y*r.y*i.x*i.y+6*h.x*s.x*a.y*r.y*i.x*i.y+h.x*a.y*r.x*s.y*i.x*i.y-h.y*a.x*s.x*r.y*i.x*i.y-6*h.y*a.x*r.x*s.y*i.x*i.y+h.y*s.x*a.y*r.x*i.x*i.y-a.x*s.x*a.y*r.x*r.y*i.y+a.x*a.y*r.x*s.y*r.y*i.x+a.x*s.x*s.y*r.y*i.x*i.y-s.x*a.y*r.x*s.y*i.x*i.y-2*h.x*s.x*b*i.x+2*h.y*L*s.y*i.y-3*h.x*h.y*a.x*r.x*u-6*h.x*h.y*s.x*i.x*u+3*h.x*h.y*a.y*r.y*d-2*h.x*h.y*r.x*p*i.x-2*h.x*a.x*s.x*r.y*u-h.x*a.x*a.y*p*i.x+3*h.x*a.x*r.x*s.y*u-4*h.x*s.x*a.y*r.x*u+3*h.y*a.x*s.x*r.x*u+6*h.x*h.y*s.y*d*i.y+2*h.x*h.y*f*r.y*i.y+2*h.x*a.x*y*i.x*i.y+2*h.x*s.x*r.x*p*i.y+6*h.x*s.x*s.y*i.x*u-3*h.x*a.y*s.y*r.y*d+2*h.x*r.x*s.y*p*i.x+h.x*y*r.x*r.y*i.x+h.y*a.x*a.y*f*i.y+4*h.y*a.x*s.y*r.y*d-3*h.y*s.x*a.y*r.y*d+2*h.y*s.x*r.x*p*i.x+2*h.y*a.y*r.x*s.y*d+a.x*s.x*a.y*p*i.x-3*a.x*s.x*r.x*s.y*u-2*h.x*f*s.y*r.y*i.y-6*h.y*s.x*s.y*d*i.y-2*h.y*s.x*f*r.y*i.y-2*h.y*g*a.y*i.x*i.y-h.y*g*r.x*r.y*i.y-2*h.y*f*s.y*r.y*i.x-2*a.x*s.x*y*i.x*i.y-a.x*a.y*f*s.y*i.y+3*s.x*a.y*s.y*r.y*d-2*s.x*r.x*s.y*p*i.x-s.x*y*r.x*r.y*i.x+3*T*a.x*r.x*i.x*i.y+3*a.x*r.x*S*i.x*i.y+2*s.x*f*s.y*r.y*i.y-3*R*a.y*r.y*i.x*i.y+2*g*a.y*s.y*i.x*i.y+g*r.x*s.y*r.y*i.y-3*A*a.y*r.y*i.x*i.y-it*_+rt*m+ot*_-st*m-3*h.x*A*_-h.x*U*d+3*R*s.x*_+h.y*F*u+3*h.y*S*m+s.x*U*d+R*b*i.x-3*T*s.y*m-T*L*i.y+A*b*i.x-F*s.y*u-L*S*i.y-h.x*g*a.y*u+h.y*a.x*y*d-3*h.x*T*d*i.y-h.x*y*f*i.y+h.y*g*p*i.x-a.x*y*s.y*d+3*R*h.y*i.x*u+R*a.x*r.y*u+2*R*a.y*r.x*u-2*T*a.x*r.y*d-T*a.y*r.x*d+g*s.x*a.y*u-3*h.x*S*d*i.y+3*h.y*A*i.x*u+a.x*A*r.y*u-2*a.x*S*r.y*d+s.x*y*f*i.y-a.y*r.x*S*d-R*r.x*p*i.y-3*R*s.y*i.x*u+3*T*s.x*d*i.y+T*f*r.y*i.x-g*s.y*p*i.x+2*A*a.y*r.x*u+3*s.x*S*d*i.y-A*r.x*p*i.y-3*A*s.y*i.x*u+f*S*r.y*i.x),K=nt.getRootsInInterval(0,1),X=0;X<K.length;X++){var P=K[X],V=new e(i.x,r.x,a.x,h.x-s.x-P*l.x-P*P*c.x-P*P*P*o.x).getRoots(),$=new e(i.y,r.y,a.y,h.y-s.y-P*l.y-P*P*c.y-P*P*P*o.y).getRoots();if(!(V.length<=0||$.length<=0))for(var at=1e-4,J=0;J<V.length;J++){var q=V[J];if(q>=0&&1>=q)for(var Y=0;Y<$.length;Y++)if(Math.abs(q-$[Y])<at)return!0}}return!1},r}function m(i){if(this==window)return new m(i);var e=this,t=void 0,i=i||{};return e.gs=i.gs,e.ad_network=i.ad_network,e.init=function(){if("admob"==e.ad_network&&(t=window.plugins.AdMob,e.onPresentInterstitialAd="onPresentInterstitialAd",e.onReceiveInterstitialAd="onReceiveInterstitialAd",e.onDismissInterstitialAd="onDismissInterstitialAd"),"mopub"==e.ad_network){if(t=window.plugins.MoPub,"undefined"==typeof t)return"admob"==e.ad_network,void e.init();e.onPresentInterstitialAd="onInterstitialPresent",e.onReceiveInterstitialAd="onInterstitialReceive",e.onDismissInterstitialAd="onInterstitialDismiss"}if("flurry"==e.ad_network){if(t=window.plugins.Flurry,"undefined"==typeof t)return"admob"==e.ad_network,void e.init();e.onPresentInterstitialAd="onPresentAd",e.onReceiveInterstitialAd="onReceiveAd",e.onDismissInterstitialAd="onDismissAd"}if("adbuddiz"==e.ad_network){if(t=window.plugins.AdBuddizPlugin,"undefined"==typeof t)return"admob"==e.ad_network,void e.init();e.onPresentInterstitialAd="onPresentInterstitialAd",e.onReceiveInterstitialAd="onReceiveInterstitialAd",e.onDismissInterstitialAd="onDismissInterstitialAd"}e.get_interstitial_options=function(){if("admob"==e.ad_network){var t="ca-app-pub-5419784921619686/9765547854",i="ca-app-pub-5419784921619686/5195747455";e.ad_id=Math.random()>.5?i:t}return"mopub"==e.ad_network&&(e.ad_id="e92b233b5d55427ab4a760a0eb027cd2"),"flurry"==e.ad_network&&(e.ad_id="Q2HW4NQTG4S9R5FNXF25"),"adbuddiz"==e.ad_network&&(e.ad_id="eca32c1d-a162-4c0a-96bc-20ddefb9662a"),{adId:e.ad_id,isTesting:!1,autoShow:!1}},e.create_interstitial(),document.addEventListener(e.onPresentInterstitialAd,e.on_present_interstitial_ad),document.addEventListener(e.onReceiveInterstitialAd,e.on_receive_interstitial_ad),document.addEventListener(e.onDismissInterstitialAd,e.on_dismiss_interstitial_ad),window.addEventListener("orientationchange",e.orientationchange),window.addEventListener("beforeunload",function(){"undefined"!=typeof e&&e.destroy()})},e.on_present_interstitial_ad=function(t){t.ad_network||(t.ad_network="admob"),t.ad_network==e.ad_network&&(e.displayed=!0,e.ondisplay&&e.ondisplay())},e.on_receive_interstitial_ad=function(t){t.ad_network||(t.ad_network="admob"),t.ad_network==e.ad_network&&(e.loaded=!0)},e.on_dismiss_interstitial_ad=function(t){t.ad_network||(t.ad_network="admob"),t.ad_network==e.ad_network&&(e.displayed=!1,e.loaded=!1,e.callback())},e.orientationchange=function(){function t(){return e.displayed?void setTimeout(t,50):(e.loaded=!1,void e.create_interstitial())}t()},e.destroy=function(){document.removeEventListener(e.onPresentInterstitialAd,e.on_present_interstitial_ad),document.removeEventListener(e.onReceiveInterstitialAd,e.on_receive_interstitial_ad),document.removeEventListener(e.onDismissInterstitialAd,e.on_dismiss_interstitial_ad),window.removeEventListener("orientationchange",e.orientationchange),t&&t.destroyInterstitialView&&t.destroyInterstitialView()},e.run=function(){e.running=!0,e.callback=function(){e.create_interstitial(),e.running=!1},e.loaded?(o&&n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.gs.DEBUG?"-beta":"")+".php?action=log_ad_show&screen_name=interstitial_ad&device_uuid="+device.uuid+"&ad_id="+e.ad_id,request_method:"POST",async:!0}),t&&t.showInterstitialAd()):t&&e.callback(),e.onrun&&e.onrun()},e.create_interstitial=function(){t&&t.createInterstitialView(e.get_interstitial_options(),function(){},function(){})},e}function ut(r){function u(){if(e.ambient_music.load_ambient_music(t.ambient_music,t.ambient_music_start),"undefined"!=typeof t.intro_audio&&""!=t.intro_audio){var o=document.createElement("div");o.style.display="none",i.appendChild(o);var d=e.get_set_directory(l)+"/"+t.intro_audio+".ogg";e.playAudio(d,{element:o,audio_type:"music",restart:!0})}i.innerHTML=c,i.children.forEach(function(e){a(e)}),"undefined"!=typeof t.intro_audio&&""!=t.intro_audio&&i.appendChild(o);var n=i.querySelector("span"),r=i.querySelector(".jt-game-header");if(null!=r&&(n.style.display="none",N({image:r,fix_ie_bug:!0,color:"#edd9a7",callback:function(e){r.parentNode.appendChild(e),r.parentNode.removeChild(r),r=e,e.style.height="100%",n.style.display="block"}})),void function(){function t(t){return"/"==t[0]?e.get_root_directory()+t:e.get_set_directory(l)+"/gui/front/"+t}var r=n.querySelectorAll("*"),i=Array.prototype.slice.call(r);i.push(n),i.forEach(function(i){var n=i.getAttribute("src");null!=n&&""!=n&&i.setAttribute("src",t(n));var e=wt(window.getComputedStyle(i).backgroundImage);""!=e&&"none"!=e&&(e=e.replace('url("',"").replace('")',""),e=e.replace("url('","").replace("')",""),e=e.replace("url(","").replace(")",""),e=e.substr(e.lastIndexOf("/")+1),i.style.backgroundImage='url("'+t(e)+'")')})}(),n.classList.add("jt-select_mode_screen-container"),"undefined"!=typeof t.mixnmatch){var h=document.createElement("div");h.className="jt-select_mode_screen-mixnmatch jt-button",h.innerHTML="Play Mix N' Match",n.appendChild(h),h.addEventListener(e.events.POINT,function(){s("mixnmatch")})}if("undefined"!=typeof t.jigsaw){var u=document.createElement("div");u.className="jt-select_mode_screen-jigsaw jt-button",u.innerHTML="Play Jigsaw",n.appendChild(u),u.addEventListener(e.events.POINT,function(){s("select_jigsaw")}),setTimeout(function(){s("select_jigsaw")},2500)}}function s(t){function i(t){1!=e.DEBUG&&e.challenge_code_request_asked||"undefined"==typeof e.account.internal_access_token?t():v({gs:e,callback:t,extra_text:" (You can also enter it later via the main menu)"})}function n(i){if(e.ambient_music_on_question_asked)i();else{var t=smoke.confirm('Keep ambient music on? (you can change this later by toggling "Audio Settings" > "Play Ambient Music".',function(t){e.ambient_music_on_question_asked=!0,e.ambient_music_on=t,i()});t.buttons.ok.innerHTML="Keep ambient music on.",t.buttons.cancel.innerHTML="Turn ambient music off.",a(t.buttons)}}function r(){o.history_control.load_page({page:t})}h||(h=!0,i(function(){n(r)}))}var i=r.content_div,o=r.mr_jigtato,t=o.game_data,l=o.set_name,e=r.global_settings;n({success:function(e){c=e,u()},error:e.errormessage,file:e.get_set_directory(l)+"/gui/front/front.htm",plaintext:!0,request_method:"GET"});var c="",h=!1}function dt(r){function h(){function T(){var t="undefined"==typeof e.account.gem_amount?"--":e.account.gem_amount;v.innerHTML=0!=e.version_code||e.version_code&&e.version_code<158?'<span style="position:relative; margin-left: 18px; top: -6px; line-height: 0; font-family:lato; font-size: 60px; vertical-align: middle">'+t+'</span><span style="position:relative; top: -3px; line-height: 0; font-family: flyingsoft-icons; font-size: 106px; vertical-align: middle">g</span>':"<span>"+t+'</span><span class="jt-gem">g</span>',h.setTimeout(T,5e3)}function R(){function p(a){var n=a.currentTarget,i=n.product,r=n.product.id;i.owned||i.state!=store.REGISTERED&&i.state!=store.INVALID&&(i.canPurchase||!i.owned)&&("gems"==r.substr(0,4)&&e.get_gem_count_from_server({success:function(t){store.order(i.id,JSON.stringify({user_id:e.account.user_id,gem_amount:t}))}}),"ad_removal"==r&&(store.order(i.id,JSON.stringify({user_id:e.account.user_id})),i.finish_single_use_callback=t.update_text))}var d=smoke.alert("");e.gem_screen_not_opened&&(e.gem_screen_not_opened=!1,e.log_user_action("Gem screen: opened."));var n=d.dialog.text;n.classList.add("jt-iap");var r=document.createElement("div");r.className="jt-iap-title_text",n.appendChild(r),void function(){function t(){r.innerHTML="Use gems to acquire puzzle packs. You currently have "+e.account.gem_amount+" gems.",r.isAttached()||clearInterval(i)}var i=setInterval(t,500);t()}();var a=document.createElement("div");if(a.className="jt-button jt-iap-title_text",a.innerHTML="Get 10 gems for every friend who installs!",n.appendChild(a),a.addEventListener(e.events.POINT,function(){d.ok(),s.challenge_a_friend_button.toggle()}),e.IS_CORDOVA&&window.store){var o=document.createElement("div");o.className="jt-iap-button_area",n.appendChild(o);var i=e.google_play_store.product_list,_=[i.gems_10,i.gems_50,i.gems_30,i.gems_100],t=document.createElement("div");t.className="jt-button jt-iap-button_area-ad_removal_button",o.appendChild(t);var f=t.product=i.ad_removal;t.update_text=function(){t.innerHTML=e.account.purchased_ad_removal?"Thank you for your purchase: ads have been removed from the game.":f.description+": "+f.price+"."},t.update_text(),t.addEventListener(e.events.POINT,p);var h=document.createElement("div");h.className="jt-iap-button_area-gem_area",o.appendChild(h),console.log(i);var l,u=0;_.forEach(function(i){if("gems"==i.id.substr(0,4)){0==u&&(l=document.createElement("div"),l.className="jt-iap-button_area-gem_area-button_row",h.appendChild(l)),u=(u+1)%2;var t=document.createElement("div");t.className="jt-button jt-iap-button_area-gem_area-button_row-button",l.appendChild(t);var n=document.createElement("div");n.className="jt-iap-button_area-gem_area-button_row-button-title";var r=document.createElement("div");r.className="jt-gem jt-iap-button_area-gem_area-button_row-button-title-gem",r.innerHTML="g",n.appendChild(r),n.innerHTML+=i.description,t.appendChild(n);var a=document.createElement("div");a.className="jt-iap-button_area-gem_area-button_row-button-price",a.innerHTML=i.price,t.appendChild(a),t.product=i,t.addEventListener(e.events.POINT,p)}})}else if(e.IS_CORDOVA){var c=document.createElement("div");c.className="jt-iap-title_text",c.innerHTML="Note: this version doesn't support purchases. Please upgrade your game version.",n.appendChild(c)}}function b(r){r.selection_tab_container.children.forEach(function(e){if(e.tab_index==r.page)var t="add";else var t="remove";e.classList[t]("jt-button-lit")}),_.innerHTML="";var f=e.select_menu_current_page[i][p]=r.page;e.select_menu_current_page=e.select_menu_current_page;var h=r.level_array,o=r.items_per_page,m=f*o,l=(f+1)*o-1;h.length-1<l&&(l=h.length-1);for(var u=0,c=m;l>=c;c++){var g=h[c],t=document.createElement("div");t.className="jt-select_screen-selection-item",u%(o/2)==0&&(t.style.marginLeft=0),u%(o/2)==1&&(t.style.marginRight=0),u+=1;var y=t.level_id=g.level_id;t.addEventListener(e.events.POINT,d),t.select_screen=s,_.appendChild(t),a(t),t.image_wrapper=document.createElement("div"),t.image_wrapper.className="jt-select_screen-selection-item-image_wrapper",t.appendChild(t.image_wrapper),t.image=s.make_new_selection_image(y),t.image_wrapper.appendChild(t.image);var n=t.rewards_container={};n.top=document.createElement("div"),n.top.className="jt-select_screen-selection-item-rewards-container-top",t.image_wrapper.appendChild(n.top),n.bottom=document.createElement("div"),n.bottom.className="jt-select_screen-selection-item-rewards-container-bottom",t.appendChild(n.bottom)}I(_)}function I(r){{var n=t.player_data;n.selected_difficulty}r.children.forEach(function(r){var _=r.rewards_container.top;_.innerHTML="";var f=r.rewards_container.bottom;f.innerHTML="";var o=r.level_id,g=u.entry_list[o];if(g.reward_container)var T=g.reward_container;else var T=o;var c=[],w=!1;Array.prototype.slice.call([0,1,2,3]).forEach(function(e){c[e]=n.jigsaw.trophies.find(function(t){return t==T+"|"+e}),"undefined"!=typeof c[e]&&(w=!0)});var h=n.jigsaw.ranks[o],s="undefined"!=typeof h;if(e["gray-filter_incomplete_images"]){r.classList[s?"remove":"add"]("jt-select_screen-selection-item-greyed_out"),r.image_wrapper.classList[s?"add":"remove"]("jt-select_screen-selection-item-image_wrapper-greyed_out"),e.get_image(r.image,i,o,"mini"+(s?"":"-grey"));var v=r.image.complete;v||r.image.addEventListener("error",function(){r.image.style.display="none",r.image.addEventListener("load",function(){r.image.style.display="";localStorage["image_is_not_local_cache.mini"+(s?"":"-grey")]})})}if(s||"undefined"!=typeof c)for(var a=0;4>a;a++){if("undefined"!=typeof c&&"undefined"!=typeof c[a]){var y=S({mr_jigtato:t,gs:e,set_name:i,level_id:o,difficulty_level:a,trophy_class:"jt-select_screen-selection-item-rewards-trophy"});f.appendChild(y)}if("undefined"!=typeof h&&"undefined"!=typeof h[a]){var p=document.createElement("div");p.className="jt-select_screen-selection-item-rewards-rank_token_wrapper",_.appendChild(p);for(var x=h[a],b=l.rank[l.difficulty_levels[a].name],m=0;x>m;m++){var d=document.createElement("div");d.className="jt-select_screen-selection-item-rewards-rank_token",p.appendChild(d),d.style.backgroundImage='url("'+e.get_set_directory(i)+"/gui/"+b.filename+'")'}}}})}1==t.first_run&&t.load_player_data_from_server();var s={};s.make_new_selection_image=function(e){var t=document.createElement("img");return t.className="jt-select_screen-selection-item-image-"+("undefined"==typeof n[e].crop_margin?"centered":"cropped"),"undefined"!=typeof n[e].crop_margin&&(t.style.marginLeft=-n[e].crop_margin+"%"),"undefined"!=typeof n[e].top&&(t.style.top=-n[e].top+"%"),"undefined"!=typeof n[e].height&&(t.style.height=n[e].height+"%"),t},o.innerHTML="";var h=s.header=document.createElement("div");h.className="jt-select_screen-header",o.appendChild(h),a(h);var y=s.body=document.createElement("div");y.className="jt-select_screen-body",o.appendChild(y),h.icon_list=document.createElement("div"),h.icon_list.className="jt-select_screen-header-icon_list",h.appendChild(h.icon_list);var P=[t.menu.generic.about,t.menu.generic.ogle_trophies,t.menu.jigsaw.toggle_categories,t.menu.jigsaw.open_misc_config_menu,t.menu.jigsaw.open_visual_settings_menu,t.menu.generic.open_audio_settings_menu],L=F({gs:e,parent:o,menu_item_list:P,column_size:3,show_hint_image_options:!0,select_screen:s,init:r}),f=(B({parent:h.icon_list,target:L,menu_class:["jt-select_screen-menu_button"],init:r}),[]);"undefined"==typeof e.select_menu_sort_index[i]&&(e.select_menu_sort_index[i]=0),"undefined"==typeof e.select_menu_sort_direction[i]&&(e.select_menu_sort_direction[i]=0);var x=s.sort_button=rt({parent:h.icon_list,menu_class:"jt-common-menu_button jt-select_screen-sort_button",sort_attributes:t.game_data.sort_attributes,entry_list:n,level_array:f,level_id:"level_id",sort_index:e.select_menu_sort_index,sort_direction:e.select_menu_sort_direction,set_name:t.set_name,gs:e}),w=t.player_data,m=s.difficulty_level_button=document.createElement("div");m.className="jt-select_screen-header-difficulty_level jt-select_screen-header-size-1 jt-button hoverable",h.appendChild(m),m.update_text=function(){this.innerHTML=l.difficulty_levels[w.selected_difficulty].name.capitalize()},m.update_text(),m.addEventListener(e.events.POINT,function(){var e=l.difficulty_levels.length;w.selected_difficulty=(w.selected_difficulty+1)%e,localStorage.player_data=JSON.stringify(t.player_data),m.update_text()});var M=s.challenge_a_friend_button=gt({select_screen:s,content_div:o,mr_jigtato:t,gs:e});h.appendChild(M);var A=s.my_packs_button=pt({select_screen:s,content_div:o,mr_jigtato:t,gs:e});h.appendChild(A);var v=s.gem_purchase_button=document.createElement("div");v.className="jt-select_screen-header-show_hint_image jt-select_screen-header-size-1 jt-gem_amount_container jt-button hoverable",v.addEventListener(e.events.POINT,R),h.appendChild(v),T(),void function(){var r=t.game_data.category_list;if("undefined"==typeof e.select_menu_current_category[i]){var n=[];for(var a in r)n.push(a);e.select_menu_current_category[i]=n[Math.floor(Math.random()*n.length)]}}();var p=e.select_menu_current_category[i];"object"!=typeof e.select_menu_current_page[i]&&(e.select_menu_current_page[i]={}),"undefined"==typeof e.select_menu_current_page[i][p]&&(e.select_menu_current_page[i][p]=0);var g=12,E=s.create_puzzle_selection_array=function(){f.splice(0,f.length);for(var t in n){var e=n[t];e.level_id=t,e.is_only_template||(e.enabled||0!=!!e.predownloaded)&&e.category==p&&f.push(e)}};E();var _=s.selection_container=document.createElement("div");_.className="jt-select_screen-selection-container",y.appendChild(_);var O=s.create_tab_container=function(n){function l(){var r=t.game_data.category_list,n=[];for(var a in r)n.push(a);var l=n.indexOf(e.select_menu_current_category[i]);e.select_menu_current_category[i]=n[(l+1)%n.length],e.select_menu_current_category=e.select_menu_current_category,p=e.select_menu_current_category[i],"undefined"==typeof e.select_menu_current_page[i][p]&&(e.select_menu_current_page[i][p]=0),s.innerHTML=r[p].shortcut,E(),o(),x.sort_levels()}function o(){r.children.forEach(function(e){e!=s&&r.removeChild(e)});var o=Math.ceil(n.item_list.length/n.items_per_page);1==o&&(o=0);for(var l=0;o>l;l++){var i=document.createElement("div");i.className="jt-button",a(i),r.appendChild(i),i.innerHTML=l+1,i.tab_index=l,n.select_function&&i.addEventListener(e.events.POINT,c)}if(0==o){var d=t.game_data.category_list,u=0;for(var p in d)if(u+=1,u>1)break;1==u&&h.classList.add("jt-select_screen-selection-container-center")}}function c(e){n.select_function({page:e.currentTarget.tab_index,selection_tab_container:r})}var h=n.selection_container,r=document.createElement("div");if(r.className="jt-select_screen-selection-tab_container",n.parent.appendChild(r),"undefined"==typeof n.use_category_selection_tab||1==n.use_category_selection_tab){var s=document.createElement("div");s.className="jt-button",a(s),r.appendChild(s),s.addEventListener(e.events.POINT,l),s.innerHTML=t.game_data.category_list[p].shortcut}return o(),r},j=s.create_selection_tab_container=function(){s.selection_tab_container=O({parent:y,selection_container:_,item_list:f,items_per_page:g,select_function:function(e){b(k(e,{level_array:f,items_per_page:g}))}})};j(),x.onsort=function(){b({page:e.select_menu_current_page[i][p],level_array:f,items_per_page:g,selection_tab_container:s.selection_tab_container})},x.sort_levels();s.refresh_puzzle_list=function(){b({page:0,level_array:f,items_per_page:g,selection_tab_container:s.selection_tab_container})};if("undefined"!=typeof e.pending_message){var C=smoke.alert(e.pending_message);C.dialog.text.style.textIndent="1em",C.dialog.text.style.textAlign="left",delete e.pending_message}c&&c()}function d(i){function r(){e.try_requesting_fullscreen&&!e.IS_WEBVIEW&&e.is_phone_or_tablet&&U(document.documentElement);var n=i.currentTarget.level_id;t.history_control.load_page({page:"jigsaw",level:n})}i.stopPropagation(),i.preventDefault();var i=s(i),n=i.currentTarget.select_screen;return n.challenge_a_friend_button.is_active?(e.log_user_action("Tell-a-friend: puzzle selected."),void n.challenge_a_friend_button.select_puzzle(i.currentTarget)):void r()}var o=r.content_div,t=r.mr_jigtato,e=r.global_settings,u=t.game_data,n=t.game_data.entry_list,l=t.game_data.jigsaw,i=t.set_name;if("undefined"!=typeof r.callback){var c=r.callback;delete r.callback}e.game_type="jigsaw",e.ambient_music.load_ambient_music(t.game_data.ambient_music,t.game_data.ambient_music_start),(new Image).setAttribute("src",t.background_image_url),(new Image).setAttribute("src",e.get_set_directory(t.set_name)+"/gui/gui-loading.png"),h()}function pt(l){function p(){i.selection_container.style.display="none",i.selection_tab_container.style.display="none",r.initialized||(r.initialized=!0,d()),r.selection_container.style.display="",r.selection_tab_container.style.display=""}function f(){i.selection_container.style.display="",i.selection_tab_container.style.display="",r.selection_container.style.display="none",r.selection_tab_container.style.display="none"}function d(){function u(r){var w=r.selection_container,S=r.selection_tab_container;S.children.forEach(function(e){if(e.tab_index==r.page)var t="add";else var t="remove";e.classList[t]("jt-button-lit")}),w.innerHTML="";var E=(s.game_data.entry_list,e.select_packs_menu_current_page[o]=r.page);e.select_packs_menu_current_page=e.select_packs_menu_current_page;var b=r.item_array,u=r.items_per_page,C=E*u,p=(E+1)*u-1;b.length-1<p&&(p=b.length-1);for(var m=0,g=C;p>=g;g++){var n=b[g],t=document.createElement("div");t.className="jt-select_screen-selection-item jt-select_packs_screen-selection-item",m%(u/2)==0&&(t.style.marginLeft=0),m%(u/2)==1&&(t.style.marginRight=0),m+=1;var d="undefined"!=typeof e.account.users_to_puzzle_packs[n.puzzle_pack_id]||0==n.gem_cost,T=t.level_id=n.image_url;t.addEventListener(e.events.POINT,function(t){var i=t.currentTarget.pack,n="undefined"!=typeof e.account.users_to_puzzle_packs[i.puzzle_pack_id]||0==i.gem_cost;n?smoke.alert("You've already acquired this pack."):f(t)}),t.pack=n,t.select_screen=i,w.appendChild(t),a(t),t.image_wrapper=document.createElement("div"),t.image_wrapper.className="jt-select_screen-selection-item-image_wrapper jt-select_packs_screen-selection-item-image_wrapper",t.appendChild(t.image_wrapper),t.image=i.make_new_selection_image(T),t.image_wrapper.appendChild(t.image),e["gray-filter_incomplete_images"]&&(t.classList[d?"remove":"add"]("jt-select_screen-selection-item-greyed_out"),t.image_wrapper.classList[d?"add":"remove"]("jt-select_screen-selection-item-image_wrapper-greyed_out"),e.get_image(t.image,o,T,"mini"+(d?"":"-grey")));var h=document.createElement("div");h.className="jt-select_packs_screen-selection-item-info-container",t.appendChild(h);var v=document.createElement("div");v.className="jt-button jt-select_packs_screen-selection-item-info-title",h.appendChild(v),v.innerHTML=n.name.capitalize();var x=document.createElement("div");x.className="jt-select_packs_screen-selection-item-info-description",x.innerHTML=n.description,h.appendChild(x);var c=document.createElement("div");c.className="jt-button jt-select_packs_screen-selection-item-info-preview_button",c.innerHTML="Preview",c.addEventListener(e.events.POINT,_),c.pack=n,h.appendChild(c);var y=document.createElement("div");y.className="jt-select_screen-selection-item-rewards-container-bottom",t.appendChild(y);var l=document.createElement("div");l.className="jt-button jt-select_packs_screen-selection-item-purchase-container-inner jt-gem_amount_container",y.appendChild(l),d?l.innerHTML="Acquired":(l.classList.add("jt-select_packs_screen-selection-item-purchase-container-inner-gem_cost"),l.innerHTML="<span>"+n.gem_cost+'</span><span class="jt-gem">g</span>',l.innerHTML=0!=e.version_code||e.version_code&&e.version_code<158?'<span style="position:relative; margin-left: 18px; top: -6px; line-height: 0; font-family:lato; font-size: 60px; vertical-align: middle">'+n.gem_cost+'</span><span style="position:relative; top: -3px; line-height: 0; font-family: flyingsoft-icons; font-size: 106px; vertical-align: middle">g</span>':"<span>"+n.gem_cost+'</span><span class="jt-gem">g</span>')}}function f(e){d(e.currentTarget.pack)}function d(r){n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=puzzle_pack_purchase&user_id="+e.account.user_id+"&internal_access_token="+e.account.internal_access_token+"&puzzle_pack_id="+r.puzzle_pack_id,error:e.errormessage,request_method:"POST",async:!0,success:function(n){e.account.gem_amount=n.gem_amount,e.account.users_to_puzzle_packs[r.puzzle_pack_id]=r.puzzle_pack_id;var c=s.game_data.entry_list,a=n.puzzle_list;a.forEach(function(t){e.paid_puzzles.push(t)}),a.forEach(function(e){c[e].enabled=!0}),i.create_puzzle_selection_array(),i.refresh_puzzle_list(),i.create_selection_tab_container(),i.sort_button.sort_levels(),u({page:e.select_packs_menu_current_page[o],item_array:l,items_per_page:h,selection_container:t,selection_tab_container:p});smoke.alert('Thank you for purchasing "'+r.name.capitalize()+'"!')}})}function _(e){e.stopPropagation(),m(e.currentTarget.pack)}function m(t){function r(l){var c=l.puzzle_list,n=smoke.confirm("",function(e){a||1!=e||d(t)}),r=n.dialog.text;r.parentNode.classList.add("jt-pack_preview_screen-dialog"),r.classList.add("jt-pack_preview_screen-text");s.game_data.entry_list;c.forEach(function(a){var t=document.createElement("div");t.className="jt-select_screen-selection-item jt-pack_preview_screen-selection-item",r.appendChild(t);var n=document.createElement("div");n.className="jt-select_screen-selection-item-image_wrapper jt-select_packs_screen-selection-item-image_wrapper",t.appendChild(n);var s=i.make_new_selection_image(a);e.get_image(s,o,a,"mini"),n.appendChild(s)});var a="undefined"!=typeof e.account.users_to_puzzle_packs[t.puzzle_pack_id]||0==t.gem_cost;a?n.dialog.buttons.removeChild(n.dialog.buttons.cancel):n.dialog.buttons.ok.innerHTML="Purchase with "+t.gem_cost+" gems."}n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=get_puzzle_pack_data&user_id="+e.account.user_id+"&internal_access_token="+e.account.internal_access_token+"&puzzle_pack_id="+t.puzzle_pack_id,error:e.errormessage,request_method:"POST",async:!0,success:r})}var t=r.selection_container=document.createElement("div");t.className="jt-select_screen-selection-container",c.appendChild(t);var l=[];for(var g in e.puzzle_pack_list)l.push(e.puzzle_pack_list[g]);l.sort(function(t,i){var n="undefined"!=typeof e.account.users_to_puzzle_packs[t.puzzle_pack_id]||0==t.gem_cost,r="undefined"!=typeof e.account.users_to_puzzle_packs[i.puzzle_pack_id]||0==i.gem_cost;return r>n?-1:n>r?1:0});var h=4,p=r.selection_tab_container=i.create_tab_container({parent:c,selection_container:t,item_list:l,items_per_page:h,select_function:function(e){u(k(e,{item_array:l,items_per_page:h,selection_container:t}))},use_category_selection_tab:!1});"undefined"==typeof e.select_packs_menu_current_page[o]&&(e.select_packs_menu_current_page[o]=0),u({page:e.select_packs_menu_current_page[o],item_array:l,items_per_page:h,selection_container:t,selection_tab_container:p})}var i=l.select_screen,s=(l.content_div,l.mr_jigtato),e=l.gs,o=(s.game_data,s.game_data.jigsaw,s.player_data,s.set_name),c=i.body,h=i.header,t=document.createElement("div");t.className="jt-select_screen-header-show_hint_image jt-select_screen-header-size-1 jt-button hoverable",t.innerHTML="My Packs",t.addEventListener(e.events.POINT,function(){t.toggle()}),t.toggle=function(){t.is_active?t.deactivate():t.activate()};var r={};return t.activate=function(){u({gs:e,error:function(){smoke.alert("You must log in to Google Play to use this feature!")},success:function(){t.is_active=!0,h.querySelectorAll(".jt-button").forEach(function(e){e!=t&&e!=i.gem_purchase_button&&(e.style.display="none")}),t.classList.remove("jt-select_screen-header-size-1"),t.classList.add("jt-select_screen-header-size-4"),p()}})},t.deactivate=function(){t.is_active=!1,h.querySelectorAll(".jt-button").forEach(function(e){e!=t&&e!=i.gem_purchase_button&&(e.style.display="")}),t.classList.add("jt-select_screen-header-size-1"),t.classList.remove("jt-select_screen-header-size-4"),f()},t}function ft(X){function $t(){if("undefined"==typeof i.account.internal_access_token)return void(e.log_query_processed=!0);var t=localStorage.app_version_date;n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(i.DEBUG?"-beta":"")+".php?action=log_play_start&build_version="+t+"&user_id="+i.account.user_id+"&internal_access_token="+i.account.internal_access_token+"&device_version="+device.version+"&device_model="+device.model+"&device_uuid="+device.uuid+"&device_version="+device.version+"&screen_name=jigsaw&puzzle_name="+C+"&difficulty_level="+e.difficulty_level,success:function(t){null!=e&&(e.log_query_processed=!0,null!=t&&"undefined"!=typeof t.message&&null!=t.message&&""!=t.message&&("undefined"!=typeof t.gem_amount&&(i.account.gem_amount=t.gem_amount),"undefined"!=typeof t.message&&(e.pending_message=t.message,e.pending_message_audio_pre=t.message_audio_pre,e.pending_message_audio_post=t.message_audio_post,e.pending_message_ok_text=t.message_ok_text)))},error:function(){e.log_query_processed=!0},request_method:"POST",async:!0})}function bt(){e.force_screen_refresh+=1}function Et(){e.force_screen_refresh-=1}function hi(){e.do_screen_refresh_run=!0,e.show_pieces_deferred=window.requestAnimationFrame(nt)}function ci(){e.do_screen_refresh_run=!1,window.cancelAnimationFrame(e.show_pieces_deferred)}function nt(y,p){function h(){p||(e.show_pieces_deferred=window.requestAnimationFrame(nt))}if(e.do_screen_refresh_run){if(!e.do_screen_refresh&&(e.force_screen_refresh<=0||!t.background_image_drawn))return void h();if(t.first_render_complete&&document.body.appendChild(t),t.first_render_complete=!0,e.do_screen_refresh=!1,e.do_category_refresh&&(o.refresh(),e.do_category_refresh=!1),void function(){if(t.cached_width||t.cached_height){if(t.cached_width){var e=t.cached_width;delete t.cached_width}else var e=t.width;if(t.cached_height){var i=t.cached_height;delete t.cached_height}else var i=t.height;t.renderer.resize(e,i)}}(),t.cached_width){var g=t.cached_width;delete t.cached_width}else var g=t.width;if(t.cached_height){var f=t.cached_height;delete t.cached_height}else var f=t.height;if(!t.background_image_drawn&&!x.initial_background_is_transparent){var i=t.getContext("2d");if(i)i.fillStyle="rgba(255,255,255,255)",i.fillRect(0,0,g,f);else{var i=t.getContext("webgl");i.clearColor(1,1,1,1),i.clear(i.COLOR_BUFFER_BIT)}}var i=t.stage;t.load_opacity_transition<1?(t.load_opacity_transition+=.1,e.do_screen_refresh=!0,t.load_opacity_transition>1&&(t.load_opacity_transition=1)):t.initial_alpha_sequence_complete=!0;var a=e.zoom.scale,u=e.zoom.offset_x,d=e.zoom.offset_y;i.x=u,i.y=d,a&&(i.scale.x=a,i.scale.y=a),i.alpha=1;var c=e.piece_margin,l=2*e.piece_margin;if(t.piece_container&&(0==!!t.piece_sprite_container.is_cached||1==!!t.refresh_piece_styling)){t.piece_sprite_container.is_cached=!0,t.refresh_piece_styling=!1;{var _=-u/a,m=-d/a;_+t.width/a,m+t.height/a}t.piece_container.children.forEach(function(e){e.sprite.x=Math.round(e.left-c),e.sprite.y=Math.round(e.top-c),e.sprite.width=Math.round(e.calc_width+l),e.sprite.height=Math.round(e.calc_height+l)}),x.cache_jigsaw_pieces_into_giant_texture&&(t.piece_sprite_container.renderer=t.renderer,t.initial_alpha_sequence_complete&&(t.piece_sprite_container.do_cacheAsBitmap?(t.piece_sprite_container._destroyCachedSprite(),t.piece_sprite_container._generateCachedSprite(1/e.piece_logical_scale)):(t.piece_sprite_container._bounds.x=0,t.piece_sprite_container._bounds.y=0,t.piece_sprite_container._bounds.width=t.renderer.width/e.piece_logical_scale,t.piece_sprite_container._bounds.height=t.renderer.height/e.piece_logical_scale,t.piece_sprite_container.do_cacheAsBitmap=!0,t.piece_sprite_container._generateCachedSprite(1/e.piece_logical_scale))))}if(null!=r&&"visible"==r.visibility){var s=r.sprite;s.x=Math.round(r.left-c),s.y=Math.round(r.top-c),s.width=Math.round(r.calc_width+l),s.height=Math.round(r.calc_height+l)}if(t.loading_animation.display){var n=t.loading_animation;"undefined"==typeof n.rotation_base1&&(n.rotation_base1=0),n.rotation_base1=(n.rotation_base1+.0025)%1,n.outer.sprite.rotation=-n.rotation_base1*Math.PI*2,n.stage.alpha<1&&(n.stage.alpha=n.stage.alpha+.01)}t.renderer.render(t.real_stage),h()}}function Rt(e){return"undefined"==typeof e&&(e={}),k.stop(),4==o.container.childNodes.length?void smoke.alert("No more than 4 categories can be used at one time.",function(){k.resume()}):void smoke.prompt("Please enter the name of the new category.",function(t){if(""===t)return void smoke.alert("You can't set a blank name!",function(){k.resume()});if(k.resume(),"undefined"==typeof e.complete&&(e.complete=function(){}),t===!1)return void("undefined"!=typeof e.error&&(e.complete(),e.error()));var i=o.add_category(t);"undefined"!=typeof e.success&&(e.complete(),e.success(i)),U()})}function Ot(){var s=!i.jigsaw_minimal_ui&&i.show_trophy_ribbon?l(wt):0,c=l(d);if("undefined"!=typeof e.area){{"undefined"!=typeof e.area[0].margin_top?e.area[0].margin_top:0}if(e.jigsaw_arrange_pieces_on_entire_area){var n=parseFloat(window.getComputedStyle(_).width)/2;e.area[0].width=e.area[1].width=n,e.area[0].left=0,e.area[1].left=n}else{var n=(parseFloat(window.getComputedStyle(_).width)-T.width)/2;e.area[0].width=e.area[1].width=n,e.area[0].left=0,e.area[1].left=n+T.width}}var a=s+(i.jigsaw_minimal_ui?0:l(p)),h=i.jigsaw_minimal_ui||null==V.parentNode?0:l(V);if(d.style.height="",i.jigsaw_minimal_ui){e.area&&e.area.forEach(function(e){e.margin_top=128});var r=l(d.parentNode)}else{e.area&&e.area.forEach(function(e){e.margin_top=0});var r=l(d.parentNode)-a-h}d.style.top=a+"px",d.style.height=r+"px",V.style.top=parseFloat(d.style.top)+parseFloat(d.style.height)+"px",t.reposition_and_resize(),A(),"undefined"!=typeof T&&T.naturalHeight&&(e.area&&e.area.forEach(function(e){e.height=r*e.height_ratio}),u.top=(r-T.height+(T.height-T.height))/2),et(),o.container.children.forEach(function(t){t.piece_container.children.forEach(function(t){e.area[t.area];t.top=t.top*(r/c)}),m.size_pieces(t.piece_container.children)})}function et(){if(!t.bg.image.complete)return void t.setTimeout(et,50);if(0==!!t.bg.refresh_bg&&(t.bg.refresh_bg=!0,t.bg.width="undefined"!=typeof t.cached_width?t.cached_width:t.width,t.bg.height="undefined"!=typeof t.cached_height?t.cached_height:t.height,t.bg.getContext("2d").drawImage(t.bg.image,0,0,t.bg.image.naturalWidth,t.bg.image.naturalHeight,0,0,t.bg.width,t.bg.height),D({parent:t.stage,logical_parent:t.bg,canvas:t.bg,position:0}),A()),t.background_image_drawn=!0,"undefined"==typeof u)return void t.setTimeout(et,50);if("undefined"==typeof u.left)return void t.setTimeout(et,50);if(!u.base_image.complete)return void t.setTimeout(et,50);t.bg.refresh_bg=!0;var i=t.bg.getContext("2d");t.bg.width="undefined"!=typeof t.cached_width?t.cached_width:t.width,t.bg.height="undefined"!=typeof t.cached_height?t.cached_height:t.height,i.drawImage(t.bg.image,0,0,t.bg.image.naturalWidth,t.bg.image.naturalHeight,0,0,t.bg.width,t.bg.height);var r=u.left,a=u.top,s=u.width,o=u.height,n=(e.piece_margin,u.base_image);(1==n.style.opacity||e.jigsaw_show_hint_rect)&&(i.fillStyle="white",i.fillRect(r,a,s,o),(1==n.style.opacity||e.jigsaw_show_hint_image)&&(i.globalAlpha=n.style.opacity,i.drawImage(n,r,a,s,o),i.globalAlpha=1)),D({parent:t.stage,logical_parent:t.bg,canvas:t.bg,position:0})}function si(){var e=u.base_image;e.style.zIndex=1,e.style.position="absolute",e.style.left=0,e.style.top=0,e.style.opacity=.2}function ai(e){var e=e||{},s="undefined"!=typeof e.jigsaw_minimal_ui?e.jigsaw_minimal_ui:i.jigsaw_minimal_ui,o="undefined"!=typeof e.jigsaw_use_large_square_images?e.jigsaw_use_large_square_images:i.jigsaw_use_large_square_images,r="undefined"!=typeof e.jigsaw_image_size_type?e.jigsaw_image_size_type:i.jigsaw_image_size_type,t=e.base_image||T,n={};if(s){if(0==r)var a=880;if(1==r)var a=1e3;if(2==r)var a=1080}else{if(0==r)var a=800;if(1==r)var a=860;if(2==r)var a=880}return n.width=Math.round(a/1.33333),t.naturalHeight==t.naturalWidth?o&&(n.width=a,n.height=a):t.naturalHeight<t.naturalWidth&&(n.width=a*t.naturalWidth/t.naturalHeight),n.height=parseFloat(n.width*t.naturalHeight/t.naturalWidth),n}function Dt(){function r(){return 0==!!t.first_render_complete||i.ad_control&&!i.ad_control.ignore&&i.ad_control.running||0==!!e.log_query_processed?void d.inner.setTimeout(r,50):void Yt()}e.jigsaw_initial_show_hint_image=i.jigsaw_show_hint_image,e.jigsaw_show_hint_rect=i.jigsaw_show_hint_rect,e.jigsaw_show_hint_image=i.jigsaw_show_hint_image,e.piece_margin=i.jigsaw_get_scaled_piece_margin(e),e.piece_margin_style=i.jigsaw_piece_margin_style,d.inner.appendChild(v);var n=u.composite_image=document.createElement("canvas");if(n.set_size=function(){n.width=(T.width+2*e.piece_margin)/e.piece_logical_scale,n.height=(T.height+2*e.piece_margin)/e.piece_logical_scale,n.cached_sprite_data={width:u.width+2*e.piece_margin,height:u.height+2*e.piece_margin,x:u.left-e.piece_margin,y:u.top-e.piece_margin}},si(),"undefined"==typeof localStorage["puzzle_states."+Z+"."+C+"."+P.selected_difficulty]){gt();var a=Math.round(1e6*Math.random());Math.seedrandom(a),o.add_category("General"),oi({source_image:T,width:T.width,height:T.height,size_x:e.tile_x,size_y:e.tile_y,draw_settings:x,callback:function(t){j=t,ii(j,o.current_category.piece_container),M=Array.prototype.slice.call(o.current_category.piece_container.children),Ct(M),st(o.current_category.piece_container),e.pieces_in_position_count=0,r()}})}else kt({callback:r})}function Yt(){function a(){i.jigsaw_minimal_ui?p.show_title_animation({callback:k.resume}):p.setTimeout(function(){p.autoshow_title({callback:k.resume})},1e3),m.event_listeners_loaded||(m.event_listeners_loaded=!0,v.addEventListener(i.events.POINT_START,Qt),document.addEventListener(i.events.POINT_MOVE,jt),i.is_phone_or_tablet?(R({target:d.inner,result_function:Ut,start_condition:function(){return 0==!!t.controls_locked&&null==r},start_effect:function(){i.jigsaw_pinch_controls_not_run&&(i.log_user_action("Pinch controls: run for the first time."),i.jigsaw_pinch_controls_not_run=!1),v.drag_end(),v.pinch_active=!0},end_effect:function(){v.pinch_active=!1}}),v.addEventListener("touchend",H),v.addEventListener("touchcancel",H),v.addEventListener("touchleave",H),_.addEventListener("touchend",H)):(document.addEventListener("mouseup",H),window.addEventListener("blur",pt),window.addEventListener("mouseout",Ft),d.inner.addEventListener("mousewheel",Gt),d.inner.addEventListener("DOMMouseScroll",Gt))),p.setTimeout(function(){"undefined"!=typeof i.ambient_music.last_on_state&&(1==i.ambient_music.last_on_state&&(i.ambient_music_on=!0),delete i.ambient_music.last_on_state),E.play_intro_audio({level_id:X.level_id,parent:d.inner})},400)}if(t.loading_animation.stop(),"undefined"==typeof e.pending_message||""==e.pending_message)a();else{var n=smoke.alert(e.pending_message,function(){e.pending_message_audio_post&&(i.playAudio(i.audio_dir+"/"+e.pending_message_audio_post+".ogg",{audio_type:"sound_effect",blocking:!1}),delete e.pending_message_audio_post),delete e.pending_message,a()});e.pending_message_audio_pre&&(i.playAudio(i.audio_dir+"/"+e.pending_message_audio_pre+".ogg",{audio_type:"sound_effect",blocking:!1}),delete e.pending_message_audio_pre),"undefined"!=typeof e.pending_ok_text&&(n.dialog.input.ok.innerHTML=e.pending_ok_text,delete e.pending_ok_text),n.dialog.text.style.textIndent="1em",n.dialog.text.style.textAlign="left"}}function ii(l,c){for(var r=[],n=e.tile_x*e.tile_y,i=new Array(n),t=0;n>t;t++)i[t]=t;for(var t=0;n>t;t++){var o=Math.randInt(0,n-1),h=i[o];i[o]=i[t],i[t]=h}for(var t=0,a=0;a<e.tile_x;a++)for(var s=0;s<e.tile_y;s++)r[i[t]]=l[a][s],t+=1;return r.forEach(function(e){c.appendChild(e)}),r}function st(h,s){A();var l="undefined"!=typeof s;"undefined"==typeof h&&(h=o.current_category.piece_container),"undefined"==typeof s&&(s=h.children);var s=Array.prototype.slice.call(s);1!=l&&(h.piece_matrix=[]);var c=h.piece_matrix;if(0!=s.length)for(var u=0,i=0,g=e.area.length;g>i;i++){var r=e.area[i],d=r.piece_row_max,p=r.piece_column_max,f=r.width/p;if(P.selected_difficulty<=1)var _=0,m=r.height/d;else var _=r.margin_top,m=(r.height-2*_)/d;1!=l&&(c[i]=[]);for(var n=0;d>n;n++){1!=l&&(c[i][n]=[]);for(var a=0;p>a;a++){var t=c[i][n][a]=s[u];if((1==l||"undefined"!=typeof c[i][n][a])&&!(1==l&&"undefined"!=typeof c[i][n][a]||t.puzzle_width.length>1||(t.area=i,t.row=n,t.column=a,t.left=f/2+a*f+r.left-t.calc_width/2,t.top=_+m/2+n*m+r.top-t.calc_height/2,t.piece_matrix=c,u+=1,1!=l||s.length!=u)))return}}}}function ti(){var e=document.createElement("div");return e.className="jt-play-trophy_ribbon",e.addEventListener(i.events.POINT,function(){W({mr_jigtato:E,gs:i,callback:function(){}})}),e.update=function(){e.innerHTML="";var n=P.jigsaw.trophies,c=E.set_name,r=37,s=n.length<=r?n.length:r;s==r&&e.classList.add("jt-play-trophy_ribbon-max_trophies");for(var a=0;s>a;a++){var o=n[a],h=o.split("|")[0],u=o.split("|")[1],l=E.get_trophy_item({game_type:i.game_type,level_id:h,difficulty_level:u}),t=document.createElement("img");t.className="jt-play-main_image_border_width",i.get_image(t,c,l.filename,"trophy"),t.style.backgroundColor=l.background_color,e.appendChild(t)}},e.update(),_.appendChild(e),e}function ei(){if(it.reward_container)var t=it.reward_container;else var t=C;var n=t+"|"+e.difficulty_level,r=E.get_trophy_item({game_type:i.game_type,level_id:t,difficulty_level:e.difficulty_level}),a=P.jigsaw.trophies;return-1!=a.indexOf(n)?{trophy_item:r,trophy_already_exists:!0}:(a.push(n),{trophy_item:r,trophy_already_exists:!1})}function Kt(l){var r=P.jigsaw.best_times[+e.jigsaw_initial_show_hint_image];"undefined"==typeof r[C]&&(r[C]={});var t=r[C][e.difficulty_level];"undefined"==typeof t&&(t=86400),t>l&&(t=r[C][e.difficulty_level]=l);var i=J.difficulty_levels[e.difficulty_level].point_cutoffs_visible;0==e.jigsaw_initial_show_hint_image&&(i*=J.difficulty_levels[e.difficulty_level].point_cutoffs_hidden_multiplier);for(var a=i.length;a>=0;a--){var c=Math.round(i[a]*e.get_piece_count());if(c>=l)break}var n=a+1,h=n==i.length?-1:Math.round(i[n]*e.get_piece_count()),s=P.jigsaw.ranks;"undefined"==typeof s[C]&&(s[C]={});var o=s[C][e.difficulty_level];return"undefined"==typeof o&&(o=-1),n>o&&(o=s[C][e.difficulty_level]=n),{best_time:t,rank_count:n,next_rank_point:h}}function Ht(){return e.pieces_in_position_count==e.tile_x*e.tile_y}function ni(){k.style.visibility="hidden",k.counter=0,e.zoom={scale:1,offset_x:0,offset_y:0},Dt()}function Jt(n){var n=n||{};i.playAudio(i.audio_dir+"/answer-give up.ogg",{audio_type:"sound_effect",blocking:!1}),o.select_category(o.original_category),Array.prototype.slice.call(o.container.childNodes).forEach(function(e){e!=o.container.childNodes[0]&&o.remove_category(e)}),e.zoom={scale:1,offset_x:0,offset_y:0},t.piece_container=u;var r=(e.piece_margin,o.current_category.piece_container.children);r.forEach(function(e){u.appendChild(e),e.left=Math.randInt(0,u.base_image.width)-e.width_float+u.left,e.top=Math.randInt(0,u.base_image.height)-e.height_float+u.top;var t=e.puzzle_left_min+u.left,i=e.puzzle_top_min+u.top;e.calc_width=e.width_float,e.calc_height=e.height_float,TweenMax.to(e,.8,{parseTransform:!0,ease:Linear.ease,left:t,top:i,width:e.calc_width,height:e.calc_height})}),bt(),d.inner.setTimeout(Et,800),d.inner.setTimeout(function(){qt({callback:n.callback})},1e3),d.inner.setTimeout(function(){lt({user_gave_up:!0}),850})}function lt(c){function f(){qt({hide_controls:!0}),x()}function x(){wt.update();var t=smoke.alert("",g);h(t);var s=t.dialog.text;s.classList.add("jt-play-trophy_reward-parent");var o=document.createElement("p");o.className="jt-play-trophy_reward-text",o.innerHTML=y?"This level gave you the following trophy:":"You've acquired a trophy on this level and difficulty:",s.appendChild(o);var r=document.createElement("p");r.className="jt-play-trophy_reward-trophy_name",r.style.color="undefined"!=typeof n.text_color?n.text_color:n.background_color,s.appendChild(r);var u=n.display_name.substr(n.display_name.length-1);if(r.innerHTML=n.display_name.capitalizeFirstLetter()+("!"==u||"."==u?"":"."),"undefined"!=typeof n.text_outline_color){var a=n.text_outline_color.split(",")[0].trim();i.is_chromium||i.is_android?(r.style.textShadow="none",r.style.WebkitTextStrokeColor=a,w({element:r,size:"4px",color:""})):r.style.textShadow="4px 4px "+a+", 4px 0 "+a+", 0 4px "+a+", -4px 0 "+a+", 0 -4px "+a+", -4px 4px "+a+", 4px -4px "+a+", -4px -4px "+a}if("undefined"!=typeof n.subtitle){var l=document.createElement("div");l.className="jt-play-trophy_reward-text",l.innerHTML=n.subtitle,s.appendChild(l)}var p="jt-play-main_image_border_width jt-play-trophy_reward-trophy_image",f=i.is_phone_or_tablet?"":"jt-play-trophy_reward-trophy_image-expanded",c=S({mr_jigtato:E,gs:i,set_name:Q,level_id:C,difficulty_level:e.difficulty_level,trophy_class:p+" "+f});s.appendChild(c),t.text.appendChild(t.buttons),o.style.opacity=r.style.opacity=l.style.opacity=t.buttons.ok.style.opacity=0,t.text.style.maxHeight="100%",t.text.style.marginBottom=0,t.text.style.height="862px",t.buttons.style.marginTop="426px",t.buttons.style.visibility="hidden",c.style.visibility="hidden",c.style.opacity=0,TweenMax.to(o,.5,{delay:0,parseTransform:!0,ease:Linear.ease,opacity:1}),d.inner.setTimeout(function(){c.style.visibility="visible"},600),TweenMax.to(c,.8,{delay:.6,parseTransform:!0,ease:Linear.ease,opacity:1,className:p}),TweenMax.to(r,1.1,{delay:.5,parseTransform:!0,ease:Cubic.easeIn,opacity:1}),TweenMax.to(l,.8,{delay:1.8,parseTransform:!0,ease:Cubic.easeIn,opacity:1}),d.inner.setTimeout(function(){t.buttons.style.visibility="visible"},2e3),TweenMax.to(t.buttons.ok,.2,{delay:2.7,parseTransform:!0,ease:Cubic.easeIn,opacity:1})}function g(){var e=J.rank[J.difficulty_levels[P.selected_difficulty].name];i.playAudio(i.get_set_directory(Q)+"/audio/"+e.rank_audio[r]+".m4a",{audio_type:"music",element:d.inner,restart:!0});var s=smoke.alert("");h(s),s.dialog.buttons.ok.addEventListener(i.events.POINT,function(){3==r&&window.kiipInstance&&(console.log(window.kiipInstance),window.kiipInstance.postMoment("rank_count: "+r+", selected_difficulty: "+P.selected_difficulty)),t.fireworks=new mt({gs:i,draw_area:t})});var n=s.dialog.text;n.classList.add("jt-play-show_rank-parent");var c=1==r?e.name:e.plural;n.innerHTML='<p> You completed the puzzle in <span class="jt-play-show_rank-text-bright">'+k.counter+'</span> seconds.</p><p> Your personal best is <span class="jt-play-show_rank-text-bright">'+v+"</span> seconds.</p>",n.innerHTML+=0==r?'<p> No <span class="jt-play-show_rank-text-bright">'+c+"</span> won this round!</p>":'<p> Your reward: <span class="jt-play-show_rank-text-bright">'+b[r]+"</span> "+c+".</p>";var o=document.createElement("div");o.className="jt-play-show_rank-image-container";for(var l=0;r>l;l++){var a=document.createElement("div");a.className="jt-play-show_rank-image-item",o.appendChild(a),a.style.opacity=.01,a.style.backgroundImage='url("'+i.get_set_directory(Q)+"/gui/"+e.filename+'")',void function(t,n){d.inner.setTimeout(function(){TweenMax.to(t,2,{parseTransform:!0,ease:Linear.ease,css:{opacity:1}}),d.inner.setTimeout(function(){t.addEventListener(i.events.POINT,function(){"undefined"!=typeof e.click_audio&&i.playAudio(i.get_set_directory(Q)+"/audio/"+e.click_audio+".ogg",{element:d.inner,audio_type:"music"})})},2e3)},n)}(a,500*l)}if(n.appendChild(o),0==r)var f='Complete the puzzle in <span class="jt-play-show_rank-text-bright">'+p+"</span> seconds or less to gain a "+e.name+"!";else if(-1!=p)var f='Complete the puzzle in <span class="jt-play-show_rank-text-bright">'+p+"</span> seconds or less to gain more "+e.plural+"!";else var f="You've achieved the highest rank for this puzzle and level!";var u=document.createElement("p");u.innerHTML=f,n.appendChild(u)}var c=c||{};localStorage.removeItem("puzzle_states."+Z+"."+C+"."+P.selected_difficulty);var a=c.user_gave_up||!1;i.ambient_music.last_on_state=i.ambient_music_on,i.ambient_music_on=!1;var m=ft[Math.floor(Math.random()*ft.length)];if(0==a){i.playAudio(i.audio_dir+"/"+m,{audio_type:"sound_effect",blocking:!1})}if(k.stop(),_.style.overflow="hidden",a||(t.controls_locked=!0),1!=e.zoom.scale||0!=e.zoom.offset_x||0!=e.zoom.offset_y){var o=1e3;TweenMax.to(e.zoom,o/1e3,{parseTransform:!0,ease:Linear.ease,scale:1,offset_x:0,offset_y:0})}else var o=1e3;if(t.single_piece_left){var l=t.single_piece_left;delete t.single_piece_left,u.appendChild(l),t.piece_container=u,TweenMax.to(l,o/1e3,{parseTransform:!0,ease:Cubic.easeInOut,calc_width:l.width_float,calc_height:l.height_float,left:u.left,top:u.top,onComplete:function(){Et()}}),bt()}if(a||setTimeout(function(){t.controls_locked=!1},o),1!=a){var s=ei(),n=s.trophy_item,y=s.trophy_already_exists,s=Kt(k.counter),v=s.best_time,r=s.rank_count,p=s.next_rank_point,b=["zero","one","two","three"];localStorage.player_data=JSON.stringify(P),0==a?d.inner.setTimeout(f,o+(c.show_trophy_delay||550)):d.inner.setTimeout(f,o+(c.show_trophy_delay||550))}}function qt(e){var e=e||{};if(A(),u.children.forEach(function(e){e.side_set&&(u.removeChild(e),O(e))}),o.container.children.forEach(function(e){o.remove_category(e)}),u.base_image.style.opacity=1,O(u.composite_image),et(),e.hide_controls){var t=i.use_categories;i.use_categories=!1,p.autoshow_title(),i.use_categories=t,Xt.morph_to_back_button()}e.callback&&e.callback()}function Vt(t,r){o.item_under_mouse=null;var a=c(r,d.inner),l=a[0],h=a[1];t.left=(l/_.desired_scale-e.zoom.offset_x)/e.zoom.scale+(i.jigsaw_center_piece_on_move?-t.calc_width/2:-t.initial_offset_left-t.calc_width/2),t.top=(h/_.desired_scale-e.zoom.offset_y)/e.zoom.scale+(i.jigsaw_center_piece_on_move?-t.calc_height/2:-t.initial_offset_top-t.calc_height/2),A();var n=document.elementFromPoint(r.clientX,r.clientY);null!=n&&(n.is_category_deck_item&&(o.item_under_mouse=n),n.parentNode.is_category_deck_item&&(o.item_under_mouse=n.parentNode));var s=i.jigsaw_heat_seeking_color_options[i.jigsaw_heat_seeking_color_index];"undefined"!=typeof s&&Wt(s)}function Wt(i,a){if(null!=r&&(!a||r.last_border_color_x!=r.left||r.last_border_color_y!=r.top)&&(r.last_border_color_x=r.left,r.last_border_color_y=r.top,d.inner.setTimeout(function(){Wt(i,a)},500),r.border_adjust_count="undefined"==typeof r.border_adjust_count?0:r.border_adjust_count+1,10==r.border_adjust_count&&(r.border_adjust_count=0),0==r.border_adjust_count)){r.border_adjust_count=0;var o=r.left-u.left,l=r.top-u.top,e=Math.abs(o-r.puzzle_left_min)/t.width+Math.abs(l-r.puzzle_top_min)/t.height;e>1&&(e=1),e=Math.pow(e,.5);var n=parseInt(255*e),s=parseInt(127*e);if("red"==i)var c="rgba("+(255-n)+", 0,"+s+", 1)";if("cyan"==i){b=255-n+s,b>255&&(b=255);var c="rgba(0, "+(255-n)+","+b+", 1)"}dt(r.canvas,c),Lt(r)}}function Gt(e){function r(i){var t=i.wheelDelta,e=i.detail;return e?t?t/e/40*e>0?1:-1:-e/3:t/120}if(e.preventDefault(),!t.controls_locked){var i=c(e,d),a=i[0],s=i[1],n=1+Math.abs(r(e))/4.5,o=At(e)>0?n:1/n;Ut(o,a,s)}}function Ut(r,i,n){var a=e.zoom.scale;i/=_.content_scale,n/=_.content_scale;var t=a*r;r>1?t>e.zoom.scalemax&&(t=e.zoom.scalemax):t<e.zoom.scalemin&&(t=e.zoom.scalemin);var s=(e.zoom.offset_x-i)*(t/e.zoom.scale)+i,o=(e.zoom.offset_y-n)*(t/e.zoom.scale)+n;e.zoom.scale=t,e.zoom.offset_x=s,e.zoom.offset_y=o}function Qt(n){if(n.preventDefault(),!t.controls_locked){var s=n.target;if("undefined"!=typeof n.targetTouches){if(n.touches.length>1){if(null!=r){var n=n.touches[Array.prototype.slice.call(n.touches).findIndex(function(e){return e.identifier!=r.touch_id})];s!=v||v.pinch_active||v.drag_start(n)}return}n=n.targetTouches[0]}else if(null!=r)return;if(!Y(n)){var u=c(n,d.inner),f=(u[0]/_.desired_scale-e.zoom.offset_x)/e.zoom.scale,p=(u[1]/_.desired_scale-e.zoom.offset_y)/e.zoom.scale,h=[],y=o.current_category;if(y)for(var m=y.piece_container,l=0,g=m.children.length;g>l;l++){var a=m.children[l];if(!a.placed&&!(f<a.left||p<a.top||f>a.left+a.calc_width||p>a.top+a.calc_height)){var w=((f-a.left)/i.jigsaw_piece_scale_to_actual+e.piece_margin)/e.piece_logical_scale,T=((p-a.top)/i.jigsaw_piece_scale_to_actual+e.piece_margin)/e.piece_logical_scale,E=a.dummy_canvas.getContext("2d").isPointInPath(a.path,w,T);E&&h.push(a)}}if(0==h.length)return void(s!=v||v.pinch_active||v.drag_start(n));for(var s=h[0],x=+h[0].sprite.index,l=1,g=h.length;g>l;l++){var a=h[l];+a.zIndex<=x||(x=+a.zIndex,s=a)}A(),i.playAudio(i.audio_dir+"/global-pick up.ogg",{audio_type:"sound_effect",blocking:!1});var b=o.basket_button;if(b.is_selected)return void b.toggle_piece(s);if(O(s),D({logical_parent:s,canvas:s.canvas,is_2d:!0}),r=s,r.touch_id=n.identifier,r.pickup_left=r.left,r.pickup_top=r.top,r.calc_width=r.width_float,r.calc_height=r.height_float,t.piece_sprite_container.removeChild(s.sprite),t.stage.addChild(s.sprite),0==i.jigsaw_center_piece_on_move){var u=c(n,d.inner),f=u[0],p=u[1];r.initial_offset_left=(f/_.desired_scale-e.zoom.offset_x)/e.zoom.scale-s.virtual_left,r.initial_offset_top=(p/_.desired_scale-e.zoom.offset_y)/e.zoom.scale-s.virtual_top}document.body.style.cursor="pointer",s.visibility="hidden",r.visibility="visible",Vt(r,n)}}}function Ft(e){"undefined"!=typeof e.changedTouches&&(e=e.changedTouches[0]);var n=e.pageX,r=e.pageY,t=window.scrollX;"undefined"==typeof t&&(t=document.body.scrollLeft);var i=window.scrollY;"undefined"==typeof i&&(i=document.body.scrollTop),r>=0&&r<=window.innerHeight+i&&n>=0&&n<=window.innerWidth+t||H(e)}function H(l){if(null!=v){if("undefined"==typeof l.touches)v.drag_end();else{var P=l.touches[Array.prototype.slice.call(l.touches).findIndex(function(e){return e.identifier==v.touch_id})];if("undefined"==typeof P&&v.drag_end(),null!=r){var I=l.touches[Array.prototype.slice.call(l.touches).findIndex(function(e){return e.identifier==r.touch_id})];if("undefined"!=typeof I)return}}if(null!=r){"undefined"!=typeof l.changedTouches&&(l=l.changedTouches[0]);var y=!0,g=!1;if(null!=o.item_under_mouse){var A=o.current_category;if(A!=o.item_under_mouse){y=!1,g=!0;var x=o.item_under_mouse.piece_container;x.appendChild(r),st(x,[r])}}var k=o.current_category.piece_container.children,s=r,c=i.jigsaw_piece_scale_to_actual,b=2*i.jigsaw_required_precision,a=[],R=r.left+(1-c)/2*s.width_float-s.puzzle_left_min*c,L=r.top+(1-c)/2*s.height_float-s.puzzle_top_min*c;if(k.forEach(function(e){if(e!=s)for(var h=e.virtual_left-e.width_float*c/2-e.puzzle_left_min*c,d=e.virtual_top-e.height_float*c/2-e.puzzle_top_min*c,n=Math.abs(h-R),r=Math.abs(d-L),t=0,l=s.puzzle_width.length;l>t;t++)for(var g=s.puzzle_width[t],u=s.puzzle_height[t],i=0,p=e.puzzle_width.length;p>i;i++)if(!e.placed){var f=e.puzzle_width[i],_=e.puzzle_height[i],m=(g+f)/b,o=(u+_)/b;if(!(n>m||r>o||Math.abs(e.x[i]-s.x[t])+Math.abs(e.y[i]-s.y[t])!=1)){-1==a.indexOf(e)&&a.push(e);break}}}),a.length>0){var s=r,a=a.concat([s]),p=u.composite_image.width-2*e.piece_margin/e.piece_logical_scale,_=0,d=u.composite_image.height-2*e.piece_margin/e.piece_logical_scale,m=0;a.forEach(function(e){p>e.puzzle_left_min&&(p=e.puzzle_left_min),d>e.puzzle_top_min&&(d=e.puzzle_top_min),_<e.puzzle_left_min+e.width_float&&(_=e.puzzle_left_min+e.width_float),m<e.puzzle_top_min+e.height_float&&(m=e.puzzle_top_min+e.height_float)});var n=_t();return n.className="jt-jigsaw-piece_deck-piece",n.piece_id=s.piece_id,n.x=[],n.y=[],n.puzzle_width=[],n.puzzle_height=[],n.puzzle_left=[],n.puzzle_top=[],n.puzzle_left_min=p,n.puzzle_top_min=d,n.side_set=rt(a,!0),n.shape_string=$(rt(a,i.jigsaw_combine_pieces),[-p,-d]),n.dummy_canvas=document.createElement("canvas"),n.path=new Path2D(n.shape_string),M.push(n),s.parentNode.appendChild(n),n.width_float=Math.round(1e3*(_-p))/1e3,n.height_float=Math.round(1e3*(m-d))/1e3,n.width=Math.ceil((n.width_float+2*e.piece_margin)/e.piece_logical_scale),n.height=Math.ceil((n.height_float+2*e.piece_margin)/e.piece_logical_scale),a.forEach(function(e){e.parentNode.removeChild(e)}),a.forEach(function(e){O(e),M.splice(M.indexOf(e),1),e.x.forEach(function(i,t){j[e.x[t]][e.y[t]]=n}),n.x=n.x.concat(e.x),n.y=n.y.concat(e.y),n.puzzle_width=n.puzzle_width.concat(e.puzzle_width),n.puzzle_height=n.puzzle_height.concat(e.puzzle_height),n.puzzle_left=n.puzzle_left.concat(e.puzzle_left),n.puzzle_top=n.puzzle_top.concat(e.puzzle_top)}),n.calc_width=n.width_float*i.jigsaw_piece_scale_to_actual,n.calc_height=n.height_float*i.jigsaw_piece_scale_to_actual,n.left=(n.puzzle_left_min-a[0].puzzle_left_min)*i.jigsaw_piece_scale_to_actual+a[0].left,n.top=(n.puzzle_top_min-a[0].puzzle_top_min)*i.jigsaw_piece_scale_to_actual+a[0].top,n.x.length==e.tile_x*e.tile_y&&(t.single_piece_left=n,lt()),ot(n),O(r),r=null,vt(),t.refresh_piece_styling=!0,void U()}if(y)for(var f=r,w=!1,T=r.calc_width/i.jigsaw_required_precision,E=r.calc_height/i.jigsaw_required_precision,C=r.left-u.left,S=r.top-u.top;;){if(C+T<f.puzzle_left_min)break;if(C-T>f.puzzle_left_min)break;if(S+E<f.puzzle_top_min)break;if(S-E>f.puzzle_top_min)break;w=!0;break}if(i.playAudio(i.audio_dir+"/global-put down.ogg",{audio_type:"sound_effect",blocking:!1}),!w)return void pt({is_transferred_to_different_category:g});if(ot(r),D({logical_parent:r,canvas:r.canvas}),i.jigsaw_animate_piece_placement){var h=r;t.piece_sprite_container.addChildAt(h.sprite,0),r=null;var z=h.puzzle_left_min+u.left,B=h.puzzle_top_min+u.top;bt(),h.placed=!0,TweenMax.to(h,.35,{parseTransform:!0,ease:Linear.ease,left:z,top:B,onComplete:function(){Et(),zt(h)}})}else zt(r)}}}function zt(a){e.pieces_in_position_count+=a.x.length,a.parentNode.removeChild(a),document.body.style.cursor="",a.placed=!0;for(var m=[],w=[],S=[[0,0,!0],[-1,0,!0],[0,-1,!0],[1,0,!0],[0,1,!0],[1,1,!1],[-1,-1,!1],[1,-1,!1],[-1,1,!1],[-2,0,!1],[0,-2,!1],[2,0,!1],[0,2,!1],[2,1,!1],[-2,-1,!1],[2,-1,!1],[-2,1,!1],[1,2,!1],[-1,-2,!1],[1,-2,!1],[-1,2,!1],[2,2,!1],[-2,-2,!1],[2,-2,!1],[-2,2,!1]],d={},b=a.x,c=u.composite_image.width-2*e.piece_margin/e.piece_logical_scale,f=0,l=u.composite_image.height-2*e.piece_margin/e.piece_logical_scale,_=0,s=0;s<b.length;s++){var T=a.x[s],v=a.y[s];j[T][v]=Pt(a)}for(var s=0;s<b.length;s++){var T=a.x[s],v=a.y[s];S.forEach(function(t){var i=T+t[0];if("undefined"!=typeof j[i]){var r=v+t[1],e=j[i][r];if("undefined"!=typeof e&&e.placed){var n=!1;"undefined"==typeof d[e.piece_id]&&(n=!0,d[e.piece_id]=t[2],m.push(e)),1==t[2]&&(1==n||0==d[e.piece_id])&&(d[e.piece_id]=!0,w.push(e),c>e.puzzle_left_min&&(c=e.puzzle_left_min),l>e.puzzle_top_min&&(l=e.puzzle_top_min),f<e.puzzle_left_min+e.width_float&&(f=e.puzzle_left_min+e.width_float),_<e.puzzle_top_min+e.height_float&&(_=e.puzzle_top_min+e.height_float))}}})}var C=(rt(m,!0),$(rt(m,i.jigsaw_combine_pieces),[-Math.floor(c),-Math.floor(l)])),n=document.createElement("canvas");n.width_float=Math.round(1e3*(f-c))/1e3,n.height_float=Math.round(1e3*(_-l))/1e3,n.width=Math.ceil((n.width_float+2*e.piece_margin)/e.piece_logical_scale),n.height=Math.ceil((n.height_float+2*e.piece_margin)/e.piece_logical_scale);var o=n.getContext("2d");o.save(),y({x:e.piece_margin,y:e.piece_margin,scale:1/e.piece_logical_scale,data:C,strokeStyle:"rgba(63,63,63,1)",lineWidth:0,canvas:n}),o.clip();var p=(u.composite_image.width-2*e.piece_margin/e.piece_logical_scale)*e.piece_logical_scale/u.base_image.naturalWidth;w.forEach(function(t){o.drawImage(u.base_image,t.puzzle_left_min/p,t.puzzle_top_min/p,t.width*e.piece_logical_scale/p,t.height*e.piece_logical_scale/p,(t.puzzle_left_min-c)/e.piece_logical_scale,(t.puzzle_top_min-l)/e.piece_logical_scale,t.width,t.height)}),o.restore(),o.save(),o.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),i.jigsaw_use_3d_effect&&g({canvas:n,draw_settings:x,stroke_width:x.stroke_width,cut_multiplier:x.cut_multiplier,shape_string:C,scale:1/e.piece_logical_scale,clear_stroke:"undefined"==typeof e.piece_margin_style,game_instance:e}),dt(n),o.restore();var E=u.composite_image.getContext("2d");E.globalCompositeOperation="source-over",E.drawImage(n,c/e.piece_logical_scale,l/e.piece_logical_scale,n.width,n.height),n.width=0,n.height=0;var h=u.composite_image;h.texture?Lt(h):D({parent:t.stage,canvas:h,position:1,is_2d:!0}),h.sprite.x=u.left-e.piece_margin,h.sprite.y=u.top-e.piece_margin,O(a),a==r&&(r=null),vt(),U(),Ht()&&lt()}function pt(e){if(null!=r){if(A(),"undefined"==typeof e&&(e={}),document.body.style.cursor="",e.is_transferred_to_different_category||t.piece_sprite_container.addChild(r.sprite),r.visibility="visible",!i.freestyle_mode||e.is_transferred_to_different_category)r.left=r.pickup_left,r.top=r.pickup_top;else{if(r.left=r.left+(r.calc_width-r.calc_width)/2,r.top=r.top+(r.calc_height-r.calc_height)/2,r.virtual_left-.25*r.calc_width<0)r.virtual_left=.25*r.calc_width;else{var n=parseFloat(window.getComputedStyle(d.inner).width);r.virtual_left+.25*r.calc_width>n&&(r.virtual_left=n-.25*r.calc_width)}if(r.virtual_top-.25*r.calc_height<0)r.virtual_top=.25*r.calc_height;else{var a=parseFloat(window.getComputedStyle(d.inner).height);r.virtual_top+.25*r.calc_height>a&&(r.virtual_top=a-.25*r.calc_height)}}delete r.border_adjust_count,delete r.pickup_left,delete r.pickup_top,ot(r),D({logical_parent:r,canvas:r.canvas}),r.calc_width=r.width_float*i.jigsaw_piece_scale_to_actual,r.calc_height=r.height_float*i.jigsaw_piece_scale_to_actual,r=null,o.item_under_mouse=null,vt(),U()}}function jt(e){if("touchcancel"==e.type&&e.preventDefault(),!t.controls_locked){{e.target}if(e.touches){if(v.drag_active){var i=e.touches[Array.prototype.slice.call(e.touches).findIndex(function(e){return e.identifier==v.touch_id})];v.drag_update(i)}e=e.targetTouches[0]}else v.drag_update(e);null!=r&&Vt(r,e)}}function oi(b){function m(i,n,r,a,s,o){var e=f[i][n][r],t=f[a][s][o];return A.testCurveCurveIntersection(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3])?!0:A.testCurveCurveIntersection(e[3],e[4],e[5],e[6],t[0],t[1],t[2],t[3])?!0:A.testCurveCurveIntersection(e[0],e[1],e[2],e[3],t[3],t[4],t[5],t[6])?!0:A.testCurveCurveIntersection(e[3],e[4],e[5],e[6],t[3],t[4],t[5],t[6])?!0:!1}function tt(r,s,l,c,p,_,f,g){for(var o=new Array,i=[new Array,new Array],d=0;2>d;d++){if(0==d)var n=6*r-12*l+6*p,u=-3*r+9*l-9*p+3*f,T=3*l-3*r;else var n=6*s-12*c+6*_,u=-3*s+9*c-9*_+3*g,T=3*c-3*s;if(Math.abs(u)<1e-12){if(Math.abs(n)<1e-12)continue;var e=-T/n;e>0&&1>e&&o.push(e)}else{var w=n*n-4*T*u,v=Math.sqrt(w);if(!(0>w)){var y=(-n+v)/(2*u);y>0&&1>y&&o.push(y);var m=(-n-v)/(2*u);m>0&&1>m&&o.push(m)}}}for(var x,b,t,a=o.length,h=a;a--;){var e=o[a];t=1-e,x=t*t*t*r+3*t*t*e*l+3*t*e*e*p+e*e*e*f,i[0][a]=x,b=t*t*t*s+3*t*t*e*c+3*t*e*e*_+e*e*e*g,i[1][a]=b}return i[0][h]=r,i[1][h]=s,i[0][h+1]=f,i[1][h+1]=g,{x0:Math.min.apply(null,i[0]),y0:Math.min.apply(null,i[1]),x1:Math.max.apply(null,i[0]),y1:Math.max.apply(null,i[1])}}for(var h=(b.success||function(){},b.source_image),_=b.size_x,v=b.size_y,N=b.width,B=b.height,z=b.draw_settings,y=[],A=ct(),G=100/_,W=100/v,r=0;_>=r;r++){y[r]=[];for(var n=0;v>=n;n++){var et=0==r||r==_?0:.25*Math.randBMT(),Z=0==n||n==v?0:.25*Math.randBMT();y[r][n]=[(r+et)*G,(n+Z)*W]}}for(var Y=[[[450,-150],[226,-59],void 0,void 0,2],[[330,-180],[155,-120],void 0,void 0,3],[[333,58],[120,-50],void 0,void 0,4],[[312,15],[75,54],void 0,void 0,4],[[275,65],[17,7],void 0,void 0,8],[[260,0],[40,0],void 0,void 0,9],[[312,15],[95,-33],void 0,void 0,9],[[280,-80],[108,-124],void 0,void 0,9],[[220,0],[80,0],void 0,void 0,20],[[223,-19],[80,0],[35,265],110,24]],O=[],a=0;a<Y.length;a++)for(var k=Y[a],T=0;T<k[4];T++)O.push([k[0],k[1],k[2],k[3]]);var f=[];for(vh=0;2>vh;vh++){f[vh]=[];for(var r=0;_+vh>r;r++){f[vh][r]=[];for(var n=0;v+(1-vh)>n;n++){var t=[[0,0],[220,0],[60,80],[150,80],[240,80],[80,0],[300,0]];if((0==n||n==v+1-vh-1)&&0==vh||(0==r||r==_+vh-1)&&1==vh)t=[t[0],t[t.length-1]];else{var K=Math.randInt(0,O.length-1),p=O[K];t[1]=[p[0][0]-10+20*Math.randBMT(),p[0][1]-10+20*Math.randBMT()],t[5]=[p[1][0]-10+20*Math.randBMT(),p[1][1]-10+20*Math.randBMT()],"undefined"!=typeof p[2]&&(t[2][0]=p[2][0],t[4][0]=p[2][1]);var Q=Math.randInt(0,1);if(1==Q){var H=t[1][0];t[1][0]=300-t[5][0],t[5][0]=300-H}if("undefined"!=typeof p[3])var $=p[3]-5+10*Math.randBMT();else if(0!=Math.randInt(0,4))var $=70+20*Math.randBMT();else var $=60+40*Math.randBMT();t[2][1]=t[3][1]=t[4][1]=$;var J=Math.randInt(0,1);if(1==J)for(var a=1,c=t.length;c-1>a;a++)t[a][1]=-t[a][1]}for(var a=0,c=t.length;c>a;a++){if(1==vh){var H=t[a][0];t[a][0]=t[a][1],t[a][1]=H}t[a][0]=t[a][0]/300*G+y[r][n][0],t[a][1]=t[a][1]/300*W+y[r][n][1]}var c=t.length;t[c-1]=0==vh?[y[r+1][n][0],y[r+1][n][1]]:[y[r][n+1][0],y[r][n+1][1]];for(var a=0;c>a;a++)t[a][0]=t[a][0].toFixed(4),t[a][1]=t[a][1].toFixed(4);for(var D=new Array(c),a=0;c>a;a++)D[a]=[t[a][0]/100*N,t[a][1]/100*B];if(f[vh][r][n]=D,D.length>2&&n>0&&r>0&&vh>0){var t=f[vh][r][n];if(A.testCurveCurveIntersection(t[0],t[1],t[2],t[3],t[3],t[4],t[5],t[6])&&Math.random()>.01){n-=1;continue}if(0==vh){if(m(vh,r,n,1-vh,r,n)&&Math.random()>.01){n-=1;continue}if(n>0&&m(vh,r,n,1-vh,r,n-1)&&Math.random()>.01){n-=1;continue}if(n>0&&_-1>r&&m(vh,r,n,1-vh,r+1,n-1)&&Math.random()>.01){n-=1;continue}if(_-1>r&&m(vh,r,n,1-vh,r+1,n)&&Math.random()>.01){n-=1;continue}}else{if(m(vh,r,n,1-vh,r,n)&&Math.random()>.01){n-=1;continue}if(r>0&&m(vh,r,n,1-vh,r-1,n)&&Math.random()>.01){n-=1;continue}if(r>0&&v-1>n&&m(vh,r,n,1-vh,r-1,n+1)&&Math.random()>.01){n-=1;continue}if(v-1>n&&m(vh,r,n,1-vh,r,n+1)&&Math.random()>.01){n-=1;continue}}}}}}for(var j=[],V="",q=0,r=0;_>r;r++){j[r]=[];for(var n=0;v>n;n++){for(var w=[],C=[],E="",S="",o={x0:N,y0:B,x1:0,y1:0},d=(f[0][r][n][0][0],f[0][r][n][0][1],[]),u=0;4>u;u++){var L=0,t=f[u%2==0?1:0][r+(2==u?1:0)][n+(3==u?1:0)],c=t.length;if(2>=c)var o={x0:t[0][0]<o.x0?t[0][0]:o.x0,y0:t[0][1]<o.y0?t[0][1]:o.y0,x1:t[1][0]>o.x1?t[1][0]:o.x1,y1:t[1][1]>o.y1?t[1][1]:o.y1};else for(var a=0;4>a;a+=3)var x=tt(t[0+a][0],t[0+a][1],t[1+a][0],t[1+a][1],t[2+a][0],t[2+a][1],t[3+a][0],t[3+a][1]),o={x0:x.x0<o.x0?x.x0:o.x0,y0:x.y0<o.y0?x.y0:o.y0,x1:x.x1>o.x1?x.x1:o.x1,y1:x.y1>o.y1?x.y1:o.y1};var R=0==u&&c>2?" M ":" L ";c>2&&0!=u&&(R=""),S+=R,""!=R&&(C.length>0&&("M"!=E&&d.push({type:E,points:C}),C=[],0==L&&d.length>0&&(w.push({x:r,y:n,s:w.length,p:d}),d=[]),L+=1),E=R.trim());for(var a=u%3==0?c-1:0,T=0;c>T;T++)(0==u||2>=c||0!=T)&&(T%3==1&&c>2&&("M"!=E&&d.push({type:E,points:C}),C=[],0==L&&d.length>0&&(w.push({x:r,y:n,s:w.length,p:d}),d=[]),L+=1,E="C",S+=" C "),S+=t[a][0].toFixed(4)+","+t[a][1].toFixed(4),C.push([parseFloat(t[a][0].toFixed(4)),parseFloat(t[a][1].toFixed(4))]),T!=c-1&&(S+=" ")),u%3==0?a--:a++}d.push({type:E,points:C}),w.push({x:r,y:n,s:w.length,p:d}),S+="z",V+=S+" ";var X=s(o),o={x0:Math.round(1e3*o.x0)/1e3,y0:Math.round(1e3*o.y0)/1e3,x1:Math.round(1e3*o.x1)/1e3,y1:Math.round(1e3*o.y1)/1e3},F=Math.round(1e3*(o.x1-o.x0))/1e3,U=Math.round(1e3*(o.y1-o.y0))/1e3,l=_t();l.x=[r],l.y=[n],l.piece_id=q,l.width=Math.ceil(F+2*e.piece_margin)/e.piece_logical_scale,l.height=Math.ceil(U+2*e.piece_margin)/e.piece_logical_scale,l.width_float=F,l.height_float=U,l.puzzle_width=[F],l.puzzle_height=[U],l.puzzle_left_min=X.x0,l.puzzle_top_min=X.y0,l.puzzle_left=[o.x0],l.puzzle_top=[o.y0],l.side_set=[w],l.placed=!1,j[r][n]=l,q+=1}}var M=document.createElement("canvas"),I=M.getContext("2d");M.width=(N+2*e.piece_margin)/e.piece_logical_scale,M.height=(B+2*e.piece_margin)/e.piece_logical_scale;var P=h.naturalWidth/h.width,it=P*h.width<=h.naturalWidth?P*h.width:h.naturalWidth,nt=P*h.height<=h.naturalHeight?P*h.height:h.naturalHeight;I.drawImage(h,0,0,it,nt,e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale,h.width/e.piece_logical_scale,h.height/e.piece_logical_scale),I.save(),I.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),i.jigsaw_use_3d_effect&&g({canvas:M,draw_settings:z,stroke_width:z.stroke_width,cut_multiplier:z.cut_multiplier,shape_string:V,scale:1/e.piece_logical_scale,clear_stroke:"undefined"==typeof e.piece_margin_style,game_instance:e}),It({piece_grid:j,big_canvas:M,grid_is_new:!0,callback:function(e){I.restore(),b.callback(e)}})}function It(i){function u(){for(var i=0;_>i;i++){var e=a[c][n];if(1==r||!e.placed){var m=!1;0==r&&e.sprite&&(m=!0,O(e)),e.shape_string=$(e.side_set,[-e.puzzle_left_min,-e.puzzle_top_min]),xt(e,p),D({canvas:e.canvas,logical_parent:e}),0==m&&t.piece_sprite_container.removeChild(e.sprite),1==r&&(e.zIndex=l)}if(l+=1,n+=1,n==o&&(n=0,c+=1),c==h)break}l!=h*o?(t.refresh_piece_styling=!0,timeout=d.inner.setTimeout(u,20)):(ut=void 0,void function(){for(var n={},l=0;h>l;l++)for(var c=0;o>c;c++){var e=a[l][c];0==r&&e.placed||(e.parentNode==t.piece_container||null==e.parentNode)&&(n[e.zIndex]=e)}for(var u=s(t.piece_sprite_container.children),i=0,d=u.length;d>i;i++)t.piece_sprite_container.removeChild(u[i]);for(var i in n)t.piece_sprite_container.addChild(n[i].sprite);t.piece_sprite_container.is_cached=!1,f(a)}())}var a=i.piece_grid,p=i.big_canvas,r=i.grid_is_new,f=i.callback,h=e.tile_x,o=e.tile_y,_=20,l=0,c=0,n=0;"undefined"!=typeof ut&&clearTimeout(ut),ut=void 0,u()}function vt(){for(var i=t.piece_sprite_container.children,e=0,n=i.length;n>e;e++){var r=i[e].logical_parent;r.zIndex=e}t.piece_sprite_container.is_cached=!1}function $(n,e,t){function r(n){var r="",i="";return n.forEach(function(a){a.p.forEach(function(s){if(r+=" "+s.type+" ",""==i){var o=n[n.length-1].p,l=o[o.length-1],a=l.points;switch(l.type){case"L":i="M "+(a[1][0]*t+e[0]).toFixed(4)+","+(a[1][1]*t+e[1]).toFixed(4)+" ";break;case"C":i="M "+(a[2][0]*t+e[0]).toFixed(4)+","+(a[2][1]*t+e[1]).toFixed(4)+" "}}s.points.forEach(function(i){r+=(i[0]*t+e[0]).toFixed(4)+","+(i[1]*t+e[1]).toFixed(4)+" "})})}),i+r+"z"}var t="undefined"!=typeof t?t:1,e="undefined"==typeof e?[0,0]:e;e[0]*=t,e[1]*=t;var a=n,i=[];return a.forEach(function(e){i.push(r(e))}),"".concat.apply(i)}function dt(r,i,a){var n="undefined"!=typeof i?i:e.piece_margin_style;if("undefined"!=typeof n){var t=r.getContext("2d");t.lineJoin="round",t.lineCap="round",t.lineWidth=e.piece_margin/e.jigsaw_scale_low_power_sizer*x.border_scale,"clear"==i?(t.strokeStyle="rgba(0,0,0,1)",t.globalCompositeOperation="destination-out",t.stroke(),t.globalCompositeOperation="source-in"):(t.strokeStyle=n,t.stroke())}}function rt(b,w){if(!w){var d=[];b.forEach(function(e){e.side_set.forEach(function(e){d.push(e)})});var T=[].concat.apply(d);return T}for(var x=[[-1,0],[0,-1],[1,0],[0,1]],c=[],l=[],i=-1;i<e.tile_x+2;i++){l[i]=[];for(var n=-1;n<e.tile_y+2;n++)l[i][n]=[0,0,0,0]}for(var i=-1;i<e.tile_x+1;i++){c[i]=[];for(var n=-1;n<e.tile_y+1;n++)c[i][n]=void 0}b.forEach(function(e){e.x.forEach(function(i,t){c[e.x[t]][e.y[t]]=e})});for(var v=[],i=0;i<e.tile_x;i++)for(var n=0;n<e.tile_y;n++)if(c[i][n])for(var p=0;4>p;p++)if(!l[i][n][p]){for(var g=[],t=p,m=0,y=!1,a=i,r=n;;){var o=a+x[t][0],s=r+x[t][1];if(l[a][r][t]=1,l[o][s][(t+2)%4]=1,c[o][s]){if(3==m)break;m+=1,t=(t+3)%4,a=o,r=s}else{if(0==y){y=!0;var h=a,u=r;o>a&&(h+=1,2==t&&(u+=1)),s>r&&(u+=1,1==t&&(h+=1)),a>o&&2==t&&(u+=1),r>s&&1==t&&(h+=1);var f=h,_=u}else{var f=a,_=r;if(o>a&&(f+=1,2==t&&(_+=1)),s>r&&(_+=1,1==t&&(f+=1)),a>o&&2==t&&(_+=1),r>s&&1==t&&(f+=1),h==f&&u==_)break}g.push([a,r,t]),l[a][r][t]=1,l[o][s][(t+2)%4]=1,t=(t+1)%4,m=0}}g.length>0&&v.push(g)}var d=[];return v.forEach(function(t){var e=[];t.forEach(function(i){var s=i[0],l=i[1],h=i[2],a=c[s][l];e:for(var r=0,u=a.side_set.length;u>r;r++)for(var o=a.side_set[r],n=0,d=o.length;d>n;n++){var t=o[n];if(s==t.x&&l==t.y&&h==t.s)break e}e.push(t)}),d.push(e)}),d}function Pt(e){return{placed:e.placed,puzzle_left:e.puzzle_left,puzzle_top:e.puzzle_top,puzzle_left_min:e.puzzle_left_min,puzzle_top_min:e.puzzle_top_min,width:e.width,height:e.height,width_float:e.width_float,height_float:e.height_float,puzzle_width:e.puzzle_width,puzzle_height:e.puzzle_height,x:e.x,y:e.y,zIndex:e.zIndex,virtual_left:e.virtual_left,virtual_top:e.virtual_top,piece_id:e.piece_id,side_set:e.side_set}}function D(i){if(i instanceof HTMLCanvasElement||i instanceof HTMLImageElement)var n=i,e=i,r=t.piece_sprite_container,o=r.children.length;else var e="undefined"!=typeof i.logical_parent?i.logical_parent:i.canvas,n=i.canvas,r="undefined"!=typeof i.parent?i.parent:t.piece_sprite_container,o="undefined"!=typeof i.position?i.position:r.children.length;var a=i.invalidate,c=i.is_2d;"undefined"==typeof a&&(a=!1);var s=e.cached_sprite_data;if(e.sprite&&"undefined"==typeof i.position&&-1!=r.children.indexOf(e.sprite)&&(o-=1),(e.canvas||e==n)&&O(e),c&&n!=e?(n.texture=new PIXI.Texture.fromCanvas(n),e.texture=n.texture,delete n.texture):e.texture=new PIXI.Texture.fromCanvas(n),e.sprite=new PIXI.Sprite(e.texture),e.sprite.logical_parent=e,e.canvas=e.texture.baseTexture.source,"undefined"!=typeof s)for(var l in s)e.sprite[l]=s[l];return r.addChildAt(e.sprite,o),A(),"undefined"!=typeof r&&r==t.piece_sprite_container&&1==a&&(r.is_cached=!1),e}function O(e,n){if("undefined"==typeof n&&(n=!1),"undefined"!=typeof e&&e.texture){var i=e.sprite.parent;"undefined"!=typeof i&&e.sprite.parent.removeChild(e.sprite),e.texture.destroy(!0),e.texture=null,e.sprite=null,"undefined"!=typeof i&&i==t.piece_sprite_container&&1==n&&(i.is_cached=!1),A()}}function Lt(e){t.renderer.gl&&e.texture&&PIXI.updateWebGLTexture(e.texture.baseTexture,t.renderer.gl)}function li(e,t){return e.forEach(function(e){e.forEach(function(e){e.p.forEach(function(e){e.points.forEach(function(e){e.forEach(function(n,i){e[i]=e[i]*t})})})})}),e}function _t(){var e={};e.is_jigsaw_piece=!0,e.canvas=document.createElement("canvas");var c=null;Object.defineProperty(e,"parentNode",{get:function(){return c},set:function(e){c=e}});var i,n;Object.defineProperty(e,"left",{get:function(){return i},set:function(n){i=n,a=i+o/2,e!=r&&(t.refresh_piece_styling=!0,t.refresh_piece_styling=!0)}}),Object.defineProperty(e,"top",{get:function(){return n},set:function(i){n=i,s=n+l/2,e!=r&&(t.refresh_piece_styling=!0,t.refresh_piece_styling=!0)}});var a,s;Object.defineProperty(e,"virtual_left",{get:function(){return a},set:function(n){a=n,i=a-o/2,e!=r&&(t.refresh_piece_styling=!0)}}),Object.defineProperty(e,"virtual_top",{get:function(){return s},set:function(i){s=i,n=s-l/2,e!=r&&(t.refresh_piece_styling=!0)}});var o,l;return Object.defineProperty(e,"calc_width",{get:function(){return o},set:function(n){o=n,i=a-o/2,e!=r&&(t.refresh_piece_styling=!0)}}),Object.defineProperty(e,"calc_height",{get:function(){return l},set:function(i){l=i,n=s-l/2,e!=r&&(t.refresh_piece_styling=!0)}}),e}function Mt(e){var t=[];Object.defineProperty(e,"children",{get:function(){return t},set:function(e){t=e}}),Object.defineProperty(e,"childNodes",{get:function(){return t},set:function(e){t=e}}),e.appendChild=function(t){t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,e.children.push(t),A(),Bt()},e.removeChild=function(t){e.children.splice(e.children.indexOf(t),1),A(),Bt()},Array.prototype.slice.call(["forEach"]).forEach(function(t){e.children[t]=function(i,n){return Array.prototype.slice.call(e.children)[t](i,n)}})}function xt(t,c,r){if("undefined"!=typeof t.element)var r=t,t=r.element,c=r.parent,m=r.stroke_style;var i=t.canvas;i.width=t.width,i.height=t.height,r||(r={});var p="undefined"==typeof r.render_stroke?!0:r.render_stroke,f="undefined"==typeof r.use_3d_effect?!1:r.use_3d_effect,o=r.margin||0,s=e.piece_logical_scale,a=e.piece_margin,n=i.getContext("2d");n.save(),y({x:a+o,y:a+o,scale:1/s,data:t.shape_string,strokeStyle:"rgba(63,63,63,1)",lineWidth:0,canvas:i}),n.clip(),t.dummy_canvas=document.createElement("canvas");var _=$(t.side_set,[-t.puzzle_left_min+a+o,-t.puzzle_top_min+a+o],1/s);if(t.path=new Path2D(_),c instanceof HTMLImageElement){var l=(u.composite_image.width-2*e.piece_margin/e.piece_logical_scale)*e.piece_logical_scale/u.base_image.naturalWidth,h=i.width*s/l,d=i.height*s/l;h>n.width&&(h=n.width),d>n.height&&(d=n.height),n.drawImage(c,t.puzzle_left_min/l,t.puzzle_top_min/l,h,d,0,0,i.width,i.height)}else n.drawImage(c,(t.puzzle_left_min+a)/s,(t.puzzle_top_min+a)/s,i.width,i.height,0,0,i.width,i.height);n.restore(),f&&(n.save(),n.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),g({canvas:i,draw_settings:x,stroke_width:x.stroke_width,cut_multiplier:x.cut_multiplier,shape_string:t.shape_string,scale:1/e.piece_logical_scale,clear_stroke:!p,game_instance:e}),n.restore()),p&&(n.save(),dt(i,m),n.restore())}function ot(t){O(t),t.canvas=document.createElement("canvas"),xt({element:t,parent:u.base_image,use_3d_effect:i.jigsaw_use_3d_effect,render_stroke:"undefined"!=typeof e.piece_margin_style}),D({logical_parent:t,canvas:t.canvas,invalidate:!0})}var _=X.content_div,E=X.mr_jigtato,i=X.global_settings,C=X.level_id;_.innerHTML="";var J=E.game_data.jigsaw,ui=E.game_data.trophy_list,P=E.player_data,it=E.game_data.entry_list[C],Q=E.set_name,Z=i.game_type,m={},x={},e=m.game_instance={},tt=J.difficulty_levels[P.selected_difficulty];e.difficulty_level=P.selected_difficulty,e.get_piece_count=function(){return e.tile_x*e.tile_y},e.intro_audio_count=0,!i.is_kiosk&&i.use_social_media_buttons&&K();var ft=["answer-correct-10865990.ogg","answer-correct-23303730.ogg","answer-correct-25513672.ogg","answer-correct-25513693.ogg","answer-correct-37240671.ogg","answer-correct-37240686.ogg","answer-correct-37241588.ogg","answer-correct-37241627.ogg"],ri=["global-pick up.ogg","global-put down.ogg","answer-give up.ogg","fireworks-1.ogg","fireworks-2.ogg","fireworks-3.ogg","fireworks-4.ogg"].concat(ft);q({parent:i,dir:i.audio_dir+"/",audio_list:ri,type:"is_sound_effect"}),i.ambient_music.last_on_state=i.ambient_music_on,i.ambient_music_on=!1,i.ambient_music.load_ambient_music(E.game_data.ambient_music,E.game_data.ambient_music_start),$t();var A=(performance.now(),m.screen_refresh=function(){e.do_screen_refresh=!0}),Bt=m.category_refresh=function(){e.do_screen_refresh=!0,e.do_category_refresh=!0};if(e.force_screen_refresh=0,hi(),void function(){var i,t={},n=void 0,r=void 0;Object.defineProperty(t,"scalemin",{value:1,enumerable:!1,writable:!0}),Object.defineProperty(t,"scalemax",{value:4,enumerable:!1,writable:!0}),Object.defineProperty(t,"scale",{enumerable:!0,get:function(){return i},set:function(e){i=e,A()}}),Object.defineProperty(t,"offset_x",{enumerable:!0,get:function(){return n},set:function(e){if("undefined"!=typeof d){if(e>0)e=0;else{var r=parseFloat(window.getComputedStyle(d).width),t=(1-i)*r;t>e&&(e=t)}e=Math.round(1e4*e)/1e4,n=e,A()}}}),Object.defineProperty(t,"offset_y",{enumerable:!0,get:function(){return r},set:function(e){if("undefined"!=typeof d){if(e>0)e=0;else{var n=parseFloat(window.getComputedStyle(d).height),t=(1-i)*n;t>e&&(e=t)}e=Math.round(1e4*e)/1e4,r=e,A()}}}),Object.defineProperty(e,"zoom",{enumerable:!0,get:function(){return t},set:function(e){t.scale=e.scale,t.offset_x=e.offset_x,t.offset_y=e.offset_y}})}(),_.style.overflow="hidden",a(_),m.menu_item_list=[E.menu.generic.about,E.menu.generic.ogle_trophies,{text:"Restart",action:function(n,e,t){var i=smoke.confirm('<span style="color: #cc0000; font-weight: bold">Warning:</span> this will reset the puzzle piece positions and generate new puzzle pieces. Continue?',function(i){return 0==i?void e():void t.init.current_game.help_menu_obj.close({callback:function(){Jt({callback:function(){d.inner.setTimeout(ni,1e3)}})}})});h(i)}},{text:"Back to Main Menu",action:function(n,r,e){{var t=e.init;t.current_game}e.close(),i.IS_WEBVIEW?window.history.back():t.mr_jigtato.history_control.load_page({page:"select_jigsaw"})}},{text:"Rearrange Jigsaw Pieces",action:function(){st(o.current_category.piece_container),U(),m.help_menu_obj.close()}},E.menu.jigsaw.toggle_categories,E.menu.jigsaw.open_misc_config_menu,E.menu.jigsaw.show_mini_hint_image,{text:"undefined"==typeof E.game_data.play_intro_audio_text?"Play Puzzle Intro Audio":E.game_data.play_intro_audio_text,action:function(i,t){e.intro_audio_count+=1,E.play_intro_audio({level_id:X.level_id,count:e.intro_audio_count,parent:d.inner}),t()}},E.menu.jigsaw.open_visual_settings_menu,E.menu.generic.open_audio_settings_menu],!i.is_kiosk&&i.use_social_media_buttons){var Tt=m.social_sharing_button_container=document.createElement("div");Tt.className="jt-play-social_sharing_button_container",_.appendChild(Tt),G({parent:Tt,button_class:"jt-social_button_small"})}var wt=m.trophy_ribbon=ti({parent:_}),p=m.game_title=document.createElement("div");p.className="jt-play-title",p.hidden_top_value="-155%",a(p);var V=m.bottom_bar=document.createElement("div");V.className="jt-play-bottom_bar jt-play-main_image_border_width",a(V),_.appendChild(p),p.hide_title=function(e){var e=e||{};"undefined"==typeof e.callback&&(e.callback=function(){}),"undefined"==typeof e.duration&&(e.duration=500),i.jigsaw_minimal_ui&&(e.duration=0),o.style.display="",0==e.duration?(p.inner.style.top=p.hidden_top_value,o.style.top=0,p.inner.style.display="none",e.callback()):(TweenMax.to(o,e.duration/1e3,{parseTransform:!0,ease:Linear.ease,css:{top:0}}),TweenMax.to(p.inner,e.duration/1e3,{parseTransform:!0,ease:Linear.ease,css:{top:p.hidden_top_value,display:"none"}}),d.inner.setTimeout(e.callback,e.duration))},p.show_title=function(e){var e=e||{};"undefined"==typeof e.callback&&(e.callback=function(){}),"undefined"==typeof e.duration&&(e.duration=500),i.jigsaw_minimal_ui&&(e.duration=0),p.inner.style.display="",0==e.duration?(o.style.top=p.hidden_top_value,p.inner.style.top=0,o.style.display="none",e.callback()):(TweenMax.to(p.inner,e.duration/1e3,{parseTransform:!0,ease:Linear.ease,css:{top:0}}),TweenMax.to(o,e.duration/1e3,{parseTransform:!0,ease:Linear.ease,css:{top:p.hidden_top_value,display:"none"}}),d.inner.setTimeout(e.callback,e.duration))},p.autoshow_title=function(e){p[i.use_categories?"hide_title":"show_title"](e)},p.show_title_animation=function(i){function r(){setTimeout(function(){_.appendChild(e)},0);var s=e.childNodes[0],r=new SplitText(s,{type:"chars, words"}).chars,u=Math.floor(r.length/2),a=new TimelineLite,o=function(){(null==t||null==t.parentNode)&&TweenLite.killTweensOf(n)},c=!0;if(c)for(var i=0;i<r.length;i++){for(var h=r[i].children,l=0;l<h.length;l++)h[l].style.opacity=0;a.from(r[i],1.8,{onUpdate:o,x:40*(i-u),opacity:0,ease:Power2.easeOut},.05*i*18/r.length)}return a.fromTo(s,3+1*c,{onUpdate:o,z:250,y:74,visibility:"visible"},{z:-200,ease:SlowMo.ease.config(.1,.9)},0),a.to(s,1.5,{onUpdate:o,rotationX:-720,autoAlpha:0,scale:.3,ease:Power2.easeInOut},"-=1.5"),a}"undefined"==typeof i.callback&&(i.callback=function(){});var e=p.inner.cloneNode(!0);e.className="jt-select_screen-title-center-inner",e.style.display="",e.style.top="",p.autoshow_title({duration:0});var n=new TimelineMax;n.eventCallback("onComplete",function(){e.parentNode&&(_.removeChild(e),i.callback())}),setTimeout(function(){n.add(r())},0),TweenLite.set(e,{perspective:700,visibility:"visible"})};var o=m.category_deck=document.createElement("div");o.className="jt-jigsaw-category_deck",o.item_under_mouse=null,p.appendChild(o),o.edit_button=document.createElement("img"),o.edit_button.className="jt-op_button jt-op_button-edit"+(i.is_phone_or_tablet?" hoverable jt-op_button-edit-colored":""),o.edit_button.src=i["/"]+"images/gui/gui-item_edit.png",o.appendChild(o.edit_button),o.add_button=document.createElement("img"),o.add_button.className="jt-op_button jt-op_button-add"+(i.is_phone_or_tablet?" hoverable jt-op_button-add-colored":""),o.add_button.src=i["/"]+"images/gui/gui-item_expand_or_add.png",o.appendChild(o.add_button),o.basket_button=document.createElement("img"),o.basket_button.className="jt-op_button jt-op_button-basket"+(i.is_phone_or_tablet?" hoverable jt-op_button-basket-colored":""),o.basket_button.piece_list=[],o.basket_button.is_selected=!1,o.basket_button.src=i["/"]+"images/gui/gui-basket.png",o.appendChild(o.basket_button),o.remove_button=document.createElement("img"),o.remove_button.className="jt-op_button jt-op_button-remove"+(i.is_phone_or_tablet?" hoverable jt-op_button-remove-colored":""),o.remove_button.src=i["/"]+"images/gui/gui-item_remove.png",o.appendChild(o.remove_button),o.container=document.createElement("div"),o.container.className="jt-jigsaw-category_deck-container",o.appendChild(o.container),o.add_category=function(s){var t=document.createElement("div");t.className="jt-jigsaw-category_deck-category jt-play-main_image_border_width jt-button_generic hoverable",o.container.appendChild(t),t.inner=document.createElement("div"),t.appendChild(t.inner),o.set_category_name(t,s);var n=t.piece_container=document.createElement("div");n.className="jt-jigsaw-piece_container",Mt(n);J.difficulty_levels[e.difficulty_level];n.piece_matrix=[];for(var r=0,l=e.area.length;l>r;r++){var c=e.area[r];n.piece_matrix[r]=[];for(var a=0;a<c.piece_row_max;a++)n.piece_matrix[r][a]=[]}return"undefined"==typeof o.current_category&&(o.select_category(t),o.original_category=t),t.addEventListener(i.events.POINT,function(e){o.select_category(e.currentTarget),U()}),t.is_category_deck_item=!0,t},o.set_category_name=function(e,t){var i=p.style.display;p.style.display="block",e.inner.innerHTML=t,e.style.padding=0,e.style.border="none",L(e.inner,{unit_type:"px",transform_scale:_.content_scale}),e.style.padding="",e.style.border="",p.style.display=i},o.remove_category=function(e){var t=e.piece_container,i=t.children;if(o.original_category&&e!=o.original_category){var n=o.original_category.piece_container;i.forEach(function(e){n.appendChild(e)})}else i.forEach(function(t){e.piece_container.removeChild(t)});t.parentNode&&t.parentNode.removeChild(t),o.original_category&&(e!=o.original_category?st(o.original_category.piece_container,i):delete o.original_category),1==o.container.children.length&&delete o.current_category,o.container.removeChild(e)},o.select_category=function(e){"undefined"!=typeof e&&(o.current_category=e,t.piece_container=e.piece_container,A(),o.refresh(),o.container.children.forEach(function(t){if(t==e)var i="add";else var i="remove";t.classList[i]("jt-button_generic-lit")}),t.piece_sprite_container.is_cached=!1)},o.refresh=function(){var i=M;if("undefined"!=typeof i)for(var n=0,a=i.length;a>n;n++){var r=i[n],e=r.sprite;if("undefined"!=typeof e&&null!=e)if(r.parentNode!=o.current_category.piece_container&&r.parentNode!=u){if("undefined"==typeof e.parent)continue;t.piece_sprite_container.removeChild(e)}else{if("undefined"!=typeof e.parent)continue;t.piece_sprite_container.addChild(e)}}},o.edit_button.addEventListener(i.events.POINT,function(){var e=o.current_category;k.stop(),smoke.prompt('Please enter a new name for category "'+e.inner.innerHTML+'".',function(t){return""===t?void smoke.alert("You can't set a blank name!",function(){k.resume()}):(k.resume(),void(t!==!1&&(o.set_category_name(e,t),U())))})}),o.add_button.addEventListener(i.events.POINT,Rt);var z=o.basket_button;z.addEventListener(i.events.POINT,function(n){var e=n.currentTarget,r=0==e.piece_list.length;e.classList[e.is_selected?"remove":"add"]("jt-op_button-basket"+(i.is_phone_or_tablet?"-colored":"")+"-selected"),e.is_selected&&!r&&Rt({error:function(){e.piece_list=[]},complete:function(){e.piece_list.forEach(function(t){e.remove_piece(t,{modify_array:!1})})},success:function(i){e.piece_list.forEach(function(e){i.piece_container.appendChild(e)}),e.piece_list.forEach(function(e){"undefined"!=typeof e.sprite.parent&&t.piece_sprite_container.removeChild(e.sprite)}),st(i.piece_container),e.piece_list=[],U()}}),e.is_selected=!e.is_selected}),z.toggle_piece=function(e,t){-1!=z.piece_list.indexOf(e)?z.remove_piece(e,t):z.add_piece(e,t)},z.remove_piece=function(t,e){"undefined"==typeof e&&(e={});var n="undefined"==typeof e.modify_array?!0:e.modify_array;if(n){var i=z.piece_list.indexOf(t);-1!=i&&z.piece_list.splice(i,1)}ot(t)},z.add_piece=function(e,t){"undefined"==typeof t&&(t={});var n="undefined"==typeof t.modify_array?!0:t.modify_array;O(e),e.canvas=document.createElement("canvas"),xt({element:e,parent:u.base_image,use_3d_effect:i.jigsaw_use_3d_effect,render_stroke:!0,stroke_style:"#e0b270"}),D({logical_parent:e,canvas:e.canvas,invalidate:!0}),n&&z.piece_list.push(e)},o.remove_button.addEventListener(i.events.POINT,function(){function t(t){k.resume(),0!=t&&(o.remove_category(e),o.select_category(o.original_category),U())}k.stop();var e=o.current_category;return e==o.original_category?void smoke.alert("You can't remove the initial category!",function(){k.resume()}):void(0==e.piece_container.children.length?t(!0):smoke.confirm('Are you sure you want to remove the category "'+e.inner.innerHTML+'"? Its pieces will be added to the first category.',t,{ok:"Proceed"}))});var k=m.timer_obj=at({parent:p});m.timer_obj.style.display=i.show_timer?"":"none",a(k),m.refresh_gui_display=function(){var e=m.trophy_ribbon;e.style.display=!i.jigsaw_minimal_ui&&i.show_trophy_ribbon?"":"none",i.jigsaw_minimal_ui?(d.style.borderWidth=0,p.classList.add("minimal_ui"),p.classList.add("jt-play-title-minimal_ui"),p.inner.classList.add("jt-play-title-inner-minimal_ui"),_.classList.add("jt-play-action_area-minimal_ui"),m.menu_button_obj.classList.add("jt-play-menu_button-minimal_ui"),m.timer_obj.classList.add("jt-play-timer-minimal_ui"),m.menu_button_obj.setAttribute("current_text","M"),_.appendChild(m.timer_obj),_.appendChild(m.menu_button_obj),_.appendChild(p),V.parentNode==_&&_.removeChild(V)):(d.style.borderWidth="",p.classList.remove("jt-play-title-minimal_ui"),p.inner.classList.remove("jt-play-title-inner-minimal_ui"),d.classList.remove("jt-play-action_area-minimal_ui"),m.menu_button_obj.classList.remove("jt-play-menu_button-minimal_ui"),m.timer_obj.classList.remove("jt-play-timer-minimal_ui"),_.insertBefore(p,d),_.insertBefore(V,d.nextSibling),p.insertBefore(m.timer_obj,p.childNodes[0]),p.appendChild(m.menu_button_obj)),Ot()};var St=m.help_menu_obj=F({gs:i,parent:_,current_game:m,menu_item_list:m.menu_item_list,column_size:3,show_hint_image_options:!0,init:X}),Xt=m.menu_button_obj=B({parent:p,target:St,current_game:m,menu_class:"jt-play-menu_button",back_button_page:"select_jigsaw",init:X});it.use_image_title?N({image_src:i.get_set_directory(Q)+"/puzzle/"+C+"-title.png",fix_ie_bug:!0,color:"#edd9a7",callback:function(e){p.inner=e,p.inner.className="jt-play-title-inner",p.inner.style.position="relative",p.inner.style.width=p.inner.width+"px",p.inner.style.height=p.inner.height+"px",p.inner.style.left=0,p.appendChild(p.inner)}}):(p.inner=document.createElement("div"),p.inner.className="jt-play-title-inner",p.appendChild(p.inner),p.inner.text=document.createElement("p"),p.inner.text.innerHTML=it.name,p.inner.appendChild(p.inner.text),L(p.inner.text,{unit_type:"px",transform_scale:_.content_scale}));var d=document.createElement("div");d.className="jt-play-action_area",d.style.overflow="hidden",_.appendChild(d),i.is_phone_or_tablet||d.addEventListener("mousedown",function(e){e.preventDefault()}),d.inner=document.createElement("div"),d.inner.style.position="absolute",d.inner.style.width="100%",d.inner.style.height="100%",d.inner.style.transformOrigin="0 0",d.appendChild(d.inner),e.zoom={scale:1,offset_x:0,offset_y:0};var ht=new PIXI.Stage,yt=new PIXI.DisplayObjectContainer,Nt=new PIXI.DisplayObjectContainer,t=_.draw_area=document.createElement("canvas");t.className="jt-draw_area",t.controls_locked=!1,i.is_webgl=function(){var e=document.createElement("canvas"),t=e.getContext("webgl");return null!=t?(i.canvas_context="webgl",!0):(i.canvas_context="2d",!1)}();var Zt=new PIXI[1==i.is_webgl?"WebGLRenderer":"CanvasRenderer"](1,1,{transparent:!0,clearBeforeRender:!1,view:t});t.renderer=Zt,t.stage=yt,t.piece_sprite_container=Nt,t.real_stage=ht,ht.addChild(yt),yt.addChild(Nt),t.load_opacity_transition=.5,t.style.pointerEvents="none",t.bg=document.createElement("canvas"),t.bg.image=new Image,t.bg.image.src=E.background_image_url,t.reposition_and_resize=function(){var n=I(_),r=l(_),e=_.content_scale,a=parseFloat(getComputedStyle(d).top),o=i.jigsaw_minimal_ui?0:l(V);t.style.left=Math.round((window.innerWidth-n*e)/2)+"px",t.style.top=Math.round((window.innerHeight-r*e)/2+a*e)+"px",t.style.width=n*e+"px",t.style.height=(r-a-o)*e+"px",t.fireworks&&t.fireworks.update_size();var s=window.getComputedStyle(d);t.cached_width=Math.round(parseFloat(s.width)),t.cached_height=Math.round(parseFloat(s.height))},t.reposition_and_resize(),void function(){switch(e.jigsaw_scale_low_power_sizer=e.difficulty_level>=i.jigsaw_reduce_texture_size?2:1,e.difficulty_level){case 0:x.cut_multiplier=1,e.piece_logical_scale=1*e.jigsaw_scale_low_power_sizer,x.shadow_white_opacity=.5,x.shadow_black_opacity=.8,x.border_scale=1,x.stroke_shadow_blur=16,e.zoom.scalemax=2;break;case 1:x.cut_multiplier=1.1,e.piece_logical_scale=.75*e.jigsaw_scale_low_power_sizer,x.shadow_white_opacity=.6,x.shadow_black_opacity=.8,x.border_scale=1,x.stroke_shadow_blur=15,e.zoom.scalemax=2.666;break;case 2:x.cut_multiplier=1.5,e.piece_logical_scale=.5*e.jigsaw_scale_low_power_sizer,x.shadow_white_opacity=.6,x.shadow_black_opacity=.8,x.border_scale=.8,x.stroke_shadow_blur=12,e.zoom.scalemax=4;break;case 3:x.cut_multiplier=1.75,e.piece_logical_scale=.5*e.jigsaw_scale_low_power_sizer,x.shadow_white_opacity=.7,x.shadow_black_opacity=.8,x.border_scale=.5,x.stroke_shadow_blur=8,e.zoom.scalemax=6}x.stroke_width=e.piece_logical_scale/e.jigsaw_scale_low_power_sizer}();var u=m.main_image=document.createElement("div");u.className="jt-play-main_image jt-jigsaw-main_image",a(u),Mt(u),u.classList.add("jt-jigsaw-main_image-active");var T=u.base_image=document.createElement("img"),v=document.createElement("div");v.className="jt-jigsaw-piece_deck";var j,M,r=null;T.crossOrigin="Anonymous",i.get_image(T,Q,C,"default"),T.addEventListener("load",function(){null!=d&&d.inner.setTimeout(Dt,30)});var f=new Image;f.src=i.get_set_directory(E.set_name)+"/gui/gui-loading.png",f.logical_parent=t,t.loading_animation=f,f.defer_start=function(e){d.inner.setTimeout(function(){f&&!f.game_initialized&&(f.start(),nt(void 0,!0))},e)},f.start=function(){1!=!!f.game_initialized&&(f.stage.alpha=1,f.display=!0,ht.addChild(f.stage),A())},f.stop=function(){f.stage&&(f.stage.alpha=1),f.game_initialized=!0,f.display&&(f.display=!1,ht.removeChild(f.stage)),A()},f.addEventListener("load",function(){if(null!=d&&d.isAttached()){var e=f.width/2,i=f.height,a=(t.width-e)/2,s=(t.height-i)/2;f.stage=new PIXI.DisplayObjectContainer;var n=document.createElement("canvas");n.width=e,n.height=i;var o=n.getContext("2d");o.drawImage(f,e,0,e,i,0,0,e,i),f.outer={},D({logical_parent:f.outer,parent:f.stage,canvas:n}),f.outer.sprite.x=a+e/2,f.outer.sprite.y=s+i/2,f.outer.sprite.width=e,f.outer.sprite.height=i,f.outer.sprite.pivot.x=e/2,f.outer.sprite.pivot.y=i/2;var r=document.createElement("canvas");r.width=e,r.height=i;var o=r.getContext("2d");o.drawImage(f,0,0),f.inner={},D({logical_parent:f.inner,parent:f.stage,canvas:r}),f.inner.sprite.x=a,f.inner.sprite.y=s,f.inner.sprite.width=e,f.inner.sprite.height=i,f.start(),nt(void 0,!0)}}),m.refresh_gui_display(),nt(void 0,!0);var gt=m.set_base_image_size=function(){var t=ai();T.width=t.width,T.height=t.height,2==i.jigsaw_arrange_pieces_on_entire_area&&T.naturalHeight<=T.naturalWidth&&(e.jigsaw_arrange_pieces_on_entire_area=!0),void function(){var n=Math.round(T.naturalWidth/T.naturalHeight*1e3)/1e3;switch(e.tile_x=tt.tile_x,e.tile_y=tt.tile_y,n){case.8:e.tile_x=e.tile_y,e.tile_y*=1.25;break;case 1:e.tile_x=e.tile_y;break;case 1.25:e.tile_x=1.25*e.tile_y;break;case 1.333:var t=e.tile_x;e.tile_x=e.tile_y,e.tile_y=t;break;case 1.364:var t=e.tile_x;e.tile_x=e.tile_y,e.tile_y=t;break;case 1.4:var t=e.tile_x;e.tile_x=e.tile_y,e.tile_y=t;break;case 1.433:var t=e.tile_x;e.tile_x=e.tile_y,e.tile_y=t;break;case 1.5:var t=e.tile_y;e.tile_x=e.tile_y,e.tile_y=.75*t}var i=e.tile_x*e.tile_y/tt.piece_column_max/2;e.area=[{top:0,height_ratio:1,piece_row_max:i,piece_column_max:tt.piece_column_max},{top:0,height_ratio:1,piece_row_max:i,piece_column_max:tt.piece_column_max}]}(),Ot(),u.left=(parseFloat(window.getComputedStyle(_).width)-T.width)/2,u.width=T.width,u.height=T.height;var n=u.composite_image;n.set_size()},Ct=m.size_pieces=function(e){e.forEach(function(e){e.calc_width=e.width_float*i.jigsaw_piece_scale_to_actual,e.calc_height=e.height_float*i.jigsaw_piece_scale_to_actual}),t.piece_sprite_container.is_cached=!1};_.cleanup=function(){if(i.IS_CORDOVA&&i.audio_container[E.last_intro_audio]&&(i.audio_container[E.last_intro_audio].src="",delete i.audio_container[E.last_intro_audio],E.last_intro_audio=""),t.fireworks&&t.fireworks.destroy(),ci(),null!=t.parentNode&&document.body.removeChild(t),k.destroy(),document.removeEventListener(i.events.POINT_MOVE,jt),i.is_phone_or_tablet?_.removeEventListener("touchend",H):(document.removeEventListener("mouseup",H),window.addEventListener("blur",pt),window.removeEventListener("mouseout",Ft)),_.innerHTML="","undefined"!=typeof i.ambient_music.last_on_state&&(1==i.ambient_music.last_on_state&&(i.ambient_music_on=!0),delete i.ambient_music.last_on_state),"undefined"!=typeof j)for(var n=0;n<e.tile_x+1;n++){j[n]=[];for(var a=0;a<e.tile_y+1;a++)j[n][a]=void 0}t.piece_container&&(t.piece_container.children.forEach(function(e){M.splice(M.indexOf(e),1);var t=e.piece_matrix;t&&delete t[e.area][e.row][e.column],e.piece_matrix=null,e.width=0,O(e),e=null}),t.piece_container.children=[],delete t.piece_container.piece_matrix,delete t.piece_container),O(u.base_image),O(t.bg),f.inner&&O(f.inner),f.outer&&O(f.outer),O(u.composite_image),t.stage.removeChild(t.piece_sprite_container),t.real_stage.removeChild(t.stage),t.real_stage.interactionManager.removeEvents(),t.renderer.destroy&&t.renderer.destroy(),u.composite_image&&(delete u.composite_image.set_size,delete u.composite_image),delete _.draw_area,delete f.logical_parent;for(var s in t)delete t[s];E=null,i=null,C=null,J=null,ui=null,P=null,it=null,Q=null,Z=null,m=null,x=null,e=null,tt=null,A=null,wt=null,p=null,o=null,z=null,k=null,St=null,Xt=null,d=null,t=null,u=null,T=null,v=null,r=null,j=null,M=null,f=null,gt=null,Ct=null,U=null,kt=null,delete _.cleanup},v.drag_active=!1,v.drag_start=function(e){v.drag_active=!0,v.touch_id=e.identifier,v.drag_update(e,!0)},v.drag_update=function(s,o){if(0!=v.drag_active){var t=c(s,d),i=t[0]/_.content_scale,n=t[1]/_.content_scale,l=e.zoom.scale,r=e.zoom.offset_x,a=e.zoom.offset_y;o||(r+=i-v.drag_initial_x,a+=n-v.drag_initial_y),e.zoom.offset_x=r,e.zoom.offset_y=a,v.drag_initial_x=i,v.drag_initial_y=n,v.drag_initial_scale=l}},v.drag_end=function(){v.touch_id=null,v.drag_active=!1};var ut=void 0,U=m.save_puzzle_state=function(){var t={};t.game_instance={jigsaw_initial_show_hint_image:e.jigsaw_initial_show_hint_image,jigsaw_show_hint_image:e.jigsaw_show_hint_image,jigsaw_show_hint_rect:e.jigsaw_show_hint_rect,jigsaw_arrange_pieces_on_entire_area:e.jigsaw_arrange_pieces_on_entire_area,action_area_height:parseFloat(window.getComputedStyle(d.inner).height),base_image_width_to_naturalWidth:T.width/T.naturalWidth},t.counter=m.timer_obj.counter,t.zoom=e.zoom,t.piece_list=[],M.forEach(function(e){var e=Pt(e);delete e.width,delete e.height,t.piece_list.push(e)}),t.category_deck={};var n=t.category_deck.container=[];o.container.childNodes.forEach(function(t){var e={};e.innerHTML=t.childNodes[0].innerHTML,n.push(e);var i=e.pieces=[];t.piece_container.children.forEach(function(e){i.push({piece_id:e.piece_id})})}),t.category_deck.current_category_name=o.current_category.childNodes[0].innerHTML;var i=JSON.parse(localStorage["puzzle_states.$keys"]);i[Z+"."+C+"."+P.selected_difficulty]=!0,localStorage["puzzle_states.$keys"]=JSON.stringify(i),localStorage["puzzle_states."+Z+"."+C+"."+P.selected_difficulty]=JSON.stringify(t)},kt=m.load_puzzle_state=function(s){function l(){var e={};M.forEach(function(t){e[t.piece_id]=t});var i=t.category_deck.current_category_name,n=t.category_deck.container;n.forEach(function(t){var n=o.add_category(t.innerHTML),r=t.pieces,a=n.piece_container;r.forEach(function(t){var i=e[t.piece_id];a.appendChild(i)}),t.innerHTML==i&&o.select_category(n),Ct(n.piece_container.children)}),Ht()&&lt(),s.callback()}var t=JSON.parse(localStorage["puzzle_states."+Z+"."+C+"."+P.selected_difficulty]);e.jigsaw_initial_show_hint_image=t.game_instance.jigsaw_initial_show_hint_image,e.jigsaw_show_hint_image=i.jigsaw_show_hint_image,e.jigsaw_show_hint_rect=i.jigsaw_show_hint_rect,e.jigsaw_arrange_pieces_on_entire_area=t.game_instance.jigsaw_arrange_pieces_on_entire_area;var a=t.game_instance.action_area_height,n=t.game_instance.base_image_width_to_naturalWidth;if("undefined"==typeof n&&(n=1),"undefined"!=typeof a)var c=parseFloat(window.getComputedStyle(d.inner).height)/a;m.timer_obj.counter=t.counter,gt();var h=T.width/T.naturalWidth/n;e.zoom=t.zoom,j=[];for(var r=0;r<e.tile_x;r++)j[r]=[];M=t.piece_list,m.redraw_main_image_and_pieces({piece_rescale:h,top_rescale:c,callback:l})};m.redraw_main_image_and_pieces=function(p){function S(){f.restore();var i=o.getContext("2d");i.save(),y({x:e.piece_margin,y:e.piece_margin,scale:1/e.piece_logical_scale,data:v,strokeStyle:"rgba(63,63,63,1)",lineWidth:0,canvas:o}),i.clip(),i.drawImage(h,-e.piece_margin/e.piece_logical_scale,-e.piece_margin/e.piece_logical_scale),i.restore(),i.save(),i.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),dt(o),i.restore(),D({parent:t.stage,canvas:o,position:1,is_2d:!0}),o.sprite.x=u.left-e.piece_margin,o.sprite.y=u.top-e.piece_margin,"undefined"!=typeof E&&E()}"undefined"==typeof p&&(p={});var a=p.piece_rescale,k=p.top_rescale||1,E=p.callback;e.pieces_in_position_count=0;for(var w=[],_=[],d=0;d<M.length;d++){var n=M[d];if("undefined"!=typeof a&&(n.width_float=Math.round(n.width_float*a*1e3/1e3),n.height_float=Math.round(n.height_float*a*1e3/1e3),n.puzzle_left_min=Math.round(n.puzzle_left_min*a*1e3/1e3),n.puzzle_top_min=Math.round(n.puzzle_top_min*a*1e3/1e3),n.width=Math.ceil(n.width_float/e.piece_logical_scale),n.height=Math.ceil(n.height_float/e.piece_logical_scale),n.puzzle_width.forEach(function(t,e){n.puzzle_width[e]=Math.round(n.puzzle_width[e]*a*1e3/1e3),n.puzzle_height[e]=Math.round(n.puzzle_height[e]*a*1e3/1e3),n.puzzle_left[e]=Math.round(n.puzzle_left[e]*a*1e3/1e3),n.puzzle_top[e]=Math.round(n.puzzle_top[e]*a*1e3/1e3)}),n.side_set=li(n.side_set,a)),n.width=Math.ceil((n.width_float+2*e.piece_margin)/e.piece_logical_scale),n.height=Math.ceil((n.height_float+2*e.piece_margin)/e.piece_logical_scale),n.placed){e.pieces_in_position_count+=n.x.length,n.shape_string=$(n.side_set,[-n.puzzle_left_min,-n.puzzle_top_min]),w.push(n);for(var l=0,b=n.x.length;b>l;l++)j[n.x[l]][n.y[l]]=n}else{if(_.push(n),M[d].canvas)var r=M[d];else var r=_t();r.x=s(n.x),r.y=s(n.y),r.zIndex=s(n.zIndex),r.piece_id=n.piece_id,r.width_float=n.width_float,r.height_float=n.height_float,r.width=n.width,r.height=n.height,r.virtual_left=n.virtual_left,r.virtual_top=n.virtual_top*k,r.puzzle_width=s(n.puzzle_width),r.puzzle_height=s(n.puzzle_height),r.puzzle_left_min=n.puzzle_left_min,r.puzzle_top_min=n.puzzle_top_min,r.puzzle_left=s(n.puzzle_left),r.puzzle_top=s(n.puzzle_top),r.side_set=s(n.side_set),r.placed=!1,M[d]=r;for(var l=0,b=r.x.length;b>l;l++)j[r.x[l]][r.y[l]]=r}}A();var R=rt(w,i.jigsaw_combine_pieces),m=[];_.forEach(function(e){e.side_set.forEach(function(e){m.push(e)})});{var v=$(R,[0,0]),P=v+" "+$(m,[0,0]),c=T,o=u.composite_image;c.naturalWidth/c.width}o.set_size();var h=document.createElement("canvas");h.width=o.width,h.height=o.height;var f=h.getContext("2d"),L=c.naturalWidth,C=c.naturalHeight;f.drawImage(c,0,0,L,C,e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale,c.width/e.piece_logical_scale,c.height/e.piece_logical_scale),f.save(),f.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),i.jigsaw_use_3d_effect&&g({canvas:h,draw_settings:x,stroke_width:x.stroke_width,cut_multiplier:x.cut_multiplier,shape_string:P,scale:1/e.piece_logical_scale,clear_stroke:"undefined"==typeof e.piece_margin_style,game_instance:e}),It({piece_grid:j,big_canvas:h,grid_is_new:!1,callback:S})}}function g(e){function t(t){{var i=t.game_instance,n=t.canvas,h=t.draw_settings,s=t.stroke_width/i.jigsaw_scale_low_power_sizer,p=t.cut_multiplier,d=t.shape_string,f=t.scale,c=t.outline_style||"transparent";t.clear_stroke}if(t.outline_width)var u=t.outline_width;else if(i.piece_margin_style&&0!=i.piece_margin)var u=i.piece_margin>=5?10:6;else var u=10;var u=8;u/=i.jigsaw_scale_low_power_sizer;var o=n.getContext("2d"),a=document.createElement("canvas");a.width=n.width,a.height=n.height;var e=a.getContext("2d");y({x:0,y:0,scale:f,data:d,strokeStyle:"rgba(255,255,255,1)",lineJoin:"round",lineCap:"round",lineWidth:2/i.jigsaw_scale_low_power_sizer,canvas:a}),e.shadowBlur=h.stroke_shadow_blur/i.jigsaw_scale_low_power_sizer,e.shadowColor="rgba(0,0,0,"+h.shadow_black_opacity+")",e.shadowOffsetX=3*-s,e.shadowOffsetY=3*-s,e.stroke(),e.shadowColor="rgba(255,255,255,"+h.shadow_white_opacity+")",e.shadowOffsetX=3*s,e.shadowOffsetY=3*s,e.stroke();var r=document.createElement("canvas");r.width=n.width,r.height=n.height;var l=r.getContext("2d");l.drawImage(a,0,0),l.drawImage(r,0,0),l.drawImage(r,0,0),l.drawImage(r,0,0),o.globalCompositeOperation="source-atop",o.drawImage(r,0,0),t.clear_stroke&&(e.clearRect(0,0,n.width,n.height),e.lineWidth=u*s*p*i.jigsaw_scale_low_power_sizer*.5,e.shadowBlur=0,"transparent"!=c&&(e.strokeStyle=c),e.shadowColor="rgba(0,0,0,0)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.stroke(),o.globalCompositeOperation="transparent"==c?"destination-out":"source-atop",o.drawImage(a,0,0)),o.globalCompositeOperation="source-over"}t(e)}function mt(i){function a(){var t=e.canvas;t.style.position="absolute",t.style.pointerEvents="none",t.style.zIndex=1e4,document.body.appendChild(t),s(),n()}function n(){"undefined"!=typeof e.proton&&(e.requestAnimationFrameID=requestAnimationFrame(n),e.proton.update())}function s(){var i=e.canvas,n=e.proton=new Proton,t=e.emitter=new Proton.Emitter;t.rate=new Proton.Rate(new Proton.Span(2,2),1),t.addInitialize(new Proton.Mass(1)),t.addInitialize(new Proton.Radius(1,2)),t.addInitialize(new Proton.P(new Proton.LineZone(10,i.height,i.width,i.height))),t.addInitialize(new Proton.Life(.8,1.75)),t.addInitialize(new Proton.V(new Proton.Span(.8,1.65),new Proton.Span(0,0,!0),"polar")),t.addBehavior(new Proton.Gravity(.1)),t.addBehavior(new Proton.Color("#ff0000","random")),t.emit(),n.addEmitter(t);var a=e.renderer=new Proton.Renderer("canvas",n,i);a.onProtonUpdate=function(){var n=e.canvas.getContext("2d"),t=e.canvas_temp.getContext("2d");e.canvas_temp.width=e.canvas_temp.width,t.globalAlpha=.9,t.drawImage(e.canvas,0,0,i.width,i.height),e.canvas.width=e.canvas.width,n.drawImage(e.canvas_temp,0,0,i.width,i.height)},a.start(),t.addEventListener(Proton.PARTICLE_DEAD,function(e){var t=Math.randInt(1,4);r.playAudio(r.audio_dir+"/fireworks-"+t+".ogg",{audio_type:"sound_effect",blocking:!1}),Math.random()<.7?o(e.particle):l(e.particle)})}function o(i){var n=e.proton,t=new Proton.Emitter;t.rate=new Proton.Rate(new Proton.Span(62,75),1),t.addInitialize(new Proton.Mass(1)),t.addInitialize(new Proton.Radius(1,2)),t.addInitialize(new Proton.Life(.9,2.5)),t.addInitialize(new Proton.V(new Proton.Span(.4,.8),new Proton.Span(0,360),"polar")),t.addBehavior(new Proton.RandomDrift(1,1,.005)),t.addBehavior(new Proton.Alpha(1,0)),t.addBehavior(new Proton.Gravity(.3));var r=Math.random()>.3?Proton.MathUtils.randomColor():"random";t.addBehavior(new Proton.Color(r)),t.p.x=i.p.x,t.p.y=i.p.y,t.emit("once",!0),n.addEmitter(t)}function l(i){var n=e.proton,t=new Proton.Emitter;t.rate=new Proton.Rate(new Proton.Span(50,60),1),t.addInitialize(new Proton.Mass(1)),t.addInitialize(new Proton.Radius(4,8)),t.addInitialize(new Proton.Life(1,2)),t.addInitialize(new Proton.V([.2,.4],new Proton.Span(0,360),"polar")),t.addBehavior(new Proton.Alpha(1,0)),t.addBehavior(new Proton.Scale(1,.1)),t.addBehavior(new Proton.Gravity(.09));var r=Proton.MathUtils.randomColor();t.addBehavior(new Proton.Color(r)),t.p.x=i.p.x,t.p.y=i.p.y,t.emit("once",!0),n.addEmitter(t)}var r=i.gs,t=i.draw_area,e=this;return e.destroy=function(){null!=e.canvas.parentNode&&e.canvas.parentNode.removeChild(e.canvas),e.proton.destroy(),cancelAnimationFrame(e.requestAnimationFrameID)},e.update_size=function(){if("undefined"==typeof e.canvas||e.canvas.width_full!=t.width||e.canvas.height_full!=t.height){"undefined"!=typeof e.canvas&&e.destroy();var i=e.canvas=document.createElement("canvas");i.width_full=t.width,i.height_full=t.height,i.width=t.width/5,i.height=t.height/5;var n=e.canvas_temp=document.createElement("canvas");n.width=t.width/5,n.height=t.height/5,a()}var i=e.canvas;i.style.width=t.style.width,i.style.height=t.style.height,i.style.left=t.style.left,i.style.top=t.style.top},e.update_size(),this}function gt(i){function s(){e.is_active||(e.title_index=(e.title_index+1)%e.title_list.length,e.innerHTML=e.title_list[e.title_index]),e.setTimeout(s,4e3)}var r=i.select_screen,a=(i.content_div,i.mr_jigtato),t=i.gs,o=r.header,e=document.createElement("div");return e.className="jt-select_screen-header-show_hint_image jt-select_screen-header-size-2 jt-button hoverable",e.title_list=["Tell a friend!","Earn extra puzzle packs!","Get 10 gems per friend!"],e.title_index=e.title_list.length-1,s(),e.addEventListener(t.events.POINT,function(){e.toggle()}),e.toggle=function(){e.is_active?e.deactivate():e.activate()},e.activate=function(){u({gs:t,error:function(){smoke.alert("You must log in to Google Play to use this feature!")},success:function(){e.is_active=!0,o.querySelectorAll(".jt-button").forEach(function(t){t!=e&&t!=r.difficulty_level_button&&(t.style.display="none")}),e.classList.remove("jt-select_screen-header-size-2"),e.classList.add("jt-select_screen-header-size-4"),e.innerHTMLoriginal=e.innerHTML,e.innerHTML="Pick a puzzle to create the challenge with!",t.log_user_action("Tell a friend: initialized.")}})},e.deactivate=function(){e.is_active=!1,o.querySelectorAll(".jt-button").forEach(function(t){t!=e&&t!=r.difficulty_level_button&&(t.style.display="")}),e.classList.add("jt-select_screen-header-size-2"),e.classList.remove("jt-select_screen-header-size-4"),e.innerHTML=e.innerHTMLoriginal},e.select_puzzle=function(v){function _(){function a(a){return t.log_user_action("Tell-a-friend: email entered: "+a),a===!1?void e.deactivate():void u({gs:t,error:function(){e.deactivate(),smoke.alert("You must log in to Google Play to use this feature!")},success:function(){n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(t.DEBUG?"-beta":"")+".php?action=social_challenge_a_friend&user_id="+t.account.user_id+"&internal_access_token="+t.account.internal_access_token+"&puzzle_name="+i+"&selected_difficulty="+r+"&best_time="+l+"&email_address_list="+a,error:function(i){t.errormessage(i,e.deactivate)},request_method:"POST",async:!0,success:function(){e.deactivate();var t=smoke.alert("Your challenge has been sent! If your friend downloads the game and enter your unique code for the first time (specified in the email), they will receive access to the puzzle you shared, and both of you will receive 9 gems each!");t.dialog.text.style.textAlign="left",t.dialog.text.style.textIndent="1em",t.dialog.buttons.ok.innerHTML="Excellent!"}})}})}if(t.log_user_action("Tell-a-friend: email prompt screen."),window.plugins&&window.plugins.ContactPickerPlugin)return void window.plugins.ContactPickerPlugin.pickContact({error:function(i){t.errormessage(i),e.deactivate()},success:function(t){return"object"!=typeof t||"string"!=typeof t.email?void e.deactivate():void setTimeout(function(){a(t.email)},0)}});smoke.prompt("Type in your friend's email(s) to send them your challenge!",a,{ok:"Send!"})}var i=v.level_id,h=a.player_data,r=h.selected_difficulty,s=t.jigsaw_show_hint_image,o=h.jigsaw.best_times[+s];if("undefined"==typeof o[i]){s=!s;var o=h.jigsaw.best_times[+s]}if("undefined"==typeof o[i])return void smoke.alert("You didn't finish this puzzle!");if("undefined"==typeof o[i][r]){var r=0;for(var p in o[i])p>r&&(r=p)}var f=a.game_data.jigsaw.difficulty_levels[r].name.capitalize(),l=o[i][r],d=(l-l%60)/60,m=l%60,g=(d>0?d+" minutes, ":"")+m+" seconds",y=a.game_data.entry_list[i].name,c=smoke.alert('Your best time on "'+y.capitalize().replace(/_/g," ")+'" in '+f+" mode is "+g+", with the hint image "+(1==s?"ON":"OFF")+".",_);c.dialog.text.style.textAlign="left",c.dialog.text.style.textIndent="1em",c.dialog.buttons.ok.innerHTML="Continue..."},e}function v(e){function i(){t.challenge_code_request_asked=!0;var i=smoke.confirm('If you received a CHALLENGE CODE from a friend, enter one to gain 10 "gems".'+e.extra_text,function(n){if(n===!1)return void e.callback();var i=smoke.prompt("",function(i){M({gs:t,challenge_code:i,error:function(){v(e)},success:e.callback})});i.dialog.text.parentNode.removeChild(i.dialog.text)}),n=(i.dialog,i.dialog.text);n.style.textAlign="left",n.style.textIndent="1em",i.buttons.ok.innerHTML="Enter It",i.buttons.cancel.innerHTML="No Challenge Code",a(i.buttons)}var t=e.gs;"undefined"==typeof e.callback&&(e.callback=function(){}),"undefined"==typeof e.extra_text&&(e.extra_text=""),u({gs:t,error:e.callback,success:function(){if("undefined"!=typeof t.android.INSTALL_REFERRER||"undefined"!=typeof t.account.email_address){var n="";"undefined"!=typeof t.android.INSTALL_REFERRER&&(n=function(){var e="";return t.android.INSTALL_REFERRER.split(";").findIndex(function(i){var t=i.split("=");if(1!=t.length&&"S.referrer"==t[0]){var t=decodeURIComponent(t[1]).split("=");if(1!=t.length)return e=t[1],!0}}),e}());var n=t.android.INSTALL_REFERRER;M({gs:t,challenge_code:n,error:i,success:e.callback})}else i()}})}function M(e){var t=e.gs,i="undefined"!=typeof e.challenge_code?e.challenge_code:"",r=(e.error,function(i){if(t.challenge_code_processed=!0,"undefined"==typeof i||"undefined"==typeof i.gem_amount)return void e.success();smoke.alert("CHALLENGE code provided by your friend, "+i.challenger_name+", "+auto_accept+'accepted. You have received 10 gems and access to the "'+i.puzzle_name.capitalize()+'" puzzle!',e.success),"undefined"!=typeof i.gem_amount&&(t.account.gem_amount=i.gem_amount)});n({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(t.DEBUG?"-beta":"")+".php?action=social_accept_challenge&challenge_code="+i+"&accepter_user_id="+t.account.user_id+"&internal_access_token="+t.account.internal_access_token,error:function(n){return""==i?void r():void t.errormessage(n,e.error)},request_method:"POST",async:!0,success:r})}var A="safari",P="com.flyingsoft.safari.jigsaw",o=!0,f=!0;!function(s,n){var i,a,t,e,r;s.Kiip||(e={version:"1.0g",request:n,busy:!1,requestQueue:[{events:[{id:"session_start",start:(new Date).toISOString()}]}],currentUnit:n,unitQueue:[],localWebIDKey:"kpwd",userData:null,app_key:null,frameTimeout:5e3,postData:function(e){return this.busy||!this.device_id?void this.requestQueue.push(e):(this.busy=!0,e=new t.Options(e),this.request||(window.XDomainRequest?(this.request=new window.XDomainRequest,this.request.onload=this._handleXDomainLoad,this.request.onerror=this._handleFailure,this.request.ontimeout=this._handleFailure):(this.request=new window.XMLHttpRequest,this.request.onreadystatechange=this._handleReadyStateChange)),this.request.open("POST",t.getOrigin()+t.API+"r="+t.now(),!0),this.request.setRequestHeader&&(this.request.setRequestHeader("Accept","application/json"),this.request.setRequestHeader("Content-Type","application/json"),this.request.setRequestHeader("X-Requested-With","XMLHttpRequest")),this.request._type=e.moment_id?"moment":"analytics",void this.request.send(JSON.stringify(e)))},_handleXDomainLoad:function(){e._handleSuccess(),e.busy=!1,e.nextMoment()},_handleReadyStateChange:function(){e.readyStateChange()},readyStateChange:function(){4===this.request.readyState&&("moment"===this.request._type&&(this.request.status>=200&&this.request.status<300||0===this.request.status?this._handleSuccess():this._handleFailure()),this.busy=!1,this.request._type=n,this.nextMoment())},_handleFailure:function(){e.instance.callback(null)},_handleSuccess:function(){var e;try{e=JSON.parse(this.request.responseText)}catch(t){e=null}e&&e.view?this.createUnit(e.view.modal):this._handleFailure()},_handleMessages:function(t){var n,i;n=t&&t.data?t.data:"",i=n.split("|"),e.parseFrameCommand(i[0],i[1])},_handleDeviceIDFail:function(){e.parseFrameCommand("webid","blocked;web-noid")},_handleUnitFail:function(){e.parseFrameCommand("destroy"),e.instance.callback(null)},parseFrameCommand:function(t,i){var e=this.currentUnit;clearTimeout(this._iframeTimeout),"webid"===t&&(this.busy=!1,this.validateWebID(i),this.nextMoment()),"ready"===t&&e&&this.instance.callback(e),"destroy"===t&&e&&e.destroy(),e=n},validateWebID:function(e){e&&e.match(/^blocked;/)&&(e=e.split(";")[1],e=this.getLocalWebID(e)),this.device_id=e,this.webIDFrame.parentNode.removeChild(this.webIDFrame),this.webIDFrame=n},getLocalWebID:function(i){var e,t=window.localStorage&&window.localStorage.getItem?window.localStorage:null;if(t&&(e=t.getItem(this.localWebIDKey)),e||(e=this.getCookie(this.localWebIDKey)),e||(e=i),t)try{t.setItem(this.localWebIDKey,e)}catch(n){}return this.setCookie(this.localWebIDKey,e,1/0,"/",window.location.hostname,!1),e},createUnit:function(e){return this.currentUnit?void this.unitQueue.push(e):void(this.currentUnit=new a(e.body_url))},nextUnit:function(){var e=this.unitQueue.shift();this.currentUnit=n,e&&this.createUnit(e)},nextMoment:function(){this.requestQueue.length&&!this.busy&&setTimeout(function(){this.postData(this.requestQueue.shift())}.bind(this),0)},getDeviceID:function(){var i;if(!(this.busy||this.device_id||t.isBadIE)){if(!window.document.body)return void window.document.addEventListener("DOMContentLoaded",this.getDeviceID.bind(this),!1);window.addEventListener("message",e._handleMessages,!1),this.busy=!0,i=t.getOrigin()+"/webid/",i+="?"+encodeURIComponent(t.protocol+"://"+window.location.hostname+(window.location.port?":"+window.location.port:"")),this.webIDFrame=document.createElement("iframe"),this.webIDFrame.setAttribute("frameborder","0"),this.webIDFrame.setAttribute("src",i),this.webIDFrame.style.position="absolute",this.webIDFrame.style.width=0,this.webIDFrame.style.height=0,document.body.appendChild(this.webIDFrame),this._iframeTimeout=setTimeout(this._handleDeviceIDFail,this.frameTimeout)}},getCookie:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setCookie:function(i,a,e,n,r,s){if(!i||/^(?:expires|max\-age|path|domain|secure)$/i.test(i))return!1;var t="";if(e)switch(e.constructor){case Number:t=1/0===e?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+e;break;case String:t="; expires="+e;break;case Date:t="; expires="+e.toUTCString()}return document.cookie=encodeURIComponent(i)+"="+encodeURIComponent(a)+t+(r?"; domain="+r:"")+(n?"; path="+n:"")+(s?"; secure":""),!0}},t={isBadIE:!window.document.addEventListener,protocol:"file:"===window.location.protocol?"http":window.location.protocol.replace(":",""),origin:"://api.kiip.me",getOrigin:function(){return this.protocol+this.origin},API:"/2.0/web/moment/?",Options:function(n){var i={};return e.testMode&&(i.test=!0),e.web_user_id&&(i.web_user_id=e.web_user_id),"[object Object]"===t.typeOf(n)&&t.merge(i,n),i.app_key=e.app_key,i.user_data=e.userData,i.protocol=t.protocol,i.sdk_version="1.0",i.device_id=e.device_id,i},toQueryString:function(i){var e,n,t,r=[];for(t in i)e=i[t],n=t+"="+encodeURIComponent(e),e&&r.push(n);return r.join("&")},merge:function(n,i){var e;for(e in i)"[object Function]"!==t.typeOf(i[e])&&i[e]&&(n[e]=i[e]);return n},now:function(){return+new Date},typeOf:function(e){return Object.prototype.toString.call(e)},uniqueID:function(){return r||(r=t.now()),(r++).toString(36)}},i=function(i,n){if(e.instance&&i===e.app_key)return e.instance;if(e.instance)throw new Error("Kiip Error: Only one Kiip instance is allowed per page");if(!i)throw new Error("Kiip Error: You must supply an app key");(!window.JSON||t.isBadIE)&&(e.disabled=!0),e.app_key=i,"[object Function]"===t.typeOf(n)&&(this.callback=n),e.instance=this},i.prototype.setEmail=function(t){return e.email=t,this},i.prototype.setUserId=function(i){return("[object String]"===t.typeOf(i)||"[object Number]"===t.typeOf(i))&&(e.web_user_id=i+""),this},i.prototype.setContainer=function(i){return e.container="[object String]"===t.typeOf(i)?document.getElementById(i):i,this},i.prototype.setUserData=function(i){return"[object Object]"!==t.typeOf(i)?this:(e.userData||(e.userData={}),t.merge(e.userData,i),this)},i.prototype.setTestMode=function(){return e.testMode=!0,this},i.prototype.postMoment=function(t){return!t||e.disabled?(this.callback(null),this):(e.postData({moment_id:t}),this)},i.prototype.callback=function(e){e&&e.show&&e.show()},i.prototype.unload=function(){return e.email=n,e.container=n,e.currentUnit&&e.currentUnit.destroy(),e.request&&e.request.abort(),window.removeEventListener?window.removeEventListener("message",e._handleMessages,!1):window.detachEvent("onmessage",e._handleMessages),e.instance=null,n},i.version=e.version,a=function(n){var i,a,r;this.id=t.uniqueID(),n+="&domain="+encodeURIComponent(t.protocol+"://"+window.location.hostname+(window.location.port?":"+window.location.port:"")),n+="&frame_id="+this.id,n+="&overlay="+(e.container?"false":"true"),i=document.createElement("iframe"),i.setAttribute("frameborder","0"),i.setAttribute("src",n),i.style.zIndex="2147483647",i.style.width="100%",i.style.height="100%",i.style.minWidth="320px",i.style.minHeight="330px",e.container?(i.style.position="relative",e.container.appendChild(i)):(i.style.position="fixed",i.style.top="-999999px",i.style.left="-999999px",document.body.appendChild(i)),this.setID=function(e){return i.id=e,this},this.show=function(n){return r?this:(r=!0,i.style.top="0px",i.style.left="0px","[object Function]"===t.typeOf(n)&&(a=n),i.contentWindow.postMessage("show",t.getOrigin()),e.email&&i.contentWindow.postMessage("email="+e.email,t.getOrigin()),this)},this.destroy=function(){return r?(r=!1,i.parentNode.removeChild(i),a&&a(),e.nextUnit(),this):this},e._iframeTimeout=setTimeout(e._handleUnitFail,e.frameTimeout)},e.getDeviceID(),window.Kiip=i)}(window);var t={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var a,n,r,c,h,o,s,l="",i=0;for(e=t.compress(e);i<2*e.length;)i%2==0?(a=e.charCodeAt(i/2)>>8,n=255&e.charCodeAt(i/2),r=i/2+1<e.length?e.charCodeAt(i/2+1)>>8:0/0):(a=255&e.charCodeAt((i-1)/2),(i+1)/2<e.length?(n=e.charCodeAt((i+1)/2)>>8,r=255&e.charCodeAt((i+1)/2)):n=r=0/0),i+=3,c=a>>2,h=(3&a)<<4|n>>4,o=(15&n)<<2|r>>6,s=63&r,isNaN(n)?o=s=64:isNaN(r)&&(s=64),l=l+t._keyStr.charAt(c)+t._keyStr.charAt(h)+t._keyStr.charAt(o)+t._keyStr.charAt(s);return l},decompressFromBase64:function(e){if(null==e)return"";var i,o,l,c,p,u,r,a,s="",d=0,n=0,h=t._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");n<e.length;)p=t._keyStr.indexOf(e.charAt(n++)),u=t._keyStr.indexOf(e.charAt(n++)),r=t._keyStr.indexOf(e.charAt(n++)),a=t._keyStr.indexOf(e.charAt(n++)),o=p<<2|u>>4,l=(15&u)<<4|r>>2,c=(3&r)<<6|a,d%2==0?(i=o<<8,64!=r&&(s+=h(i|l)),64!=a&&(i=c<<8)):(s+=h(i|o),64!=r&&(i=l<<8),64!=a&&(s+=h(i|c))),d+=3;return t.decompress(s)},compressToUTF16:function(a){if(null==a)return"";var s,e,i,n="",o=0,r=t._f;for(a=t.compress(a),s=0;s<a.length;s++)switch(e=a.charCodeAt(s),o++){case 0:n+=r((e>>1)+32),i=(1&e)<<14;break;case 1:n+=r(i+(e>>2)+32),i=(3&e)<<13;break;case 2:n+=r(i+(e>>3)+32),i=(7&e)<<12;break;case 3:n+=r(i+(e>>4)+32),i=(15&e)<<11;break;case 4:n+=r(i+(e>>5)+32),i=(31&e)<<10;break;case 5:n+=r(i+(e>>6)+32),i=(63&e)<<9;break;case 6:n+=r(i+(e>>7)+32),i=(127&e)<<8;break;case 7:n+=r(i+(e>>8)+32),i=(255&e)<<7;break;case 8:n+=r(i+(e>>9)+32),i=(511&e)<<6;break;case 9:n+=r(i+(e>>10)+32),i=(1023&e)<<5;break;case 10:n+=r(i+(e>>11)+32),i=(2047&e)<<4;break;case 11:n+=r(i+(e>>12)+32),i=(4095&e)<<3;break;case 12:n+=r(i+(e>>13)+32),i=(8191&e)<<2;break;case 13:n+=r(i+(e>>14)+32),i=(16383&e)<<1;break;case 14:n+=r(i+(e>>15)+32,(32767&e)+32),o=0}return n+r(i+32)},decompressFromUTF16:function(a){if(null==a)return"";for(var i,e,n="",o=0,s=0,r=t._f;s<a.length;){switch(e=a.charCodeAt(s)-32,o++){case 0:i=e<<1;break;case 1:n+=r(i|e>>14),i=(16383&e)<<2;break;case 2:n+=r(i|e>>13),i=(8191&e)<<3;break;case 3:n+=r(i|e>>12),i=(4095&e)<<4;break;case 4:n+=r(i|e>>11),i=(2047&e)<<5;break;case 5:n+=r(i|e>>10),i=(1023&e)<<6;break;case 6:n+=r(i|e>>9),i=(511&e)<<7;break;case 7:n+=r(i|e>>8),i=(255&e)<<8;break;case 8:n+=r(i|e>>7),i=(127&e)<<9;break;case 9:n+=r(i|e>>6),i=(63&e)<<10;break;case 10:n+=r(i|e>>5),i=(31&e)<<11;break;case 11:n+=r(i|e>>4),i=(15&e)<<12;break;case 12:n+=r(i|e>>3),i=(7&e)<<13;break;case 13:n+=r(i|e>>2),i=(3&e)<<14;break;case 14:n+=r(i|e>>1),i=(1&e)<<15;break;case 15:n+=r(i|e),o=0}s++}return t.decompress(n)},compress:function(_){if(null==_)return"";var n,r,f,u={},d={},h="",p="",a="",l=2,m=3,s=2,o="",e=0,i=0,c=t._f;for(f=0;f<_.length;f+=1)if(h=_.charAt(f),Object.prototype.hasOwnProperty.call(u,h)||(u[h]=m++,d[h]=!0),p=a+h,Object.prototype.hasOwnProperty.call(u,p))a=p;else{if(Object.prototype.hasOwnProperty.call(d,a)){if(a.charCodeAt(0)<256){for(n=0;s>n;n++)e<<=1,15==i?(i=0,o+=c(e),e=0):i++;for(r=a.charCodeAt(0),n=0;8>n;n++)e=e<<1|1&r,15==i?(i=0,o+=c(e),e=0):i++,r>>=1}else{for(r=1,n=0;s>n;n++)e=e<<1|r,15==i?(i=0,o+=c(e),e=0):i++,r=0;for(r=a.charCodeAt(0),n=0;16>n;n++)e=e<<1|1&r,15==i?(i=0,o+=c(e),e=0):i++,r>>=1}l--,0==l&&(l=Math.pow(2,s),s++),delete d[a]}else for(r=u[a],n=0;s>n;n++)e=e<<1|1&r,15==i?(i=0,o+=c(e),e=0):i++,r>>=1;l--,0==l&&(l=Math.pow(2,s),s++),u[p]=m++,a=String(h)}if(""!==a){if(Object.prototype.hasOwnProperty.call(d,a)){if(a.charCodeAt(0)<256){for(n=0;s>n;n++)e<<=1,15==i?(i=0,o+=c(e),e=0):i++;for(r=a.charCodeAt(0),n=0;8>n;n++)e=e<<1|1&r,15==i?(i=0,o+=c(e),e=0):i++,r>>=1}else{for(r=1,n=0;s>n;n++)e=e<<1|r,15==i?(i=0,o+=c(e),e=0):i++,r=0;for(r=a.charCodeAt(0),n=0;16>n;n++)e=e<<1|1&r,15==i?(i=0,o+=c(e),e=0):i++,r>>=1}l--,0==l&&(l=Math.pow(2,s),s++),delete d[a]}else for(r=u[a],n=0;s>n;n++)e=e<<1|1&r,15==i?(i=0,o+=c(e),e=0):i++,r>>=1;l--,0==l&&(l=Math.pow(2,s),s++)}for(r=2,n=0;s>n;n++)e=e<<1|1&r,15==i?(i=0,o+=c(e),e=0):i++,r>>=1;for(;;){if(e<<=1,15==i){o+=c(e);break}i++}return o},decompress:function(_){if(null==_)return"";if(""==_)return null;var g,d,h,n,a,r,i,s,o=[],l=4,c=4,p=3,u="",m="",f=t._f,e={string:_,val:_.charCodeAt(0),position:32768,index:1};for(d=0;3>d;d+=1)o[d]=d;for(n=0,r=Math.pow(2,2),i=1;i!=r;)a=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),n|=(a>0?1:0)*i,i<<=1;switch(g=n){case 0:for(n=0,r=Math.pow(2,8),i=1;i!=r;)a=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),n|=(a>0?1:0)*i,i<<=1;s=f(n);break;case 1:for(n=0,r=Math.pow(2,16),i=1;i!=r;)a=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),n|=(a>0?1:0)*i,i<<=1;s=f(n);break;case 2:return""}for(o[3]=s,h=m=s;;){if(e.index>e.string.length)return"";for(n=0,r=Math.pow(2,p),i=1;i!=r;)a=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),n|=(a>0?1:0)*i,i<<=1;switch(s=n){case 0:for(n=0,r=Math.pow(2,8),i=1;i!=r;)a=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),n|=(a>0?1:0)*i,i<<=1;o[c++]=f(n),s=c-1,l--;break;case 1:for(n=0,r=Math.pow(2,16),i=1;i!=r;)a=e.val&e.position,e.position>>=1,0==e.position&&(e.position=32768,e.val=e.string.charCodeAt(e.index++)),n|=(a>0?1:0)*i,i<<=1;o[c++]=f(n),s=c-1,l--;break;case 2:return m}if(0==l&&(l=Math.pow(2,p),p++),o[s])u=o[s];else{if(s!==c)return null;u=h+h.charAt(0)}m+=u,o[c++]=h+u.charAt(0),l--,h=u,0==l&&(l=Math.pow(2,p),p++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=t),!function(r,a,i,e,u,g,s,o,l){function y(a){var l,s=a.length,i=this,n=0,o=i.i=i.j=0,r=i.S=[];for(s||(a=[s++]);e>n;)r[n]=n++;for(n=0;e>n;n++)r[n]=r[o=t&o+a[n%s]+(l=r[n])],r[o]=l;(i.g=function(l){for(var s,o=0,r=i.i,a=i.j,n=i.S;l--;)s=n[r=t&r+1],o=o*e+n[t&(n[r]=n[a=t&a+s])+(n[a]=s)];return i.i=r,i.j=a,o})(e)}function h(e,i){var n,t=[],r=typeof e;if(i&&"object"==r)for(n in e)try{t.push(h(e[n],i-1))}catch(a){}return t.length?t:"string"==r?e:e+"\x00"}function c(a,i){for(var s,r=a+"",e=0;e<r.length;)i[t&e]=t&(s^=19*i[t&e])+r.charCodeAt(e++);return n(i)}function _(t){try{return r.crypto.getRandomValues(t=new Uint8Array(e)),n(t)}catch(i){return[+new Date,r,(t=r.navigator)&&t.plugins,r.screen,n(a)]}}function n(e){return String.fromCharCode.apply(0,e)}var f=i.pow(e,u),d=i.pow(2,g),m=2*d,t=e-1,p=i["seed"+l]=function(r,t,p){var o=[];t=1==t?{entropy:!0}:t||{};var g=c(h(t.entropy?[r,n(a)]:null==r?_():r,3),o),s=new y(o);return c(n(s.S),a),(t.pass||p||function(e,t,n){return n?(i[l]=e,t):e})(function(){for(var t=s.g(u),n=f,i=0;d>t;)t=(t+i)*e,n*=e,i=s.g(1);for(;t>=m;)t/=2,n/=2,i>>>=1;return(t+i)/n},g,"global"in t?t.global:this==i)};c(i[l](),a),s&&s.exports?s.exports=p:o&&o.amd&&o(function(){return p})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random"),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozancelAnimationFrame||window.webkitCancelAnimationFrame,!function(){var i=this,e=e||{};e.WEBGL_RENDERER=0,e.CANVAS_RENDERER=1,e.VERSION="v1.6.1",e.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},e.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},e._UID=0,"undefined"!=typeof Float32Array?(e.Float32Array=Float32Array,e.Uint16Array=Uint16Array):(e.Float32Array=Array,e.Uint16Array=Array),e.INTERACTION_FREQUENCY=30,e.AUTO_PREVENT_DEFAULT=!0,e.RAD_TO_DEG=180/Math.PI,e.DEG_TO_RAD=Math.PI/180,e.RETINA_PREFIX="@2x",e.dontSayHello=!0,e.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0},e.sayHello=function(t){if(!e.dontSayHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var i=["%c %c %c Pixi.js "+e.VERSION+" - "+t+"  %c  %c  http://www.pixijs.com/  %c %c %c%c ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,i)}else window.console&&console.log("Pixi.js "+e.VERSION+" - http://www.pixijs.com/");e.dontSayHello=!0}},e.Point=function(e,t){this.x=e||0,this.y=t||0},e.Point.prototype.clone=function(){return new e.Point(this.x,this.y)},e.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},e.Point.prototype.constructor=e.Point,e.Rectangle=function(e,t,i,n){this.x=e||0,this.y=t||0,this.width=i||0,this.height=n||0},e.Rectangle.prototype.clone=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Rectangle.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(e>=i&&e<=i+this.width){var n=this.y;if(t>=n&&t<=n+this.height)return!0}return!1},e.Rectangle.prototype.constructor=e.Rectangle,e.EmptyRectangle=new e.Rectangle(0,0,0,0),e.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),"number"==typeof t[0]){for(var n=[],i=0,r=t.length;r>i;i+=2)n.push(new e.Point(t[i],t[i+1]));t=n}this.points=t},e.Polygon.prototype.clone=function(){for(var i=[],t=0;t<this.points.length;t++)i.push(this.points[t].clone());return new e.Polygon(i)},e.Polygon.prototype.contains=function(o,t){for(var i=!1,e=0,n=this.points.length-1;e<this.points.length;n=e++){var a=this.points[e].x,r=this.points[e].y,l=this.points[n].x,s=this.points[n].y,c=r>t!=s>t&&(l-a)*(t-r)/(s-r)+a>o;c&&(i=!i)}return i},e.Polygon.prototype.constructor=e.Polygon,e.Circle=function(e,t,i){this.x=e||0,this.y=t||0,this.radius=i||0},e.Circle.prototype.clone=function(){return new e.Circle(this.x,this.y,this.radius)},e.Circle.prototype.contains=function(i,n){if(this.radius<=0)return!1;var e=this.x-i,t=this.y-n,r=this.radius*this.radius;return e*=e,t*=t,r>=e+t},e.Circle.prototype.getBounds=function(){return new e.Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},e.Circle.prototype.constructor=e.Circle,e.Ellipse=function(e,t,i,n){this.x=e||0,this.y=t||0,this.width=i||0,this.height=n||0},e.Ellipse.prototype.clone=function(){return new e.Ellipse(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.contains=function(i,n){if(this.width<=0||this.height<=0)return!1;var e=(i-this.x)/this.width,t=(n-this.y)/this.height;return e*=e,t*=t,1>=e+t},e.Ellipse.prototype.getBounds=function(){return new e.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},e.Ellipse.prototype.constructor=e.Ellipse,e.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},e.Matrix.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},e.Matrix.prototype.toArray=function(i){this.array||(this.array=new e.Float32Array(9));var t=this.array;return i?(t[0]=this.a,t[1]=this.c,t[2]=0,t[3]=this.b,t[4]=this.d,t[5]=0,t[6]=this.tx,t[7]=this.ty,t[8]=1):(t[0]=this.a,t[1]=this.b,t[2]=this.tx,t[3]=this.c,t[4]=this.d,t[5]=this.ty,t[6]=0,t[7]=0,t[8]=1),t},e.Matrix.prototype.apply=function(i,t){return t=t||new e.Point,t.x=this.a*i.x+this.b*i.y+this.tx,t.y=this.c*i.x+this.d*i.y+this.ty,t},e.Matrix.prototype.applyInverse=function(n,i){i=i||new e.Point;var t=1/(this.a*this.d+this.b*-this.c);return i.x=this.d*t*n.x-this.b*t*n.y+(this.ty*this.b-this.tx*this.d)*t,i.y=this.a*t*n.y-this.c*t*n.x+(this.tx*this.c-this.ty*this.a)*t,i},e.Matrix.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},e.Matrix.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},e.Matrix.prototype.rotate=function(i){var e=Math.cos(i),t=Math.sin(i),n=this.a,r=this.c,a=this.tx;return this.a=n*e-this.b*t,this.b=n*t+this.b*e,this.c=r*e-this.d*t,this.d=r*t+this.d*e,this.tx=a*e-this.ty*t,this.ty=a*t+this.ty*e,this},e.identityMatrix=new e.Matrix,e.determineMatrixArrayType=function(){return"undefined"!=typeof Float32Array?Float32Array:Array},e.Matrix2=e.determineMatrixArrayType(),e.DisplayObject=function(){this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new e.Matrix,this.color=[],this.dynamic=!0,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new e.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},e.DisplayObject.prototype.constructor=e.DisplayObject,e.DisplayObject.prototype.setInteractive=function(e){this.interactive=e},Object.defineProperty(e.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(e){this._interactive=e,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}}),Object.defineProperty(e.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask&&(this._mask.isMask=!1),this._mask=e,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(e){if(e){for(var n=[],t=0;t<e.length;t++)for(var r=e[t].passes,i=0;i<r.length;i++)n.push(r[i]);this._filterBlock={target:this,filterPasses:n}}this._filters=e}}),Object.defineProperty(e.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap!==e&&(e?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=e)}}),e.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var e=this.parent.worldTransform,t=this.worldTransform,p=this.pivot.x,d=this.pivot.y,r=this._cr*this.scale.x,a=-this._sr*this.scale.y,s=this._sr*this.scale.x,c=this._cr*this.scale.y,u=this.position.x-r*p-d*a,h=this.position.y-c*d-p*s,l=e.a,n=e.b,i=e.c,o=e.d;t.a=l*r+n*s,t.b=l*a+n*c,t.tx=l*u+n*h+e.tx,t.c=i*r+o*s,t.d=i*a+o*c,t.ty=i*u+o*h+e.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},e.DisplayObject.prototype.getBounds=function(t){return t=t,e.EmptyRectangle},e.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(e.identityMatrix)},e.DisplayObject.prototype.setStageReference=function(e){this.stage=e,this._interactive&&(this.stage.dirty=!0)},e.DisplayObject.prototype.generateTexture=function(n,r,a){var t=this.getLocalBounds(),i=new e.RenderTexture(0|t.width,0|t.height,a,r,n);return i.render(this,new e.Point(-t.x,-t.y)),i},e.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},e.DisplayObject.prototype.toGlobal=function(e){return this.updateTransform(),this.worldTransform.apply(e)},e.DisplayObject.prototype.toLocal=function(e,t){return t&&(e=t.toGlobal(e)),this.updateTransform(),this.worldTransform.applyInverse(e)},e.DisplayObject.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha,t.gl?e.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):e.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},e.getAncestorRenderer=function(t){for(;;){if(null==t||"object"!=typeof t)return void 0;if(t.renderer instanceof e.WebGLRenderer||t.renderer instanceof e.CanvasRenderer)return t.renderer;t=t.parent}},e.DisplayObject.prototype._generateCachedSprite=function(n){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var r=new e.RenderTexture(0|t.width,0|t.height,e.getAncestorRenderer(this),void 0,n);this._cachedSprite=new e.Sprite(r),this._cachedSprite.worldTransform=this.worldTransform}var i=this._filters;this._filters=null,this._cachedSprite.filters=i,this._cachedSprite.texture.render(this,new e.Point(-t.x,-t.y)),this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._filters=i,this._cacheAsBitmap=!0},e.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},e.DisplayObject.prototype._renderWebGL=function(e){e=e},e.DisplayObject.prototype._renderCanvas=function(e){e=e},Object.defineProperty(e.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e}}),Object.defineProperty(e.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e}}),e.DisplayObjectContainer=function(){e.DisplayObject.call(this),this.children=[]},e.DisplayObjectContainer.prototype=Object.create(e.DisplayObject.prototype),e.DisplayObjectContainer.prototype.constructor=e.DisplayObjectContainer,Object.defineProperty(e.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/(t/this.scale.x):1,this._width=e}}),Object.defineProperty(e.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/(t/this.scale.y):1,this._height=e}}),e.DisplayObjectContainer.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},e.DisplayObjectContainer.prototype.addChildAt=function(e,t){if(t>=0&&t<=this.children.length)return e.parent&&e.parent.removeChild(e),e.parent=this,this.children.splice(t,0,e),this.stage&&e.setStageReference(this.stage),e;throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length)},e.DisplayObjectContainer.prototype.swapChildren=function(e,t){if(e!==t){var i=this.children.indexOf(e),n=this.children.indexOf(t);if(0>i||0>n)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=t,this.children[n]=e}},e.DisplayObjectContainer.prototype.getChildAt=function(e){if(e>=0&&e<this.children.length)return this.children[e];throw new Error("getChildAt: Supplied index "+e+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller")},e.DisplayObjectContainer.prototype.removeChild=function(e){return this.removeChildAt(this.children.indexOf(e))},e.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},e.DisplayObjectContainer.prototype.removeChildren=function(o,n){var r=o||0,a="number"==typeof n?n:this.children.length,e=a-r;if(e>0&&a>=e){for(var t=this.children.splice(r,e),i=0;i<t.length;i++){var s=t[i];this.stage&&s.removeStageReference(),s.parent=void 0}return t}if(0===e&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},e.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(e.DisplayObject.prototype.updateTransform.call(this),!this._cacheAsBitmap))for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateTransform()},e.DisplayObjectContainer.prototype.getBounds=function(h){if(0===this.children.length)return e.EmptyRectangle;if(h){var d=this.worldTransform;this.worldTransform=h,this.updateTransform(),this.worldTransform=d}for(var t,c,l,n=1/0,r=1/0,s=-1/0,a=-1/0,u=!1,o=0,p=this.children.length;p>o;o++){var f=this.children[o];f.visible&&(u=!0,t=this.children[o].getBounds(h),n=n<t.x?n:t.x,r=r<t.y?r:t.y,c=t.width+t.x,l=t.height+t.y,s=s>c?s:c,a=a>l?a:l)}if(!u)return e.EmptyRectangle;var i=this._bounds;return i.x=n,i.y=r,i.width=s-n,i.height=a-r,i},e.DisplayObjectContainer.prototype.getLocalBounds=function(){var i=this.worldTransform;this.worldTransform=e.identityMatrix;for(var t=0,n=this.children.length;n>t;t++)this.children[t].updateTransform();var r=this.getBounds();return this.worldTransform=i,r},e.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0);for(var e=0,i=this.children.length;i>e;e++){var n=this.children[e];n.setStageReference(t)}},e.DisplayObjectContainer.prototype.removeStageReference=function(){for(var e=0,t=this.children.length;t>e;e++){var i=this.children[e];i.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},e.DisplayObjectContainer.prototype._renderWebGL=function(e){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(e);var t,i;if(this._mask||this._filters){for(this._filters&&(e.spriteBatch.flush(),e.filterManager.pushFilter(this._filterBlock)),this._mask&&(e.spriteBatch.stop(),e.maskManager.pushMask(this.mask,e),e.spriteBatch.start()),t=0,i=this.children.length;i>t;t++)this.children[t]._renderWebGL(e);e.spriteBatch.stop(),this._mask&&e.maskManager.popMask(this._mask,e),this._filters&&e.filterManager.popFilter(),e.spriteBatch.start()}else for(t=0,i=this.children.length;i>t;t++)this.children[t]._renderWebGL(e)}},e.DisplayObjectContainer.prototype._renderCanvas=function(e){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(e);this._mask&&e.maskManager.pushMask(this._mask,e);for(var t=0,i=this.children.length;i>t;t++){var n=this.children[t];n._renderCanvas(e)}this._mask&&e.maskManager.popMask(e)}},e.Sprite=function(t){e.DisplayObjectContainer.call(this),this.anchor=new e.Point,this.texture=t,this._width=0,this._height=0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL,t.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Sprite.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Sprite.prototype.constructor=e.Sprite,Object.defineProperty(e.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width,this._width=e}}),Object.defineProperty(e.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height,this._height=e}}),e.Sprite.prototype.setTexture=function(e){this.texture=e,this.cachedTint=16777215},e.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},e.Sprite.prototype.getBounds=function(S){var E=this.texture.frame.width,C=this.texture.frame.height,p=E*(1-this.anchor.x),w=E*-this.anchor.x,T=C*(1-this.anchor.y),s=C*-this.anchor.y,a=S||this.worldTransform,l=a.a,c=a.c,h=a.b,u=a.d,d=a.tx,o=a.ty,f=l*w+h*s+d,_=u*s+c*w+o,m=l*p+h*s+d,g=u*s+c*p+o,y=l*p+h*T+d,v=u*T+c*p+o,x=l*w+h*T+d,b=u*T+c*w+o,i=-1/0,n=-1/0,t=1/0,e=1/0;t=t>f?f:t,t=t>m?m:t,t=t>y?y:t,t=t>x?x:t,e=e>_?_:e,e=e>g?g:e,e=e>v?v:e,e=e>b?b:e,i=f>i?f:i,i=m>i?m:i,i=y>i?y:i,i=x>i?x:i,n=_>n?_:n,n=g>n?g:n,n=v>n?v:n,n=b>n?b:n;var r=this._bounds;return r.x=t,r.width=i-t,r.y=e,r.height=n-e,this._currentBounds=r,r},e.Sprite.prototype._renderWebGL=function(e){if(this.visible&&!(this.alpha<=0)){var t,n;if(this._mask||this._filters){var i=e.spriteBatch;for(this._filters&&(i.flush(),e.filterManager.pushFilter(this._filterBlock)),this._mask&&(i.stop(),e.maskManager.pushMask(this.mask,e),i.start()),i.render(this),t=0,n=this.children.length;n>t;t++)this.children[t]._renderWebGL(e);i.stop(),this._mask&&e.maskManager.popMask(this._mask,e),this._filters&&e.filterManager.popFilter(),i.start()}else for(e.spriteBatch.render(this),t=0,n=this.children.length;n>t;t++)this.children[t]._renderWebGL(e)}},e.Sprite.prototype._renderCanvas=function(t){if(!(this.visible===!1||0===this.alpha||this.texture.crop.width<=0||this.texture.crop.height<=0)){if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid){var i=this.texture.baseTexture.resolution/t.resolution;t.context.globalAlpha=this.worldAlpha,t.roundPixels?t.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,0|this.worldTransform.tx,0|this.worldTransform.ty):t.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,this.worldTransform.tx*t.resolution,this.worldTransform.ty*t.resolution),t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=t.scaleMode===e.scaleModes.LINEAR);var r=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,a=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=e.CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,r/i,a/i,this.texture.crop.width/i,this.texture.crop.height/i)):t.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,r/i,a/i,this.texture.crop.width/i,this.texture.crop.height/i)}for(var n=0,s=this.children.length;s>n;n++)this.children[n]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},e.Sprite.fromFrame=function(t){var i=e.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new e.Sprite(i)},e.Sprite.fromImage=function(t,i,n){var r=e.Texture.fromImage(t,i,n);return new e.Sprite(r)},e.SpriteBatch=function(t){e.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},e.SpriteBatch.prototype=Object.create(e.DisplayObjectContainer.prototype),e.SpriteBatch.constructor=e.SpriteBatch,e.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new e.WebGLFastSpriteBatch(t),this.ready=!0},e.SpriteBatch.prototype.updateTransform=function(){e.DisplayObject.prototype.updateTransform.call(this)},e.SpriteBatch.prototype._renderWebGL=function(e){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(e.gl),e.spriteBatch.stop(),e.shaderManager.setShader(e.shaderManager.fastShader),this.fastSpriteBatch.begin(this,e),this.fastSpriteBatch.render(this),e.spriteBatch.start())},e.SpriteBatch.prototype._renderCanvas=function(c){if(this.visible&&!(this.alpha<=0)&&this.children.length){var r=c.context;r.globalAlpha=this.worldAlpha,e.DisplayObject.prototype.updateTransform.call(this);for(var a=this.worldTransform,s=!0,o=0;o<this.children.length;o++){var t=this.children[o];if(t.visible){var l=t.texture,i=l.frame;if(r.globalAlpha=this.worldAlpha*t.alpha,t.rotation%(2*Math.PI)===0)s&&(r.setTransform(a.a,a.c,a.b,a.d,a.tx,a.ty),s=!1),r.drawImage(l.baseTexture.source,i.x,i.y,i.width,i.height,t.anchor.x*-i.width*t.scale.x+t.position.x+.5|0,t.anchor.y*-i.height*t.scale.y+t.position.y+.5|0,i.width*t.scale.x,i.height*t.scale.y);else{s||(s=!0),e.DisplayObject.prototype.updateTransform.call(t);var n=t.worldTransform;c.roundPixels?r.setTransform(n.a,n.c,n.b,n.d,0|n.tx,0|n.ty):r.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),r.drawImage(l.baseTexture.source,i.x,i.y,i.width,i.height,t.anchor.x*-i.width+.5|0,t.anchor.y*-i.height+.5|0,i.width,i.height)}}}}},e.MovieClip=function(t){e.Sprite.call(this,t[0]),this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},e.MovieClip.prototype=Object.create(e.Sprite.prototype),e.MovieClip.prototype.constructor=e.MovieClip,Object.defineProperty(e.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),e.MovieClip.prototype.stop=function(){this.playing=!1},e.MovieClip.prototype.play=function(){this.playing=!0},e.MovieClip.prototype.gotoAndStop=function(e){this.playing=!1,this.currentFrame=e;var t=this.currentFrame+.5|0;this.setTexture(this.textures[t%this.textures.length])},e.MovieClip.prototype.gotoAndPlay=function(e){this.currentFrame=e,this.playing=!0},e.MovieClip.prototype.updateTransform=function(){if(e.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=this.currentFrame+.5|0;this.currentFrame=this.currentFrame%this.textures.length,this.loop||t<this.textures.length?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},e.MovieClip.fromFrames=function(i){for(var n=[],t=0;t<i.length;t++)n.push(new e.Texture.fromFrame(i[t]));return new e.MovieClip(n)},e.MovieClip.fromImages=function(i){for(var n=[],t=0;t<i.length;t++)n.push(new e.Texture.fromImage(i[t]));return new e.MovieClip(n)},e.FilterBlock=function(){this.visible=!0,this.renderable=!0},e.Text=function(t,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=1,e.Sprite.call(this,e.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(i)},e.Text.prototype=Object.create(e.Sprite.prototype),e.Text.prototype.constructor=e.Text,Object.defineProperty(e.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width,this._width=e}}),Object.defineProperty(e.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height,this._height=e}}),e.Text.prototype.setStyle=function(e){e=e||{},e.font=e.font||"bold 20pt Arial",e.fill=e.fill||"black",e.align=e.align||"left",e.stroke=e.stroke||"black",e.strokeThickness=e.strokeThickness||0,e.wordWrap=e.wordWrap||!1,e.wordWrapWidth=e.wordWrapWidth||100,e.dropShadow=e.dropShadow||!1,e.dropShadowAngle=e.dropShadowAngle||Math.PI/6,e.dropShadowDistance=e.dropShadowDistance||4,e.dropShadowColor=e.dropShadowColor||"black",this.style=e,this.dirty=!0},e.Text.prototype.setText=function(e){this.text=e.toString()||" ",this.dirty=!0},e.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution,this.context.font=this.style.font;var c=this.text;this.style.wordWrap&&(c=this.wordWrap(this.text));for(var i=c.split(/(?:\r\n|\r|\n)/),r=[],n=0,e=0;e<i.length;e++){var h=this.context.measureText(i[e]).width;r[e]=h,n=Math.max(n,h)}var o=n+this.style.strokeThickness;this.style.dropShadow&&(o+=this.style.dropShadowDistance),this.canvas.width=(o+this.context.lineWidth)*this.resolution;var s=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,l=s*i.length;this.style.dropShadow&&(l+=this.style.dropShadowDistance),this.canvas.height=l*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top";var t,a;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var u=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,d=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(e=0;e<i.length;e++)t=this.style.strokeThickness/2,a=this.style.strokeThickness/2+e*s,"right"===this.style.align?t+=n-r[e]:"center"===this.style.align&&(t+=(n-r[e])/2),this.style.fill&&this.context.fillText(i[e],t+u,a+d)}for(this.context.fillStyle=this.style.fill,e=0;e<i.length;e++)t=this.style.strokeThickness/2,a=this.style.strokeThickness/2+e*s,"right"===this.style.align?t+=n-r[e]:"center"===this.style.align&&(t+=(n-r[e])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(i[e],t,a),this.style.fill&&this.context.fillText(i[e],t,a);this.updateTexture()},e.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height},e.Text.prototype._renderWebGL=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1,e.updateWebGLTexture(this.texture.baseTexture,t.gl)),e.Sprite.prototype._renderWebGL.call(this,t)},e.Text.prototype._renderCanvas=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1),e.Sprite.prototype._renderCanvas.call(this,t)},e.Text.prototype.determineFontHeight=function(n){var i=e.Text.heightCache[n];if(!i){var r=document.getElementsByTagName("body")[0],t=document.createElement("div"),a=document.createTextNode("M");t.appendChild(a),t.setAttribute("style",n+";position:absolute;top:0;left:0"),r.appendChild(t),i=t.offsetHeight,e.Text.heightCache[n]=i,r.removeChild(t)}return i},e.Text.prototype.wordWrap=function(l){for(var t="",r=l.split("\n"),i=0;i<r.length;i++){for(var a=this.style.wordWrapWidth,n=r[i].split(" "),e=0;e<n.length;e++){var s=this.context.measureText(n[e]).width,o=s+this.context.measureText(" ").width;0===e||o>a?(e>0&&(t+="\n"),t+=n[e],a=this.style.wordWrapWidth-s):(a-=o,t+=" "+n[e])}i<r.length-1&&(t+="\n")}return t},e.Text.prototype.destroy=function(e){this.context=null,this.canvas=null,this.texture.destroy(void 0===e?!0:e)},e.Text.heightCache={},e.BitmapText=function(t,i){e.DisplayObjectContainer.call(this),this._pool=[],this.setText(t),this.setStyle(i),this.updateText(),this.dirty=!1},e.BitmapText.prototype=Object.create(e.DisplayObjectContainer.prototype),e.BitmapText.prototype.constructor=e.BitmapText,e.BitmapText.prototype.setText=function(e){this.text=e||" ",this.dirty=!0},e.BitmapText.prototype.setStyle=function(t){t=t||{},t.align=t.align||"left",this.style=t;var i=t.font.split(" ");this.fontName=i[i.length-1],this.fontSize=i.length>=2?parseInt(i[i.length-2],10):e.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=t.tint},e.BitmapText.prototype.updateText=function(){for(var c=e.BitmapText.fonts[this.fontName],i=new e.Point,o=null,r=[],a=0,h=[],u=0,l=this.fontSize/c.size,t=0;t<this.text.length;t++){var d=this.text.charCodeAt(t);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(t)))h.push(i.x),a=Math.max(a,i.x),u++,i.x=0,i.y+=c.lineHeight,o=null;else{var s=c.chars[d];s&&(o&&s[o]&&(i.x+=s.kerning[o]),r.push({texture:s.texture,line:u,charCode:d,position:new e.Point(i.x+s.xOffset,i.y+s.yOffset)}),i.x+=s.xAdvance,o=d)}}h.push(i.x),a=Math.max(a,i.x);var _=[];for(t=0;u>=t;t++){var p=0;"right"===this.style.align?p=a-h[t]:"center"===this.style.align&&(p=(a-h[t])/2),_.push(p)}var g=this.children.length,f=r.length,y=this.tint||16777215;for(t=0;f>t;t++){var n=g>t?this.children[t]:this._pool.pop();n?n.setTexture(r[t].texture):n=new e.Sprite(r[t].texture),n.position.x=(r[t].position.x+_[r[t].line])*l,n.position.y=r[t].position.y*l,n.scale.x=n.scale.y=l,n.tint=y,n.parent||this.addChild(n)}for(;this.children.length>f;){var m=this.getChildAt(this.children.length-1);this._pool.push(m),this.removeChild(m)}this.textWidth=a*l,this.textHeight=(i.y+c.lineHeight)*l},e.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.BitmapText.fonts={},e.InteractionData=function(){this.global=new e.Point,this.target=null,this.originalEvent=null},e.InteractionData.prototype.getLocalPosition=function(u,n){var i=u.worldTransform,r=this.global,a=i.a,s=i.b,c=i.tx,l=i.c,o=i.d,h=i.ty,t=1/(a*o+s*-l);return n=n||new e.Point,n.x=o*t*r.x+-s*t*r.y+(h*s-c*o)*t,n.y=a*t*r.y+-l*t*r.x+(-h*a+c*l)*t,n},e.InteractionData.prototype.constructor=e.InteractionData,e.InteractionManager=function(t){this.stage=t,this.mouse=new e.InteractionData,this.touchs={},this.tempPoint=new e.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1,this.resolution=1},e.InteractionManager.prototype.constructor=e.InteractionManager,e.InteractionManager.prototype.collectInteractiveSprite=function(r,i){for(var n=r.children,a=n.length,t=a-1;t>=0;t--){var e=n[t];e._interactive?(i.interactiveChildren=!0,this.interactiveItems.push(e),e.children.length>0&&this.collectInteractiveSprite(e,e)):(e.__iParent=null,e.children.length>0&&this.collectInteractiveSprite(e,i))}},e.InteractionManager.prototype.setTarget=function(e){this.target=e,this.resolution=e.resolution,null===this.interactionDOMElement&&this.setTargetDomElement(e.view)},e.InteractionManager.prototype.setTargetDomElement=function(e){this.removeEvents(),window.navigator.msPointerEnabled&&(e.style["-ms-content-zooming"]="none",e.style["-ms-touch-action"]="none"),this.interactionDOMElement=e,e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mousedown",this.onMouseDown,!0),e.addEventListener("mouseout",this.onMouseOut,!0),e.addEventListener("touchstart",this.onTouchStart,!0),e.addEventListener("touchend",this.onTouchEnd,!0),e.addEventListener("touchmove",this.onTouchMove,!0)},e.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null)},e.InteractionManager.prototype.update=function(){if(this.target){var a=Date.now(),r=a-this.last;if(r=r*e.INTERACTION_FREQUENCY/1e3,!(1>r)){this.last=a;var i=0;this.dirty&&this.rebuildInteractiveGraph();var o=this.interactiveItems.length,n="inherit",s=!1;for(i=0;o>i;i++){var t=this.interactiveItems[i];t.__hit=this.hitTest(t,this.mouse),this.mouse.target=t,t.__hit&&!s?(t.buttonMode&&(n=t.defaultCursor),t.interactiveChildren||(s=!0),t.__isOver||(t.mouseover&&t.mouseover(this.mouse),t.__isOver=!0)):t.__isOver&&(t.mouseout&&t.mouseout(this.mouse),t.__isOver=!1)}this.currentCursorStyle!==n&&(this.currentCursorStyle=n,this.interactionDOMElement.style.cursor=n)}}},e.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=!1;for(var t=this.interactiveItems.length,e=0;t>e;e++)this.interactiveItems[e].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)},e.InteractionManager.prototype.onMouseMove=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t||window.event;var e=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width)/this.resolution,this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height)/this.resolution;for(var r=this.interactiveItems.length,i=0;r>i;i++){var n=this.interactiveItems[i];n.mousemove&&n.mousemove(this.mouse)}},e.InteractionManager.prototype.onMouseDown=function(s){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=s||window.event,e.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var o=this.interactiveItems.length,a=this.mouse.originalEvent,i=2===a.button||3===a.which,n=i?"rightdown":"mousedown",l=i?"rightclick":"click",c=i?"__rightIsDown":"__mouseIsDown",h=i?"__isRightDown":"__isDown",r=0;o>r;r++){var t=this.interactiveItems[r];if((t[n]||t[l])&&(t[c]=!0,t.__hit=this.hitTest(t,this.mouse),t.__hit&&(t[n]&&t[n](this.mouse),t[h]=!0,!t.interactiveChildren)))break}},e.InteractionManager.prototype.onMouseOut=function(i){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=i||window.event;var n=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var t=0;n>t;t++){var e=this.interactiveItems[t];e.__isOver&&(this.mouse.target=e,e.mouseout&&e.mouseout(this.mouse),e.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},e.InteractionManager.prototype.onMouseUp=function(h){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=h||window.event;for(var c=this.interactiveItems.length,l=!1,o=this.mouse.originalEvent,t=2===o.button||3===o.which,r=t?"rightup":"mouseup",s=t?"rightclick":"click",a=t?"rightupoutside":"mouseupoutside",n=t?"__isRightDown":"__isDown",i=0;c>i;i++){var e=this.interactiveItems[i];(e[s]||e[r]||e[a])&&(e.__hit=this.hitTest(e,this.mouse),e.__hit&&!l?(e[r]&&e[r](this.mouse),e[n]&&e[s]&&e[s](this.mouse),e.interactiveChildren||(l=!0)):e[n]&&e[a]&&e[a](this.mouse),e[n]=!1)}},e.InteractionManager.prototype.hitTest=function(t,n){var a=n.global;if(!t.worldVisible)return!1;var x=t instanceof e.Sprite,r=t.worldTransform,h=r.a,d=r.b,_=r.tx,l=r.c,c=r.d,f=r.ty,i=1/(h*c+d*-l),s=c*i*a.x+-d*i*a.y+(f*d-_*c)*i,u=h*i*a.y+-l*i*a.x+(-f*h+_*l)*i;if(n.target=t,t.hitArea&&t.hitArea.contains)return t.hitArea.contains(s,u)?(n.target=t,!0):!1;if(x){var o,m=t.texture.frame.width,g=t.texture.frame.height,y=-m*t.anchor.x;if(s>y&&y+m>s&&(o=-g*t.anchor.y,u>o&&o+g>u))return n.target=t,!0}for(var v=t.children.length,p=0;v>p;p++){var b=t.children[p],w=this.hitTest(b,n);if(w)return n.target=t,!0}return!1},e.InteractionManager.prototype.onTouchMove=function(n){this.dirty&&this.rebuildInteractiveGraph();var e,t=this.interactionDOMElement.getBoundingClientRect(),o=n.changedTouches,r=0;for(r=0;r<o.length;r++){var i=o[r];e=this.touchs[i.identifier],e.originalEvent=n||window.event,e.global.x=(i.clientX-t.left)*(this.target.width/t.width)/this.resolution,e.global.y=(i.clientY-t.top)*(this.target.height/t.height)/this.resolution,!navigator.isCocoonJS||t.left||t.top||n.target.style.width||n.target.style.height||(e.global.x=i.clientX,e.global.y=i.clientY);for(var s=0;s<this.interactiveItems.length;s++){var a=this.interactiveItems[s];a.touchmove&&a.__touchData&&a.__touchData[i.identifier]&&a.touchmove(e)}}},e.InteractionManager.prototype.onTouchStart=function(a){this.dirty&&this.rebuildInteractiveGraph();var n=this.interactionDOMElement.getBoundingClientRect();e.AUTO_PREVENT_DEFAULT&&a.preventDefault();for(var l=a.changedTouches,s=0;s<l.length;s++){var r=l[s],i=this.pool.pop();i||(i=new e.InteractionData),i.originalEvent=a||window.event,this.touchs[r.identifier]=i,i.global.x=(r.clientX-n.left)*(this.target.width/n.width)/this.resolution,i.global.y=(r.clientY-n.top)*(this.target.height/n.height)/this.resolution,!navigator.isCocoonJS||n.left||n.top||a.target.style.width||a.target.style.height||(i.global.x=r.clientX,i.global.y=r.clientY);for(var c=this.interactiveItems.length,o=0;c>o;o++){var t=this.interactiveItems[o];if((t.touchstart||t.tap)&&(t.__hit=this.hitTest(t,i),t.__hit&&(t.touchstart&&t.touchstart(i),t.__isDown=!0,t.__touchData=t.__touchData||{},t.__touchData[r.identifier]=i,!t.interactiveChildren)))break}}},e.InteractionManager.prototype.onTouchEnd=function(r){this.dirty&&this.rebuildInteractiveGraph();for(var n=this.interactionDOMElement.getBoundingClientRect(),o=r.changedTouches,a=0;a<o.length;a++){var t=o[a],i=this.touchs[t.identifier],l=!1;i.global.x=(t.clientX-n.left)*(this.target.width/n.width)/this.resolution,i.global.y=(t.clientY-n.top)*(this.target.height/n.height)/this.resolution,!navigator.isCocoonJS||n.left||n.top||r.target.style.width||r.target.style.height||(i.global.x=t.clientX,i.global.y=t.clientY);for(var c=this.interactiveItems.length,s=0;c>s;s++){var e=this.interactiveItems[s];e.__touchData&&e.__touchData[t.identifier]&&(e.__hit=this.hitTest(e,e.__touchData[t.identifier]),i.originalEvent=r||window.event,(e.touchend||e.tap)&&(e.__hit&&!l?(e.touchend&&e.touchend(i),e.__isDown&&e.tap&&e.tap(i),e.interactiveChildren||(l=!0)):e.__isDown&&e.touchendoutside&&e.touchendoutside(i),e.__isDown=!1),e.__touchData[t.identifier]=null)}this.pool.push(i),this.touchs[t.identifier]=null}},e.Stage=function(t){e.DisplayObjectContainer.call(this),this.worldTransform=new e.Matrix,this.interactive=!0,this.interactionManager=new e.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new e.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(t)},e.Stage.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Stage.prototype.constructor=e.Stage,e.Stage.prototype.setInteractionDelegate=function(e){this.interactionManager.setTargetDomElement(e)},e.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var e=0,t=this.children.length;t>e;e++)this.children[e].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},e.Stage.prototype.setBackgroundColor=function(i){this.backgroundColor=i||0,this.backgroundColorSplit=e.hex2rgb(this.backgroundColor);var t=this.backgroundColor.toString(16);t="000000".substr(0,6-t.length)+t,this.backgroundColorString="#"+t},e.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},e.hex2rgb=function(e){return[(e>>16&255)/255,(e>>8&255)/255,(255&e)/255]},e.rgb2hex=function(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){return function(r){function t(){for(var e=arguments.length,a=new Array(e);e--;)a[e]=arguments[e];a=n.concat(a),i.apply(this instanceof t?this:r,a)}var i=this,e=arguments.length-1,n=[];if(e>0)for(n.length=e;e--;)n[e]=arguments[e+1];if("function"!=typeof i)throw new TypeError;return t.prototype=function a(e){return e&&(a.prototype=e),this instanceof a?void 0:new a}(i.prototype),t}}()),e.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(i){}},e.canUseNewCanvasBlendModes=function(){if("undefined"==typeof document)return!1;var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),0===e.getImageData(0,0,1,1).data[0]},e.getNextPowerOfTwo=function(e){if(e>0&&0===(e&e-1))return e;for(var t=1;e>t;)t<<=1;return t},e.EventTarget=function(){var e={};this.addEventListener=this.on=function(t,i){void 0===e[t]&&(e[t]=[]),-1===e[t].indexOf(i)&&e[t].unshift(i)},this.dispatchEvent=this.emit=function(t){if(e[t.type]&&e[t.type].length)for(var i=e[t.type].length-1;i>=0;i--)e[t.type][i](t)},this.removeEventListener=this.off=function(t,n){if(void 0!==e[t]){var i=e[t].indexOf(n);-1!==i&&e[t].splice(i,1)}},this.removeAllEventListeners=function(i){var t=e[i];t&&(t.length=0)}},e.autoDetectRenderer=function(){function i(e,i){function t(){return e.apply(this,i)}return t.prototype=e.prototype,new t}var t=Array.prototype.slice.call(arguments);"undefined"==typeof t[0]&&(t[0]=800),"undefined"==typeof t[1]&&(t[1]=600);var n=function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}();return i(e[(n?"WebGL":"Canvas")+"Renderer"],t)},e.autoDetectRecommendedRenderer=function(t,i,n){t||(t=800),i||(i=600);var r=function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}(),a=/Android/i.test(navigator.userAgent);return r&&!a?new e.WebGLRenderer(t,i,n):new e.CanvasRenderer(t,i,n)},e.PolyK={},e.PolyK.Triangulate=function(n){var u=!0,a=n.length>>1;if(3>a)return[];for(var o=[],i=[],t=0;a>t;t++)i.push(t);t=0;for(var r=a;r>3;){var h=i[(t+0)%r],c=i[(t+1)%r],l=i[(t+2)%r],f=n[2*h],_=n[2*h+1],v=n[2*c],m=n[2*c+1],g=n[2*l],y=n[2*l+1],d=!1;if(e.PolyK._convex(f,_,v,m,g,y,u)){d=!0;for(var p=0;r>p;p++){var s=i[p];if(s!==h&&s!==c&&s!==l&&e.PolyK._PointInTriangle(n[2*s],n[2*s+1],f,_,v,m,g,y)){d=!1;break}}}if(d)o.push(h,c,l),i.splice((t+1)%r,1),r--,t=0;else if(t++>3*r){if(!u)return window.console.log("PIXI Warning: shape too complex to fill"),[];for(o=[],i=[],t=0;a>t;t++)i.push(t);t=0,r=a,u=!1}}return o.push(i[0],i[1],i[2]),o},e.PolyK._PointInTriangle=function(b,m,a,s,x,v,y,g){var t=y-a,i=g-s,n=x-a,e=v-s,d=b-a,p=m-s,f=t*t+i*i,r=t*n+i*e,u=t*d+i*p,o=n*n+e*e,_=n*d+e*p,h=1/(f*o-r*r),c=(o*u-r*_)*h,l=(f*_-r*u)*h;return c>=0&&l>=0&&1>c+l},e.PolyK._convex=function(i,n,e,t,r,a,s){return(n-t)*(r-e)+(e-i)*(a-t)>=0===s},e.initDefaultShaders=function(){},e.CompileVertexShader=function(t,i){return e._CompileShader(t,i,t.VERTEX_SHADER)},e.CompileFragmentShader=function(t,i){return e._CompileShader(t,i,t.FRAGMENT_SHADER)},e._CompileShader=function(e,i,n){var r=i.join("\n"),t=e.createShader(n);return e.shaderSource(t,r),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)?t:(window.console.log(e.getShaderInfoLog(t)),null)},e.compileProgram=function(t,n,r){var a=e.CompileFragmentShader(t,r),s=e.CompileVertexShader(t,n),i=t.createProgram();return t.attachShader(i,s),t.attachShader(i,a),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),i},e.PixiShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.attributes=[],this.init()},e.PixiShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc||e.PixiShader.defaultVertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.dimensions=t.getUniformLocation(i,"dimensions"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var n in this.uniforms)this.uniforms[n].uniformLocation=t.getUniformLocation(i,n);this.initUniforms(),this.program=i},e.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,i=this.gl;for(var n in this.uniforms){t=this.uniforms[n];var e=t.type;"sampler2D"===e?(t._init=!1,null!==t.value&&this.initSampler2D(t)):"mat2"===e||"mat3"===e||"mat4"===e?(t.glMatrix=!0,t.glValueLength=1,"mat2"===e?t.glFunc=i.uniformMatrix2fv:"mat3"===e?t.glFunc=i.uniformMatrix3fv:"mat4"===e&&(t.glFunc=i.uniformMatrix4fv)):(t.glFunc=i["uniform"+e],t.glValueLength="2f"===e||"2i"===e?2:"3f"===e||"3i"===e?3:"4f"===e||"4i"===e?4:1)}},e.PixiShader.prototype.initSampler2D=function(i){if(i.value&&i.value.baseTexture&&i.value.baseTexture.hasLoaded){var e=this.gl;if(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,i.value.baseTexture._glTextures[e.id]),i.textureData){var t=i.textureData,o=t.magFilter?t.magFilter:e.LINEAR,s=t.minFilter?t.minFilter:e.LINEAR,a=t.wrapS?t.wrapS:e.CLAMP_TO_EDGE,r=t.wrapT?t.wrapT:e.CLAMP_TO_EDGE,n=t.luminance?e.LUMINANCE:e.RGBA;if(t.repeat&&(a=e.REPEAT,r=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!t.flipY),t.width){var l=t.width?t.width:512,c=t.height?t.height:2,h=t.border?t.border:0;e.texImage2D(e.TEXTURE_2D,0,n,l,c,h,n,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,n,e.RGBA,e.UNSIGNED_BYTE,i.value.baseTexture.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,r)}e.uniform1i(i.uniformLocation,this.textureCount),i._init=!0,this.textureCount++}},e.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var t,i=this.gl;for(var n in this.uniforms)t=this.uniforms[n],1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(i,t.uniformLocation,t.transpose,t.value):t.glFunc.call(i,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),i.bindTexture(i.TEXTURE_2D,t.value.baseTexture._glTextures[i.id]||e.createWebGLTexture(t.value.baseTexture,i)),i.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},e.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"],e.PixiFastShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},e.PixiFastShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.dimensions=t.getUniformLocation(i,"dimensions"),this.uMatrix=t.getUniformLocation(i,"uMatrix"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(i,"aPositionCoord"),this.aScale=t.getAttribLocation(i,"aScale"),this.aRotation=t.getAttribLocation(i,"aRotation"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=i},e.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.StripShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},e.StripShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.colorAttribute=t.getAttribLocation(i,"aColor"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},e.PrimitiveShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},e.PrimitiveShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.tintColor=t.getUniformLocation(i,"tint"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(i,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.ComplexPrimitiveShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},e.ComplexPrimitiveShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.tintColor=t.getUniformLocation(i,"tint"),this.color=t.getUniformLocation(i,"color"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},e.WebGLGraphics=function(){},e.WebGLGraphics.renderGraphics=function(r,i){var a,t=i.gl,l=i.projection,c=i.offset,n=i.shaderManager.primitiveShader;r.dirty&&e.WebGLGraphics.updateGraphics(r,t);for(var o=r._webGL[t.id],s=0;s<o.data.length;s++)1===o.data[s].mode?(a=o.data[s],i.stencilManager.pushStencil(r,a,i),t.drawElements(t.TRIANGLE_FAN,4,t.UNSIGNED_SHORT,2*(a.indices.length-4)),i.stencilManager.popStencil(r,a,i)):(a=o.data[s],i.shaderManager.setShader(n),n=i.shaderManager.primitiveShader,t.uniformMatrix3fv(n.translationMatrix,!1,r.worldTransform.toArray(!0)),t.uniform2f(n.projectionVector,l.x,-l.y),t.uniform2f(n.offsetVector,-c.x,-c.y),t.uniform3fv(n.tintColor,e.hex2rgb(r.tint)),t.uniform1f(n.alpha,r.worldAlpha),t.bindBuffer(t.ARRAY_BUFFER,a.buffer),t.vertexAttribPointer(n.aVertexPosition,2,t.FLOAT,!1,24,0),t.vertexAttribPointer(n.colorAttribute,4,t.FLOAT,!1,24,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a.indexBuffer),t.drawElements(t.TRIANGLE_STRIP,a.indices.length,t.UNSIGNED_SHORT,0))},e.WebGLGraphics.updateGraphics=function(a,s){var i=a._webGL[s.id];i||(i=a._webGL[s.id]={lastIndex:0,data:[],gl:s}),a.dirty=!1;var r;if(a.clearDirty){for(a.clearDirty=!1,r=0;r<i.data.length;r++){var o=i.data[r];o.reset(),e.WebGLGraphics.graphicsDataPool.push(o)}i.data=[],i.lastIndex=0}var n;for(r=i.lastIndex;r<a.graphicsData.length;r++){var t=a.graphicsData[r];t.type===e.Graphics.POLY?(t.fill&&t.points.length>6&&(t.points.length>10?(n=e.WebGLGraphics.switchMode(i,1),e.WebGLGraphics.buildComplexPoly(t,n)):(n=e.WebGLGraphics.switchMode(i,0),e.WebGLGraphics.buildPoly(t,n))),t.lineWidth>0&&(n=e.WebGLGraphics.switchMode(i,0),e.WebGLGraphics.buildLine(t,n))):(n=e.WebGLGraphics.switchMode(i,0),t.type===e.Graphics.RECT?e.WebGLGraphics.buildRectangle(t,n):t.type===e.Graphics.CIRC||t.type===e.Graphics.ELIP?e.WebGLGraphics.buildCircle(t,n):t.type===e.Graphics.RREC&&e.WebGLGraphics.buildRoundedRectangle(t,n)),i.lastIndex++}for(r=0;r<i.data.length;r++)n=i.data[r],n.dirty&&n.upload()},e.WebGLGraphics.switchMode=function(i,n){var t;return i.data.length?(t=i.data[i.data.length-1],(t.mode!==n||1===n)&&(t=e.WebGLGraphics.graphicsDataPool.pop()||new e.WebGLGraphicsData(i.gl),t.mode=n,i.data.push(t))):(t=e.WebGLGraphics.graphicsDataPool.pop()||new e.WebGLGraphicsData(i.gl),t.mode=n,i.data.push(t)),t.dirty=!0,t},e.WebGLGraphics.buildRectangle=function(t,p){var c=t.points,n=c[0],r=c[1],l=c[2],u=c[3];if(t.fill){var f=e.hex2rgb(t.fillColor),a=t.fillAlpha,h=f[0]*a,o=f[1]*a,d=f[2]*a,i=p.points,_=p.indices,s=i.length/6;i.push(n,r),i.push(h,o,d,a),i.push(n+l,r),i.push(h,o,d,a),i.push(n,r+u),i.push(h,o,d,a),i.push(n+l,r+u),i.push(h,o,d,a),_.push(s,s,s+1,s+2,s+3,s+3)}if(t.lineWidth){var m=t.points;t.points=[n,r,n+l,r,n+l,r+u,n,r+u,n,r],e.WebGLGraphics.buildLine(t,p),t.points=m}},e.WebGLGraphics.buildRoundedRectangle=function(s,f){var h=s.points,i=h[0],n=h[1],l=h[2],o=h[3],a=h[4],t=[];if(t.push(i,n+a),t=t.concat(e.WebGLGraphics.quadraticBezierCurve(i,n+o-a,i,n+o,i+a,n+o)),t=t.concat(e.WebGLGraphics.quadraticBezierCurve(i+l-a,n+o,i+l,n+o,i+l,n+o-a)),t=t.concat(e.WebGLGraphics.quadraticBezierCurve(i+l,n+a,i+l,n,i+l-a,n)),t=t.concat(e.WebGLGraphics.quadraticBezierCurve(i+a,n,i,n,i,n+a)),s.fill){var _=e.hex2rgb(s.fillColor),p=s.fillAlpha,v=_[0]*p,y=_[1]*p,g=_[2]*p,m=f.points,d=f.indices,u=m.length/6,c=e.PolyK.Triangulate(t),r=0;for(r=0;r<c.length;r+=3)d.push(c[r]+u),d.push(c[r]+u),d.push(c[r+1]+u),d.push(c[r+2]+u),d.push(c[r+2]+u);for(r=0;r<t.length;r++)m.push(t[r],t[++r],v,y,g,p)}if(s.lineWidth){var x=s.points;s.points=t,e.WebGLGraphics.buildLine(s,f),s.points=x}},e.WebGLGraphics.quadraticBezierCurve=function(m,p,s,n,_,f){function t(e,t,i){var n=t-e;return e+n*i}for(var o,r,c,h,u,d,l=20,a=[],e=0,i=0;l>=i;i++)e=i/l,o=t(m,s,e),r=t(p,n,e),c=t(s,_,e),h=t(n,f,e),u=t(o,c,e),d=t(r,h,e),a.push(u,d);return a},e.WebGLGraphics.buildCircle=function(i,h){var r=i.points,u=r[0],c=r[1],y=r[2],g=r[3],l=40,s=2*Math.PI/l,t=0;if(i.fill){var d=e.hex2rgb(i.fillColor),n=i.fillAlpha,m=d[0]*n,f=d[1]*n,_=d[2]*n,p=h.points,o=h.indices,a=p.length/6;for(o.push(a),t=0;l+1>t;t++)p.push(u,c,m,f,_,n),p.push(u+Math.sin(s*t)*y,c+Math.cos(s*t)*g,m,f,_,n),o.push(a++,a++);o.push(a-1)}if(i.lineWidth){var v=i.points;for(i.points=[],t=0;l+1>t;t++)i.points.push(u+Math.sin(s*t)*y,c+Math.cos(s*t)*g);e.WebGLGraphics.buildLine(i,h),i.points=v}},e.WebGLGraphics.buildLine=function(w,U){var o=0,t=w.points;if(0!==t.length){if(w.lineWidth%2)for(o=0;o<t.length;o++)t[o]+=.5;var k=new e.Point(t[0],t[1]),x=new e.Point(t[t.length-2],t[t.length-1]);if(k.x===x.x&&k.y===x.y){t=t.slice(),t.pop(),t.pop(),x=new e.Point(t[t.length-2],t[t.length-1]);var N=x.x+.5*(k.x-x.x),B=x.y+.5*(k.y-x.y);t.unshift(N,B),t.push(N,B)}var E,b,_,p,a,r,A,S,n,i,g,f,v,y,z,P,M,R,O,L,C,G,l,s=U.points,I=U.indices,T=t.length/2,F=t.length,D=s.length/6,m=w.lineWidth/2,j=e.hex2rgb(w.lineColor),c=w.lineAlpha,u=j[0]*c,h=j[1]*c,d=j[2]*c;for(_=t[0],p=t[1],a=t[2],r=t[3],n=-(p-r),i=_-a,l=Math.sqrt(n*n+i*i),n/=l,i/=l,n*=m,i*=m,s.push(_-n,p-i,u,h,d,c),s.push(_+n,p+i,u,h,d,c),o=1;T-1>o;o++)_=t[2*(o-1)],p=t[2*(o-1)+1],a=t[2*o],r=t[2*o+1],A=t[2*(o+1)],S=t[2*(o+1)+1],n=-(p-r),i=_-a,l=Math.sqrt(n*n+i*i),n/=l,i/=l,n*=m,i*=m,g=-(r-S),f=a-A,l=Math.sqrt(g*g+f*f),g/=l,f/=l,g*=m,f*=m,z=-i+p-(-i+r),P=-n+a-(-n+_),M=(-n+_)*(-i+r)-(-n+a)*(-i+p),R=-f+S-(-f+r),O=-g+a-(-g+A),L=(-g+A)*(-f+r)-(-g+a)*(-f+S),C=z*O-R*P,Math.abs(C)<.1?(C+=10.1,s.push(a-n,r-i,u,h,d,c),s.push(a+n,r+i,u,h,d,c)):(E=(P*L-O*M)/C,b=(R*M-z*L)/C,G=(E-a)*(E-a)+(b-r)+(b-r),G>19600?(v=n-g,y=i-f,l=Math.sqrt(v*v+y*y),v/=l,y/=l,v*=m,y*=m,s.push(a-v,r-y),s.push(u,h,d,c),s.push(a+v,r+y),s.push(u,h,d,c),s.push(a-v,r-y),s.push(u,h,d,c),F++):(s.push(E,b),s.push(u,h,d,c),s.push(a-(E-a),r-(b-r)),s.push(u,h,d,c)));for(_=t[2*(T-2)],p=t[2*(T-2)+1],a=t[2*(T-1)],r=t[2*(T-1)+1],n=-(p-r),i=_-a,l=Math.sqrt(n*n+i*i),n/=l,i/=l,n*=m,i*=m,s.push(a-n,r-i),s.push(u,h,d,c),s.push(a+n,r+i),s.push(u,h,d,c),I.push(D),o=0;F>o;o++)I.push(D++);I.push(D-1)}},e.WebGLGraphics.buildComplexPoly=function(h,c){var i=h.points.slice();if(!(i.length<6)){var u=c.indices;c.points=i,c.alpha=h.fillAlpha,c.color=e.hex2rgb(h.fillColor);for(var r,a,n=1/0,s=-1/0,o=1/0,l=-1/0,t=0;t<i.length;t+=2)r=i[t],a=i[t+1],n=n>r?r:n,s=r>s?r:s,o=o>a?a:o,l=a>l?a:l;i.push(n,o,s,o,s,l,n,l);var d=i.length/2;for(t=0;d>t;t++)u.push(t)}},e.WebGLGraphics.buildPoly=function(l,c){var n=l.points;if(!(n.length<6)){var h=c.points,a=c.indices,f=n.length/2,o=e.hex2rgb(l.fillColor),s=l.fillAlpha,u=o[0]*s,d=o[1]*s,p=o[2]*s,i=e.PolyK.Triangulate(n),r=h.length/6,t=0;for(t=0;t<i.length;t+=3)a.push(i[t]+r),a.push(i[t]+r),a.push(i[t+1]+r),a.push(i[t+2]+r),a.push(i[t+2]+r);for(t=0;f>t;t++)h.push(n[2*t],n[2*t+1],u,d,p,s)}},e.WebGLGraphics.graphicsDataPool=[],e.WebGLGraphicsData=function(e){this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.lastIndex=0,this.buffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},e.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[],this.lastIndex=0},e.WebGLGraphicsData.prototype.upload=function(){var e=this.gl;this.glPoints=new Float32Array(this.points),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.glPoints,e.STATIC_DRAW),this.glIndicies=new Uint16Array(this.indices),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.glIndicies,e.STATIC_DRAW),this.dirty=!1},e.glContexts=[],e.WebGLRenderer=function(r,a,i){if(i)for(var n in e.defaultRenderOptions)"undefined"==typeof i[n]&&(i[n]=e.defaultRenderOptions[n]);else i=e.defaultRenderOptions;this.type=e.WEBGL_RENDERER,this.resolution=i.resolution,this.transparent=i.transparent,this.preserveDrawingBuffer=i.preserveDrawingBuffer,this.clearBeforeRender=i.clearBeforeRender,this.width=r||800,this.height=a||600,this.view=i.view||document.createElement("canvas"),this.contextLost=this.handleContextLost.bind(this),this.contextRestoredLost=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLost,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredLost,!1),this.contextOptions={alpha:this.transparent,antialias:i.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer};var t=null;if(["experimental-webgl","webgl"].forEach(function(e){try{t=t||this.view.getContext(e,this.contextOptions)}catch(i){}},this),!t)throw new Error("This browser does not support webGL. Try using the canvas renderer"+this);this.gl=t,this.glContextId=t.id=e.WebGLRenderer.glContextId++,e.glContexts[this.glContextId]=t,e.blendModesWebGL||(e.blendModesWebGL=[],e.blendModesWebGL[e.blendModes.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.ADD]=[t.SRC_ALPHA,t.DST_ALPHA],e.blendModesWebGL[e.blendModes.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SCREEN]=[t.SRC_ALPHA,t.ONE],e.blendModesWebGL[e.blendModes.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA]),this.projection=new e.Point,this.offset=new e.Point(0,0),this.resize(r,a),this.contextLost=!1,this.shaderManager=new e.WebGLShaderManager(t),this.spriteBatch=new e.WebGLSpriteBatch(t),this.maskManager=new e.WebGLMaskManager(t),this.filterManager=new e.WebGLFilterManager(t,this.transparent),this.stencilManager=new e.WebGLStencilManager(t),this.blendModeManager=new e.WebGLBlendModeManager(t),this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,this.renderSession.renderer=this,this.renderSession.resolution=this.resolution,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,this.transparent)},e.WebGLRenderer.prototype.constructor=e.WebGLRenderer,e.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(t.interactive&&t.interactionManager.removeEvents(),this.__stage=t),e.WebGLRenderer.updateTextures(),t.updateTransform(),t._interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)));var i=this.gl;i.viewport(0,0,this.width,this.height),i.bindFramebuffer(i.FRAMEBUFFER,null),this.clearBeforeRender&&(this.transparent?i.clearColor(0,0,0,0):i.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],1),i.clear(i.COLOR_BUFFER_BIT)),this.renderDisplayObject(t,this.projection),t.interactive?t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)):t._interactiveEventsAdded&&(t._interactiveEventsAdded=!1,t.interactionManager.setTarget(this))}},e.WebGLRenderer.prototype.renderDisplayObject=function(t,i,n){this.renderSession.blendModeManager.setBlendMode(e.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.currentBlendMode=9999,this.renderSession.projection=i,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,n),t._renderWebGL(this.renderSession),this.spriteBatch.end()},e.WebGLRenderer.updateTextures=function(){var t=0;for(t=0;t<e.Texture.frameUpdates.length;t++)e.WebGLRenderer.updateTextureFrame(e.Texture.frameUpdates[t]);for(t=0;t<e.texturesToDestroy.length;t++)e.WebGLRenderer.destroyTexture(e.texturesToDestroy[t]);e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,e.Texture.frameUpdates.length=0},e.WebGLRenderer.destroyTexture=function(i){for(var t=i._glTextures.length-1;t>=0;t--){var n=i._glTextures[t],r=e.glContexts[t];r&&n&&r.deleteTexture(n)}i._glTextures.length=0},e.WebGLRenderer.updateTextureFrame=function(e){e._updateWebGLuvs()},e.WebGLRenderer.prototype.resize=function(e,t){this.width=e*this.resolution,this.height=t*this.resolution,this.view.width=this.width,this.view.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=-this.height/2/this.resolution},e.createWebGLTexture=function(i,t){return i.hasLoaded&&(i._glTextures[t.id]=t.createTexture(),t.bindTexture(t.TEXTURE_2D,i._glTextures[t.id]),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultipliedAlpha),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i.scaleMode===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i.scaleMode===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),i._powerOf2?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),t.bindTexture(t.TEXTURE_2D,null),i._dirty[t.id]=!1),i._glTextures[t.id]},e.updateWebGLTexture=function(i,t){i._glTextures[t.id]&&(t.bindTexture(t.TEXTURE_2D,i._glTextures[t.id]),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultipliedAlpha),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i.scaleMode===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i.scaleMode===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),i._powerOf2?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),i._dirty[t.id]=!1)},e.WebGLRenderer.prototype.handleContextLost=function(e){e.preventDefault(),this.contextLost=!0},e.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.contextOptions)}catch(r){try{this.gl=this.view.getContext("webgl",this.contextOptions)}catch(a){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}e.glContexts[this.glContextId]=null;var t=this.gl;this.glContextId=t.id=e.WebGLRenderer.glContextId++,e.glContexts[this.glContextId]=t,this.shaderManager.setContext(t),this.spriteBatch.setContext(t),this.maskManager.setContext(t),this.filterManager.setContext(t),this.renderSession.gl=this.gl,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,this.transparent),this.gl.viewport(0,0,this.width,this.height);for(var i in e.TextureCache){var n=e.TextureCache[i].baseTexture;n._glTextures=[]}"object"==typeof this.contextLost&&this.view.removeEventListener("webglcontextlost",this.contextLost),this.contextLost=!1},e.WebGLRenderer.prototype.destroy=function(){"object"==typeof this.contextLost&&this.view.removeEventListener("webglcontextlost",this.contextLost),this.view.removeEventListener("webglcontextrestored",this.contextRestoredLost),e.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null,this.view=null,this.__stage=null,this.contextRestoredLost=null,this.stencilManager=null,this.blendModeManager=null,this.contextOptions=null},e.WebGLRenderer.glContextId=0,e.WebGLBlendModeManager=function(e){this.gl=e,this.currentBlendMode=99999},e.WebGLBlendModeManager.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var i=e.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(i[0],i[1]),!0},e.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},e.WebGLMaskManager=function(e){this.setContext(e)},e.WebGLMaskManager.prototype.setContext=function(e){this.gl=e},e.WebGLMaskManager.prototype.pushMask=function(t,i){var n=i.gl;t.dirty&&e.WebGLGraphics.updateGraphics(t,n),t._webGL[n.id].data.length&&i.stencilManager.pushStencil(t,t._webGL[n.id].data[0],i)},e.WebGLMaskManager.prototype.popMask=function(e,t){var i=this.gl;t.stencilManager.popStencil(e,e._webGL[i.id].data[0],t)},e.WebGLMaskManager.prototype.destroy=function(){this.gl=null},e.WebGLStencilManager=function(e){this.stencilStack=[],this.setContext(e),this.reverse=!0,this.count=0},e.WebGLStencilManager.prototype.setContext=function(e){this.gl=e},e.WebGLStencilManager.prototype.pushStencil=function(n,i,r){var e=this.gl;this.bindGraphics(n,i,r),0===this.stencilStack.length&&(e.enable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(i);var t=this.count;e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.ALWAYS,0,255),e.stencilOp(e.KEEP,e.KEEP,e.INVERT),1===i.mode?(e.drawElements(e.TRIANGLE_FAN,i.indices.length-4,e.UNSIGNED_SHORT,0),this.reverse?(e.stencilFunc(e.EQUAL,255-t,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)):(e.stencilFunc(e.EQUAL,t,255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_SHORT,2*(i.indices.length-4)),this.reverse?e.stencilFunc(e.EQUAL,255-(t+1),255):e.stencilFunc(e.EQUAL,t+1,255),this.reverse=!this.reverse):(this.reverse?(e.stencilFunc(e.EQUAL,t,255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)):(e.stencilFunc(e.EQUAL,255-t,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)),e.drawElements(e.TRIANGLE_STRIP,i.indices.length,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,t+1,255):e.stencilFunc(e.EQUAL,255-(t+1),255)),e.colorMask(!0,!0,!0,!0),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),this.count++},e.WebGLStencilManager.prototype.bindGraphics=function(n,r,a){this._currentGraphics=n;var i,t=this.gl,s=a.projection,o=a.offset;1===r.mode?(i=a.shaderManager.complexPrimitiveShader,a.shaderManager.setShader(i),t.uniformMatrix3fv(i.translationMatrix,!1,n.worldTransform.toArray(!0)),t.uniform2f(i.projectionVector,s.x,-s.y),t.uniform2f(i.offsetVector,-o.x,-o.y),t.uniform3fv(i.tintColor,e.hex2rgb(n.tint)),t.uniform3fv(i.color,r.color),t.uniform1f(i.alpha,n.worldAlpha*r.alpha),t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,8,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.indexBuffer)):(i=a.shaderManager.primitiveShader,a.shaderManager.setShader(i),t.uniformMatrix3fv(i.translationMatrix,!1,n.worldTransform.toArray(!0)),t.uniform2f(i.projectionVector,s.x,-s.y),t.uniform2f(i.offsetVector,-o.x,-o.y),t.uniform3fv(i.tintColor,e.hex2rgb(n.tint)),t.uniform1f(i.alpha,n.worldAlpha),t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,24,0),t.vertexAttribPointer(i.colorAttribute,4,t.FLOAT,!1,24,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.indexBuffer))},e.WebGLStencilManager.prototype.popStencil=function(n,i,r){var e=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)e.disable(e.STENCIL_TEST);else{var t=this.count;this.bindGraphics(n,i,r),e.colorMask(!1,!1,!1,!1),1===i.mode?(this.reverse=!this.reverse,this.reverse?(e.stencilFunc(e.EQUAL,255-(t+1),255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)):(e.stencilFunc(e.EQUAL,t+1,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_SHORT,2*(i.indices.length-4)),e.stencilFunc(e.ALWAYS,0,255),e.stencilOp(e.KEEP,e.KEEP,e.INVERT),e.drawElements(e.TRIANGLE_FAN,i.indices.length-4,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,t,255):e.stencilFunc(e.EQUAL,255-t,255)):(this.reverse?(e.stencilFunc(e.EQUAL,t+1,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)):(e.stencilFunc(e.EQUAL,255-(t+1),255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)),e.drawElements(e.TRIANGLE_STRIP,i.indices.length,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,t,255):e.stencilFunc(e.EQUAL,255-t,255)),e.colorMask(!0,!0,!0,!0),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}},e.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null,this.gl=null},e.WebGLShaderManager=function(t){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)},e.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new e.PrimitiveShader(t),this.complexPrimitiveShader=new e.ComplexPrimitiveShader(t),this.defaultShader=new e.PixiShader(t),this.fastShader=new e.PixiFastShader(t),this.stripShader=new e.StripShader(t),this.setShader(this.defaultShader)},e.WebGLShaderManager.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var n=t[e];this.tempAttribState[n]=!0}var i=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?i.enableVertexAttribArray(e):i.disableVertexAttribArray(e))},e.WebGLShaderManager.prototype.setShader=function(e){return this._currentId===e._UID?!1:(this._currentId=e._UID,this.currentShader=e,this.gl.useProgram(e.program),this.setAttribs(e.attributes),!0)},e.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},e.WebGLSpriteBatch=function(n){this.vertSize=6,this.size=2e3;var r=4*this.size*this.vertSize,i=6*this.size;this.vertices=new Float32Array(r),this.indices=new Uint16Array(i),this.lastIndexCount=0;for(var e=0,t=0;i>e;e+=6,t+=4)this.indices[e+0]=t+0,this.indices[e+1]=t+1,this.indices[e+2]=t+2,this.indices[e+3]=t+0,this.indices[e+4]=t+2,this.indices[e+5]=t+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.setContext(n),this.dirty=!0,this.textures=[],this.blendModes=[]},e.WebGLSpriteBatch.prototype.setContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLSpriteBatch.prototype.begin=function(e){this.renderSession=e,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},e.WebGLSpriteBatch.prototype.end=function(){this.flush()},e.WebGLSpriteBatch.prototype.render=function(r){var i=r.texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=i.baseTexture);var n=i._uvs;if(n){var o,a,l,s,u=r.worldAlpha,p=r.tint,e=this.vertices,x=r.anchor.x,b=r.anchor.y;if(i.trim){var d=i.trim;a=d.x-x*d.width,o=a+i.crop.width,s=d.y-b*d.height,l=s+i.crop.height}else o=i.frame.width*(1-x),a=i.frame.width*-x,l=i.frame.height*(1-b),s=i.frame.height*-b;var t=4*this.currentBatchSize*this.vertSize,f=i.baseTexture.resolution,c=r.worldTransform,m=c.a/f,g=c.c/f,y=c.b/f,v=c.d/f,h=c.tx,_=c.ty;e[t++]=m*a+y*s+h,e[t++]=v*s+g*a+_,e[t++]=n.x0,e[t++]=n.y0,e[t++]=u,e[t++]=p,e[t++]=m*o+y*s+h,e[t++]=v*s+g*o+_,e[t++]=n.x1,e[t++]=n.y1,e[t++]=u,e[t++]=p,e[t++]=m*o+y*l+h,e[t++]=v*l+g*o+_,e[t++]=n.x2,e[t++]=n.y2,e[t++]=u,e[t++]=p,e[t++]=m*a+y*l+h,e[t++]=v*l+g*a+_,e[t++]=n.x3,e[t++]=n.y3,e[t++]=u,e[t++]=p,this.textures[this.currentBatchSize]=r.texture.baseTexture,this.blendModes[this.currentBatchSize]=r.blendMode,this.currentBatchSize++}},e.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var a=t.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=a.baseTexture),t._uvs||(t._uvs=new e.TextureUvs);var r=t._uvs;t.tilePosition.x%=a.baseTexture.width*t.tileScaleOffset.x,t.tilePosition.y%=a.baseTexture.height*t.tileScaleOffset.y;var f=t.tilePosition.x/(a.baseTexture.width*t.tileScaleOffset.x),v=t.tilePosition.y/(a.baseTexture.height*t.tileScaleOffset.y),S=t.width/a.baseTexture.width/(t.tileScale.x*t.tileScaleOffset.x),C=t.height/a.baseTexture.height/(t.tileScale.y*t.tileScaleOffset.y);r.x0=0-f,r.y0=0-v,r.x1=1*S-f,r.y1=0-v,r.x2=1*S-f,r.y2=1*C-v,r.x3=0-f,r.y3=1*C-v;var l=t.worldAlpha,c=t.tint,i=this.vertices,E=t.width,T=t.height,w=t.anchor.x,k=t.anchor.y,_=E*(1-w),m=E*-w,g=T*(1-k),y=T*-k,n=4*this.currentBatchSize*this.vertSize,x=a.baseTexture.resolution,s=t.worldTransform,p=s.a/x,d=s.c/x,u=s.b/x,o=s.d/x,b=s.tx,h=s.ty;i[n++]=p*m+u*y+b,i[n++]=o*y+d*m+h,i[n++]=r.x0,i[n++]=r.y0,i[n++]=l,i[n++]=c,i[n++]=p*_+u*y+b,i[n++]=o*y+d*_+h,i[n++]=r.x1,i[n++]=r.y1,i[n++]=l,i[n++]=c,i[n++]=p*_+u*g+b,i[n++]=o*g+d*_+h,i[n++]=r.x2,i[n++]=r.y2,i[n++]=l,i[n++]=c,i[n++]=p*m+u*g+b,i[n++]=o*g+d*m+h,i[n++]=r.x3,i[n++]=r.y3,i[n++]=l,i[n++]=c,this.textures[this.currentBatchSize]=a.baseTexture,this.blendModes[this.currentBatchSize]=t.blendMode,this.currentBatchSize++},e.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var e=this.gl;if(this.renderSession.shaderManager.setShader(this.renderSession.shaderManager.defaultShader),this.dirty){this.dirty=!1,e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var c=this.renderSession.projection;e.uniform2f(this.shader.projectionVector,c.x,c.y);var l=4*this.vertSize;e.vertexAttribPointer(this.shader.aVertexPosition,2,e.FLOAT,!1,l,0),e.vertexAttribPointer(this.shader.aTextureCoord,2,e.FLOAT,!1,l,8),e.vertexAttribPointer(this.shader.colorAttribute,2,e.FLOAT,!1,l,16)}if(this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var h=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);e.bufferSubData(e.ARRAY_BUFFER,0,h)}for(var r,a,i=0,s=0,n=null,o=this.renderSession.blendModeManager.currentBlendMode,t=0,u=this.currentBatchSize;u>t;t++)r=this.textures[t],a=this.blendModes[t],(n!==r||o!==a)&&(this.renderBatch(n,i,s),s=t,i=0,n=r,o=a,this.renderSession.blendModeManager.setBlendMode(o)),i++;this.renderBatch(n,i,s),this.currentBatchSize=0}},e.WebGLSpriteBatch.prototype.renderBatch=function(i,n,r){if(0!==n){var t=this.gl;t.bindTexture(t.TEXTURE_2D,i._glTextures[t.id]||e.createWebGLTexture(i,t)),i._dirty[t.id]&&e.updateWebGLTexture(this.currentBaseTexture,t),t.drawElements(t.TRIANGLES,6*n,t.UNSIGNED_SHORT,6*r*2),this.renderSession.drawCount++}},e.WebGLSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},e.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},e.WebGLFastSpriteBatch=function(n){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var r=4*this.size*this.vertSize,i=6*this.maxSize;this.vertices=new Float32Array(r),this.indices=new Uint16Array(i),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var e=0,t=0;i>e;e+=6,t+=4)this.indices[e+0]=t+0,this.indices[e+1]=t+1,this.indices[e+2]=t+2,this.indices[e+3]=t+0,this.indices[e+4]=t+2,this.indices[e+5]=t+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(n)},e.WebGLFastSpriteBatch.prototype.setContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW)},e.WebGLFastSpriteBatch.prototype.begin=function(e,t){this.renderSession=t,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=e.worldTransform.toArray(!0),this.start()},e.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.render=function(n){var t=n.children,e=t[0];if(e.texture._uvs){this.currentBaseTexture=e.texture.baseTexture,e.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(e.blendMode));for(var i=0,r=t.length;r>i;i++)this.renderSprite(t[i]);this.flush()}},e.WebGLFastSpriteBatch.prototype.renderSprite=function(e){if(e.visible&&(e.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=e.texture.baseTexture,e.texture._uvs))){var n,h,c,o,a,s,r,t,i=this.vertices;if(n=e.texture._uvs,h=e.texture.frame.width,c=e.texture.frame.height,e.texture.trim){var l=e.texture.trim;a=l.x-e.anchor.x*l.width,o=a+e.texture.crop.width,r=l.y-e.anchor.y*l.height,s=r+e.texture.crop.height}else o=e.texture.frame.width*(1-e.anchor.x),a=e.texture.frame.width*-e.anchor.x,s=e.texture.frame.height*(1-e.anchor.y),r=e.texture.frame.height*-e.anchor.y;t=4*this.currentBatchSize*this.vertSize,i[t++]=a,i[t++]=r,i[t++]=e.position.x,i[t++]=e.position.y,i[t++]=e.scale.x,i[t++]=e.scale.y,i[t++]=e.rotation,i[t++]=n.x0,i[t++]=n.y1,i[t++]=e.alpha,i[t++]=o,i[t++]=r,i[t++]=e.position.x,i[t++]=e.position.y,i[t++]=e.scale.x,i[t++]=e.scale.y,i[t++]=e.rotation,i[t++]=n.x1,i[t++]=n.y1,i[t++]=e.alpha,i[t++]=o,i[t++]=s,i[t++]=e.position.x,i[t++]=e.position.y,i[t++]=e.scale.x,i[t++]=e.scale.y,i[t++]=e.rotation,i[t++]=n.x2,i[t++]=n.y2,i[t++]=e.alpha,i[t++]=a,i[t++]=s,i[t++]=e.position.x,i[t++]=e.position.y,i[t++]=e.scale.x,i[t++]=e.scale.y,i[t++]=e.rotation,i[t++]=n.x3,i[t++]=n.y3,i[t++]=e.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},e.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(this.currentBaseTexture._glTextures[t.id]||e.createWebGLTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var i=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,i)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.start=function(){var e=this.gl;e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var i=this.renderSession.projection;e.uniform2f(this.shader.projectionVector,i.x,i.y),e.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var t=4*this.vertSize;e.vertexAttribPointer(this.shader.aVertexPosition,2,e.FLOAT,!1,t,0),e.vertexAttribPointer(this.shader.aPositionCoord,2,e.FLOAT,!1,t,8),e.vertexAttribPointer(this.shader.aScale,2,e.FLOAT,!1,t,16),e.vertexAttribPointer(this.shader.aRotation,1,e.FLOAT,!1,t,24),e.vertexAttribPointer(this.shader.aTextureCoord,2,e.FLOAT,!1,t,28),e.vertexAttribPointer(this.shader.colorAttribute,1,e.FLOAT,!1,t,36)},e.WebGLFilterManager=function(e,t){this.transparent=t,this.filterStack=[],this.offsetX=0,this.offsetY=0,this.setContext(e)},e.WebGLFilterManager.prototype.setContext=function(e){this.gl=e,this.texturePool=[],this.initShaderBuffers()},e.WebGLFilterManager.prototype.begin=function(e,i){this.renderSession=e,this.defaultShader=e.shaderManager.defaultShader;var t=this.renderSession.projection;this.width=2*t.x,this.height=2*-t.y,this.buffer=i},e.WebGLFilterManager.prototype.pushFilter=function(n){var i=this.gl,s=this.renderSession.projection,o=this.renderSession.offset;n._filterArea=n.target.filterArea||n.target.getBounds(),this.filterStack.push(n);var l=n.filterPasses[0];this.offsetX+=n._filterArea.x,this.offsetY+=n._filterArea.y;var r=this.texturePool.pop();r?r.resize(this.width,this.height):r=new e.FilterTexture(this.gl,this.width,this.height),i.bindTexture(i.TEXTURE_2D,r.texture);var t=n._filterArea,a=l.padding;t.x-=a,t.y-=a,t.width+=2*a,t.height+=2*a,t.x<0&&(t.x=0),t.width>this.width&&(t.width=this.width),t.y<0&&(t.y=0),t.height>this.height&&(t.height=this.height),i.bindFramebuffer(i.FRAMEBUFFER,r.frameBuffer),i.viewport(0,0,t.width,t.height),s.x=t.width/2,s.y=-t.height/2,o.x=-t.x,o.y=-t.y,this.renderSession.shaderManager.setShader(this.defaultShader),i.uniform2f(this.defaultShader.projectionVector,t.width/2,-t.height/2),i.uniform2f(this.defaultShader.offsetVector,-t.x,-t.y),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),n._glFilterTexture=r},e.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,n=this.filterStack.pop(),i=n._filterArea,h=n._glFilterTexture,g=this.renderSession.projection,f=this.renderSession.offset;if(n.filterPasses.length>1){t.viewport(0,0,i.width,i.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=i.height,this.vertexArray[2]=i.width,this.vertexArray[3]=i.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=i.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var o=h,r=this.texturePool.pop();r||(r=new e.FilterTexture(this.gl,this.width,this.height)),r.resize(this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,r.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var p=0;p<n.filterPasses.length-1;p++){var v=n.filterPasses[p];t.bindFramebuffer(t.FRAMEBUFFER,r.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,o.texture),this.applyFilterPass(v,i,i.width,i.height);var x=o;o=r,r=x}t.enable(t.BLEND),h=o,this.texturePool.push(r)}var y=n.filterPasses[n.filterPasses.length-1];this.offsetX-=i.x,this.offsetY-=i.y;var s=this.width,a=this.height,c=0,d=0,_=this.buffer;if(0===this.filterStack.length)t.colorMask(!0,!0,!0,!0);else{var m=this.filterStack[this.filterStack.length-1];i=m._filterArea,s=i.width,a=i.height,c=i.x,d=i.y,_=m._glFilterTexture.frameBuffer}g.x=s/2,g.y=-a/2,f.x=c,f.y=d,i=n._filterArea;var u=i.x-c,l=i.y-d;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=u,this.vertexArray[1]=l+i.height,this.vertexArray[2]=u+i.width,this.vertexArray[3]=l+i.height,this.vertexArray[4]=u,this.vertexArray[5]=l,this.vertexArray[6]=u+i.width,this.vertexArray[7]=l,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,s,a),t.bindFramebuffer(t.FRAMEBUFFER,_),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,h.texture),this.applyFilterPass(y,i,s,a),this.renderSession.shaderManager.setShader(this.defaultShader),t.uniform2f(this.defaultShader.projectionVector,s/2,-a/2),t.uniform2f(this.defaultShader.offsetVector,-c,-d),this.texturePool.push(h),n._glFilterTexture=null},e.WebGLFilterManager.prototype.applyFilterPass=function(n,s,r,a){var t=this.gl,i=n.shaders[t.id];i||(i=new e.PixiShader(t),i.fragmentSrc=n.fragmentSrc,i.uniforms=n.uniforms,i.init(),n.shaders[t.id]=i),this.renderSession.shaderManager.setShader(i),t.uniform2f(i.projectionVector,r/2,-a/2),t.uniform2f(i.offsetVector,0,0),n.uniforms.dimensions&&(n.uniforms.dimensions.value[0]=this.width,n.uniforms.dimensions.value[1]=this.height,n.uniforms.dimensions.value[2]=this.vertexArray[0],n.uniforms.dimensions.value[3]=this.vertexArray[5]),i.syncUniforms(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.vertexAttribPointer(i.aTextureCoord,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.vertexAttribPointer(i.colorAttribute,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),this.renderSession.drawCount++},e.WebGLFilterManager.prototype.initShaderBuffers=function(){var e=this.gl;this.vertexBuffer=e.createBuffer(),this.uvBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW),this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvArray,e.STATIC_DRAW),this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),e.STATIC_DRAW)},e.WebGLFilterManager.prototype.destroy=function(){var e=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null,e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.uvBuffer),e.deleteBuffer(this.colorBuffer),e.deleteBuffer(this.indexBuffer)},e.FilterTexture=function(t,n,r,i){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),i=i||e.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(n,r)},e.FilterTexture.prototype.clear=function(){var e=this.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},e.FilterTexture.prototype.resize=function(t,i){if(this.width!==t||this.height!==i){this.width=t,this.height=i;var e=this.gl;e.bindTexture(e.TEXTURE_2D,this.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindRenderbuffer(e.RENDERBUFFER,this.renderBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t,i)}},e.FilterTexture.prototype.destroy=function(){var e=this.gl;e.deleteFramebuffer(this.frameBuffer),e.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},e.CanvasMaskManager=function(){},e.CanvasMaskManager.prototype.pushMask=function(n,a){var r=a.context;r.save();var s=n.alpha,t=n.worldTransform,i=a.resolution;r.setTransform(t.a*i,t.c*i,t.b*i,t.d*i,t.tx*i,t.ty*i),e.CanvasGraphics.renderGraphicsMask(n,r),r.clip(),n.worldAlpha=s},e.CanvasMaskManager.prototype.popMask=function(e){e.context.restore()},e.CanvasTinter=function(){},e.CanvasTinter.getTintedTexture=function(s,i){var t=s.texture;i=e.CanvasTinter.roundColor(i);var n="#"+("00000"+(0|i).toString(16)).substr(-6);if(t.tintCache=t.tintCache||{},t.tintCache[n])return t.tintCache[n];var r=e.CanvasTinter.canvas||document.createElement("canvas");if(e.CanvasTinter.tintMethod(t,i,r),e.CanvasTinter.convertTintToImage){var a=new Image;a.src=r.toDataURL(),t.tintCache[n]=a}else t.tintCache[n]=r,e.CanvasTinter.canvas=null;return r},e.CanvasTinter.tintWithMultiply=function(i,r,n){var t=n.getContext("2d"),e=i.crop;n.width=e.width,n.height=e.height,t.fillStyle="#"+("00000"+(0|r).toString(16)).substr(-6),t.fillRect(0,0,e.width,e.height),t.globalCompositeOperation="multiply",t.drawImage(i.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height),t.globalCompositeOperation="destination-atop",t.drawImage(i.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.CanvasTinter.tintWithOverlay=function(n,r,i){var t=i.getContext("2d"),e=n.crop;i.width=e.width,i.height=e.height,t.globalCompositeOperation="copy",t.fillStyle="#"+("00000"+(0|r).toString(16)).substr(-6),t.fillRect(0,0,e.width,e.height),t.globalCompositeOperation="destination-atop",t.drawImage(n.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.CanvasTinter.tintWithPerPixel=function(o,u,a){var n=a.getContext("2d"),t=o.crop;a.width=t.width,a.height=t.height,n.globalCompositeOperation="copy",n.drawImage(o.baseTexture.source,t.x,t.y,t.width,t.height,0,0,t.width,t.height);for(var s=e.hex2rgb(u),d=s[0],h=s[1],c=s[2],l=n.getImageData(0,0,t.width,t.height),r=l.data,i=0;i<r.length;i+=4)r[i+0]*=d,r[i+1]*=h,r[i+2]*=c;n.putImageData(l,0,0)},e.CanvasTinter.roundColor=function(n){var i=e.CanvasTinter.cacheStepsPerColorChannel,t=e.hex2rgb(n);return t[0]=Math.min(255,t[0]/i*i),t[1]=Math.min(255,t[1]/i*i),t[2]=Math.min(255,t[2]/i*i),e.rgb2hex(t)},e.CanvasTinter.cacheStepsPerColorChannel=8,e.CanvasTinter.convertTintToImage=!1,e.CanvasTinter.canUseMultiply=e.canUseNewCanvasBlendModes(),e.CanvasTinter.tintMethod=e.CanvasTinter.canUseMultiply?e.CanvasTinter.tintWithMultiply:e.CanvasTinter.tintWithPerPixel,e.CanvasRenderer=function(n,r,t){if(t)for(var i in e.defaultRenderOptions)"undefined"==typeof t[i]&&(t[i]=e.defaultRenderOptions[i]);else t=e.defaultRenderOptions;this.type=e.CANVAS_RENDERER,this.resolution=t.resolution,this.clearBeforeRender=t.clearBeforeRender,this.transparent=t.transparent,e.blendModesCanvas||(e.blendModesCanvas=[],e.canUseNewCanvasBlendModes()?(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="multiply",e.blendModesCanvas[e.blendModes.SCREEN]="screen",e.blendModesCanvas[e.blendModes.OVERLAY]="overlay",e.blendModesCanvas[e.blendModes.DARKEN]="darken",e.blendModesCanvas[e.blendModes.LIGHTEN]="lighten",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="color-dodge",e.blendModesCanvas[e.blendModes.COLOR_BURN]="color-burn",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="hard-light",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="soft-light",e.blendModesCanvas[e.blendModes.DIFFERENCE]="difference",e.blendModesCanvas[e.blendModes.EXCLUSION]="exclusion",e.blendModesCanvas[e.blendModes.HUE]="hue",e.blendModesCanvas[e.blendModes.SATURATION]="saturation",e.blendModesCanvas[e.blendModes.COLOR]="color",e.blendModesCanvas[e.blendModes.LUMINOSITY]="luminosity"):(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="source-over",e.blendModesCanvas[e.blendModes.SCREEN]="source-over",e.blendModesCanvas[e.blendModes.OVERLAY]="source-over",e.blendModesCanvas[e.blendModes.DARKEN]="source-over",e.blendModesCanvas[e.blendModes.LIGHTEN]="source-over",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="source-over",e.blendModesCanvas[e.blendModes.COLOR_BURN]="source-over",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.DIFFERENCE]="source-over",e.blendModesCanvas[e.blendModes.EXCLUSION]="source-over",e.blendModesCanvas[e.blendModes.HUE]="source-over",e.blendModesCanvas[e.blendModes.SATURATION]="source-over",e.blendModesCanvas[e.blendModes.COLOR]="source-over",e.blendModesCanvas[e.blendModes.LUMINOSITY]="source-over")),this.width=n||800,this.height=r||600,this.width*=this.resolution,this.height*=this.resolution,this.view=t.view||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width*this.resolution,this.view.height=this.height*this.resolution,this.count=0,this.maskManager=new e.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1},this.resize(n,r),"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="msImageSmoothingEnabled")},e.CanvasRenderer.prototype.constructor=e.CanvasRenderer,e.CanvasRenderer.prototype.render=function(t){e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent||(this.context.fillStyle=t.backgroundColorString),this.context[this.transparent?"clearRect":"fillRect"](0,0,this.width,this.height)),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),e.Texture.frameUpdates.length>0&&(e.Texture.frameUpdates.length=0)},e.CanvasRenderer.prototype.resize=function(e,t){this.width=e*this.resolution,this.height=t*this.resolution,this.view.width=this.width,this.view.height=this.height},e.CanvasRenderer.prototype.renderDisplayObject=function(e,t){this.renderSession.context=t||this.context,this.renderSession.resolution=this.resolution,e._renderCanvas(this.renderSession)},e.CanvasRenderer.prototype.renderStripFlat=function(s){var t=this.context,e=s.verticies,a=e.length/2;this.count++,t.beginPath();for(var n=1;a-2>n;n++){var i=2*n,r=e[i],o=e[i+2],l=e[i+4],c=e[i+1],h=e[i+3],u=e[i+5];t.moveTo(r,c),t.lineTo(o,h),t.lineTo(l,u)}t.fillStyle="#FF0000",t.fill(),t.closePath()},e.CanvasRenderer.prototype.renderStrip=function(l){var o=this.context,f=l.verticies,m=l.uvs,v=f.length/2;this.count++;for(var y=1;v-2>y;y++){var e=2*y,p=f[e],d=f[e+2],c=f[e+4],_=f[e+1],h=f[e+3],u=f[e+5],t=m[e]*l.texture.width,s=m[e+2]*l.texture.width,a=m[e+4]*l.texture.width,r=m[e+1]*l.texture.height,n=m[e+3]*l.texture.height,i=m[e+5]*l.texture.height;o.save(),o.beginPath(),o.moveTo(p,_),o.lineTo(d,h),o.lineTo(c,u),o.closePath(),o.clip();var g=t*n+r*a+s*i-n*a-r*s-t*i,x=p*n+r*c+d*i-n*c-r*d-p*i,b=t*d+p*a+s*c-d*a-p*s-t*c,w=t*n*c+r*d*a+p*s*i-p*n*a-r*s*c-t*d*i,T=_*n+r*u+h*i-n*u-r*h-_*i,E=t*h+_*a+s*u-h*a-_*s-t*u,C=t*n*u+r*h*a+_*s*i-_*n*a-r*s*u-t*h*i;o.transform(x/g,T/g,b/g,E/g,w/g,C/g),o.drawImage(l.texture.baseTexture.source,0,0),o.restore()}},e.CanvasBuffer=function(e,t){this.width=e,this.height=t,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=e,this.canvas.height=t},e.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.CanvasBuffer.prototype.resize=function(e,t){this.width=this.canvas.width=e,this.height=this.canvas.height=t},e.CanvasGraphics=function(){},e.CanvasGraphics.renderGraphics=function(b,t){for(var o=b.worldAlpha,p="",T=0;T<b.graphicsData.length;T++){var i=b.graphicsData[T],n=i.points;if(t.strokeStyle=p="#"+("00000"+(0|i.lineColor).toString(16)).substr(-6),t.lineWidth=i.lineWidth,i.type===e.Graphics.POLY){t.beginPath(),t.moveTo(n[0],n[1]);for(var g=1;g<n.length/2;g++)t.lineTo(n[2*g],n[2*g+1]);n[0]===n[n.length-2]&&n[1]===n[n.length-1]&&t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.stroke())}else if(i.type===e.Graphics.RECT)(i.fillColor||0===i.fillColor)&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fillRect(n[0],n[1],n[2],n[3])),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.strokeRect(n[0],n[1],n[2],n[3]));else if(i.type===e.Graphics.CIRC)t.beginPath(),t.arc(n[0],n[1],n[2],0,2*Math.PI),t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.stroke());else if(i.type===e.Graphics.ELIP){var _=i.points,v=2*_[2],m=2*_[3],u=_[0]-v/2,f=_[1]-m/2;t.beginPath();var S=.5522848,y=v/2*S,x=m/2*S,E=u+v,w=f+m,d=u+v/2,c=f+m/2;t.moveTo(u,c),t.bezierCurveTo(u,c-x,d-y,f,d,f),t.bezierCurveTo(d+y,f,E,c-x,E,c),t.bezierCurveTo(E,c+x,d+y,w,d,w),t.bezierCurveTo(d-y,w,u,c+x,u,c),t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.stroke())}else if(i.type===e.Graphics.RREC){var a=n[0],r=n[1],h=n[2],l=n[3],s=n[4],C=Math.min(h,l)/2|0;s=s>C?C:s,t.beginPath(),t.moveTo(a,r+s),t.lineTo(a,r+l-s),t.quadraticCurveTo(a,r+l,a+s,r+l),t.lineTo(a+h-s,r+l),t.quadraticCurveTo(a+h,r+l,a+h,r+l-s),t.lineTo(a+h,r+s),t.quadraticCurveTo(a+h,r,a+h-s,r),t.lineTo(a+s,r),t.quadraticCurveTo(a,r,a,r+s),t.closePath(),(i.fillColor||0===i.fillColor)&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.stroke())}}},e.CanvasGraphics.renderGraphicsMask=function(E,t){var b=E.graphicsData.length;if(0!==b){b>1&&(b=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var x=0;1>x;x++){var l=E.graphicsData[x],i=l.points;if(l.type===e.Graphics.POLY){t.beginPath(),t.moveTo(i[0],i[1]);for(var f=1;f<i.length/2;f++)t.lineTo(i[2*f],i[2*f+1]);i[0]===i[i.length-2]&&i[1]===i[i.length-1]&&t.closePath()}else if(l.type===e.Graphics.RECT)t.beginPath(),t.rect(i[0],i[1],i[2],i[3]),t.closePath();else if(l.type===e.Graphics.CIRC)t.beginPath(),t.arc(i[0],i[1],i[2],0,2*Math.PI),t.closePath();else if(l.type===e.Graphics.ELIP){var p=l.points,g=2*p[2],_=2*p[3],h=p[0]-g/2,d=p[1]-_/2;t.beginPath();var T=.5522848,m=g/2*T,y=_/2*T,w=h+g,v=d+_,u=h+g/2,o=d+_/2;t.moveTo(h,o),t.bezierCurveTo(h,o-y,u-m,d,u,d),t.bezierCurveTo(u+m,d,w,o-y,w,o),t.bezierCurveTo(w,o+y,u+m,v,u,v),t.bezierCurveTo(u-m,v,h,o+y,h,o),t.closePath()}else if(l.type===e.Graphics.RREC){var r=i[0],n=i[1],c=i[2],s=i[3],a=i[4],C=Math.min(c,s)/2|0;a=a>C?C:a,t.beginPath(),t.moveTo(r,n+a),t.lineTo(r,n+s-a),t.quadraticCurveTo(r,n+s,r+a,n+s),t.lineTo(r+c-a,n+s),t.quadraticCurveTo(r+c,n+s,r+c,n+s-a),t.lineTo(r+c,n+a),t.quadraticCurveTo(r+c,n,r+c-a,n),t.lineTo(r+a,n),t.quadraticCurveTo(r,n,r,n+a),t.closePath()}}}},e.Graphics=function(){e.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.tint=16777215,this.blendMode=e.blendModes.NORMAL,this.currentPath={points:[]},this._webGL=[],this.isMask=!1,this.bounds=null,this.boundsPadding=10,this.dirty=!0},e.Graphics.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Graphics.prototype.constructor=e.Graphics,Object.defineProperty(e.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap=e,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),e.Graphics.prototype.lineStyle=function(t,i,n){return this.currentPath.points.length||this.graphicsData.pop(),this.lineWidth=t||0,this.lineColor=i||0,this.lineAlpha=arguments.length<3?1:n,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.moveTo=function(t,i){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.currentPath.points.push(t,i),this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.lineTo=function(e,t){return this.currentPath.points.push(e,t),this.dirty=!0,this},e.Graphics.prototype.quadraticCurveTo=function(i,s,u,h){0===this.currentPath.points.length&&this.moveTo(0,0);var r,a,c=20,t=this.currentPath.points;0===t.length&&this.moveTo(0,0);for(var o=t[t.length-2],l=t[t.length-1],e=0,n=1;c>=n;n++)e=n/c,r=o+(i-o)*e,a=l+(s-l)*e,t.push(r+(i+(u-i)*e-r)*e,a+(s+(h-s)*e-a)*e);return this.dirty=!0,this},e.Graphics.prototype.bezierCurveTo=function(m,c,_,d,u,h){0===this.currentPath.points.length&&this.moveTo(0,0);for(var t,r,a,n,s,l=20,i=this.currentPath.points,p=i[i.length-2],f=i[i.length-1],e=0,o=1;l>=o;o++)e=o/l,t=1-e,r=t*t,a=r*t,n=e*e,s=n*e,i.push(a*p+3*r*e*m+3*t*n*_+s*u,a*f+3*r*e*c+3*t*n*d+s*h);return this.dirty=!0,this},e.Graphics.prototype.arcTo=function(a,o,b,x,c){0===this.currentPath.points.length&&this.moveTo(a,o);var r=this.currentPath.points,v=r[r.length-2],y=r[r.length-1],t=y-o,e=v-a,n=x-o,i=b-a,u=Math.abs(t*i-e*n);if(1e-8>u||0===c)r.push(a,o);else{var p=t*t+e*e,m=n*n+i*i,_=t*n+e*i,s=c*Math.sqrt(p)/u,l=c*Math.sqrt(m)/u,f=s*_/p,g=l*_/m,d=s*i+l*e,h=s*n+l*t,w=e*(l+f),T=t*(l+f),E=i*(s+g),C=n*(s+g),S=Math.atan2(T-h,w-d),k=Math.atan2(C-h,E-d);this.arc(d+a,h+o,c,S,k,e*n>i*t)}return this.dirty=!0,this},e.Graphics.prototype.arc=function(g,u,r,e,i,s){var c=g+Math.cos(e)*r,_=u+Math.sin(e)*r,t=this.currentPath.points;if((0!==t.length&&t[t.length-2]!==c||t[t.length-1]!==_)&&(this.moveTo(c,_),t=this.currentPath.points),e===i)return this;!s&&e>=i?i+=2*Math.PI:s&&i>=e&&(e+=2*Math.PI);var o=s?-1*(e-i):i-e,h=Math.abs(o)/(2*Math.PI)*40;if(0===o)return this;for(var n=o/(2*h),b=2*n,p=Math.cos(n),f=Math.sin(n),l=h-1,x=l%1/l,a=0;l>=a;a++){var v=a+x*a,m=n+e+b*v,d=Math.cos(m),y=-Math.sin(m);t.push((p*d+f*y)*r+g,(p*-y+f*d)*r+u)}return this.dirty=!0,this},e.Graphics.prototype.drawPath=function(t){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath),this.currentPath.points=this.currentPath.points.concat(t),this.dirty=!0,this},e.Graphics.prototype.beginFill=function(e,t){return this.filling=!0,this.fillColor=e||0,this.fillAlpha=arguments.length<2?1:t,this},e.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.Graphics.prototype.drawRect=function(t,i,n,r){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,r],type:e.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawRoundedRect=function(t,i,n,r,a){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,r,a],type:e.Graphics.RREC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawCircle=function(i,n,t){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[i,n,t,t],type:e.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawEllipse=function(t,i,n,r){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,r],type:e.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this.bounds=null,this},e.Graphics.prototype.generateTexture=function(t,a){t=t||2;var i=this.getBounds(),n=new e.CanvasBuffer(i.width*t,i.height*t),r=e.Texture.fromCanvas(n.canvas,a);return r.baseTexture.resolution=t,n.context.scale(t,t),n.context.translate(-i.x,-i.y),e.CanvasGraphics.renderGraphics(this,n.context),r},e.Graphics.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return this.dirty&&(this._generateCachedSprite(),e.updateWebGLTexture(this._cachedSprite.texture.baseTexture,t.gl),this.dirty=!1),this._cachedSprite.alpha=this.alpha,void e.Sprite.prototype._renderWebGL.call(this._cachedSprite,t);if(t.spriteBatch.stop(),t.blendModeManager.setBlendMode(this.blendMode),this._mask&&t.maskManager.pushMask(this._mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode){t.spriteBatch.currentBlendMode=this.blendMode;var n=e.blendModesWebGL[t.spriteBatch.currentBlendMode];t.spriteBatch.gl.blendFunc(n[0],n[1])}if(e.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var i=0,r=this.children.length;r>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this.mask,t),t.drawCount++,t.spriteBatch.start()}},e.Graphics.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){var r=t.context,i=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,r.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t.context);var n=t.resolution;r.setTransform(i.a*n,i.c*n,i.b*n,i.d*n,i.tx*n,i.ty*n),e.CanvasGraphics.renderGraphics(this,r);for(var a=0,s=this.children.length;s>a;a++)this.children[a]._renderCanvas(t);this._mask&&t.maskManager.popMask(t.context)}},e.Graphics.prototype.getBounds=function(E){this.bounds||this.updateBounds();var b=this.bounds.x,u=this.bounds.width+this.bounds.x,x=this.bounds.y,v=this.bounds.height+this.bounds.y,r=E||this.worldTransform,y=r.a,o=r.c,f=r.b,l=r.d,c=r.tx,h=r.ty,w=y*u+f*v+c,T=l*v+o*u+h,d=y*b+f*v+c,p=l*v+o*b+h,s=y*b+f*x+c,_=l*x+o*b+h,m=y*u+f*x+c,g=l*x+o*u+h,n=w,i=T,t=w,e=T;t=t>d?d:t,t=t>s?s:t,t=t>m?m:t,e=e>p?p:e,e=e>_?_:e,e=e>g?g:e,n=d>n?d:n,n=s>n?s:n,n=m>n?m:n,i=p>i?p:i,i=_>i?_:i,i=g>i?g:i;var a=this._bounds;return a.x=t,a.width=n-t,a.y=e,a.height=i-e,a},e.Graphics.prototype.updateBounds=function(){for(var r,i,t,h,c,s=1/0,o=-1/0,a=1/0,l=-1/0,p=0;p<this.graphicsData.length;p++){var f=this.graphicsData[p],_=f.type,n=f.lineWidth;if(r=f.points,_===e.Graphics.RECT)i=r[0]-n/2,t=r[1]-n/2,h=r[2]+n,c=r[3]+n,s=s>i?i:s,o=i+h>o?i+h:o,a=a>t?t:a,l=t+c>l?t+c:l;else if(_===e.Graphics.CIRC||_===e.Graphics.ELIP)i=r[0],t=r[1],h=r[2]+n/2,c=r[3]+n/2,s=s>i-h?i-h:s,o=i+h>o?i+h:o,a=a>t-c?t-c:a,l=t+c>l?t+c:l;else for(var u=0;u<r.length;u+=2)i=r[u],t=r[u+1],s=s>i-n?i-n:s,o=i+n>o?i+n:o,a=a>t-n?t-n:a,l=t+n>l?t+n:l}var d=this.boundsPadding;this.bounds=new e.Rectangle(s-d,a-d,o-s+2*d,l-a+2*d)},e.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var i=new e.CanvasBuffer(t.width,t.height),n=e.Texture.fromCanvas(i.canvas);this._cachedSprite=new e.Sprite(n),this._cachedSprite.buffer=i,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._cachedSprite.buffer.context.translate(-t.x,-t.y),e.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},e.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},e.Graphics.POLY=0,e.Graphics.RECT=1,e.Graphics.CIRC=2,e.Graphics.ELIP=3,e.Graphics.RREC=4,e.Strip=function(t){e.DisplayObjectContainer.call(this),this.texture=t,this.uvs=new e.Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new e.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new e.Float32Array([1,1,1,1]),this.indices=new e.Uint16Array([0,1,2,3]),this.dirty=!0,this.padding=0},e.Strip.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Strip.prototype.constructor=e.Strip,e.Strip.prototype._renderWebGL=function(e){!this.visible||this.alpha<=0||(e.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(e),e.shaderManager.setShader(e.shaderManager.stripShader),this._renderStrip(e),e.spriteBatch.start())},e.Strip.prototype._initWebGL=function(t){var e=t.gl;this._vertexBuffer=e.createBuffer(),this._indexBuffer=e.createBuffer(),this._uvBuffer=e.createBuffer(),this._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.verticies,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)},e.Strip.prototype._renderStrip=function(n){var t=n.gl,r=n.projection,a=n.offset,i=n.shaderManager.stripShader;t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.uniformMatrix3fv(i.translationMatrix,!1,this.worldTransform.toArray(!0)),t.uniform2f(i.projectionVector,r.x,-r.y),t.uniform2f(i.offsetVector,-a.x,-a.y),t.uniform1f(i.alpha,1),this.dirty?(this.dirty=!1,t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.verticies,t.STATIC_DRAW),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.STATIC_DRAW),t.vertexAttribPointer(i.aTextureCoord,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture.baseTexture._glTextures[t.id]||e.createWebGLTexture(this.texture.baseTexture,t)),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)):(t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.verticies),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer),t.vertexAttribPointer(i.aTextureCoord,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture.baseTexture._glTextures[t.id]||e.createWebGLTexture(this.texture.baseTexture,t)),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),t.drawElements(t.TRIANGLE_STRIP,this.indices.length,t.UNSIGNED_SHORT,0)},e.Strip.prototype._renderCanvas=function(C){var n=C.context,i=this.worldTransform;C.roundPixels?n.setTransform(i.a,i.c,i.b,i.d,0|i.tx,0|i.ty):n.setTransform(i.a,i.c,i.b,i.d,i.tx,i.ty);var y=this,v=y.verticies,w=y.uvs,S=v.length/2;this.count++;for(var E=0;S-2>E;E++){var t=2*E,l=v[t],c=v[t+2],h=v[t+4],u=v[t+1],s=v[t+3],p=v[t+5];if(0===this.padding){var x=(l+c+h)/3,T=(u+s+p)/3,r=l-x,a=u-T,e=Math.sqrt(r*r+a*a);l=x+r/e*(e+3),u=T+a/e*(e+3),r=c-x,a=s-T,e=Math.sqrt(r*r+a*a),c=x+r/e*(e+3),s=T+a/e*(e+3),r=h-x,a=p-T,e=Math.sqrt(r*r+a*a),h=x+r/e*(e+3),p=T+a/e*(e+3)}var g=w[t]*y.texture.width,m=w[t+2]*y.texture.width,_=w[t+4]*y.texture.width,f=w[t+1]*y.texture.height,d=w[t+3]*y.texture.height,o=w[t+5]*y.texture.height;n.save(),n.beginPath(),n.moveTo(l,u),n.lineTo(c,s),n.lineTo(h,p),n.closePath(),n.clip();var b=g*d+f*_+m*o-d*_-f*m-g*o,k=l*d+f*h+c*o-d*h-f*c-l*o,A=g*c+l*_+m*h-c*_-l*m-g*h,M=g*d*h+f*c*_+l*m*o-l*d*_-f*m*h-g*c*o,R=u*d+f*p+s*o-d*p-f*s-u*o,L=g*s+u*_+m*p-s*_-u*m-g*p,P=g*d*p+f*s*_+u*m*o-u*d*_-f*m*p-g*s*o;n.transform(k/b,R/b,A/b,L/b,M/b,P/b),n.drawImage(y.texture.baseTexture.source,0,0),n.restore()}},e.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.Rope=function(i,t){e.Strip.call(this,i),this.points=t,this.verticies=new e.Float32Array(4*t.length),this.uvs=new e.Float32Array(4*t.length),this.colors=new e.Float32Array(2*t.length),this.indices=new e.Uint16Array(2*t.length),this.refresh()},e.Rope.prototype=Object.create(e.Strip.prototype),e.Rope.prototype.constructor=e.Rope,e.Rope.prototype.refresh=function(){var r=this.points;if(!(r.length<1)){var t=this.uvs,c=r[0],a=this.indices,s=this.colors;this.count-=.2,t[0]=0,t[1]=0,t[2]=0,t[3]=1,s[0]=1,s[1]=1,a[0]=0,a[1]=1;for(var o,e,n,l=r.length,i=1;l>i;i++)o=r[i],e=4*i,n=i/(l-1),i%2?(t[e]=n,t[e+1]=0,t[e+2]=n,t[e+3]=1):(t[e]=n,t[e+1]=0,t[e+2]=n,t[e+3]=1),e=2*i,s[e]=1,s[e+1]=1,e=2*i,a[e]=e,a[e+1]=e+1,c=o}},e.Rope.prototype.updateTransform=function(){var r=this.points;if(!(r.length<1)){var l,o=r[0],t={x:0,y:0};this.count-=.2;for(var n,a,u,c,h,s=this.verticies,d=r.length,i=0;d>i;i++)n=r[i],a=4*i,l=i<r.length-1?r[i+1]:n,t.y=-(l.x-o.x),t.x=l.y-o.y,u=10*(1-i/(d-1)),u>1&&(u=1),c=Math.sqrt(t.x*t.x+t.y*t.y),h=this.texture.height/2,t.x/=c,t.y/=c,t.x*=h,t.y*=h,s[a]=n.x+t.x,s[a+1]=n.y+t.y,s[a+2]=n.x-t.x,s[a+3]=n.y-t.y,o=n;e.DisplayObjectContainer.prototype.updateTransform.call(this)}},e.Rope.prototype.setTexture=function(e){this.texture=e},e.TilingSprite=function(t,i,n){e.Sprite.call(this,t),this._width=i||100,this._height=n||100,this.tileScale=new e.Point(1,1),this.tileScaleOffset=new e.Point(1,1),this.tilePosition=new e.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL},e.TilingSprite.prototype=Object.create(e.Sprite.prototype),e.TilingSprite.prototype.constructor=e.TilingSprite,Object.defineProperty(e.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}}),Object.defineProperty(e.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}}),e.TilingSprite.prototype.setTexture=function(e){this.texture!==e&&(this.texture=e,this.refreshTexture=!0,this.cachedTint=16777215)},e.TilingSprite.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha){var i,n;for(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(e.updateWebGLTexture(this.tilingTexture.baseTexture,t.gl),this.tilingTexture.needsUpdate=!1)):t.spriteBatch.renderTilingSprite(this),i=0,n=this.children.length;n>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this._mask,t),t.spriteBatch.start()}},e.TilingSprite.prototype._renderCanvas=function(i){if(this.visible!==!1&&0!==this.alpha){var t=i.context;this._mask&&i.maskManager.pushMask(this._mask,t),t.globalAlpha=this.worldAlpha;var o,l,r=this.worldTransform,a=i.resolution;if(t.setTransform(r.a*a,r.c*a,r.b*a,r.d*a,r.tx*a,r.ty*a),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=t.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==i.currentBlendMode&&(i.currentBlendMode=this.blendMode,t.globalCompositeOperation=e.blendModesCanvas[i.currentBlendMode]);var n=this.tilePosition,s=this.tileScale;for(n.x%=this.tilingTexture.baseTexture.width,n.y%=this.tilingTexture.baseTexture.height,t.scale(s.x,s.y),t.translate(n.x,n.y),t.fillStyle=this.__tilePattern,t.fillRect(-n.x+this.anchor.x*-this._width,-n.y+this.anchor.y*-this._height,this._width/s.x,this._height/s.y),t.scale(1/s.x,1/s.y),t.translate(-n.x,-n.y),this._mask&&i.maskManager.popMask(i.context),o=0,l=this.children.length;l>o;o++)this.children[o]._renderCanvas(i)}},e.TilingSprite.prototype.getBounds=function(){var C=this._width,E=this._height,p=C*(1-this.anchor.x),b=C*-this.anchor.x,w=E*(1-this.anchor.y),T=E*-this.anchor.y,a=this.worldTransform,o=a.a,l=a.c,c=a.b,h=a.d,u=a.tx,d=a.ty,s=o*b+c*T+u,f=h*T+l*b+d,_=o*p+c*T+u,m=h*T+l*p+d,g=o*p+c*w+u,y=h*w+l*p+d,v=o*b+c*w+u,x=h*w+l*b+d,i=-1/0,n=-1/0,t=1/0,e=1/0;t=t>s?s:t,t=t>_?_:t,t=t>g?g:t,t=t>v?v:t,e=e>f?f:e,e=e>m?m:e,e=e>y?y:e,e=e>x?x:e,i=s>i?s:i,i=_>i?_:i,i=g>i?g:i,i=v>i?v:i,n=f>n?f:n,n=m>n?m:n,n=y>n?y:n,n=x>n?x:n;var r=this._bounds;return r.x=t,r.width=i-t,r.y=e,r.height=n-e,this._currentBounds=r,r},e.TilingSprite.prototype.onTextureUpdate=function(){},e.TilingSprite.prototype.generateTilingTexture=function(o){if(this.texture.baseTexture.hasLoaded){var n,r,i=this.texture,t=i.frame,l=t.width!==i.baseTexture.width||t.height!==i.baseTexture.height,s=!1;if(o?(n=e.getNextPowerOfTwo(t.width),r=e.getNextPowerOfTwo(t.height),(t.width!==n||t.height!==r)&&(s=!0)):l&&(n=t.width,r=t.height,s=!0),s){var a;this.tilingTexture&&this.tilingTexture.isTiling?(a=this.tilingTexture.canvasBuffer,a.resize(n,r),this.tilingTexture.baseTexture.width=n,this.tilingTexture.baseTexture.height=r,this.tilingTexture.needsUpdate=!0):(a=new e.CanvasBuffer(n,r),this.tilingTexture=e.Texture.fromCanvas(a.canvas),this.tilingTexture.canvasBuffer=a,this.tilingTexture.isTiling=!0),a.context.drawImage(i.baseTexture.source,i.crop.x,i.crop.y,i.crop.width,i.crop.height,0,0,n,r),this.tileScaleOffset.x=t.width/n,this.tileScaleOffset.y=t.height/r}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=i;this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}};var t={};t.BoneData=function(e,t){this.name=e,this.parent=t},t.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},t.SlotData=function(e,t){this.name=e,this.boneData=t},t.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},t.Bone=function(e,t){this.data=e,this.parent=t,this.setToSetupPose()},t.Bone.yDown=!1,t.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(a,s){var e=this.parent;null!=e?(this.worldX=this.x*e.m00+this.y*e.m01+e.worldX,this.worldY=this.x*e.m10+this.y*e.m11+e.worldY,this.worldScaleX=e.worldScaleX*this.scaleX,this.worldScaleY=e.worldScaleY*this.scaleY,this.worldRotation=e.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var i=this.worldRotation*Math.PI/180,n=Math.cos(i),r=Math.sin(i);this.m00=n*this.worldScaleX,this.m10=r*this.worldScaleX,this.m01=-r*this.worldScaleY,this.m11=n*this.worldScaleY,a&&(this.m00=-this.m00,this.m01=-this.m01),s&&(this.m10=-this.m10,this.m11=-this.m11),t.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var e=this.data;this.x=e.x,this.y=e.y,this.rotation=e.rotation,this.scaleX=e.scaleX,this.scaleY=e.scaleY}},t.Slot=function(e,t,i){this.data=e,this.skeleton=t,this.bone=i,this.setToSetupPose()},t.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(e){this.attachment=e,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(e){this._attachmentTime=this.skeleton.time-e},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var e=this.data;this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a;for(var i=this.skeleton.data.slots,t=0,n=i.length;n>t;t++)if(i[t]==e){this.setAttachment(e.attachmentName?this.skeleton.getAttachmentBySlotIndex(t,e.attachmentName):null);break}}},t.Skin=function(e){this.name=e,this.attachments={}},t.Skin.prototype={addAttachment:function(e,t,i){this.attachments[e+":"+t]=i},getAttachment:function(e,t){return this.attachments[e+":"+t]},_attachAll:function(s,o){for(var e in o.attachments){var i=e.indexOf(":"),n=parseInt(e.substring(0,i),10),r=e.substring(i+1),t=s.slots[n];if(t.attachment&&t.attachment.name==r){var a=this.getAttachment(n,r);a&&t.setAttachment(a)}}}},t.Animation=function(e,t,i){this.name=e,this.timelines=t,this.duration=i},t.Animation.prototype={apply:function(n,t,r){r&&this.duration&&(t%=this.duration);for(var i=this.timelines,e=0,a=i.length;a>e;e++)i[e].apply(n,t,1)},mix:function(n,t,r,a){r&&this.duration&&(t%=this.duration);for(var i=this.timelines,e=0,s=i.length;s>e;e++)i[e].apply(n,t,a)}},t.binarySearch=function(r,a,t){var i=0,e=Math.floor(r.length/t)-2;if(!e)return t;for(var n=e>>>1;;){if(r[(n+1)*t]<=a?i=n+1:e=n,i==e)return(i+1)*t;n=i+e>>>1}},t.linearSearch=function(t,n,i){for(var e=0,r=t.length-i;r>=e;e+=i)if(t[e]>n)return e;return-1},t.Curves=function(e){this.curves=[],this.curves.length=6*(e-1)},t.Curves.prototype={setLinear:function(e){this.curves[6*e]=0},setStepped:function(e){this.curves[6*e]=-1},setCurve:function(g,o,r,u,f){var i=.1,a=i*i,s=a*i,_=3*i,m=3*a,h=6*a,n=6*s,d=2*-o+u,p=2*-r+f,l=3*(o-u)+1,c=3*(r-f)+1,t=6*g,e=this.curves;e[t]=o*_+d*m+l*s,e[t+1]=r*_+p*m+c*s,e[t+2]=d*h+l*n,e[t+3]=p*h+c*n,e[t+4]=l*n,e[t+5]=c*n},getCurvePercent:function(f,e){e=0>e?0:e>1?1:e;var t=6*f,i=this.curves,n=i[t];if(!n)return e;if(-1==n)return 0;for(var s=i[t+1],h=i[t+2],o=i[t+3],p=i[t+4],d=i[t+5],r=n,a=s,c=8;;){if(r>=e){var l=r-n,u=a-s;return u+(a-u)*(e-l)/(r-l)}if(!c)break;c--,n+=h,s+=o,h+=p,o+=d,r+=n,a+=s}return a+(1-a)*(e-r)/(1-r)}},t.RotateTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=2*e},t.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(e,t,i){e*=2,this.frames[e]=t,this.frames[e+1]=i},apply:function(h,a,o){var e,i=this.frames;if(!(a<i[0])){var n=h.bones[this.boneIndex];if(a>=i[i.length-2]){for(e=n.data.rotation+i[i.length-1]-n.rotation;e>180;)e-=360;for(;-180>e;)e+=360;return void(n.rotation+=e*o)}var r=t.binarySearch(i,a,2),l=i[r-1],c=i[r],s=1-(a-c)/(i[r-2]-c);for(s=this.curves.getCurvePercent(r/2-1,s),e=i[r+1]-l;e>180;)e-=360;for(;-180>e;)e+=360;for(e=n.data.rotation+(l+e*s)-n.rotation;e>180;)e-=360;for(;-180>e;)e+=360;n.rotation+=e*o}}},t.TranslateTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=3*e},t.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,t,i,n){e*=3,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=n},apply:function(h,r,a){var e=this.frames;if(!(r<e[0])){var i=h.bones[this.boneIndex];if(r>=e[e.length-3])return i.x+=(i.data.x+e[e.length-2]-i.x)*a,void(i.y+=(i.data.y+e[e.length-1]-i.y)*a);var n=t.binarySearch(e,r,3),o=e[n-2],l=e[n-1],c=e[n],s=1-(r-c)/(e[n+-3]-c);s=this.curves.getCurvePercent(n/3-1,s),i.x+=(i.data.x+o+(e[n+1]-o)*s-i.x)*a,i.y+=(i.data.y+l+(e[n+2]-l)*s-i.y)*a}}},t.ScaleTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=3*e},t.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,t,i,n){e*=3,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=n},apply:function(h,r,a){var e=this.frames;if(!(r<e[0])){var i=h.bones[this.boneIndex];if(r>=e[e.length-3])return i.scaleX+=(i.data.scaleX-1+e[e.length-2]-i.scaleX)*a,void(i.scaleY+=(i.data.scaleY-1+e[e.length-1]-i.scaleY)*a);var n=t.binarySearch(e,r,3),o=e[n-2],l=e[n-1],c=e[n],s=1-(r-c)/(e[n+-3]-c);s=this.curves.getCurvePercent(n/3-1,s),i.scaleX+=(i.data.scaleX-1+o+(e[n+1]-o)*s-i.scaleX)*a,i.scaleY+=(i.data.scaleY-1+l+(e[n+2]-l)*s-i.scaleY)*a}}},t.ColorTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=5*e},t.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(e,t,i,n,r,a){e*=5,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=n,this.frames[e+3]=r,this.frames[e+4]=a},apply:function(g,o,a){var e=this.frames;if(!(o<e[0])){var i=g.slots[this.slotIndex];if(o>=e[e.length-5]){var s=e.length-1;return i.r=e[s-3],i.g=e[s-2],i.b=e[s-1],void(i.a=e[s])}var n=t.binarySearch(e,o,5),p=e[n-4],l=e[n-3],h=e[n-2],u=e[n-1],d=e[n],r=1-(o-d)/(e[n-5]-d);r=this.curves.getCurvePercent(n/5-1,r);var f=p+(e[n+1]-p)*r,_=l+(e[n+2]-l)*r,m=h+(e[n+3]-h)*r,c=u+(e[n+4]-u)*r;1>a?(i.r+=(f-i.r)*a,i.g+=(_-i.g)*a,i.b+=(m-i.b)*a,i.a+=(c-i.a)*a):(i.r=f,i.g=_,i.b=m,i.a=c)}}},t.AttachmentTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=e,this.attachmentNames=[],this.attachmentNames.length=e},t.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(e,t,i){this.frames[e]=t,this.attachmentNames[e]=i},apply:function(n,i){var e=this.frames;if(!(i<e[0])){var r;r=i>=e[e.length-1]?e.length-1:t.binarySearch(e,i,1)-1;var a=this.attachmentNames[r];n.slots[this.slotIndex].setAttachment(a?n.getAttachmentBySlotIndex(this.slotIndex,a):null)}}},t.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},t.SkeletonData.prototype={defaultSkin:null,findBone:function(i){for(var t=this.bones,e=0,n=t.length;n>e;e++)if(t[e].name==i)return t[e];return null},findBoneIndex:function(i){for(var t=this.bones,e=0,n=t.length;n>e;e++)if(t[e].name==i)return e;return-1},findSlot:function(i){for(var t=this.slots,e=0,n=t.length;n>e;e++)if(t[e].name==i)return slot[e];return null},findSlotIndex:function(i){for(var t=this.slots,e=0,n=t.length;n>e;e++)if(t[e].name==i)return e;return-1},findSkin:function(i){for(var t=this.skins,e=0,n=t.length;n>e;e++)if(t[e].name==i)return t[e];return null},findAnimation:function(i){for(var t=this.animations,e=0,n=t.length;n>e;e++)if(t[e].name==i)return t[e];return null}},t.Skeleton=function(e){this.data=e,this.bones=[];for(var i=0,n=e.bones.length;n>i;i++){var r=e.bones[i],o=r.parent?this.bones[e.bones.indexOf(r.parent)]:null;this.bones.push(new t.Bone(r,o))}for(this.slots=[],this.drawOrder=[],i=0,n=e.slots.length;n>i;i++){var a=e.slots[i],l=this.bones[e.bones.indexOf(a.boneData)],s=new t.Slot(a,this,l);this.slots.push(s),this.drawOrder.push(s)}},t.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var i=this.flipX,n=this.flipY,t=this.bones,e=0,r=t.length;r>e;e++)t[e].updateWorldTransform(i,n)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,i=t.length;i>e;e++)t[e].setToSetupPose()},setSlotsToSetupPose:function(){for(var t=this.slots,e=0,i=t.length;i>e;e++)t[e].setToSetupPose(e)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(i){for(var t=this.bones,e=0,n=t.length;n>e;e++)if(t[e].data.name==i)return t[e];return null},findBoneIndex:function(i){for(var t=this.bones,e=0,n=t.length;n>e;e++)if(t[e].data.name==i)return e;return-1},findSlot:function(i){for(var t=this.slots,e=0,n=t.length;n>e;e++)if(t[e].data.name==i)return t[e];return null},findSlotIndex:function(i){for(var t=this.slots,e=0,n=t.length;n>e;e++)if(t[e].data.name==i)return e;return-1},setSkinByName:function(e){var t=this.data.findSkin(e);if(!t)throw"Skin not found: "+e;this.setSkin(t)},setSkin:function(e){this.skin&&e&&e._attachAll(this,this.skin),this.skin=e},getAttachmentBySlotName:function(e,t){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(e),t)},getAttachmentBySlotIndex:function(e,t){if(this.skin){var i=this.skin.getAttachment(e,t);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(e,t):null},setAttachment:function(t,i){for(var r=this.slots,e=0,s=r.size;s>e;e++){var a=r[e];if(a.data.name==t){var n=null;if(i&&(n=this.getAttachment(e,i),null==n))throw"Attachment not found: "+i+", for slot: "+t;return void a.setAttachment(n)}}throw"Slot not found: "+t},update:function(e){time+=e}},t.AttachmentType={region:0},t.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},t.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,i,n,r,a){var e=this.uvs;a?(e[2]=t,e[3]=r,e[4]=t,e[5]=i,e[6]=n,e[7]=i,e[0]=n,e[1]=r):(e[0]=t,e[1]=r,e[2]=t,e[3]=i,e[4]=n,e[5]=i,e[6]=n,e[7]=r)},updateOffset:function(){var o=this.width/this.regionOriginalWidth*this.scaleX,c=this.height/this.regionOriginalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.regionOffsetX*o,r=-this.height/2*this.scaleY+this.regionOffsetY*c,l=n+this.regionWidth*o,a=r+this.regionHeight*c,s=this.rotation*Math.PI/180,t=Math.cos(s),i=Math.sin(s),g=n*t+this.x,h=n*i,u=r*t+this.y,d=r*i,p=l*t+this.x,f=l*i,_=a*t+this.y,m=a*i,e=this.offset;e[0]=g-d,e[1]=u+h,e[2]=g-m,e[3]=_+h,e[4]=p-m,e[5]=_+f,e[6]=p-d,e[7]=u+f},computeVertices:function(n,r,i,t){n+=i.worldX,r+=i.worldY;var a=i.m00,s=i.m01,o=i.m10,l=i.m11,e=this.offset;t[0]=e[0]*a+e[1]*s+n,t[1]=e[0]*o+e[1]*l+r,t[2]=e[2]*a+e[3]*s+n,t[3]=e[2]*o+e[3]*l+r,t[4]=e[4]*a+e[5]*s+n,t[5]=e[4]*o+e[5]*l+r,t[6]=e[6]*a+e[7]*s+n,t[7]=e[6]*o+e[7]*l+r}},t.AnimationStateData=function(e){this.skeletonData=e,this.animationToMixTime={}},t.AnimationStateData.prototype={defaultMix:0,setMixByName:function(e,t,r){var i=this.skeletonData.findAnimation(e);if(!i)throw"Animation not found: "+e;var n=this.skeletonData.findAnimation(t);if(!n)throw"Animation not found: "+t;this.setMix(i,n,r)},setMix:function(e,t,i){this.animationToMixTime[e.name+":"+t.name]=i},getMix:function(t,i){var e=this.animationToMixTime[t.name+":"+i.name];return e?e:this.defaultMix}},t.AnimationState=function(e){this.data=e,this.queue=[]},t.AnimationState.prototype={animationSpeed:1,current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(e){if(this.currentTime+=e*this.animationSpeed,this.previousTime+=e,this.mixTime+=e,this.queue.length>0){var t=this.queue[0];this.currentTime>=t.delay&&(this._setAnimation(t.animation,t.loop),this.queue.shift())}},apply:function(e){if(this.current)if(this.previous){this.previous.apply(e,this.previousTime,this.previousLoop);var t=this.mixTime/this.mixDuration;t>=1&&(t=1,this.previous=null),this.current.mix(e,this.currentTime,this.currentLoop,t)}else this.current.apply(e,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(e,t){this.previous=null,e&&this.current&&(this.mixDuration=this.data.getMix(this.current,e),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=e,this.currentLoop=t,this.currentTime=0},setAnimationByName:function(e,i){var t=this.data.skeletonData.findAnimation(e);if(!t)throw"Animation not found: "+e;this.setAnimation(t,i)},setAnimation:function(e,t){this.queue.length=0,this._setAnimation(e,t)},addAnimationByName:function(e,i,n){var t=this.data.skeletonData.findAnimation(e);if(!t)throw"Animation not found: "+e;this.addAnimation(t,i,n)},addAnimation:function(n,r,e){var t={};if(t.animation=n,t.loop=r,!e||0>=e){var i=this.queue.length?this.queue[this.queue.length-1].animation:this.current;e=null!=i?i.duration-this.data.getMix(i,n)+(e||0):0}t.delay=e,this.queue.push(t)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},t.SkeletonJson=function(e){this.attachmentLoader=e},t.SkeletonJson.prototype={scale:1,readSkeletonData:function(c){for(var e,n=new t.SkeletonData,x=c.bones,r=0,m=x.length;m>r;r++){var i=x[r],g=null;if(i.parent&&(g=n.findBone(i.parent),!g))throw"Parent bone not found: "+i.parent;e=new t.BoneData(i.name,g),e.length=(i.length||0)*this.scale,e.x=(i.x||0)*this.scale,e.y=(i.y||0)*this.scale,e.rotation=i.rotation||0,e.scaleX=i.scaleX||1,e.scaleY=i.scaleY||1,n.bones.push(e)}var w=c.slots;for(r=0,m=w.length;m>r;r++){var l=w[r];if(e=n.findBone(l.bone),!e)throw"Slot bone not found: "+l.bone;var a=new t.SlotData(l.name,e),s=l.color;s&&(a.r=t.SkeletonJson.toColor(s,0),a.g=t.SkeletonJson.toColor(s,1),a.b=t.SkeletonJson.toColor(s,2),a.a=t.SkeletonJson.toColor(s,3)),a.attachmentName=l.attachment,n.slots.push(a)}var p=c.skins;for(var f in p)if(p.hasOwnProperty(f)){var _=p[f],o=new t.Skin(f);for(var u in _)if(_.hasOwnProperty(u)){var T=n.findSlotIndex(u),v=_[u];for(var h in v)if(v.hasOwnProperty(h)){var b=this.readAttachment(o,h,v[h]);null!=b&&o.addAttachment(T,h,b)}}n.skins.push(o),"default"==o.name&&(n.defaultSkin=o)}var y=c.animations;for(var d in y)y.hasOwnProperty(d)&&this.readAnimation(d,y[d],n);return n},readAttachment:function(a,n,i){n=i.name||n;var r=t.AttachmentType[i.type||"region"];if(r==t.AttachmentType.region){var e=new t.RegionAttachment;return e.x=(i.x||0)*this.scale,e.y=(i.y||0)*this.scale,e.scaleX=i.scaleX||1,e.scaleY=i.scaleY||1,e.rotation=i.rotation||0,e.width=(i.width||32)*this.scale,e.height=(i.height||32)*this.scale,e.updateOffset(),e.rendererObject={},e.rendererObject.name=n,e.rendererObject.scale={},e.rendererObject.scale.x=e.scaleX,e.rendererObject.scale.y=e.scaleY,e.rendererObject.rotation=-e.rotation*Math.PI/180,e}throw"Unknown attachment type: "+r},readAnimation:function(T,x,g){var a,e,s,i,r,n,l,c=[],o=0,p=x.bones;for(var h in p)if(p.hasOwnProperty(h)){var v=g.findBoneIndex(h);if(-1==v)throw"Bone not found: "+h;var f=p[h];for(s in f)if(f.hasOwnProperty(s))if(r=f[s],"rotate"==s){for(e=new t.RotateTimeline(r.length),e.boneIndex=v,a=0,n=0,l=r.length;l>n;n++)i=r[n],e.setFrame(a,i.time,i.angle),t.SkeletonJson.readCurve(e,a,i),a++;c.push(e),o=Math.max(o,e.frames[2*e.getFrameCount()-2])}else{if("translate"!=s&&"scale"!=s)throw"Invalid timeline type for a bone: "+s+" ("+h+")";var _=1;for("scale"==s?e=new t.ScaleTimeline(r.length):(e=new t.TranslateTimeline(r.length),_=this.scale),e.boneIndex=v,a=0,n=0,l=r.length;l>n;n++){i=r[n];var E=(i.x||0)*_,w=(i.y||0)*_;e.setFrame(a,i.time,E,w),t.SkeletonJson.readCurve(e,a,i),a++}c.push(e),o=Math.max(o,e.frames[3*e.getFrameCount()-3])}}var m=x.slots;for(var u in m)if(m.hasOwnProperty(u)){var y=m[u],b=g.findSlotIndex(u);for(s in y)if(y.hasOwnProperty(s))if(r=y[s],"color"==s){for(e=new t.ColorTimeline(r.length),e.slotIndex=b,a=0,n=0,l=r.length;l>n;n++){i=r[n];var d=i.color,C=t.SkeletonJson.toColor(d,0),S=t.SkeletonJson.toColor(d,1),k=t.SkeletonJson.toColor(d,2),A=t.SkeletonJson.toColor(d,3);e.setFrame(a,i.time,C,S,k,A),t.SkeletonJson.readCurve(e,a,i),a++}c.push(e),o=Math.max(o,e.frames[5*e.getFrameCount()-5])}else{if("attachment"!=s)throw"Invalid timeline type for a slot: "+s+" ("+u+")";for(e=new t.AttachmentTimeline(r.length),e.slotIndex=b,a=0,n=0,l=r.length;l>n;n++)i=r[n],e.setFrame(a++,i.time,i.name);c.push(e),o=Math.max(o,e.frames[e.getFrameCount()-1])}}g.animations.push(new t.Animation(T,c,o))}},t.SkeletonJson.readCurve=function(t,i,n){var e=n.curve;e&&("stepped"==e?t.curves.setStepped(i):e instanceof Array&&t.curves.setCurve(i,e[0],e[1],e[2],e[3]))},t.SkeletonJson.toColor=function(e,t){if(8!=e.length)throw"Color hexidecimal length must be 8, recieved: "+e;return parseInt(e.substr(2*t,2),16)/255},t.Atlas=function(d,u){this.textureLoader=u,this.pages=[],this.regions=[];var r=new t.AtlasReader(d),e=[];e.length=4;for(var n=null;;){var a=r.readLine();if(null==a)break;if(a=r.trim(a),a.length)if(n){var i=new t.AtlasRegion;i.name=a,i.page=n,i.rotate="true"==r.readValue(),r.readTuple(e);var s=parseInt(e[0],10),o=parseInt(e[1],10);r.readTuple(e);var h=parseInt(e[0],10),c=parseInt(e[1],10);i.u=s/n.width,i.v=o/n.height,i.rotate?(i.u2=(s+c)/n.width,i.v2=(o+h)/n.height):(i.u2=(s+h)/n.width,i.v2=(o+c)/n.height),i.x=s,i.y=o,i.width=Math.abs(h),i.height=Math.abs(c),4==r.readTuple(e)&&(i.splits=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)],4==r.readTuple(e)&&(i.pads=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)],r.readTuple(e))),i.originalWidth=parseInt(e[0],10),i.originalHeight=parseInt(e[1],10),r.readTuple(e),i.offsetX=parseInt(e[0],10),i.offsetY=parseInt(e[1],10),i.index=parseInt(r.readValue(),10),this.regions.push(i)}else{n=new t.AtlasPage,n.name=a,n.format=t.Atlas.Format[r.readValue()],r.readTuple(e),n.minFilter=t.Atlas.TextureFilter[e[0]],n.magFilter=t.Atlas.TextureFilter[e[1]];var l=r.readValue();n.uWrap=t.Atlas.TextureWrap.clampToEdge,n.vWrap=t.Atlas.TextureWrap.clampToEdge,"x"==l?n.uWrap=t.Atlas.TextureWrap.repeat:"y"==l?n.vWrap=t.Atlas.TextureWrap.repeat:"xy"==l&&(n.uWrap=n.vWrap=t.Atlas.TextureWrap.repeat),u.load(n,a),this.pages.push(n)}else n=null}},t.Atlas.prototype={findRegion:function(i){for(var t=this.regions,e=0,n=t.length;n>e;e++)if(t[e].name==i)return t[e];return null},dispose:function(){for(var t=this.pages,e=0,i=t.length;i>e;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var n=this.regions,i=0,r=n.length;r>i;i++){var e=n[i];e.page==t&&(e.u=e.x/t.width,e.v=e.y/t.height,e.rotate?(e.u2=(e.x+e.height)/t.width,e.v2=(e.y+e.width)/t.height):(e.u2=(e.x+e.width)/t.width,e.v2=(e.y+e.height)/t.height))}}},t.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},t.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},t.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},t.AtlasPage=function(){},t.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},t.AtlasRegion=function(){},t.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},t.AtlasReader=function(e){this.lines=e.split(/\r\n|\r|\n/)},t.AtlasReader.prototype={index:0,trim:function(e){return e.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var e=this.readLine(),t=e.indexOf(":");if(-1==t)throw"Invalid line: "+e;return this.trim(e.substring(t+1))},readTuple:function(r){var e=this.readLine(),a=e.indexOf(":");if(-1==a)throw"Invalid line: "+e;for(var t=0,i=a+1;3>t;t++){var n=e.indexOf(",",i);if(-1==n){if(!t)throw"Invalid line: "+e;break}r[t]=this.trim(e.substr(i,n-i)),i=n+1}return r[t]=this.trim(e.substring(i)),t+1}},t.AtlasAttachmentLoader=function(e){this.atlas=e},t.AtlasAttachmentLoader.prototype={newAttachment:function(a,n,r){switch(n){case t.AttachmentType.region:var e=this.atlas.findRegion(r);if(!e)throw"Region not found in atlas: "+r+" ("+n+")";var i=new t.RegionAttachment(r);return i.rendererObject=e,i.setUVs(e.u,e.v,e.u2,e.v2,e.rotate),i.regionOffsetX=e.offsetX,i.regionOffsetY=e.offsetY,i.regionWidth=e.width,i.regionHeight=e.height,i.regionOriginalWidth=e.originalWidth,i.regionOriginalHeight=e.originalHeight,i}throw"Unknown attachment type: "+n}},t.Bone.yDown=!0,e.AnimCache={},e.Spine=function(s){if(e.DisplayObjectContainer.call(this),this.spineData=e.AnimCache[s],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+s);this.skeleton=new t.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new t.AnimationStateData(this.spineData),this.state=new t.AnimationState(this.stateData),this.slotContainers=[];for(var n=0,l=this.skeleton.drawOrder.length;l>n;n++){var i=this.skeleton.drawOrder[n],r=i.attachment,a=new e.DisplayObjectContainer;if(this.slotContainers.push(a),this.addChild(a),r instanceof t.RegionAttachment){var c=r.rendererObject.name,o=this.createSprite(i,r.rendererObject);i.currentSprite=o,i.currentSpriteName=c,a.addChild(o)}}},e.Spine.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Spine.prototype.constructor=e.Spine,e.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var c=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.state.update(c),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var l=this.skeleton.drawOrder,s=0,h=l.length;h>s;s++){var i=l[s],n=i.attachment,r=this.slotContainers[s];if(n instanceof t.RegionAttachment){if(n.rendererObject&&(!i.currentSpriteName||i.currentSpriteName!=n.name)){var o=n.rendererObject.name;if(void 0!==i.currentSprite&&(i.currentSprite.visible=!1),i.sprites=i.sprites||{},void 0!==i.sprites[o])i.sprites[o].visible=!0;else{var u=this.createSprite(i,n.rendererObject);r.addChild(u)}i.currentSprite=i.sprites[o],i.currentSpriteName=o}r.visible=!0;var a=i.bone;r.position.x=a.worldX+n.x*a.m00+n.y*a.m01,r.position.y=a.worldY+n.x*a.m10+n.y*a.m11,r.scale.x=a.worldScaleX,r.scale.y=a.worldScaleY,r.rotation=-(i.bone.worldRotation*Math.PI/180),r.alpha=i.a,i.currentSprite.tint=e.rgb2hex([i.r,i.g,i.b])}else r.visible=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.Spine.prototype.createSprite=function(n,t){var r=e.TextureCache[t.name]?t.name:t.name+".png",i=new e.Sprite(e.Texture.fromFrame(r));return i.scale=t.scale,i.rotation=t.rotation,i.anchor.x=i.anchor.y=.5,n.sprites=n.sprites||{},n.sprites[t.name]=i,i},e.BaseTextureCache={},e.texturesToUpdate=[],e.texturesToDestroy=[],e.BaseTextureCacheIdGenerator=0,e.BaseTexture=function(i,n){if(e.EventTarget.call(this),this.resolution=1,this.width=100,this.height=100,this.scaleMode=n||e.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=i,this.id=e.BaseTextureCacheIdGenerator++,this.premultipliedAlpha=!0,this._glTextures=[],this._dirty=[],i){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source[this.source instanceof HTMLImageElement?"naturalWidth":"width"],this.height=this.source[this.source instanceof HTMLImageElement?"naturalHeight":"height"],e.texturesToUpdate.push(this);else{var t=this;this.source.onload=function(){t.hasLoaded=!0,t.width=t.source[t.source instanceof HTMLImageElement?"naturalWidth":"width"],t.height=t.source[t.source instanceof HTMLImageElement?"naturalHeight":"height"];for(var e=0;e<t._glTextures.length;e++)t._dirty[e]=!0;t.dispatchEvent({type:"loaded",content:t})},this.source.onerror=function(){t.dispatchEvent({type:"error",content:t})}}this.imageUrl=null,this._powerOf2=!1}},e.BaseTexture.prototype.constructor=e.BaseTexture,e.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete e.BaseTextureCache[this.imageUrl],delete e.TextureCache[this.imageUrl],this.imageUrl=null,this.source.src=""):this.source&&this.source._pixiId&&delete e.BaseTextureCache[this.source._pixiId],this.source=null,e.texturesToDestroy.push(this)},e.BaseTexture.prototype.updateSourceImage=function(e){this.hasLoaded=!1,this.source.src=null,this.source.src=e},e.BaseTexture.fromImage=function(t,n,a){var i=e.BaseTextureCache[t];if(void 0===n&&-1===t.indexOf("data:")&&(n=!0),!i){var r=new Image;n&&(r.crossOrigin=""),r.src=t,i=new e.BaseTexture(r,a),i.imageUrl=t,e.BaseTextureCache[t]=i,-1!==t.indexOf(e.RETINA_PREFIX+".")&&(i.resolution=2)}return i},e.BaseTexture.fromCanvas=function(t,n){t._pixiId||(t._pixiId="canvas_"+e.TextureCacheIdGenerator++);var i=e.BaseTextureCache[t._pixiId];return i||(i=new e.BaseTexture(t,n),e.BaseTextureCache[t._pixiId]=i),i},e.TextureCache={},e.FrameCache={},e.TextureCacheIdGenerator=0,e.Texture=function(t,i){e.EventTarget.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new e.Rectangle(0,0,1,1)),t instanceof e.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=i,this.trim=null,this.valid=!1,this._uvs=null,this.width=0,this.height=0,this.crop=new e.Rectangle(0,0,1,1),t.hasLoaded?(this.noFrame&&(i=new e.Rectangle(0,0,t.width,t.height)),this.setFrame(i)):t.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))},e.Texture.prototype.constructor=e.Texture,e.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new e.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame),this.dispatchEvent({type:"update",content:this})},e.Texture.prototype.destroy=function(e){e&&this.baseTexture.destroy(),this.valid=!1},e.Texture.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,!this.trim&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&e.Texture.frameUpdates.push(this)},e.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new e.TextureUvs);var t=this.crop,i=this.baseTexture.width,n=this.baseTexture.height;this._uvs.x0=t.x/i,this._uvs.y0=t.y/n,this._uvs.x1=(t.x+t.width)/i,this._uvs.y1=t.y/n,this._uvs.x2=(t.x+t.width)/i,this._uvs.y2=(t.y+t.height)/n,this._uvs.x3=t.x/i,this._uvs.y3=(t.y+t.height)/n},e.Texture.fromImage=function(i,n,r){var t=e.TextureCache[i];return t||(t=new e.Texture(e.BaseTexture.fromImage(i,n,r)),e.TextureCache[i]=t),t},e.Texture.fromFrame=function(t){var i=e.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return i},e.Texture.fromCanvas=function(t,i){var n=e.BaseTexture.fromCanvas(t,i);return new e.Texture(n)},e.Texture.addTextureToCache=function(t,i){e.TextureCache[i]=t},e.Texture.removeTextureFromCache=function(t){var i=e.TextureCache[t];return delete e.TextureCache[t],delete e.BaseTextureCache[t],i},e.Texture.frameUpdates=[],e.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},e.RenderTexture=function(i,n,r,a,s){if(e.EventTarget.call(this),this.width=i||100,this.height=n||100,this.resolution=s||1,this.frame=new e.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new e.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new e.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=a||e.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,this.renderer=r||e.defaultRenderer,this.renderer.type===e.WEBGL_RENDERER){var t=this.renderer.gl;this.textureBuffer=new e.FilterTexture(t,this.width*this.resolution,this.height*this.resolution,this.baseTexture.scaleMode),this.baseTexture._glTextures[t.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new e.Point(.5*this.width,.5*-this.height)}else this.render=this.renderCanvas,this.textureBuffer=new e.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype=Object.create(e.Texture.prototype),e.RenderTexture.prototype.constructor=e.RenderTexture,e.RenderTexture.prototype.resize=function(t,i,n){(t!==this.width||i!==this.height)&&(this.valid=t>0&&i>0,this.width=this.frame.width=this.crop.width=t,this.height=this.frame.height=this.crop.height=i,n&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===e.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution))},e.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===e.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},e.RenderTexture.prototype.renderWebGL=function(t,n,s){if(this.valid){var i=this.renderer.gl;i.colorMask(!0,!0,!0,!0),i.viewport(0,0,this.width*this.resolution,this.height*this.resolution),i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer),s&&this.textureBuffer.clear();var a=t.children,o=t.worldTransform;t.worldTransform=e.RenderTexture.tempMatrix,t.worldAlpha=1,t.worldTransform.d=-1,t.worldTransform.ty=-2*this.projection.y,n&&(t.worldTransform.tx=n.x,t.worldTransform.ty-=n.y);for(var r=0,l=a.length;l>r;r++)a[r].updateTransform();e.WebGLRenderer.updateTextures(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer),t.worldTransform=o,this.renderer.spriteBatch.dirty=!0}},e.RenderTexture.prototype.renderCanvas=function(t,i,s){if(this.valid){var r=t.children,o=t.worldTransform;t.worldTransform=e.RenderTexture.tempMatrix,i?(t.worldTransform.tx=i.x,t.worldTransform.ty=i.y):(t.worldTransform.tx=0,t.worldTransform.ty=0);for(var n=0,l=r.length;l>n;n++)r[n].updateTransform();s&&this.textureBuffer.clear();var a=this.textureBuffer.context,c=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,a),this.renderer.resolution=c,a.setTransform(1,0,0,1,0,0),t.worldTransform=o}},e.RenderTexture.prototype.getImage=function(){var e=new Image;return e.src=this.getBase64(),e},e.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},e.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===e.WEBGL_RENDERER){var i=this.renderer.gl,r=this.textureBuffer.width,a=this.textureBuffer.height,n=new Uint8Array(4*r*a);i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer),i.readPixels(0,0,r,a,i.RGBA,i.UNSIGNED_BYTE,n),i.bindFramebuffer(i.FRAMEBUFFER,null);for(var l=new e.CanvasBuffer(r,a),c=l.context.getImageData(0,0,r,a),s=c.data,t=0;t<n.length;t+=4){var o=n[t+3];s[t]=n[t]*o,s[t+1]=n[t+1]*o,s[t+2]=n[t+2]*o,s[t+3]=o}return l.context.putImageData(c,0,0),l.canvas}return this.textureBuffer.canvas},e.RenderTexture.tempMatrix=new e.Matrix,e.AssetLoader=function(t,i){e.EventTarget.call(this),this.assetURLs=t,this.crossorigin=i,this.loadersByType={jpg:e.ImageLoader,jpeg:e.ImageLoader,png:e.ImageLoader,gif:e.ImageLoader,webp:e.ImageLoader,json:e.JsonLoader,atlas:e.AtlasLoader,anim:e.SpineLoader,xml:e.BitmapFontLoader,fnt:e.BitmapFontLoader}},e.AssetLoader.prototype.constructor=e.AssetLoader,e.AssetLoader.prototype._getDataType=function(i){var e="data:",a=i.slice(0,e.length).toLowerCase();if(a===e){var n=i.slice(e.length),r=n.indexOf(",");if(-1===r)return null;var t=n.slice(0,r).split(";")[0];return t&&"text/plain"!==t.toLowerCase()?t.split("/").pop().toLowerCase():"txt"}return null},e.AssetLoader.prototype.load=function(){function a(e){s.onAssetLoaded(e.content)}var s=this;this.loadCount=this.assetURLs.length;for(var t=0;t<this.assetURLs.length;t++){var i=this.assetURLs[t],e=this._getDataType(i);e||(e=i.split("?").shift().split(".").pop().toLowerCase());var n=this.loadersByType[e];if(!n)throw new Error(e+" is an unsupported file type");var r=new n(i,this.crossorigin);r.addEventListener("loaded",a),r.load()}},e.AssetLoader.prototype.onAssetLoaded=function(e){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this,loader:e}),this.onProgress&&this.onProgress(e),this.loadCount||(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},e.JsonLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.loaded=!1},e.JsonLoader.prototype.constructor=e.JsonLoader,e.JsonLoader.prototype.load=function(){window.XDomainRequest&&this.crossorigin?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=this.onError.bind(this),this.ajaxRequest.ontimeout=this.onError.bind(this),this.ajaxRequest.onprogress=function(){}):this.ajaxRequest=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onload=this.onJSONLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},e.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var l=this.baseUrl+this.json.meta.image,a=new e.ImageLoader(l,this.crossorigin),r=this.json.frames;this.texture=a.texture.baseTexture,a.addEventListener("loaded",this.onLoaded.bind(this));for(var n in r){var i=r[n].frame;if(i&&(e.TextureCache[n]=new e.Texture(this.texture,{x:i.x,y:i.y,width:i.w,height:i.h}),e.TextureCache[n].crop=new e.Rectangle(i.x,i.y,i.w,i.h),r[n].trimmed)){var s=r[n].sourceSize,o=r[n].spriteSourceSize;e.TextureCache[n].trim=new e.Rectangle(o.x,o.y,s.w,s.h)}}a.load()}else if(this.json.bones){var c=new t.SkeletonJson,h=c.readSkeletonData(this.json);e.AnimCache[this.url]=h,this.onLoaded()}else this.onLoaded()},e.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.AtlasLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.crossorigin=i,this.loaded=!1},e.AtlasLoader.constructor=e.AtlasLoader,e.AtlasLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var r=this.ajaxRequest.responseText.split(/\r?\n/),a=-3,c=0,i=null,u=!1,t=0,n=0,d=this.onLoaded.bind(this);for(t=0;t<r.length;t++)if(r[t]=r[t].replace(/^\s+|\s+$/g,""),""===r[t]&&(u=t+1),r[t].length>0){if(u===t)this.atlas.meta.image.push(r[t]),c=this.atlas.meta.image.length-1,this.atlas.frames.push({}),a=-3;else if(a>0)if(a%7===1)null!=i&&(this.atlas.frames[c][i.name]=i),i={name:r[t],frame:{}};else{var s=r[t].split(" ");if(a%7===3)i.frame.x=Number(s[1].replace(",","")),i.frame.y=Number(s[2]);else if(a%7===4)i.frame.w=Number(s[1].replace(",","")),i.frame.h=Number(s[2]);else if(a%7===5){var h={x:0,y:0,w:Number(s[1].replace(",","")),h:Number(s[2])};h.w>i.frame.w||h.h>i.frame.h?(i.trimmed=!0,i.realSize=h):i.trimmed=!1}}a++}if(null!=i&&(this.atlas.frames[c][i.name]=i),this.atlas.meta.image.length>0){for(this.images=[],n=0;n<this.atlas.meta.image.length;n++){var p=this.baseUrl+this.atlas.meta.image[n],l=this.atlas.frames[n];this.images.push(new e.ImageLoader(p,this.crossorigin));for(t in l){var o=l[t].frame;o&&(e.TextureCache[t]=new e.Texture(this.images[n].texture.baseTexture,{x:o.x,y:o.y,width:o.w,height:o.h}),l[t].trimmed&&(e.TextureCache[t].realSize=l[t].realSize,e.TextureCache[t].trim.x=0,e.TextureCache[t].trim.y=0))}}for(this.currentImageId=0,n=0;n<this.images.length;n++)this.images[n].addEventListener("loaded",d);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},e.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))},e.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.SpriteSheetLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},e.SpriteSheetLoader.prototype.constructor=e.SpriteSheetLoader,e.SpriteSheetLoader.prototype.load=function(){var t=this,i=new e.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(e){t.json=e.content.json,t.onLoaded()}),i.load()},e.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader=function(t,i){e.EventTarget.call(this),this.texture=e.Texture.fromImage(t,i),this.frames=[]},e.ImageLoader.prototype.constructor=e.ImageLoader,e.ImageLoader.prototype.load=function(){this.texture.baseTexture.hasLoaded?this.onLoaded():this.texture.baseTexture.addEventListener("loaded",this.onLoaded.bind(this))},e.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader.prototype.loadFramedSpriteSheet=function(t,i,a){this.frames=[];for(var l=Math.floor(this.texture.width/t),c=Math.floor(this.texture.height/i),s=0,n=0;c>n;n++)for(var r=0;l>r;r++,s++){var o=new e.Texture(this.texture.baseTexture,{x:r*t,y:n*i,width:t,height:i});this.frames.push(o),a&&(e.TextureCache[a+"-"+s]=o)}this.load()},e.BitmapFontLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null},e.BitmapFontLoader.prototype.constructor=e.BitmapFontLoader,e.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onXMLLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},e.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var n=this.ajaxRequest.responseXML;if(!n||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){var h=new DOMParser;n=h.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var c=document.createElement("div");c.innerHTML=this.ajaxRequest.responseText,n=c}var u=this.baseUrl+n.getElementsByTagName("page")[0].getAttribute("file"),s=new e.ImageLoader(u,this.crossorigin);this.texture=s.texture.baseTexture;var r={},o=n.getElementsByTagName("info")[0],p=n.getElementsByTagName("common")[0];r.font=o.getAttribute("face"),r.size=parseInt(o.getAttribute("size"),10),r.lineHeight=parseInt(p.getAttribute("lineHeight"),10),r.chars={};for(var i=n.getElementsByTagName("char"),t=0;t<i.length;t++){var l=parseInt(i[t].getAttribute("id"),10),d=new e.Rectangle(parseInt(i[t].getAttribute("x"),10),parseInt(i[t].getAttribute("y"),10),parseInt(i[t].getAttribute("width"),10),parseInt(i[t].getAttribute("height"),10));r.chars[l]={xOffset:parseInt(i[t].getAttribute("xoffset"),10),yOffset:parseInt(i[t].getAttribute("yoffset"),10),xAdvance:parseInt(i[t].getAttribute("xadvance"),10),kerning:{},texture:e.TextureCache[l]=new e.Texture(this.texture,d)}}var a=n.getElementsByTagName("kerning");for(t=0;t<a.length;t++){var f=parseInt(a[t].getAttribute("first"),10),_=parseInt(a[t].getAttribute("second"),10),m=parseInt(a[t].getAttribute("amount"),10);r.chars[_].kerning[f]=m}e.BitmapText.fonts[r.font]=r,s.addEventListener("loaded",this.onLoaded.bind(this)),s.load()}},e.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.SpineLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.loaded=!1},e.SpineLoader.prototype.constructor=e.SpineLoader,e.SpineLoader.prototype.load=function(){var t=this,i=new e.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(e){t.json=e.content.json,t.onLoaded()}),i.load()},e.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.AbstractFilter=function(e,t){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=t||{},this.fragmentSrc=e||[]},e.AlphaMaskFilter=function(t){e.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:t},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mask.value.x=t.width,this.uniforms.mask.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},e.AlphaMaskFilter.prototype=Object.create(e.AbstractFilter.prototype),e.AlphaMaskFilter.prototype.constructor=e.AlphaMaskFilter,e.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(e){this.uniforms.mask.value=e}}),e.ColorMatrixFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},e.ColorMatrixFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorMatrixFilter.prototype.constructor=e.ColorMatrixFilter,Object.defineProperty(e.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(e){this.uniforms.matrix.value=e}}),e.GrayFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},e.GrayFilter.prototype=Object.create(e.AbstractFilter.prototype),e.GrayFilter.prototype.constructor=e.GrayFilter,Object.defineProperty(e.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(e){this.uniforms.gray.value=e}}),e.DisplacementFilter=function(t){e.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=t.width,this.uniforms.mapDimensions.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},e.DisplacementFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DisplacementFilter.prototype.constructor=e.DisplacementFilter,e.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(e){this.uniforms.displacementMap.value=e}}),Object.defineProperty(e.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(e){this.uniforms.scale.value=e}}),Object.defineProperty(e.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(e){this.uniforms.offset.value=e}}),e.PixelateFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]},e.PixelateFilter.prototype=Object.create(e.AbstractFilter.prototype),e.PixelateFilter.prototype.constructor=e.PixelateFilter,Object.defineProperty(e.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(e){this.dirty=!0,this.uniforms.pixelSize.value=e}}),e.BlurXFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurXFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurXFilter.prototype.constructor=e.BlurXFilter,Object.defineProperty(e.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.dirty=!0,this.uniforms.blur.value=1/7e3*e}}),e.BlurYFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurYFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurYFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}}),e.BlurFilter=function(){this.blurXFilter=new e.BlurXFilter,this.blurYFilter=new e.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},Object.defineProperty(e.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e}}),Object.defineProperty(e.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e}}),Object.defineProperty(e.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e}}),e.InvertFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},e.InvertFilter.prototype=Object.create(e.AbstractFilter.prototype),e.InvertFilter.prototype.constructor=e.InvertFilter,Object.defineProperty(e.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(e){this.uniforms.invert.value=e}}),e.SepiaFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},e.SepiaFilter.prototype=Object.create(e.AbstractFilter.prototype),e.SepiaFilter.prototype.constructor=e.SepiaFilter,Object.defineProperty(e.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(e){this.uniforms.sepia.value=e}}),e.TwistFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},e.TwistFilter.prototype=Object.create(e.AbstractFilter.prototype),e.TwistFilter.prototype.constructor=e.TwistFilter,Object.defineProperty(e.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(e){this.dirty=!0,this.uniforms.offset.value=e}}),Object.defineProperty(e.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(e){this.dirty=!0,this.uniforms.radius.value=e}}),Object.defineProperty(e.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(e){this.dirty=!0,this.uniforms.angle.value=e}}),e.ColorStepFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},e.ColorStepFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorStepFilter.prototype.constructor=e.ColorStepFilter,Object.defineProperty(e.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(e){this.uniforms.step.value=e}}),e.DotScreenFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},e.DotScreenFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DotScreenFilter.prototype.constructor=e.DotScreenFilter,Object.defineProperty(e.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(e){this.dirty=!0,this.uniforms.scale.value=e}}),Object.defineProperty(e.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(e){this.dirty=!0,this.uniforms.angle.value=e}}),e.CrossHatchFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]},e.CrossHatchFilter.prototype=Object.create(e.AbstractFilter.prototype),e.CrossHatchFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}}),e.RGBSplitFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},e.RGBSplitFilter.prototype=Object.create(e.AbstractFilter.prototype),e.RGBSplitFilter.prototype.constructor=e.RGBSplitFilter,Object.defineProperty(e.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.PIXI=e):"undefined"!=typeof define&&define.amd?define(e):i.PIXI=e}.call(this),!function(z,S){function e(t,i){this.proParticleCount=e.Util.initValue(t,e.POOL_MAX),this.integrationType=e.Util.initValue(i,e.EULER),this.emitters=[],this.renderers=[],this.time=0,this.oldTime=0,e.pool=new e.ParticlePool(this.proParticleCount),e.integrator=new e.NumericalIntegration(this.integrationType)}function U(){this.initialize()}function st(e){this.type=e.type,this.particle=e.particle,this.emitter=e.emitter}function L(){this.mats=[],this.size=0;for(var t=0;20>t;t++)this.mats.push(e.Mat3.create([0,0,0,0,0,0,0,0,0]))}function D(t){this.id="particle_"+D.ID++,this.reset(!0),e.Util.setPrototypeByObject(this,t)}function X(i,n){this.proParticleCount=e.Util.initValue(i,0),this.releaseTime=e.Util.initValue(n,-1),this.poolList=[],this.timeoutID=0;for(var t=0;t<this.proParticleCount;t++)this.add();this.releaseTime>0&&(this.timeoutID=setTimeout(this.release,this.releaseTime/1e3))}function H(t,i,n){this.isArray=!1,e.Util.isArray(t)?(this.isArray=!0,this.a=t):(this.a=e.Util.initValue(t,1),this.b=e.Util.initValue(i,this.a),this.center=e.Util.initValue(n,!1))}function N(t){this.colorArr=e.Util.isArray(t)?t:[t]}function V(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n,this.bottom=this.y+this.height,this.right=this.x+this.width}function F(t,i){this.id="Behavior_"+F.id++,this.life=e.Util.initValue(t,1/0),this.easing=e.ease.setEasingByName(i),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.name="Behavior"}function W(t,i){this.numPan=e.Util.initValue(t,1),this.timePan=e.Util.initValue(i,1),this.numPan=e.Util.setSpanValue(this.numPan),this.timePan=e.Util.setSpanValue(this.timePan),this.startTime=0,this.nextTime=0,this.init()}function O(){}function j(t,i,n){j._super_.call(this),this.lifePan=e.Util.setSpanValue(t,i,n)}function C(t){C._super_.call(this),this.zone=e.Util.initValue(t,new e.PointZone)}function b(t,i,n){b._super_.call(this),this.rPan=e.Util.setSpanValue(t),this.thaPan=e.Util.setSpanValue(i),this.type=e.Util.initValue(n,"vector")}function B(t,i,n){B._super_.call(this),this.massPan=e.Util.setSpanValue(t,i,n)}function A(t,i,n){A._super_.call(this),this.radius=e.Util.setSpanValue(t,i,n)}function k(t,i,n){k._super_.call(this),this.image=this.setSpanValue(t),this.w=e.Util.initValue(i,20),this.h=e.Util.initValue(n,this.w)}function f(t,i,n,r){f._super_.call(this,n,r),this.force=this.normalizeForce(new e.Vector2D(t,i)),this.name="Force"}function g(t,i,n,r,a){g._super_.call(this,r,a),this.targetPosition=e.Util.initValue(t,new e.Vector2D),this.radius=e.Util.initValue(n,1e3),this.force=e.Util.initValue(this.normalizeValue(i),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new e.Vector2D,this.lengthSq=0,this.name="Attraction"}function y(e,t,i,n,r){y._super_.call(this,n,r),this.reset(e,t,i),this.time=0,this.name="RandomDrift"}function P(e,t,i,n,r){P._super_.call(this,e,t,i,n,r),this.force*=-1,this.name="Repulsion"}function E(e,t,i){E._super_.call(this,0,e,t,i),this.name="Gravity"}function T(e,t,i,n,r){T._super_.call(this,n,r),this.reset(e,t,i),this.name="Collision"}function v(e,t,i,n){v._super_.call(this,i,n),this.reset(e,t),this.name="CrossZone"}function _(e,t,i,n){_._super_.call(this,i,n),this.reset(e,t),this.name="Alpha"}function d(e,t,i,n){d._super_.call(this,i,n),this.reset(e,t),this.name="Scale"}function p(e,t,i,n,r){p._super_.call(this,n,r),this.reset(e,t,i),this.name="Rotate"}function u(e,t,i,n){u._super_.call(this,i,n),this.reset(e,t),this.name="Color"}function x(t,i,n,r){x._super_.call(this,n,r),this.distanceVec=new e.Vector2D,this.centerPoint=e.Util.initValue(t,new e.Vector2D),this.force=e.Util.initValue(this.normalizeValue(i),100),this.name="GravityWell"}function i(t){this.initializes=[],this.particles=[],this.behaviors=[],this.emitTime=0,this.emitTotalTimes=-1,this.damping=.006,this.bindEmitter=!0,this.rate=new e.Rate(1,.1),i._super_.call(this,t),this.id="emitter_"+i.ID++}function w(e){this.selfBehaviors=[],w._super_.call(this,e)}function c(t,i,n){this.mouseTarget=e.Util.initValue(t,z),this.ease=e.Util.initValue(i,.7),this._allowEmitting=!1,this.initEventHandler(),c._super_.call(this,n)}function $(t,i,n){this.element=n,this.type=e.Util.initValue(t,"canvas"),this.proton=i,this.renderer=this.getRenderer()}function q(e,t,i){this.proton=e,this.element=t,this.stroke=i}function s(e,t){s._super_.call(this,e,t),this.stroke=null}function l(e,t,i){l._super_.call(this,e,t),this.stroke=i}function r(e,t){r._super_.call(this,e,t),this.stroke=null,this.context=this.element.getContext("2d"),this.bufferCache={}}function n(t,i,e){n._super_.call(this,t,i),this.context=this.element.getContext("2d"),this.imageData=null,this.rectangle=null,this.rectangle=e,this.createImageData(e)}function t(e,i){t._super_.call(this,e,i),this.gl=this.element.getContext("experimental-webgl",{antialias:!0,stencil:!1,depth:!1}),this.gl||alert("Sorry your browser do not suppest WebGL!"),this.initVar(),this.setMaxRadius(),this.initShaders(),this.initBuffers(),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND)}function Y(){this.vector=new e.Vector2D(0,0),this.random=0,this.crossType="dead",this.alert=!0}function o(t,n,i,r,a){o._super_.call(this),i-t>=0?(this.x1=t,this.y1=n,this.x2=i,this.y2=r):(this.x1=i,this.y1=r,this.x2=t,this.y2=n),this.dx=this.x2-this.x1,this.dy=this.y2-this.y1,this.minx=Math.min(this.x1,this.x2),this.miny=Math.min(this.y1,this.y2),this.maxx=Math.max(this.x1,this.x2),this.maxy=Math.max(this.y1,this.y2),this.dot=this.x2*this.y1-this.x1*this.y2,this.xxyy=this.dx*this.dx+this.dy*this.dy,this.gradient=this.getGradient(),this.length=this.getLength(),this.direction=e.Util.initValue(a,">")}function m(e,t,i){m._super_.call(this),this.x=e,this.y=t,this.radius=i,this.angle=0,this.center={x:this.x,y:this.y}}function M(e,t){M._super_.call(this),this.x=e,this.y=t}function R(e,t,i,n){R._super_.call(this),this.x=e,this.y=t,this.width=i,this.height=n}function h(e,t,i,n){h._super_.call(this),this.reset(e,t,i,n)}e.POOL_MAX=1e3,e.TIME_STEP=60,e.MEASURE=100,e.EULER="euler",e.RK2="runge-kutta2",e.RK4="runge-kutta4",e.VERLET="verlet",e.PARTICLE_CREATED="partilcleCreated",e.PARTICLE_UPDATE="partilcleUpdate",e.PARTICLE_SLEEP="particleSleep",e.PARTICLE_DEAD="partilcleDead",e.PROTON_UPDATE="protonUpdate",e.PROTON_UPDATE_AFTER="protonUpdateAfter",e.EMITTER_ADDED="emitterAdded",e.EMITTER_REMOVED="emitterRemoved",e.amendChangeTabsBug=!0,e.TextureBuffer={},e.TextureCanvasBuffer={},e.prototype={addRender:function(e){e.proton=this,this.renderers.push(e.proton)},addEmitter:function(t){this.emitters.push(t),t.parent=this,this.dispatchEvent(new e.Event({type:e.EMITTER_ADDED,emitter:t}))},removeEmitter:function(t){var i=this.emitters.indexOf(t);this.emitters.splice(i,1),t.parent=null,this.dispatchEvent(new e.Event({type:e.EMITTER_REMOVED,emitter:t}))},update:function(){this.dispatchEvent(new e.Event({type:e.PROTON_UPDATE})),this.oldTime||(this.oldTime=(new Date).getTime());var i=(new Date).getTime();if(this.elapsed=(i-this.oldTime)/1e3,e.amendChangeTabsBug&&this.amendChangeTabsBug(),this.oldTime=i,this.elapsed>0)for(var t=0;t<this.emitters.length;t++)this.emitters[t]&&this.emitters[t].update(this.elapsed);this.dispatchEvent(new e.Event({type:e.PROTON_UPDATE_AFTER}))},amendChangeTabsBug:function(){this.elapsed>.5&&(this.oldTime=(new Date).getTime(),this.elapsed=0)},getCount:function(){for(var t=0,i=this.emitters.length,e=0;i>e;e++)t+=this.emitters[e].particles.length;return t},destroy:function(){for(var i=this.emitters.length,t=0;i>t;t++)this.emitters[t]&&(this.emitters[t].destroy(),delete this.emitters[t]);this.emitters=[],this.time=0,this.oldTime=0,e.pool.release()}},z.Proton=e;var a=U.prototype;U.initialize=function(e){e.addEventListener=a.addEventListener,e.removeEventListener=a.removeEventListener,e.removeAllEventListeners=a.removeAllEventListeners,e.hasEventListener=a.hasEventListener,e.dispatchEvent=a.dispatchEvent},a._listeners=null,a.initialize=function(){},a.addEventListener=function(t,i){var e=this._listeners;e?this.removeEventListener(t,i):e=this._listeners={};var n=e[t];return n||(n=e[t]=[]),n.push(i),i},a.removeEventListener=function(n,a){var i=this._listeners;if(i){var e=i[n];if(e)for(var t=0,r=e.length;r>t;t++)if(e[t]==a){1==r?delete i[n]:e.splice(t,1);break}}},a.removeAllEventListeners=function(e){e?this._listeners&&delete this._listeners[e]:this._listeners=null},a.dispatchEvent=function(i){var t=!1,r=this._listeners;if(i&&r){var e=r[i.type];if(!e)return t;e=e.slice();for(var n=0,a=e.length;a>n;n++){var s=e[n];t=t||s(i)}}return!!t},a.hasEventListener=function(t){var e=this._listeners;return!(!e||!e[t])},e.EventDispatcher=U,e.EventDispatcher.initialize(e.prototype),e.Event=st;var J=J||{initValue:function(e,t){var e=null!=e&&e!=S?e:t;return e},isArray:function(e){return"object"==typeof e&&e.hasOwnProperty("length")},destroyArray:function(e){e.length=0},destroyObject:function(e){for(var t in e)delete e[t]},getVector2D:function(t,i){if("object"==typeof t)return t;var n=new e.Vector2D(t,i);return n},judgeVector2D:function(e){var t="";return(e.hasOwnProperty("x")||e.hasOwnProperty("y")||e.hasOwnProperty("p")||e.hasOwnProperty("position"))&&(t+="p"),(e.hasOwnProperty("vx")||e.hasOwnProperty("vx")||e.hasOwnProperty("v")||e.hasOwnProperty("velocity"))&&(t+="v"),(e.hasOwnProperty("ax")||e.hasOwnProperty("ax")||e.hasOwnProperty("a")||e.hasOwnProperty("accelerate"))&&(t+="a"),t},setVector2DByObject:function(t,e){e.hasOwnProperty("x")&&(t.p.x=e.x),e.hasOwnProperty("y")&&(t.p.y=e.y),e.hasOwnProperty("vx")&&(t.v.x=e.vx),e.hasOwnProperty("vy")&&(t.v.y=e.vy),e.hasOwnProperty("ax")&&(t.a.x=e.ax),e.hasOwnProperty("ay")&&(t.a.y=e.ay),e.hasOwnProperty("p")&&particle.p.copy(e.p),e.hasOwnProperty("v")&&particle.v.copy(e.v),e.hasOwnProperty("a")&&particle.a.copy(e.a),e.hasOwnProperty("position")&&particle.p.copy(e.position),e.hasOwnProperty("velocity")&&particle.v.copy(e.velocity),e.hasOwnProperty("accelerate")&&particle.a.copy(e.accelerate)},addPrototypeByObject:function(i,n,r){for(var t in n)r?r.indexOf(t)<0&&(i[t]=e.Util.getSpanValue(n[t])):i[t]=e.Util.getSpanValue(n[t]);return i},setPrototypeByObject:function(i,n,r){for(var t in n)i.hasOwnProperty(t)&&(r?r.indexOf(t)<0&&(i[t]=e.Util.getSpanValue(n[t])):i[t]=e.Util.getSpanValue(n[t]));return i},setSpanValue:function(t,i,n){return t instanceof e.Span?t:i?n?new e.Span(t,i,n):new e.Span(t,i):new e.Span(t)},getSpanValue:function(t){return t instanceof e.Span?t.getValue():t},inherits:function(e,t){if(e._super_=t,Object.create)e.prototype=Object.create(t.prototype,{constructor:{value:t}});else{var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},getImageData:function(t,i,e){t.drawImage(i,e.x,e.y);var n=t.getImageData(e.x,e.y,e.width,e.height);return t.clearRect(e.x,e.y,e.width,e.height),n},getImage:function(e,t,i,n){"string"==typeof e?this.loadAndSetImage(e,t,i,n):"object"==typeof e?this.loadAndSetImage(e.src,t,i,n):e instanceof Image&&this.loadedImage(e.src,t,i,n,e)},loadedImage:function(i,t,r,n,a){if(t.target=a,t.transform.src=i,e.TextureBuffer[i]||(e.TextureBuffer[i]=t.target),r)if(e.TextureCanvasBuffer[i])t.transform.canvas=e.TextureCanvasBuffer[i];else{var s=e.WebGLUtil.nhpot(t.target.width),o=e.WebGLUtil.nhpot(t.target.height);t.transform.canvas=e.DomUtil.createCanvas("canvas"+i,s,o);var l=t.transform.canvas.getContext("2d");l.drawImage(t.target,0,0,t.target.width,t.target.height),e.TextureCanvasBuffer[i]=t.transform.canvas}n&&n(t)},loadAndSetImage:function(t,i,n,r){if(e.TextureBuffer[t])this.loadedImage(t,i,n,r,e.TextureBuffer[t]);else{var s=this,a=new Image;a.onload=function(e){s.loadedImage(t,i,n,r,e.target)},a.src=t}},hexToRGB:function(e){var t="#"==e.charAt(0)?e.substring(1,7):e,i=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),r=parseInt(t.substring(4,6),16);return{r:i,g:n,b:r}},rgbToHex:function(e){return"rgb("+e.r+", "+e.g+", "+e.b+")"}};e.Util=J;var G=G||{ipot:function(e){return 0==(e&e-1)},nhpot:function(e){--e;for(var t=1;32>t;t<<=1)e|=e>>t;return e+1},makeTranslation:function(e,t){return[1,0,0,0,1,0,e,t,1]},makeRotation:function(e){var t=Math.cos(e),i=Math.sin(e);return[t,-i,0,i,t,0,0,0,1]},makeScale:function(e,t){return[e,0,0,0,t,0,0,0,1]},matrixMultiply:function(e,t){var i=e[0],n=e[1],r=e[2],a=e[3],s=e[4],o=e[5],l=e[6],c=e[7],v=e[8],u=t[0],d=t[1],p=t[2],f=t[3],_=t[4],m=t[5],g=t[6],y=t[7],h=t[8];return[i*u+n*f+r*g,i*d+n*_+r*y,i*p+n*m+r*h,a*u+s*f+o*g,a*d+s*_+o*y,a*p+s*m+o*h,l*u+c*f+v*g,l*d+c*_+v*y,l*p+c*m+v*h]}};e.WebGLUtil=G;var Q=Q||{createCanvas:function(i,n,r,t){var e=document.createElement("canvas"),a=t?t:"absolute";return e.id=i,e.width=n,e.height=r,e.style.position=a,e.style.opacity=0,this.transformDom(e,-500,-500,0,0),e},transformDom:function(e,t,i,n,r){e.style.WebkitTransform="translate("+t+"px, "+i+"px) scale("+n+") rotate("+r+"deg)",e.style.MozTransform="translate("+t+"px, "+i+"px) scale("+n+") rotate("+r+"deg)",e.style.OTransform="translate("+t+"px, "+i+"px) scale("+n+") rotate("+r+"deg)",e.style.msTransform="translate("+t+"px, "+i+"px) scale("+n+") rotate("+r+"deg)",e.style.transform="translate("+t+"px, "+i+"px) scale("+n+") rotate("+r+"deg)"}};e.DomUtil=Q,L.prototype.set=function(i,t){0==t?e.Mat3.set(i,this.mats[0]):e.Mat3.multiply(this.mats[t-1],i,this.mats[t]),this.size=Math.max(this.size,t+1)},L.prototype.push=function(t){0==this.size?e.Mat3.set(t,this.mats[0]):e.Mat3.multiply(this.mats[this.size-1],t,this.mats[this.size]),this.size++},L.prototype.pop=function(){this.size>0&&this.size--},L.prototype.top=function(){return this.mats[this.size-1]},e.MStack=L,D.ID=0,D.prototype={getDirection:function(){return Math.atan2(this.v.x,-this.v.y)*(180/Math.PI)},reset:function(t){return this.life=1/0,this.age=0,this.energy=1,this.dead=!1,this.sleep=!1,this.target=null,this.sprite=null,this.parent=null,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.easing=e.ease.setEasingByName(e.easeLinear),t?(this.transform={},this.p=new e.Vector2D,this.v=new e.Vector2D,this.a=new e.Vector2D,this.old={p:new e.Vector2D,v:new e.Vector2D,a:new e.Vector2D},this.behaviors=[]):(e.Util.destroyObject(this.transform),this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.removeAllBehaviors()),this.transform.rgb={r:255,g:255,b:255},this},update:function(t,i){if(!this.sleep){this.age+=t;var e,n=this.behaviors.length;for(e=0;n>e;e++)this.behaviors[e]&&this.behaviors[e].applyBehavior(this,t,i)}if(this.age>=this.life)this.destroy();else{var r=this.easing(this.age/this.life);this.energy=Math.max(1-r,0)}},addBehavior:function(e){this.behaviors.push(e),e.hasOwnProperty("parents")&&e.parents.push(this),e.initialize(this)},addBehaviors:function(t){var e,i=t.length;for(e=0;i>e;e++)this.addBehavior(t[e])},removeBehavior:function(e){var t=this.behaviors.indexOf(e);if(t>-1){var e=this.behaviors.splice(t,1);e.parents=null}},removeAllBehaviors:function(){e.Util.destroyArray(this.behaviors)},destroy:function(){this.removeAllBehaviors(),this.energy=0,this.dead=!0,this.parent=null}},e.Particle=D,X.prototype={create:function(t){return t?new newTypeParticle:new e.Particle},getCount:function(){return this.poolList.length},add:function(){return this.poolList.push(this.create())},get:function(){return 0===this.poolList.length?this.create():this.poolList.pop().reset()},set:function(t){return this.poolList.length<e.POOL_MAX?this.poolList.push(t):void 0},release:function(){for(var e=0;e<this.poolList.length;e++)this.poolList[e].destroy&&this.poolList[e].destroy(),delete this.poolList[e];this.poolList=[]}},e.ParticlePool=X;var K={randomAToB:function(e,t,i){return i?Math.floor(Math.random()*(t-e))+e:e+Math.random()*(t-e)},randomFloating:function(e,t,i){return K.randomAToB(e-t,e+t,i)},randomZone:function(){},degreeTransform:function(e){return e*Math.PI/180},toColor16:function(e){return"#"+e.toString(16)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}};e.MathUtils=K;var Z=function(t){this.type=e.Util.initValue(t,e.EULER)};Z.prototype={integrate:function(e,t,i){this.eulerIntegrate(e,t,i)},eulerIntegrate:function(e,t,i){e.sleep||(e.old.p.copy(e.p),e.old.v.copy(e.v),e.a.multiplyScalar(1/e.mass),e.v.add(e.a.multiplyScalar(t)),e.p.add(e.old.v.multiplyScalar(t)),i&&e.v.multiplyScalar(i),e.a.clear())}},e.NumericalIntegration=Z;var et=function(e,t){this.x=e||0,this.y=t||0};et.prototype={set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getGradient:function(){return 0!=this.x?Math.atan2(this.y,this.x):this.y>0?Math.PI/2:this.y<0?-Math.PI/2:void 0},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return t!==S?this.addVectors(e,t):(this.x+=e.x,this.y+=e.y,this)},addXY:function(e,t){return this.x+=e,this.y+=t,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScalar:function(e){return this.x+=e,this.y+=e,this},sub:function(e,t){return t!==S?this.subVectors(e,t):(this.x-=e.x,this.y-=e.y,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divideScalar:function(e){return 0!==e?(this.x/=e,this.y/=e):this.set(0,0),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},rotate:function(e){var t=this.x,i=this.y;return this.x=t*Math.cos(e)+i*Math.sin(e),this.y=-t*Math.sin(e)+i*Math.cos(e),this},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y},toArray:function(){return[this.x,this.y]},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new e.Vector2D(this.x,this.y)}},e.Vector2D=et;var tt=function(e,t){this.r=Math.abs(e)||0,this.tha=t||0};tt.prototype={set:function(e,t){return this.r=e,this.tha=t,this},setR:function(e){return this.r=e,this},setTha:function(e){return this.tha=e,this},copy:function(e){return this.r=e.r,this.tha=e.tha,this},toVector:function(){return new e.Vector2D(this.getX(),this.getY())},getX:function(){return this.r*Math.sin(this.tha)},getY:function(){return-this.r*Math.cos(this.tha)},normalize:function(){return this.r=1,this},equals:function(e){return e.r===this.r&&e.tha===this.tha},toArray:function(){return[this.r,this.tha]},clear:function(){return this.r=0,this.tha=0,this},clone:function(){return new e.Polar2D(this.r,this.tha)}},e.Polar2D=tt,H.prototype={getValue:function(t){return this.isArray?this.a[Math.floor(this.a.length*Math.random())]:this.center?e.MathUtils.randomFloating(this.a,this.b,t):e.MathUtils.randomAToB(this.a,this.b,t)}},e.Span=H,e.getSpan=function(t,i,n){return new e.Span(t,i,n)},e.Util.inherits(N,e.Span),N.prototype.getValue=function(){var t=this.colorArr[Math.floor(this.colorArr.length*Math.random())];return"random"==t||"Random"==t?e.MathUtils.randomColor():t},e.ColorSpan=N,V.prototype={contains:function(e,t){return e<=this.right&&e>=this.x&&t<=this.bottom&&t>=this.y?!0:!1}},e.Rectangle=V;var it=it||{create:function(e){var t=new Float32Array(9);return e&&this.set(e,t),t},set:function(i,t){for(var e=0;9>e;e++)t[e]=i[e];return t},multiply:function(t,i,e){var n=t[0],r=t[1],_=t[2],a=t[3],s=t[4],m=t[6],f=t[7],h=i[0],u=i[1],p=i[2],d=i[3],c=i[4],o=i[6],l=i[7];return e[0]=h*n+u*a,e[1]=h*r+u*s,e[2]=_*p,e[3]=d*n+c*a,e[4]=d*r+c*s,e[6]=o*n+l*a+m,e[7]=o*r+l*s+f,e},inverse:function(i,t){var e,n=i[0],r=i[1],a=i[3],s=i[4],o=i[6],l=i[7],c=s,h=-a,u=l*a-s*o,d=n*c+r*h;return e=1/d,t[0]=c*e,t[1]=-r*e,t[3]=h*e,t[4]=n*e,t[6]=u*e,t[7]=(-l*n+r*o)*e,t},multiplyVec2:function(e,i,t){var n=i[0],r=i[1];return t[0]=n*e[0]+r*e[3]+e[6],t[1]=n*e[1]+r*e[4]+e[7],t}};e.Mat3=it,F.id=0,F.prototype={reset:function(t,i){this.life=e.Util.initValue(t,1/0),this.easing=e.Util.initValue(i,e.ease.setEasingByName(e.easeLinear))},normalizeForce:function(t){return t.multiplyScalar(e.MEASURE)},normalizeValue:function(t){return t*e.MEASURE},initialize:function(){},applyBehavior:function(e,t){if(this.age+=t,this.age>=this.life||this.dead)this.energy=0,this.dead=!0,this.destroy();else{var i=this.easing(e.age/e.life);this.energy=Math.max(1-i,0)}},destroy:function(){var e,t=this.parents.length;for(e=0;t>e;e++)this.parents[e].removeBehavior(this);this.parents=[]}},e.Behavior=F,W.prototype={init:function(){this.startTime=0,this.nextTime=this.timePan.getValue()},getValue:function(e){return this.startTime+=e,this.startTime>=this.nextTime?(this.startTime=0,this.nextTime=this.timePan.getValue(),1==this.numPan.b?this.numPan.getValue(!1)>.5?1:0:this.numPan.getValue(!0)):0}},e.Rate=W,O.prototype.reset=function(){},O.prototype.init=function(t,e){this.initialize(e?e:t)},O.prototype.initialize=function(){},e.Initialize=O;var at={initialize:function(n,r,i){var t,a=i.length;for(t=0;a>t;t++)i[t]instanceof e.Initialize?i[t].init(n,r):e.InitializeUtil.init(n,r,i[t]);e.InitializeUtil.bindEmitter(n,r)},init:function(n,t,i){e.Util.setPrototypeByObject(t,i),e.Util.setVector2DByObject(t,i)},bindEmitter:function(t,i){t.bindEmitter&&(i.p.add(t.p),i.v.add(t.v),i.a.add(t.a),i.v.rotate(e.MathUtils.degreeTransform(t.rotation)))}};e.InitializeUtil=at,e.Util.inherits(j,e.Initialize),j.prototype.initialize=function(e){e.life=1/0==this.lifePan.a?1/0:this.lifePan.getValue()},e.Life=j,e.Util.inherits(C,e.Initialize),C.prototype.reset=function(t){this.zone=e.Util.initValue(t,new e.PointZone)},C.prototype.initialize=function(e){this.zone.getPosition(),e.p.x=this.zone.vector.x,e.p.y=this.zone.vector.y},e.Position=C,e.P=C,e.Util.inherits(b,e.Initialize),b.prototype.reset=function(t,i,n){this.rPan=e.Util.setSpanValue(t),this.thaPan=e.Util.setSpanValue(i),this.type=e.Util.initValue(n,"vector")},b.prototype.normalizeVelocity=function(t){return t*e.MEASURE},b.prototype.initialize=function(t){if("p"==this.type||"P"==this.type||"polar"==this.type){var i=new e.Polar2D(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*Math.PI/180);t.v.x=i.getX(),t.v.y=i.getY()}else t.v.x=this.normalizeVelocity(this.rPan.getValue()),t.v.y=this.normalizeVelocity(this.thaPan.getValue())},e.Velocity=b,e.V=b,e.Util.inherits(B,e.Initialize),B.prototype.initialize=function(e){e.mass=this.massPan.getValue()},e.Mass=B,e.Util.inherits(A,e.Initialize),A.prototype.reset=function(t,i,n){this.radius=e.Util.setSpanValue(t,i,n)},A.prototype.initialize=function(e){e.radius=this.radius.getValue(),e.transform.oldRadius=e.radius},e.Radius=A,e.Util.inherits(k,e.Initialize),k.prototype.initialize=function(t){var e=this.image.getValue();t.target="string"==typeof e?{width:this.w,height:this.h,src:e}:e},k.prototype.setSpanValue=function(t){return t instanceof e.ColorSpan?t:new e.ColorSpan(t)},e.ImageTarget=k,e.Util.inherits(f,e.Behavior),f.prototype.reset=function(i,n,t,r){this.force=this.normalizeForce(new e.Vector2D(i,n)),t&&f._super_.prototype.reset.call(this,t,r)},f.prototype.applyBehavior=function(e,t,i){f._super_.prototype.applyBehavior.call(this,e,t,i),e.a.add(this.force)},e.Force=f,e.F=f,e.Util.inherits(g,e.Behavior),g.prototype.reset=function(i,n,r,t,a){this.targetPosition=e.Util.initValue(i,new e.Vector2D),this.radius=e.Util.initValue(r,1e3),this.force=e.Util.initValue(this.normalizeValue(n),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new e.Vector2D,this.lengthSq=0,t&&g._super_.prototype.reset.call(this,t,a)},g.prototype.applyBehavior=function(e,t,i){g._super_.prototype.applyBehavior.call(this,e,t,i),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(e.p),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-6&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),e.a.add(this.attractionForce))},e.Attraction=g,e.Util.inherits(y,e.Behavior),y.prototype.reset=function(i,n,r,t,a){this.panFoce=new e.Vector2D(i,n),this.panFoce=this.normalizeForce(this.panFoce),this.delay=r,t&&y._super_.prototype.reset.call(this,t,a)},y.prototype.applyBehavior=function(t,i,n){y._super_.prototype.applyBehavior.call(this,t,i,n),this.time+=i,this.time>=this.delay&&(t.a.addXY(e.MathUtils.randomAToB(-this.panFoce.x,this.panFoce.x),e.MathUtils.randomAToB(-this.panFoce.y,this.panFoce.y)),this.time=0)},e.RandomDrift=y,e.Util.inherits(P,e.Attraction),P.prototype.reset=function(e,t,i,n,r){P._super_.prototype.reset.call(this,e,t,i,n,r),this.force*=-1},e.Repulsion=P,e.Util.inherits(E,e.Force),E.prototype.reset=function(e,t,i){E._super_.prototype.reset.call(this,0,e,t,i)},e.Gravity=E,e.G=E,e.Util.inherits(T,e.Behavior),T.prototype.reset=function(i,n,r,t,a){this.emitter=e.Util.initValue(i,null),this.mass=e.Util.initValue(n,!0),this.callback=e.Util.initValue(r,null),this.collisionPool=[],this.delta=new e.Vector2D,t&&T._super_.prototype.reset.call(this,t,a)},T.prototype.applyBehavior=function(t,h,a){for(var e,n,i,s,o,l=this.emitter?this.emitter.particles.slice(a):this.pool.slice(a),c=l.length,r=0;c>r;r++)e=l[r],e!==t&&(this.delta.copy(e.p),this.delta.sub(t.p),n=this.delta.lengthSq(),distance=t.radius+e.radius,distance*distance>=n&&(i=distance-Math.sqrt(n),i+=.5,totalMass=t.mass+e.mass,s=this.mass?e.mass/totalMass:.5,o=this.mass?t.mass/totalMass:.5,t.p.add(this.delta.clone().normalize().multiplyScalar(i*-s)),e.p.add(this.delta.normalize().multiplyScalar(i*o)),this.callback&&this.callback(t,e)))},e.Collision=T,e.Util.inherits(v,e.Behavior),v.prototype.reset=function(i,n,t,r){this.zone=i,this.zone.crossType=e.Util.initValue(n,"dead"),t&&v._super_.prototype.reset.call(this,t,r)},v.prototype.applyBehavior=function(e,t,i){v._super_.prototype.applyBehavior.call(this,e,t,i),this.zone.crossing(e)},e.CrossZone=v,e.Util.inherits(_,e.Behavior),_.prototype.reset=function(n,t,i,r){this.same=null==t||t==S?!0:!1,this.a=e.Util.setSpanValue(e.Util.initValue(n,1)),this.b=e.Util.setSpanValue(t),i&&_._super_.prototype.reset.call(this,i,r)},_.prototype.initialize=function(e){e.transform.alphaA=this.a.getValue(),e.transform.alphaB=this.same?e.transform.alphaA:this.b.getValue()},_.prototype.applyBehavior=function(e,t,i){_._super_.prototype.applyBehavior.call(this,e,t,i),e.alpha=e.transform.alphaB+(e.transform.alphaA-e.transform.alphaB)*this.energy,e.alpha<.001&&(e.alpha=0)},e.Alpha=_,e.Util.inherits(d,e.Behavior),d.prototype.reset=function(n,t,i,r){this.same=null==t||t==S?!0:!1,this.a=e.Util.setSpanValue(e.Util.initValue(n,1)),this.b=e.Util.setSpanValue(t),i&&d._super_.prototype.reset.call(this,i,r)},d.prototype.initialize=function(e){e.transform.scaleA=this.a.getValue(),e.transform.oldRadius=e.radius,e.transform.scaleB=this.same?e.transform.scaleA:this.b.getValue()},d.prototype.applyBehavior=function(e,t,i){d._super_.prototype.applyBehavior.call(this,e,t,i),e.scale=e.transform.scaleB+(e.transform.scaleA-e.transform.scaleB)*this.energy,e.scale<1e-4&&(e.scale=0),e.radius=e.transform.oldRadius*e.scale},e.Scale=d,e.Util.inherits(p,e.Behavior),p.prototype.reset=function(n,t,r,i,a){this.same=null==t||t==S?!0:!1,this.a=e.Util.setSpanValue(e.Util.initValue(n,"Velocity")),this.b=e.Util.setSpanValue(e.Util.initValue(t,0)),this.style=e.Util.initValue(r,"to"),i&&p._super_.prototype.reset.call(this,i,a)},p.prototype.initialize=function(e){e.rotation=this.a.getValue(),e.transform.rotationA=this.a.getValue(),this.same||(e.transform.rotationB=this.b.getValue())},p.prototype.applyBehavior=function(e,t,i){p._super_.prototype.applyBehavior.call(this,e,t,i),this.same?("V"==this.a.a||"Velocity"==this.a.a||"v"==this.a.a)&&(e.rotation=e.getDirection()):e.rotation+="to"==this.style||"TO"==this.style||"_"==this.style?e.transform.rotationB+(e.transform.rotationA-e.transform.rotationB)*this.energy:e.transform.rotationB},e.Rotate=p,e.Util.inherits(u,e.Behavior),u.prototype.reset=function(t,i,e,n){this.color1=this.setSpanValue(t),this.color2=this.setSpanValue(i),e&&u._super_.prototype.reset.call(this,e,n)},u.prototype.initialize=function(t){t.color=this.color1.getValue(),t.transform.beginRGB=e.Util.hexToRGB(t.color),this.color2&&(t.transform.endRGB=e.Util.hexToRGB(this.color2.getValue()))},u.prototype.applyBehavior=function(e,t,i){this.color2?(u._super_.prototype.applyBehavior.call(this,e,t,i),e.transform.rgb.r=e.transform.endRGB.r+(e.transform.beginRGB.r-e.transform.endRGB.r)*this.energy,e.transform.rgb.g=e.transform.endRGB.g+(e.transform.beginRGB.g-e.transform.endRGB.g)*this.energy,e.transform.rgb.b=e.transform.endRGB.b+(e.transform.beginRGB.b-e.transform.endRGB.b)*this.energy,e.transform.rgb.r=parseInt(e.transform.rgb.r,10),e.transform.rgb.g=parseInt(e.transform.rgb.g,10),e.transform.rgb.b=parseInt(e.transform.rgb.b,10)):(e.transform.rgb.r=e.transform.beginRGB.r,e.transform.rgb.g=e.transform.beginRGB.g,e.transform.rgb.b=e.transform.beginRGB.b)},u.prototype.setSpanValue=function(t){return t?t instanceof e.ColorSpan?t:new e.ColorSpan(t):null},e.Color=u,e.Util.inherits(x,e.Behavior),x.prototype.reset=function(i,n,t,r){this.distanceVec=new e.Vector2D,this.centerPoint=e.Util.initValue(i,new e.Vector2D),this.force=e.Util.initValue(this.normalizeValue(n),100),t&&x._super_.prototype.reset.call(this,t,r)},x.prototype.initialize=function(){},x.prototype.applyBehavior=function(e,n){this.distanceVec.set(this.centerPoint.x-e.p.x,this.centerPoint.y-e.p.y);var t=this.distanceVec.lengthSq();if(0!=t){var r=this.distanceVec.length(),i=this.force*n/(t*r);e.v.x+=i*this.distanceVec.x,e.v.y+=i*this.distanceVec.y}},e.GravityWell=x,i.ID=0,e.Util.inherits(i,e.Particle),e.EventDispatcher.initialize(i.prototype),i.prototype.emit=function(i,t){this.emitTime=0,this.emitTotalTimes=e.Util.initValue(i,1/0),1==t||"life"==t||"destroy"==t?this.life="once"==i?1:this.emitTotalTimes:isNaN(t)||(this.life=t),this.rate.init()},i.prototype.stopEmit=function(){this.emitTotalTimes=-1,this.emitTime=0},i.prototype.removeAllParticles=function(){for(var e=0;e<this.particles.length;e++)this.particles[e].dead=!0},i.prototype.createParticle=function(i,n){var t=e.pool.get();return this.setupParticle(t,i,n),this.dispatchEvent(new e.Event({type:e.PARTICLE_CREATED,particle:t})),t},i.prototype.addSelfInitialize=function(e){e.init?e.init(this):this.initAll()},i.prototype.addInitialize=function(){var e,t=arguments.length;for(e=0;t>e;e++)this.initializes.push(arguments[e])},i.prototype.removeInitialize=function(t){var e=this.initializes.indexOf(t);e>-1&&this.initializes.splice(e,1)},i.prototype.removeInitializers=function(){e.Util.destroyArray(this.initializes)},i.prototype.addBehavior=function(){var e,t=arguments.length;for(e=0;t>e;e++)this.behaviors.push(arguments[e]),arguments[e].hasOwnProperty("parents")&&arguments[e].parents.push(this)},i.prototype.removeBehavior=function(t){var e=this.behaviors.indexOf(t);e>-1&&this.behaviors.splice(e,1)},i.prototype.removeAllBehaviors=function(){e.Util.destroyArray(this.behaviors)},i.prototype.integrate=function(i){var r=1-this.damping;e.integrator.integrate(this,i,r);var t,a=this.particles.length;for(t=0;a>t;t++){var n=this.particles[t];n.update(i,t),e.integrator.integrate(n,i,r),this.dispatchEvent(new e.Event({type:e.PARTICLE_UPDATE,particle:n}))}},i.prototype.emitting=function(t){if("once"==this.emitTotalTimes){var e,i=this.rate.getValue(99999);for(e=0;i>e;e++)this.createParticle();this.emitTotalTimes="none"}else if(!isNaN(this.emitTotalTimes)&&(this.emitTime+=t,this.emitTime<this.emitTotalTimes)){var e,i=this.rate.getValue(t);for(e=0;i>e;e++)this.createParticle()}},i.prototype.update=function(n){this.age+=n,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(n),this.integrate(n);var i,t,r=this.particles.length;for(t=r-1;t>=0;t--)i=this.particles[t],i.dead&&(e.pool.set(i),this.particles.splice(t,1),this.dispatchEvent(new e.Event({type:e.PARTICLE_DEAD,particle:i})))},i.prototype.setupParticle=function(t,i,n){var r=this.initializes,a=this.behaviors;i&&(r=i instanceof Array?i:[i]),n&&(a=n instanceof Array?n:[n]),e.InitializeUtil.initialize(this,t,r),t.addBehaviors(a),t.parent=this,this.particles.push(t)},i.prototype.destroy=function(){this.dead=!0,this.emitTotalTimes=-1,0==this.particles.length&&(this.removeInitializers(),this.removeAllBehaviors(),this.parent&&this.parent.removeEmitter(this))},e.Emitter=i,e.Util.inherits(w,e.Emitter),w.prototype.addSelfBehavior=function(){var e,t=arguments.length;for(e=0;t>e;e++)this.selfBehaviors.push(arguments[e])},w.prototype.removeSelfBehavior=function(t){var e=this.selfBehaviors.indexOf(t);e>-1&&this.selfBehaviors.splice(e,1)},w.prototype.update=function(t){if(w._super_.prototype.update.call(this,t),!this.sleep){var e,i=this.selfBehaviors.length;for(e=0;i>e;e++)this.selfBehaviors[e].applyBehavior(this,t,e)}},e.BehaviorEmitter=w,e.Util.inherits(c,e.Emitter),c.prototype.initEventHandler=function(){var e=this;this.mousemoveHandler=function(t){e.mousemove.call(e,t)},this.mousedownHandler=function(t){e.mousedown.call(e,t)},this.mouseupHandler=function(t){e.mouseup.call(e,t)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},c.prototype.emit=function(){this._allowEmitting=!0},c.prototype.stopEmit=function(){this._allowEmitting=!1},c.prototype.mousemove=function(e){e.layerX||0==e.layerX?(this.p.x+=(e.layerX-this.p.x)*this.ease,this.p.y+=(e.layerY-this.p.y)*this.ease):(e.offsetX||0==e.offsetX)&&(this.p.x+=(e.offsetX-this.p.x)*this.ease,this.p.y+=(e.offsetY-this.p.y)*this.ease),this._allowEmitting&&c._super_.prototype.emit.call(this,"once")},c.prototype.destroy=function(){c._super_.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},e.FollowEmitter=c;var nt=nt||{easeLinear:function(e){return e},easeInQuad:function(e){return Math.pow(e,2)},easeOutQuad:function(e){return-(Math.pow(e-1,2)-1)},easeInOutQuad:function(e){return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2)},easeInCubic:function(e){return Math.pow(e,3)},easeOutCubic:function(e){return Math.pow(e-1,3)+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},easeInQuart:function(e){return Math.pow(e,4)},easeOutQuart:function(e){return-(Math.pow(e-1,4)-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeInSine:function(e){return-Math.cos(e*(Math.PI/2))+1},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:-Math.pow(2,-10*e)+1},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(-Math.pow(2,-10*--e)+2)},easeInCirc:function(e){return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?.5*e*e*(((t*=1.525)+1)*e-t):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},setEasingByName:function(t){switch(t){case"easeLinear":return e.ease.easeLinear;case"easeInQuad":return e.ease.easeInQuad;case"easeOutQuad":return e.ease.easeOutQuad;case"easeInOutQuad":return e.ease.easeInOutQuad;case"easeInCubic":return e.ease.easeInCubic;case"easeOutCubic":return e.ease.easeOutCubic;case"easeInOutCubic":return e.ease.easeInOutCubic;case"easeInQuart":return e.ease.easeInQuart;case"easeOutQuart":return e.ease.easeOutQuart;case"easeInOutQuart":return e.ease.easeInOutQuart;case"easeInSine":return e.ease.easeInSine;case"easeOutSine":return e.ease.easeOutSine;case"easeInOutSine":return e.ease.easeInOutSine;case"easeInExpo":return e.ease.easeInExpo;case"easeOutExpo":return e.ease.easeOutExpo;case"easeInOutExpo":return e.ease.easeInOutExpo;case"easeInCirc":return e.ease.easeInCirc;case"easeOutCirc":return e.ease.easeOutCirc;case"easeInOutCirc":return e.ease.easeInOutCirc;case"easeInBack":return e.ease.easeInBack;case"easeOutBack":return e.ease.easeOutBack;case"easeInOutBack":return e.ease.easeInOutBack;default:return e.ease.easeLinear}}};e.ease=nt,e.easeLinear="easeLinear",e.easeInQuad="easeInQuad",e.easeOutQuad="easeOutQuad",e.easeInOutQuad="easeInOutQuad",e.easeInCubic="easeInCubic",e.easeOutCubic="easeOutCubic",e.easeInOutCubic="easeInOutCubic",e.easeInQuart="easeInQuart",e.easeOutQuart="easeOutQuart",e.easeInOutQuart="easeInOutQuart",e.easeInSine="easeInSine",e.easeOutSine="easeOutSine",e.easeInOutSine="easeInOutSine",e.easeInExpo="easeInExpo",e.easeOutExpo="easeOutExpo",e.easeInOutExpo="easeInOutExpo",e.easeInCirc="easeInCirc",e.easeOutCirc="easeOutCirc",e.easeInOutCirc="easeInOutCirc",e.easeInBack="easeInBack",e.easeOutBack="easeOutBack",e.easeInOutBack="easeInOutBack",$.prototype={start:function(){this.addEventHandler(),this.renderer.start()},stop:function(){this.renderer.stop()},resize:function(e,t){this.renderer.resize(e,t)},setStroke:function(e,t){this.renderer.hasOwnProperty("stroke")?this.renderer.setStroke(e,t):alert("Sorry this renderer do not suppest stroke method!")},createImageData:function(t){this.renderer instanceof e.PixelRender&&this.renderer.createImageData(t)},setMaxRadius:function(t){this.renderer instanceof e.WebGLRender&&this.renderer.setMaxRadius(t)},blendEquation:function(t){this.renderer instanceof e.WebGLRender&&this.renderer.blendEquation(t)},blendFunc:function(t,i){this.renderer instanceof e.WebGLRender&&this.renderer.blendFunc(t,i)},setType:function(e){this.type=e,this.renderer=this.getRenderer()},getRenderer:function(){switch(this.type){case"dom":return new e.DomRender(this.proton,this.element);case"canvas":return new e.CanvasRender(this.proton,this.element);case"webgl":return new e.WebGLRender(this.proton,this.element);case"easel":return new e.EaselRender(this.proton,this.element);case"easeljs":return new e.EaselRender(this.proton,this.element);case"pixel":return new e.PixelRender(this.proton,this.element);default:return new e.BaseRender(this.proton,this.element)}},render:function(e){this.renderer.render(e)},addEventHandler:function(){this.onProtonUpdate&&(this.renderer.onProtonUpdate=this.onProtonUpdate),this.onParticleCreated&&(this.renderer.onParticleCreated=this.onParticleCreated),this.onParticleUpdate&&(this.renderer.onParticleUpdate=this.onParticleUpdate),this.onParticleDead&&(this.renderer.onParticleDead=this.onParticleDead)}},e.Renderer=$,q.prototype={start:function(){var t=this;this.proton.addEventListener(e.PROTON_UPDATE,function(){t.onProtonUpdate.call(t)}),this.proton.addEventListener(e.PROTON_UPDATE_AFTER,function(){t.onProtonUpdateAfter.call(t)}),this.proton.addEventListener(e.EMITTER_ADDED,function(e){t.onEmitterAdded.call(t,e.emitter)}),this.proton.addEventListener(e.EMITTER_REMOVED,function(e){t.onEmitterRemoved.call(t,e.emitter)});var i,n=this.proton.emitters.length;for(i=0;n>i;i++){var r=this.proton.emitters[i];this.addEmitterListener(r)}},resize:function(){},addEmitterListener:function(i){var t=this;i.addEventListener(e.PARTICLE_CREATED,function(e){t.onParticleCreated.call(t,e.particle)}),i.addEventListener(e.PARTICLE_UPDATE,function(e){t.onParticleUpdate.call(t,e.particle)}),i.addEventListener(e.PARTICLE_DEAD,function(e){t.onParticleDead.call(t,e.particle)})},stop:function(){var e,t=this.proton.emitters.length;for(this.proton.removeAllEventListeners(),e=0;t>e;e++){var i=this.proton.emitters[e];i.removeAllEventListeners()}},onEmitterAdded:function(e){this.addEmitterListener(e)},onEmitterRemoved:function(e){e.removeAllEventListeners()},onProtonUpdate:function(){},onProtonUpdateAfter:function(){},onParticleCreated:function(){},onParticleUpdate:function(){},onParticleDead:function(){}},e.BaseRender=q,e.Util.inherits(s,e.BaseRender),s.prototype.start=function(){s._super_.prototype.start.call(this)},s.prototype.setStroke=function(t,i){t=e.Util.initValue(t,"#000000"),i=e.Util.initValue(i,1),this.stroke={color:t,thinkness:i}},s.prototype.onProtonUpdate=function(){},s.prototype.onParticleCreated=function(t){if(t.target){var i=this;e.Util.getImage(t.target,t,!1,function(e){i.setImgInDIV.call(i,e)})}else t.transform.canvas=e.DomUtil.createCanvas(t.id+"_canvas",t.radius+1,t.radius+1,"absolute"),t.transform.bakOldRadius=t.radius,this.stroke?(t.transform.canvas.width=2*t.radius+2*this.stroke.thinkness,t.transform.canvas.height=2*t.radius+2*this.stroke.thinkness):(t.transform.canvas.width=2*t.radius+1,t.transform.canvas.height=2*t.radius+1),t.transform.context=t.transform.canvas.getContext("2d"),t.transform.context.fillStyle=t.color,t.transform.context.beginPath(),t.transform.context.arc(t.radius,t.radius,t.radius,0,2*Math.PI,!0),this.stroke&&(t.transform.context.strokeStyle=this.stroke.color,t.transform.context.lineWidth=this.stroke.thinkness,t.transform.context.stroke()),t.transform.context.closePath(),t.transform.context.fill(),this.element.appendChild(t.transform.canvas)},s.prototype.onParticleUpdate=function(t){t.target?t.target instanceof Image&&(t.transform.canvas.style.opacity=t.alpha,e.DomUtil.transformDom(t.transform.canvas,t.p.x-t.target.width/2,t.p.y-t.target.height/2,t.scale,t.rotation)):(t.transform.canvas.style.opacity=t.alpha,t.transform.oldRadius?e.DomUtil.transformDom(t.transform.canvas,t.p.x-t.transform.oldRadius,t.p.y-t.transform.oldRadius,t.scale,t.rotation):e.DomUtil.transformDom(t.transform.canvas,t.p.x-t.transform.bakOldRadius,t.p.y-t.transform.bakOldRadius,t.scale,t.rotation))},s.prototype.onParticleDead=function(e){e.transform.canvas&&this.element.removeChild(e.transform.canvas)},s.prototype.setImgInDIV=function(t){t.transform.canvas=e.DomUtil.createCanvas(t.id+"_canvas",t.target.width+1,t.target.height+1,"absolute",t.p.x-t.radius,t.p.y-t.radius),t.transform.context=t.transform.canvas.getContext("2d"),t.transform.context.drawImage(t.target,0,0,t.target.width,t.target.height),this.element.appendChild(t.transform.canvas)},e.DomRender=s,e.Util.inherits(l,e.BaseRender),l.prototype.resize=function(){},l.prototype.start=function(){l._super_.prototype.start.call(this)},l.prototype.onProtonUpdate=function(){},l.prototype.onParticleCreated=function(e){if(e.target)e.target=e.target.clone(),e.target.parent||(e.target.image&&(e.target.regX=e.target.image.width/2,e.target.regY=e.target.image.height/2),this.element.addChild(e.target));else{var t=new createjs.Graphics;this.stroke&&(1==this.stroke?t.beginStroke("#000000"):this.stroke instanceof String&&t.beginStroke(this.stroke)),t.beginFill(e.color).drawCircle(0,0,e.radius);var i=new createjs.Shape(t);e.target=i,this.element.addChild(e.target)}},l.prototype.onParticleUpdate=function(e){e.target&&(e.target.x=e.p.x,e.target.y=e.p.y,e.target.alpha=e.alpha,e.target.scaleX=e.target.scaleY=e.scale,e.target.rotation=e.rotation)},l.prototype.onParticleDead=function(e){e.target&&e.target.parent&&e.target.parent.removeChild(e.target)},e.EaselRender=l,e.Util.inherits(r,e.BaseRender),r.prototype.resize=function(e,t){this.element.width=e,this.element.height=t},r.prototype.start=function(){r._super_.prototype.start.call(this)},r.prototype.setStroke=function(t,i){t=e.Util.initValue(t,"#000000"),i=e.Util.initValue(i,1),this.stroke={color:t,thinkness:i}},r.prototype.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},r.prototype.onParticleCreated=function(t){t.target?e.Util.getImage(t.target,t,!1):t.color=t.color?t.color:"#ff0000"},r.prototype.onParticleUpdate=function(t){if(t.target){if(t.target instanceof Image){var n=t.target.width*t.scale|0,r=t.target.height*t.scale|0,a=t.p.x-n/2,s=t.p.y-r/2;if(t.color){t.transform.buffer||(t.transform.buffer=this.getBuffer(t.target));var i=t.transform.buffer.getContext("2d");i.clearRect(0,0,t.transform.buffer.width,t.transform.buffer.height),i.globalAlpha=t.alpha,i.drawImage(t.target,0,0),i.globalCompositeOperation="source-atop",i.fillStyle=e.Util.rgbToHex(t.transform.rgb),i.fillRect(0,0,t.transform.buffer.width,t.transform.buffer.height),i.globalCompositeOperation="source-over",i.globalAlpha=1,this.context.drawImage(t.transform.buffer,0,0,t.transform.buffer.width,t.transform.buffer.height,a,s,n,r)}else this.context.save(),this.context.globalAlpha=t.alpha,this.context.translate(t.p.x,t.p.y),this.context.rotate(e.MathUtils.degreeTransform(t.rotation)),this.context.translate(-t.p.x,-t.p.y),this.context.drawImage(t.target,0,0,t.target.width,t.target.height,a,s,n,r),this.context.globalAlpha=1,this.context.restore()}}else this.context.fillStyle=t.transform.rgb?"rgba("+t.transform.rgb.r+","+t.transform.rgb.g+","+t.transform.rgb.b+","+t.alpha+")":t.color,this.context.beginPath(),this.context.arc(t.p.x,t.p.y,t.radius,0,2*Math.PI,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()},r.prototype.onParticleDead=function(){},r.prototype.getBuffer=function(t){if(t instanceof Image){var i=t.width+"_"+t.height,e=this.bufferCache[i];return e||(e=document.createElement("canvas"),e.width=t.width,e.height=t.height,this.bufferCache[i]=e),e}},e.CanvasRender=r,e.Util.inherits(n,e.BaseRender),n.prototype.resize=function(e,t){this.element.width=e,this.element.height=t},n.prototype.createImageData=function(t){this.rectangle=t?t:new e.Rectangle(0,0,this.element.width,this.element.height),this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height),this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},n.prototype.start=function(){n._super_.prototype.start.call(this)},n.prototype.onProtonUpdate=function(){this.context.clearRect(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)},n.prototype.onProtonUpdateAfter=function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},n.prototype.onParticleCreated=function(){},n.prototype.onParticleUpdate=function(e){this.imageData&&this.setPixel(this.imageData,Math.floor(e.p.x-this.rectangle.x),Math.floor(e.p.y-this.rectangle.y),e)},n.prototype.setPixel=function(e,i,n,a){var r=a.transform.rgb;if(!(0>i||i>this.element.width||0>n||n>this.elementwidth)){var t=4*((n>>0)*e.width+(i>>0));e.data[t]=r.r,e.data[t+1]=r.g,e.data[t+2]=r.b,e.data[t+3]=255*a.alpha}},n.prototype.onParticleDead=function(){},e.PixelRender=n,e.Util.inherits(t,e.BaseRender),t.prototype.resize=function(e,t){this.umat[4]=-2,this.umat[7]=1,this.smat[0]=1/e,this.smat[4]=1/t,this.mstack.set(this.umat,0),this.mstack.set(this.smat,1),this.gl.viewport(0,0,e,t),this.element.width=e,this.element.height=t},t.prototype.setMaxRadius=function(e){this.circleCanvasURL=this.createCircle(e)},t.prototype.getVertexShader=function(){var e=["uniform vec2 viewport;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 tMat;","varying vec2 vTextureCoord;","varying float alpha;","void main() {","vec3 v = tMat * vec3(aVertexPosition, 1.0);","gl_Position = vec4(v.x, v.y, 0, 1);","vTextureCoord = aTextureCoord;","alpha = tMat[0][2];","}"].join("\n");return e},t.prototype.getFragmentShader=function(){var e=["precision mediump float;","varying vec2 vTextureCoord;","varying float alpha;","uniform sampler2D uSampler;","uniform vec4 color;","uniform bool useTexture;","uniform vec3 uColor;","void main() {","vec4 textureColor = texture2D(uSampler, vTextureCoord);","gl_FragColor = textureColor * vec4(uColor, 1.0);","gl_FragColor.w *= alpha;","}"].join("\n");return e},t.prototype.initVar=function(){this.mstack=new e.MStack,this.umat=e.Mat3.create([2,0,1,0,-2,0,-1,1,1]),this.smat=e.Mat3.create([.01,0,1,0,.01,0,0,0,1]),this.texturebuffers={}},t.prototype.start=function(){t._super_.prototype.start.call(this),this.resize(this.element.width,this.element.height)},t.prototype.blendEquation=function(e){this.gl.blendEquation(this.gl[e])},t.prototype.blendFunc=function(e,t){this.gl.blendFunc(this.gl[e],this.gl[t])},t.prototype.getShader=function(e,i,n){var t;return t=e.createShader(n?e.FRAGMENT_SHADER:e.VERTEX_SHADER),e.shaderSource(t,i),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)?t:(alert(e.getShaderInfoLog(t)),null)},t.prototype.initShaders=function(){var e=this.getShader(this.gl,this.getFragmentShader(),!0),t=this.getShader(this.gl,this.getVertexShader(),!1);this.sprogram=this.gl.createProgram(),this.gl.attachShader(this.sprogram,t),this.gl.attachShader(this.sprogram,e),this.gl.linkProgram(this.sprogram),this.gl.getProgramParameter(this.sprogram,this.gl.LINK_STATUS)||alert("Could not initialise shaders"),this.gl.useProgram(this.sprogram),this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition"),this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.sprogram.tca),this.gl.enableVertexAttribArray(this.sprogram.vpa),this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat"),this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler"),this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture"),this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor"),this.gl.uniform1i(this.sprogram.useTex,1)},t.prototype.initBuffers=function(){this.unitIBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer);var i=[0,3,1,0,2,3];this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),this.gl.STATIC_DRAW);for(var t=[],e=0;100>e;e++)t.push(e);for(idx=new Uint16Array(t),this.unitI33=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW),t=[],e=0;100>e;e++)t.push(e,e+1,e+2);idx=new Uint16Array(t),this.stripBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW)},t.prototype.createCircle=function(n){this.circleCanvasRadius=e.WebGLUtil.nhpot(e.Util.initValue(n,32));var i=e.DomUtil.createCanvas("circle_canvas",2*this.circleCanvasRadius,2*this.circleCanvasRadius),t=i.getContext("2d");return t.beginPath(),t.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,2*Math.PI,!0),t.closePath(),t.fillStyle="#FFF",t.fill(),i.toDataURL()},t.prototype.setImgInCanvas=function(t){var i=t.target.width,n=t.target.height,a=e.WebGLUtil.nhpot(t.target.width),s=e.WebGLUtil.nhpot(t.target.height),o=t.target.width/a,r=t.target.height/s;this.texturebuffers[t.transform.src]||(this.texturebuffers[t.transform.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]),t.transform.texture=this.texturebuffers[t.transform.src][0],t.transform.vcBuffer=this.texturebuffers[t.transform.src][1],t.transform.tcBuffer=this.texturebuffers[t.transform.src][2],this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.transform.tcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,o,0,0,r,r,r]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.transform.vcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,i,0,0,n,i,n]),this.gl.STATIC_DRAW);var l=t.transform.canvas.getContext("2d"),c=l.getImageData(0,0,a,s);this.gl.bindTexture(this.gl.TEXTURE_2D,t.transform.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,c),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D),t.transform.textureLoaded=!0,t.transform.textureWidth=i,t.transform.textureHeight=n},t.prototype.setStroke=function(){},t.prototype.onProtonUpdate=function(){},t.prototype.onParticleCreated=function(t){var i=this;t.transform.textureLoaded=!1,t.transform.tmat=e.Mat3.create(),t.transform.tmat[8]=1,t.transform.imat=e.Mat3.create(),t.transform.imat[8]=1,t.target?e.Util.getImage(t.target,t,!0,function(e){i.setImgInCanvas.call(i,e),e.transform.oldScale=1}):e.Util.getImage(this.circleCanvasURL,t,!0,function(e){i.setImgInCanvas.call(i,e),e.transform.oldScale=e.radius/i.circleCanvasRadius})},t.prototype.onParticleUpdate=function(e){e.transform.textureLoaded&&(this.updateMatrix(e),this.gl.uniform3f(this.sprogram.color,e.transform.rgb.r/255,e.transform.rgb.g/255,e.transform.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,!1,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.transform.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.transform.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,e.transform.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())},t.prototype.onParticleDead=function(){},t.prototype.updateMatrix=function(t){var r=e.WebGLUtil.makeTranslation(-t.transform.textureWidth/2,-t.transform.textureHeight/2),a=e.WebGLUtil.makeTranslation(t.p.x,t.p.y),s=t.rotation*(Math.PI/180),o=e.WebGLUtil.makeRotation(s),n=t.scale*t.transform.oldScale,l=e.WebGLUtil.makeScale(n,n),i=e.WebGLUtil.matrixMultiply(r,l);i=e.WebGLUtil.matrixMultiply(i,o),i=e.WebGLUtil.matrixMultiply(i,a),e.Mat3.inverse(i,t.transform.imat),i[2]=t.alpha,this.mstack.push(i)},e.WebGLRender=t,Y.prototype={getPosition:function(){},crossing:function(){}},e.Zone=Y,e.Util.inherits(o,e.Zone),o.prototype.getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient),this.vector},o.prototype.getDirection=function(t,i){var n=this.dy,e=-this.dx,r=this.dot,a=0==e?1:e;return(n*t+e*i+r)*a>0?!0:!1},o.prototype.getDistance=function(e,t){var i=this.dy,n=-this.dx,r=this.dot,a=i*e+n*t+r;return a/Math.sqrt(this.xxyy)},o.prototype.getSymmetric=function(e){var r=e.getGradient(),a=this.getGradient(),t=2*(a-r),i=e.x,n=e.y;return e.x=i*Math.cos(t)-n*Math.sin(t),e.y=i*Math.sin(t)+n*Math.cos(t),e},o.prototype.getGradient=function(){return Math.atan2(this.dy,this.dx)},o.prototype.getRange=function(e,t){var i=Math.abs(this.getGradient());i<=Math.PI/4?e.p.x<this.maxx&&e.p.x>this.minx&&t():e.p.y<this.maxy&&e.p.y>this.miny&&t()},o.prototype.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},o.prototype.crossing=function(e){var t=this;"dead"==this.crossType?">"==this.direction||"R"==this.direction||"right"==this.direction||"down"==this.direction?this.getRange(e,function(){t.getDirection(e.p.x,e.p.y)&&(e.dead=!0)}):this.getRange(e,function(){t.getDirection(e.p.x,e.p.y)||(e.dead=!0)}):"bound"==this.crossType?this.getRange(e,function(){t.getDistance(e.p.x,e.p.y)<=e.radius&&(0==t.dx?e.v.x*=-1:0==t.dy?e.v.y*=-1:t.getSymmetric(e.v))}):"cross"==this.crossType&&this.alert&&(alert("Sorry lineZone does not support cross method"),this.alert=!1)},e.LineZone=o,e.Util.inherits(m,e.Zone),m.prototype.getPosition=function(){return this.random=Math.random(),this.angle=2*Math.PI*Math.random(),this.vector.x=this.x+this.random*this.radius*Math.cos(this.angle),this.vector.y=this.y+this.random*this.radius*Math.sin(this.angle),this.vector},m.prototype.setCenter=function(e,t){this.center.x=e,this.center.y=t},m.prototype.crossing=function(e){var t=e.p.distanceTo(this.center);"dead"==this.crossType?t-e.radius>this.radius&&(e.dead=!0):"bound"==this.crossType?t+e.radius>=this.radius&&this.getSymmetric(e):"cross"==this.crossType&&this.alert&&(alert("Sorry CircleZone does not support cross method"),this.alert=!1)},m.prototype.getSymmetric=function(e){var r=e.v.getGradient(),a=this.getGradient(e),t=2*(a-r),i=e.v.x,n=e.v.y;e.v.x=i*Math.cos(t)-n*Math.sin(t),e.v.y=i*Math.sin(t)+n*Math.cos(t)},m.prototype.getGradient=function(e){return-Math.PI/2+Math.atan2(e.p.y-this.center.y,e.p.x-this.center.x)},e.CircleZone=m,e.Util.inherits(M,e.Zone),M.prototype.getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector},M.prototype.crossing=function(){this.alert&&(alert("Sorry PointZone does not support crossing method"),this.alert=!1)},e.PointZone=M,e.Util.inherits(R,e.Zone),R.prototype.getPosition=function(){return this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height,this.vector},R.prototype.crossing=function(e){"dead"==this.crossType?(e.p.x+e.radius<this.x?e.dead=!0:e.p.x-e.radius>this.x+this.width&&(e.dead=!0),e.p.y+e.radius<this.y?e.dead=!0:e.p.y-e.radius>this.y+this.height&&(e.dead=!0)):"bound"==this.crossType?(e.p.x-e.radius<this.x?(e.p.x=this.x+e.radius,e.v.x*=-1):e.p.x+e.radius>this.x+this.width&&(e.p.x=this.x+this.width-e.radius,e.v.x*=-1),e.p.y-e.radius<this.y?(e.p.y=this.y+e.radius,e.v.y*=-1):e.p.y+e.radius>this.y+this.height&&(e.p.y=this.y+this.height-e.radius,e.v.y*=-1)):"cross"==this.crossType&&(e.p.x+e.radius<this.x&&e.v.x<=0?e.p.x=this.x+this.width+e.radius:e.p.x-e.radius>this.x+this.width&&e.v.x>=0&&(e.p.x=this.x-e.radius),e.p.y+e.radius<this.y&&e.v.y<=0?e.p.y=this.y+this.height+e.radius:e.p.y-e.radius>this.y+this.height&&e.v.y>=0&&(e.p.y=this.y-e.radius))},e.RectZone=R,e.Util.inherits(h,e.Zone),h.prototype.reset=function(t,i,n,r){this.imageData=t,this.x=e.Util.initValue(i,0),this.y=e.Util.initValue(n,0),this.d=e.Util.initValue(r,2),this.vectors=[],this.setVectors()},h.prototype.setVectors=function(){var e,t,i=this.imageData.width,n=this.imageData.height;for(e=0;i>e;e+=this.d)for(t=0;n>t;t+=this.d){var r=4*((t>>0)*i+(e>>0));this.imageData.data[r+3]>0&&this.vectors.push({x:e+this.x,y:t+this.y})}return this.vector},h.prototype.getBound=function(e,t){var i=4*((t>>0)*this.imageData.width+(e>>0));return this.imageData.data[i+3]>0?!0:!1},h.prototype.getPosition=function(){return this.vector.copy(this.vectors[Math.floor(Math.random()*this.vectors.length)])},h.prototype.getColor=function(t,i){t-=this.x,i-=this.y;var e=4*((i>>0)*this.imageData.width+(t>>0));return{r:this.imageData.data[e],g:this.imageData.data[e+1],b:this.imageData.data[e+2],a:this.imageData.data[e+3]}},h.prototype.crossing=function(e){"dead"==this.crossType?e.dead=this.getBound(e.p.x-this.x,e.p.y-this.y)?!0:!1:"bound"==this.crossType&&(this.getBound(e.p.x-this.x,e.p.y-this.y)||e.v.negate())},e.ImageZone=h;var I=function(){if(z.console&&z.console.log){var e=arguments;if("string"==typeof arguments[0])if(0==arguments[0].indexOf("+")){var t=parseInt(arguments[0]);I.once<t&&(delete e[0],console.log(e),I.once++)}else console.log(e);else console.log(e)}};I.once=0,e.log=I;var rt=rt||{addEventListener:function(t,i){t.addEventListener(e.PROTON_UPDATE,function(){i()})},setStyle:function(i){var n=i||"#ff0000",t=e.Util.hexToRGB(n),r="rgba("+t.r+","+t.g+","+t.b+",0.5)";return r},drawZone:function(a,r,i,s){var t=r.getContext("2d"),n=this.setStyle();this.addEventListener(a,function(){s&&t.clearRect(0,0,r.width,r.height),i instanceof e.PointZone?(t.beginPath(),t.fillStyle=n,t.arc(i.x,i.y,10,0,2*Math.PI,!0),t.fill(),t.closePath()):i instanceof e.LineZone?(t.beginPath(),t.strokeStyle=n,t.moveTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.stroke(),t.closePath()):i instanceof e.RectZone?(t.beginPath(),t.strokeStyle=n,t.drawRect(i.x,i.y,i.width,i.height),t.stroke(),t.closePath()):i instanceof e.CircleZone&&(t.beginPath(),t.strokeStyle=n,t.arc(i.x,i.y,i.radius,0,2*Math.PI,!0),t.stroke(),t.closePath())})},drawEmitter:function(n,t,i,r){var e=t.getContext("2d"),a=this.setStyle();this.addEventListener(n,function(){r&&e.clearRect(0,0,t.width,t.height),e.beginPath(),e.fillStyle=a,e.arc(i.p.x,i.p.y,10,0,2*Math.PI,!0),e.fill(),e.closePath()})},test:{},setTest:function(e,t){this.test[e]=t},getTest:function(e){return this.test.hasOwnProperty(e)?this.test[e]:!1}};e.Debug=rt}(window),!function(){for(var i=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var e=(new Date).getTime(),t=Math.max(0,16-(e-i)),r=window.setTimeout(function(){n(e+t)},t);return i=e+t,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var r="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;if((r._gsQueue||(r._gsQueue=[])).push(function(){"use strict";r._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(r,u,t){var c=function(t){var e,i=[],n=t.length;for(e=0;e!==n;i.push(t[e++]));return i},e=function(i,n,r){t.call(this,i,n,r),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=e.prototype.render},n=1e-10,s=t._internals,p=s.isSelector,l=s.isArray,i=e.prototype=t.to({},.1,{}),a=[];e.version="1.13.1",i.constructor=e,i.kill()._gc=!1,e.killTweensOf=e.killDelayedCallsTo=t.killTweensOf,e.getTweensOf=t.getTweensOf,e.lagSmoothing=t.lagSmoothing,e.ticker=t.ticker,e.render=t.render,i.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),t.prototype.invalidate.call(this)},i.updateTo=function(n,r){var i,s=this.ratio;r&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(i in n)this.vars[i]=n[i];if(this._initted)if(r)this._initted=!1;else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&t._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var o=this._time;this.render(0,!0,!1),this._initted=!1,this.render(o,!0,!1)}else if(this._time>0){this._initted=!1,this._init();for(var a,l=1/(1-s),e=this._firstPT;e;)a=e.s+e.c,e.c*=l,e.s=a-e.c,e=e._next}return this},i.render=function(t,c,o){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var u,h,r,_,e,d,p,m,v=this._dirty?this.totalDuration():this._totalDuration,g=this._time,f=this._totalTime,y=this._cycle,i=this._duration,l=this._rawPrevTime;if(t>=v?(this._totalTime=v,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=i,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(u=!0,h="onComplete"),0===i&&(this._initted||!this.vars.lazy||o)&&(this._startTime===this._timeline._duration&&(t=0),(0===t||0>l||l===n)&&l!==t&&(o=!0,l>n&&(h="onReverseComplete")),this._rawPrevTime=m=!c||t||l===t?t:n)):1e-7>t?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==f||0===i&&l>0&&l!==n)&&(h="onReverseComplete",u=this._reversed),0>t?(this._active=!1,0===i&&(this._initted||!this.vars.lazy||o)&&(l>=0&&(o=!0),this._rawPrevTime=m=!c||t||l===t?t:n)):this._initted||(o=!0)):(this._totalTime=this._time=t,0!==this._repeat&&(_=i+this._repeatDelay,this._cycle=this._totalTime/_>>0,0!==this._cycle&&this._cycle===this._totalTime/_&&this._cycle--,this._time=this._totalTime-this._cycle*_,this._yoyo&&0!==(1&this._cycle)&&(this._time=i-this._time),this._time>i?this._time=i:0>this._time&&(this._time=0)),this._easeType?(e=this._time/i,d=this._easeType,p=this._easePower,(1===d||3===d&&e>=.5)&&(e=1-e),3===d&&(e*=2),1===p?e*=e:2===p?e*=e*e:3===p?e*=e*e*e:4===p&&(e*=e*e*e*e),this.ratio=1===d?1-e:2===d?e:.5>this._time/i?e/2:1-e/2):this.ratio=this._ease.getRatio(this._time/i)),g===this._time&&!o&&y===this._cycle)return void(f!==this._totalTime&&this._onUpdate&&(c||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||a)));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!o&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=g,this._totalTime=f,this._rawPrevTime=l,this._cycle=y,s.lazyTweens.push(this),void(this._lazy=t);this._time&&!u?this.ratio=this._ease.getRatio(this._time/i):u&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==g&&t>=0&&(this._active=!0),0===f&&(2===this._initted&&t>0&&this._init(),this._startAt&&(t>=0?this._startAt.render(t,c,o):h||(h="_dummyGS")),this.vars.onStart&&(0!==this._totalTime||0===i)&&(c||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||a))),r=this._firstPT;r;)r.f?r.t[r.p](r.c*this.ratio+r.s):r.t[r.p]=r.c*this.ratio+r.s,r=r._next;this._onUpdate&&(0>t&&this._startAt&&this._startTime&&this._startAt.render(t,c,o),c||(this._totalTime!==f||u)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||a)),this._cycle!==y&&(c||this._gc||this.vars.onRepeat&&this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||a)),h&&(!this._gc||o)&&(0>t&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(t,c,o),u&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!c&&this.vars[h]&&this.vars[h].apply(this.vars[h+"Scope"]||this,this.vars[h+"Params"]||a),0===i&&this._rawPrevTime===n&&m!==n&&(this._rawPrevTime=0))},e.to=function(t,i,n){return new e(t,i,n)},e.from=function(i,n,t){return t.runBackwards=!0,t.immediateRender=0!=t.immediateRender,new e(i,n,t)},e.fromTo=function(n,r,i,t){return t.startAt=i,t.immediateRender=0!=t.immediateRender&&0!=i.immediateRender,new e(n,r,t)},e.staggerTo=e.allTo=function(i,m,n,u,d,y,g){u=u||0;var h,s,r,o,f=n.delay||0,_=[],v=function(){n.onComplete&&n.onComplete.apply(n.onCompleteScope||this,arguments),d.apply(g||this,y||a)};for(l(i)||("string"==typeof i&&(i=t.selector(i)||i),p(i)&&(i=c(i))),h=i.length,r=0;h>r;r++){s={};for(o in n)s[o]=n[o];s.delay=f,r===h-1&&d&&(s.onComplete=v),_[r]=new e(i[r],m,s),f+=u}return _},e.staggerFrom=e.allFrom=function(i,n,t,r,a,s,o){return t.runBackwards=!0,t.immediateRender=0!=t.immediateRender,e.staggerTo(i,n,t,r,a,s,o)},e.staggerFromTo=e.allFromTo=function(n,r,i,t,a,s,o,l){return t.startAt=i,t.immediateRender=0!=t.immediateRender&&0!=i.immediateRender,e.staggerTo(n,r,t,a,s,o,l)},e.delayedCall=function(r,t,i,n,a){return new e(t,0,{delay:r,onComplete:t,onCompleteParams:i,onCompleteScope:n,onReverseComplete:t,onReverseCompleteParams:i,onReverseCompleteScope:n,immediateRender:!1,useFrames:a,overwrite:0})},e.set=function(t,i){return new e(t,0,i)},e.isTweening=function(e){return t.getTweensOf(e,!0).length>0};var o=function(a,r){for(var i=[],n=0,e=a._first;e;)e instanceof t?i[n++]=e:(r&&(i[n++]=e),i=i.concat(o(e,r)),n=i.length),e=e._next;return i},d=e.getAllTweens=function(e){return o(r._rootTimeline,e).concat(o(r._rootFramesTimeline,e))};e.killAll=function(o,t,i,r){null==t&&(t=!0),null==i&&(i=!0);var a,e,n,s=d(0!=r),l=s.length,c=t&&i&&r;for(n=0;l>n;n++)e=s[n],(c||e instanceof u||(a=e.target===e.vars.onComplete)&&i||t&&!a)&&(o?e.totalTime(e._reversed?0:e.totalDuration()):e._enabled(!1,!1))},e.killChildTweensOf=function(i,u){if(null!=i){var r,a,o,n,d,h=s.tweenLookup;if("string"==typeof i&&(i=t.selector(i)||i),p(i)&&(i=c(i)),l(i))for(n=i.length;--n>-1;)e.killChildTweensOf(i[n],u);else{r=[];for(o in h)for(a=h[o].target.parentNode;a;)a===i&&(r=r.concat(h[o].tweens)),a=a.parentNode;for(d=r.length,n=0;d>n;n++)u&&r[n].totalTime(r[n].totalDuration()),r[n]._enabled(!1,!1)}}};var h=function(o,t,i,n){t=t!==!1,i=i!==!1,n=n!==!1;for(var r,e,a=d(n),l=t&&i&&n,s=a.length;--s>-1;)e=a[s],(l||e instanceof u||(r=e.target===e.vars.onComplete)&&i||t&&!r)&&e.paused(o)};return e.pauseAll=function(e,t,i){h(!0,e,t,i)},e.resumeAll=function(e,t,i){h(!1,e,t,i)},e.globalTimeScale=function(i){var e=r._rootTimeline,a=t.ticker.time;return arguments.length?(i=i||n,e._startTime=a-(a-e._startTime)*e._timeScale/i,e=r._rootFramesTimeline,a=t.ticker.frame,e._startTime=a-(a-e._startTime)*e._timeScale/i,e._timeScale=r._rootTimeline._timeScale=i,i):e._timeScale},i.progress=function(e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},i.totalProgress=function(e){return arguments.length?this.totalTime(this.totalDuration()*e,!1):this._totalTime/this.totalDuration()},i.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!==(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},i.duration=function(e){return arguments.length?r.prototype.duration.call(this,e):this._duration},i.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},i.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},i.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},i.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},e},!0),r._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(o,s,t){var i=function(r){s.call(this,r),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var t,i,e=this.vars;for(i in e)t=e[i],n(t)&&-1!==t.join("").indexOf("{self}")&&(e[i]=this._swapSelfInParams(t));n(e.tweens)&&this.add(e.tweens,0,e.align,e.stagger)},a=1e-10,l=t._internals,f=l.isSelector,n=l.isArray,p=l.lazyTweens,u=l.lazyRender,c=[],h=r._gsDefine.globals,d=function(t){var e,i={};for(e in t)i[e]=t[e];return i},_=function(e,t,i,n){e._timeline.pause(e._startTime),t&&t.apply(n||e._timeline,i||c)},m=function(t){var e,i=[],n=t.length;for(e=0;e!==n;i.push(t[e++]));return i},e=i.prototype=new s;return i.version="1.13.1",e.constructor=i,e.kill()._gc=!1,e.to=function(i,n,e,r){var a=e.repeat&&h.TweenMax||t;return n?this.add(new a(i,n,e),r):this.set(i,e,r)},e.from=function(i,n,e,r){return this.add((e.repeat&&h.TweenMax||t).from(i,n,e),r)},e.fromTo=function(i,n,a,e,r){var s=e.repeat&&h.TweenMax||t;return n?this.add(s.fromTo(i,n,a,e),r):this.set(i,e,r)},e.staggerTo=function(e,o,r,a,l,c,h,u){var n,s=new i({onComplete:c,onCompleteParams:h,onCompleteScope:u,smoothChildTiming:this.smoothChildTiming});for("string"==typeof e&&(e=t.selector(e)||e),f(e)&&(e=m(e)),a=a||0,n=0;e.length>n;n++)r.startAt&&(r.startAt=d(r.startAt)),s.to(e[n],o,d(r),n*a);return this.add(s,l)},e.staggerFrom=function(t,i,e,n,r,a,s,o){return e.immediateRender=0!=e.immediateRender,e.runBackwards=!0,this.staggerTo(t,i,e,n,r,a,s,o)},e.staggerFromTo=function(i,n,t,e,r,a,s,o,l){return e.startAt=t,e.immediateRender=0!=e.immediateRender&&0!=t.immediateRender,this.staggerTo(i,n,e,r,a,s,o,l)},e.call=function(e,i,n,r){return this.add(t.delayedCall(0,e,i,n),r)},e.set=function(n,i,e){return e=this._parseTimeOrLabel(e,0,!0),null==i.immediateRender&&(i.immediateRender=e===this._time&&!this._paused),this.add(new t(n,0,i),e)},i.exportRoot=function(r,s){r=r||{},null==r.smoothChildTiming&&(r.smoothChildTiming=!0);var e,o,n=new i(r),a=n._timeline;for(null==s&&(s=!0),a._remove(n,!0),n._startTime=0,n._rawPrevTime=n._time=n._totalTime=a._time,e=a._first;e;)o=e._next,s&&e instanceof t&&e.target===e.vars.onComplete||n.add(e,e._startTime-e._delay),e=o;return a.add(n,0),n},e.add=function(e,l,c,d){var h,p,u,r,a,f;if("number"!=typeof l&&(l=this._parseTimeOrLabel(l,0,!0,e)),!(e instanceof o)){if(e instanceof Array||e&&e.push&&n(e)){for(c=c||"normal",d=d||0,h=l,p=e.length,u=0;p>u;u++)n(r=e[u])&&(r=new i({tweens:r})),this.add(r,h),"string"!=typeof r&&"function"!=typeof r&&("sequence"===c?h=r._startTime+r.totalDuration()/r._timeScale:"start"===c&&(r._startTime-=r.delay())),h+=d;return this._uncache(!0)}if("string"==typeof e)return this.addLabel(e,l);if("function"!=typeof e)throw"Cannot add "+e+" into the timeline; it is not a tween, timeline, function, or string.";e=t.delayedCall(0,e)}if(s.prototype.add.call(this,e,l),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(a=this,f=a.rawTime()>e._startTime;a._timeline;)f&&a._timeline.smoothChildTiming?a.totalTime(a._totalTime,!0):a._gc&&a._enabled(!0,!1),a=a._timeline;return this},e.remove=function(e){if(e instanceof o)return this._remove(e,!1);if(e instanceof Array||e&&e.push&&n(e)){for(var t=e.length;--t>-1;)this.remove(e[t]);return this}return"string"==typeof e?this.removeLabel(e):this.kill(null,e)},e._remove=function(t,i){s.prototype._remove.call(this,t,i);var e=this._last;return e?this._time>e._startTime+e._totalDuration/e._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},e.append=function(e,t){return this.add(e,this._parseTimeOrLabel(null,t,!0,e))},e.insert=e.insertMultiple=function(e,t,i,n){return this.add(e,t||0,i,n)},e.appendMultiple=function(e,t,i,n){return this.add(e,this._parseTimeOrLabel(null,t,!0,e),i,n)},e.addLabel=function(e,t){return this._labels[e]=this._parseTimeOrLabel(t),this},e.addPause=function(e,t,i,n){return this.call(_,["{self}",t,i,n],this,e)},e.removeLabel=function(e){return delete this._labels[e],this},e.getLabelTime=function(e){return null!=this._labels[e]?this._labels[e]:-1},e._parseTimeOrLabel=function(e,r,a,t){var i;if(t instanceof o&&t.timeline===this)this.remove(t);else if(t&&(t instanceof Array||t.push&&n(t)))for(i=t.length;--i>-1;)t[i]instanceof o&&t[i].timeline===this&&this.remove(t[i]);if("string"==typeof r)return this._parseTimeOrLabel(r,a&&"number"==typeof e&&null==this._labels[r]?e-this.duration():0,a);if(r=r||0,"string"!=typeof e||!isNaN(e)&&null==this._labels[e])null==e&&(e=this.duration());else{if(i=e.indexOf("="),-1===i)return null==this._labels[e]?a?this._labels[e]=this.duration()+r:r:this._labels[e]+r;r=parseInt(e.charAt(i-1)+"1",10)*Number(e.substr(i+1)),e=i>1?this._parseTimeOrLabel(e.substr(0,i-1),0,a):this.duration()}return Number(e)+r},e.seek=function(e,t){return this.totalTime("number"==typeof e?e:this._parseTimeOrLabel(e),t!==!1)},e.stop=function(){return this.paused(!0)},e.gotoAndPlay=function(e,t){return this.play(e,t)},e.gotoAndStop=function(e,t){return this.pause(e,t)},e.render=function(t,i,s){this._gc&&this._enabled(!0,!1);var e,d,o,n,l,h=this._dirty?this.totalDuration():this._totalDuration,r=this._time,_=this._startTime,m=this._timeScale,f=this._paused;if(t>=h?(this._totalTime=this._time=h,this._reversed||this._hasPausedChild()||(d=!0,n="onComplete",0===this._duration&&(0===t||0>this._rawPrevTime||this._rawPrevTime===a)&&this._rawPrevTime!==t&&this._first&&(l=!0,this._rawPrevTime>a&&(n="onReverseComplete"))),this._rawPrevTime=this._duration||!i||t||this._rawPrevTime===t?t:a,t=h+1e-4):1e-7>t?(this._totalTime=this._time=0,(0!==r||0===this._duration&&this._rawPrevTime!==a&&(this._rawPrevTime>0||0>t&&this._rawPrevTime>=0))&&(n="onReverseComplete",d=this._reversed),0>t?(this._active=!1,this._rawPrevTime>=0&&this._first&&(l=!0),this._rawPrevTime=t):(this._rawPrevTime=this._duration||!i||t||this._rawPrevTime===t?t:a,t=0,this._initted||(l=!0))):this._totalTime=this._time=this._rawPrevTime=t,this._time!==r&&this._first||s||l){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==r&&t>0&&(this._active=!0),0===r&&this.vars.onStart&&0!==this._time&&(i||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||c)),this._time>=r)for(e=this._first;e&&(o=e._next,!this._paused||f);)(e._active||e._startTime<=this._time&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(t-e._startTime)*e._timeScale,i,s):e.render((t-e._startTime)*e._timeScale,i,s)),e=o;else for(e=this._last;e&&(o=e._prev,!this._paused||f);)(e._active||r>=e._startTime&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(t-e._startTime)*e._timeScale,i,s):e.render((t-e._startTime)*e._timeScale,i,s)),e=o;this._onUpdate&&(i||(p.length&&u(),this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||c))),n&&(this._gc||(_===this._startTime||m!==this._timeScale)&&(0===this._time||h>=this.totalDuration())&&(d&&(p.length&&u(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!i&&this.vars[n]&&this.vars[n].apply(this.vars[n+"Scope"]||this,this.vars[n+"Params"]||c)))}},e._hasPausedChild=function(){for(var e=this._first;e;){if(e._paused||e instanceof i&&e._hasPausedChild())return!0;e=e._next}return!1},e.getChildren=function(o,a,s,n){n=n||-9999999999;for(var i=[],e=this._first,r=0;e;)n>e._startTime||(e instanceof t?a!==!1&&(i[r++]=e):(s!==!1&&(i[r++]=e),o!==!1&&(i=i.concat(e.getChildren(!0,a,s)),r=i.length))),e=e._next;return i},e.getTweensOf=function(a,s){var e,i,n=this._gc,r=[],o=0;for(n&&this._enabled(!0,!0),e=t.getTweensOf(a),i=e.length;--i>-1;)(e[i].timeline===this||s&&this._contains(e[i]))&&(r[o++]=e[i]);return n&&this._enabled(!1,!0),r},e._contains=function(t){for(var e=t.timeline;e;){if(e===this)return!0;e=e.timeline}return!1},e.shiftChildren=function(r,a,t){t=t||0;for(var i,e=this._first,n=this._labels;e;)e._startTime>=t&&(e._startTime+=r),e=e._next;if(a)for(i in n)n[i]>=t&&(n[i]+=r);return this._uncache(!0)},e._kill=function(t,e){if(!t&&!e)return this._enabled(!1,!1);for(var i=e?this.getTweensOf(e):this.getChildren(!0,!0,!1),n=i.length,r=!1;--n>-1;)i[n]._kill(t,e)&&(r=!0);return r},e.clear=function(i){var e=this.getChildren(!1,!0,!0),t=e.length;for(this._time=this._totalTime=0;--t>-1;)e[t]._enabled(!1,!1);return i!==!1&&(this._labels={}),this._uncache(!0)},e.invalidate=function(){for(var e=this._first;e;)e.invalidate(),e=e._next;return this},e._enabled=function(t,i){if(t===this._gc)for(var e=this._first;e;)e._enabled(t,!0),e=e._next;return s.prototype._enabled.call(this,t,i)},e.duration=function(e){return arguments.length?(0!==this.duration()&&0!==e&&this.timeScale(this._duration/e),this):(this._dirty&&this.totalDuration(),this._duration)},e.totalDuration=function(r){if(!arguments.length){if(this._dirty){for(var a,i,t=0,e=this._last,n=999999999999;e;)a=e._prev,e._dirty&&e.totalDuration(),e._startTime>n&&this._sortChildren&&!e._paused?this.add(e,e._startTime-e._delay):n=e._startTime,0>e._startTime&&!e._paused&&(t-=e._startTime,this._timeline.smoothChildTiming&&(this._startTime+=e._startTime/this._timeScale),this.shiftChildren(-e._startTime,!1,-9999999999),n=0),i=e._startTime+e._totalDuration/e._timeScale,i>t&&(t=i),e=a;this._duration=this._totalDuration=t,this._dirty=!1}return this._totalDuration}return 0!==this.totalDuration()&&0!==r&&this.timeScale(this._totalDuration/r),this},e.usesFrames=function(){for(var e=this._timeline;e._timeline;)e=e._timeline;return e===o._rootFramesTimeline},e.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},i},!0),r._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(r,a,c){var n=function(e){r.call(this,e),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},i=1e-10,t=[],s=a._internals,o=s.lazyTweens,l=s.lazyRender,h=new c(null,null,1,0),e=n.prototype=new r;return e.constructor=n,e.kill()._gc=!1,n.version="1.13.1",e.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),r.prototype.invalidate.call(this)},e.addCallback=function(e,t,i,n){return this.add(a.delayedCall(0,e,i,n),t)},e.removeCallback=function(e,n){if(e)if(null==n)this._kill(null,e);else for(var t=this.getTweensOf(e,!1),i=t.length,r=this._parseTimeOrLabel(n);--i>-1;)t[i]._startTime===r&&t[i]._enabled(!1,!1);return this},e.tweenTo=function(o,i){i=i||{};var r,s,e,n={ease:h,overwrite:i.delay?2:1,useFrames:this.usesFrames(),immediateRender:!1};for(s in i)n[s]=i[s];return n.time=this._parseTimeOrLabel(o),r=Math.abs(Number(n.time)-this._time)/this._timeScale||.001,e=new a(this,r,n),n.onStart=function(){e.target.paused(!0),e.vars.time!==e.target.time()&&r===e.duration()&&e.duration(Math.abs(e.vars.time-e.target.time())/e.target._timeScale),i.onStart&&i.onStart.apply(i.onStartScope||e,i.onStartParams||t)},e},e.tweenFromTo=function(t,n,e){e=e||{},t=this._parseTimeOrLabel(t),e.startAt={onComplete:this.seek,onCompleteParams:[t],onCompleteScope:this},e.immediateRender=e.immediateRender!==!1;var i=this.tweenTo(n,e);return i.duration(Math.abs(i.vars.time-t)/this._timeScale||.001)},e.render=function(n,a,d){this._gc&&this._enabled(!0,!1);var e,y,_,h,u,m,v=this._dirty?this.totalDuration():this._totalDuration,r=this._duration,c=this._time,g=this._totalTime,w=this._startTime,b=this._timeScale,s=this._rawPrevTime,x=this._paused,f=this._cycle;if(n>=v?(this._locked||(this._totalTime=v,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(y=!0,h="onComplete",0===this._duration&&(0===n||0>s||s===i)&&s!==n&&this._first&&(u=!0,s>i&&(h="onReverseComplete"))),this._rawPrevTime=this._duration||!a||n||this._rawPrevTime===n?n:i,this._yoyo&&0!==(1&this._cycle)?this._time=n=0:(this._time=r,n=r+1e-4)):1e-7>n?(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==c||0===r&&s!==i&&(s>0||0>n&&s>=0)&&!this._locked)&&(h="onReverseComplete",y=this._reversed),0>n?(this._active=!1,s>=0&&this._first&&(u=!0),this._rawPrevTime=n):(this._rawPrevTime=r||!a||n||this._rawPrevTime===n?n:i,n=0,this._initted||(u=!0))):(0===r&&0>s&&(u=!0),this._time=this._rawPrevTime=n,this._locked||(this._totalTime=n,0!==this._repeat&&(m=r+this._repeatDelay,this._cycle=this._totalTime/m>>0,0!==this._cycle&&this._cycle===this._totalTime/m&&this._cycle--,this._time=this._totalTime-this._cycle*m,this._yoyo&&0!==(1&this._cycle)&&(this._time=r-this._time),this._time>r?(this._time=r,n=r+1e-4):0>this._time?this._time=n=0:n=this._time))),this._cycle!==f&&!this._locked){var p=this._yoyo&&0!==(1&f),T=p===(this._yoyo&&0!==(1&this._cycle)),E=this._totalTime,C=this._cycle,S=this._rawPrevTime,k=this._time;if(this._totalTime=f*r,f>this._cycle?p=!p:this._totalTime+=r,this._time=c,this._rawPrevTime=0===r?s-1e-4:s,this._cycle=f,this._locked=!0,c=p?0:r,this.render(c,a,0===r),a||this._gc||this.vars.onRepeat&&this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||t),T&&(c=p?r+1e-4:-1e-4,this.render(c,!0,!1)),this._locked=!1,this._paused&&!x)return;this._time=k,this._totalTime=E,this._cycle=C,this._rawPrevTime=S}if(!(this._time!==c&&this._first||d||u))return void(g!==this._totalTime&&this._onUpdate&&(a||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||t)));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==g&&n>0&&(this._active=!0),0===g&&this.vars.onStart&&0!==this._totalTime&&(a||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||t)),this._time>=c)for(e=this._first;e&&(_=e._next,!this._paused||x);)(e._active||e._startTime<=this._time&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(n-e._startTime)*e._timeScale,a,d):e.render((n-e._startTime)*e._timeScale,a,d)),e=_;else for(e=this._last;e&&(_=e._prev,!this._paused||x);)(e._active||c>=e._startTime&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(n-e._startTime)*e._timeScale,a,d):e.render((n-e._startTime)*e._timeScale,a,d)),e=_;this._onUpdate&&(a||(o.length&&l(),this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||t))),h&&(this._locked||this._gc||(w===this._startTime||b!==this._timeScale)&&(0===this._time||v>=this.totalDuration())&&(y&&(o.length&&l(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!a&&this.vars[h]&&this.vars[h].apply(this.vars[h+"Scope"]||this,this.vars[h+"Params"]||t)))},e.getActive=function(t,i,n){null==t&&(t=!0),null==i&&(i=!0),null==n&&(n=!1);var e,r,a=[],s=this.getChildren(t,i,n),o=0,l=s.length;for(e=0;l>e;e++)r=s[e],r.isActive()&&(a[o++]=r);return a},e.getLabelAfter=function(t){t||0!==t&&(t=this._time);var e,i=this.getLabelsArray(),n=i.length;for(e=0;n>e;e++)if(i[e].time>t)return i[e].name;return null},e.getLabelBefore=function(e){null==e&&(e=this._time);for(var t=this.getLabelsArray(),i=t.length;--i>-1;)if(e>t[i].time)return t[i].name;return null},e.getLabelsArray=function(){var e,t=[],i=0;for(e in this._labels)t[i++]={time:this._labels[e],name:e};return t.sort(function(e,t){return e.time-t.time}),t},e.progress=function(e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},e.totalProgress=function(e){return arguments.length?this.totalTime(this.totalDuration()*e,!1):this._totalTime/this.totalDuration()},e.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(r.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},e.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!==(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},e.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},e.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},e.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},e.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.getLabelBefore(this._time+1e-8)},n},!0),function(){var u=180/Math.PI,e=[],t=[],i=[],s={},a=function(e,t,i,n){this.a=e,this.b=t,this.c=i,this.d=n,this.da=n-e,this.ca=i-e,this.ba=t-e},_=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",o=function(r,u,d,s){var n={a:r},e={},t={},i={c:s},l=(r+u)/2,h=(u+d)/2,c=(d+s)/2,o=(l+h)/2,a=(h+c)/2,p=(a-o)/8;return n.b=l+(r-l)/4,e.b=o+p,n.c=e.a=(n.b+e.b)/2,e.c=t.a=(o+a)/2,t.b=a-p,i.b=c+(s-c)/4,t.c=i.a=(t.b+i.b)/2,[n,e,t,i]},m=function(u,_,w,b,T){var c,h,r,v,n,d,p,g,x,s,f,m,y,E=u.length-1,l=0,a=u[0].a;for(c=0;E>c;c++)n=u[l],h=n.a,r=n.d,v=u[l+1].d,T?(f=e[c],m=t[c],y=.25*(m+f)*_/(b?.5:i[c]||.5),d=r-(r-h)*(b?.5*_:0!==f?y/f:0),p=r+(v-r)*(b?.5*_:0!==m?y/m:0),g=r-(d+((p-d)*(3*f/(f+m)+.5)/4||0))):(d=r-.5*(r-h)*_,p=r+.5*(v-r)*_,g=r-(d+p)/2),d+=g,p+=g,n.c=x=d,n.b=0!==c?a:a=n.a+.6*(n.c-n.a),n.da=r-h,n.ca=x-h,n.ba=a-h,w?(s=o(h,a,x,r),u.splice(l,1,s[0],s[1],s[2],s[3]),l+=4):l++,a=p;n=u[l],n.b=a,n.c=a+.4*(n.d-a),n.da=n.d-n.a,n.ca=n.c-n.a,n.ba=a-n.a,w&&(s=o(n.a,a,n.c,n.d),u.splice(l,1,s[0],s[1],s[2],s[3]))},h=function(n,r,p,u){var l,i,c,s,d,h,o=[];if(u)for(n=[u].concat(n),i=n.length;--i>-1;)"string"==typeof(h=n[i][r])&&"="===h.charAt(1)&&(n[i][r]=u[r]+Number(h.charAt(0)+h.substr(2)));if(l=n.length-2,0>l)return o[0]=new a(n[0][r],0,0,n[-1>l?0:1][r]),o;for(i=0;l>i;i++)c=n[i][r],s=n[i+1][r],o[i]=new a(c,0,0,s),p&&(d=n[i+2][r],e[i]=(e[i]||0)+(s-c)*(s-c),t[i]=(t[i]||0)+(d-s)*(d-s));return o[i]=new a(n[i][r],0,0,n[i+1][r]),o},c=function(a,g,w,b,d,u){var n,r,c,o,y,v,p,x,f={},l=[],T=u||a[0];d="string"==typeof d?","+d+",":_,null==g&&(g=1);for(r in a[0])l.push(r);if(a.length>1){for(x=a[a.length-1],p=!0,n=l.length;--n>-1;)if(r=l[n],Math.abs(T[r]-x[r])>.05){p=!1;break}p&&(a=a.concat(),u&&a.unshift(u),a.push(a[1]),u=a[a.length-3])}for(e.length=t.length=i.length=0,n=l.length;--n>-1;)r=l[n],s[r]=-1!==d.indexOf(","+r+","),f[r]=h(a,r,s[r],u);for(n=e.length;--n>-1;)e[n]=Math.sqrt(e[n]),t[n]=Math.sqrt(t[n]);if(!b){for(n=l.length;--n>-1;)if(s[r])for(c=f[l[n]],v=c.length-1,o=0;v>o;o++)y=c[o+1].da/t[o]+c[o].da/e[o],i[o]=(i[o]||0)+y*y;for(n=i.length;--n>-1;)i[n]=Math.sqrt(i[n])}for(n=l.length,o=w?4:1;--n>-1;)r=l[n],c=f[r],m(c,g,w,b,s[r]),p&&(c.splice(0,o),c.splice(c.length-o,o));return f},d=function(n,h,p){h=h||"soft";var s,u,d,g,t,f,e,c,r,i,o,m={},l="cubic"===h?3:2,y="soft"===h,_=[];if(y&&p&&(n=[p].concat(n)),null==n||l+1>n.length)throw"invalid Bezier data";for(r in n[0])_.push(r);for(f=_.length;--f>-1;){for(r=_[f],m[r]=t=[],i=0,c=n.length,e=0;c>e;e++)s=null==p?n[e][r]:"string"==typeof(o=n[e][r])&&"="===o.charAt(1)?p[r]+Number(o.charAt(0)+o.substr(2)):Number(o),y&&e>1&&c-1>e&&(t[i++]=(s+t[i-2])/2),t[i++]=s;for(c=i-l+1,i=0,e=0;c>e;e+=l)s=t[e],u=t[e+1],d=t[e+2],g=2===l?0:t[e+3],t[i++]=o=3===l?new a(s,u,d,g):new a(s,(2*u+s)/3,(2*u+d)/3,d);t.length=i}return m},p=function(p,d,s){for(var n,o,r,h,u,f,e,t,l,i,c,_=1/s,a=p.length;--a>-1;)for(i=p[a],r=i.a,h=i.d-r,u=i.c-r,f=i.b-r,n=o=0,t=1;s>=t;t++)e=_*t,l=1-e,n=o-(o=(e*e*h+3*l*(e*u+l*f))*e),c=a*s+t-1,d[c]=(d[c]||0)+n*n},f=function(u,i){i=i>>0||6;var c,e,l,t,r=[],o=[],n=0,s=0,d=i-1,h=[],a=[];for(c in u)p(u[c],r,i);for(l=r.length,e=0;l>e;e++)n+=Math.sqrt(r[e]),t=e%i,a[t]=n,t===d&&(s+=n,t=e/i>>0,h[t]=a,o[t]=s,n=0,a=[]);return{length:s,lengths:o,segments:h}},n=r._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.3",API:2,global:!0,init:function(n,t,p){this._target=n,t instanceof Array&&(t={values:t}),this._func={},this._round={},this._props=[],this._timeRes=null==t.timeResolution?6:parseInt(t.timeResolution,10);var e,u,r,a,l,o=t.values||[],s={},_=o[0],i=t.autoRotate||p.vars.orientToBezier;this._autoRotate=i?i instanceof Array?i:[["x","y","rotation",i===!0?0:Number(i)||0]]:null;for(e in _)this._props.push(e);for(r=this._props.length;--r>-1;)e=this._props[r],this._overwriteProps.push(e),u=this._func[e]="function"==typeof n[e],s[e]=u?n[e.indexOf("set")||"function"!=typeof n["get"+e.substr(3)]?e:"get"+e.substr(3)]():parseFloat(n[e]),l||s[e]!==o[0][e]&&(l=s);if(this._beziers="cubic"!==t.type&&"quadratic"!==t.type&&"soft"!==t.type?c(o,isNaN(t.curviness)?1:t.curviness,!1,"thruBasic"===t.type,t.correlate,l):d(o,t.type,s),this._segCount=this._beziers[e].length,this._timeRes){var h=f(this._beziers,this._timeRes);this._length=h.length,this._lengths=h.lengths,this._segments=h.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(i=this._autoRotate)for(this._initialRotations=[],i[0]instanceof Array||(this._autoRotate=i=[i]),r=i.length;--r>-1;){for(a=0;3>a;a++)e=i[r][a],this._func[e]="function"==typeof n[e]?n[e.indexOf("set")||"function"!=typeof n["get"+e.substr(3)]?e:"get"+e.substr(3)]:!1;e=i[r][2],this._initialRotations[r]=this._func[e]?this._func[e].call(this._target):this._target[e]}return this._startRatio=p.vars.runBackwards?1:0,!0},set:function(t){var l,v,e,s,i,n,o,_,d,a,h=this._segCount,x=this._func,g=this._target,T=t!==this._startRatio;if(this._timeRes){if(d=this._lengths,a=this._curSeg,t*=this._length,e=this._li,t>this._l2&&h-1>e){for(_=h-1;_>e&&t>=(this._l2=d[++e]););this._l1=d[e-1],this._li=e,this._curSeg=a=this._segments[e],this._s2=a[this._s1=this._si=0]}else if(this._l1>t&&e>0){for(;e>0&&(this._l1=d[--e])>=t;);0===e&&this._l1>t?this._l1=0:e++,this._l2=d[e],this._li=e,this._curSeg=a=this._segments[e],this._s1=a[(this._si=a.length-1)-1]||0,this._s2=a[this._si]}if(l=e,t-=this._l1,e=this._si,t>this._s2&&a.length-1>e){for(_=a.length-1;_>e&&t>=(this._s2=a[++e]););this._s1=a[e-1],this._si=e}else if(this._s1>t&&e>0){for(;e>0&&(this._s1=a[--e])>=t;);0===e&&this._s1>t?this._s1=0:e++,this._s2=a[e],this._si=e}n=(e+(t-this._s1)/(this._s2-this._s1))*this._prec}else l=0>t?0:t>=1?h-1:h*t>>0,n=(t-l*(1/h))*h;for(v=1-n,e=this._props.length;--e>-1;)s=this._props[e],i=this._beziers[s][l],o=(n*n*i.da+3*v*(n*i.ca+v*i.ba))*n+i.a,this._round[s]&&(o=Math.round(o)),x[s]?g[s](o):g[s]=o;if(this._autoRotate){var r,y,m,f,p,b,w,c=this._autoRotate;for(e=c.length;--e>-1;)s=c[e][2],b=c[e][3]||0,w=c[e][4]===!0?1:u,i=this._beziers[c[e][0]],r=this._beziers[c[e][1]],i&&r&&(i=i[l],r=r[l],y=i.a+(i.b-i.a)*n,f=i.b+(i.c-i.b)*n,y+=(f-y)*n,f+=(i.c+(i.d-i.c)*n-f)*n,m=r.a+(r.b-r.a)*n,p=r.b+(r.c-r.b)*n,m+=(p-m)*n,p+=(r.c+(r.d-r.c)*n-p)*n,o=T?Math.atan2(p-m,f-y)*w+b:this._initialRotations[e],x[s]?g[s](o):g[s]=o)}}}),l=n.prototype;n.bezierThrough=c,n.cubicToQuadratic=o,n._autoCSS=!0,n.quadraticToCubic=function(e,t,i){return new a(e,(2*t+e)/3,(2*t+i)/3,i)},n._cssRegister=function(){var t=r._gsDefine.globals.CSSPlugin;if(t){var e=t._internals,i=e._parseToProxy,a=e._setPluginRatio,s=e.CSSPropTween;e._registerComplexSpecialProp("bezier",{parser:function(f,l,m,c,o,h){l instanceof Array&&(l={values:l}),h=new n;var t,u,r,p=l.values,d=p.length-1,_=[],e={};if(0>d)return o;for(t=0;d>=t;t++)r=i(f,p[t],c,o,h,d!==t),_[t]=r.end;for(u in l)e[u]=l[u];return e.values=_,o=new s(f,"bezier",0,0,r.pt,2),o.data=r,o.plugin=h,o.setRatio=a,0===e.autoRotate&&(e.autoRotate=!0),!e.autoRotate||e.autoRotate instanceof Array||(t=e.autoRotate===!0?0:Number(e.autoRotate),e.autoRotate=null!=r.end.left?[["left","top","rotation",t,!1]]:null!=r.end.x?[["x","y","rotation",t,!1]]:!1),e.autoRotate&&(c._transform||c._enableTransforms(!1),r.autoRotate=c._target._gsTransform),h._onInitTween(r.proxy,e,c._tween),o}})}},l._roundProps=function(e,n){for(var t=this._overwriteProps,i=t.length;--i>-1;)(e[t[i]]||e.bezier||e.bezierThrough)&&(this._round[t[i]]=n)},l._kill=function(n){var e,t,i=this._props;for(e in this._beziers)if(e in n)for(delete this._beziers[e],delete this._func[e],t=i.length;--t>-1;)i[t]===e&&i.splice(t,1);return this._super._kill.call(this,n)}}(),r._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(R,O){var T,L,n,G,a=function(){R.call(this,"css"),this._overwriteProps.length=0,this.setRatio=a.prototype.setRatio},f={},e=a.prototype=new R("css");e.constructor=a,a.version="1.13.1",a.API=2,a.defaultTransformPerspective=0,a.defaultSkewType="compensated",e="px",a.suffixMap={top:e,right:e,bottom:e,left:e,width:e,height:e,fontSize:e,padding:e,margin:e,perspective:e,lineHeight:""};var W,gt,q,_t,ft,k,P=/(?:\d|\-\d|\.\d|\-\.\d)+/g,pt=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,B=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,z=/[^\d\-\.]/g,$=/(?:\d|\-|\+|=|#|\.)*/g,Q=/opacity *= *([^)]*)/i,Ct=/opacity:([^;]*)/i,Et=/alpha\(opacity *=.+?\)/i,ot=/^(rgb|hsl)/,lt=/([A-Z])/g,ut=/-([a-z])/gi,wt=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,tt=function(t,e){return e.toUpperCase()},vt=/(?:Left|Right|Width)/i,Rt=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,Tt=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,d=/,(?=[^\)]*(?:\(|$))/gi,h=Math.PI/180,b=180/Math.PI,j={},y=document,m=y.createElement("div"),F=y.createElement("img"),u=a._internals={_specialProps:f},g=navigator.userAgent,v=function(){var e,t=g.indexOf("Android"),i=y.createElement("div");return q=-1!==g.indexOf("Safari")&&-1===g.indexOf("Chrome")&&(-1===t||Number(g.substr(t+8,1))>3),ft=q&&6>Number(g.substr(g.indexOf("Version/")+8,1)),_t=-1!==g.indexOf("Firefox"),/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(g)&&(k=parseFloat(RegExp.$1)),i.innerHTML="<a style='top:1px;opacity:.55;'>a</a>",e=i.getElementsByTagName("a")[0],e?/^0.55/.test(e.style.opacity):!1}(),rt=function(e){return Q.test("string"==typeof e?e:(e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100:1},ct=function(e){window.console&&console.log(e)},dt="",et="",M=function(e,i){i=i||m;var n,t,r=i.style;if(void 0!==r[e])return e;for(e=e.charAt(0).toUpperCase()+e.substr(1),n=["O","Moz","ms","Ms","Webkit"],t=5;--t>-1&&void 0===r[n[t]+e];);return t>=0?(et=3===t?"ms":n[t],dt="-"+et.toLowerCase()+"-",et+e):null},A=y.defaultView?y.defaultView.getComputedStyle:function(){},i=a.getStyle=function(i,t,n,a,r){var e;return v||"opacity"!==t?(!a&&i.style[t]?e=i.style[t]:(n=n||A(i))?e=n[t]||n.getPropertyValue(t)||n.getPropertyValue(t.replace(lt,"-$1").toLowerCase()):i.currentStyle&&(e=i.currentStyle[t]),null==r||e&&"none"!==e&&"auto"!==e&&"auto auto"!==e?e:r):rt(i)},p=u.convertToPixels=function(o,h,e,t,f){if("px"===t||!t)return e;if("auto"===t||!e)return 0;var s,n,c,l=vt.test(h),r=o,u=m.style,d=0>e;if(d&&(e=-e),"%"===t&&-1!==h.indexOf("border"))s=e/100*(l?o.clientWidth:o.clientHeight);else{if(u.cssText="border:0 solid red;position:"+i(o,"position")+";line-height:0;","%"!==t&&r.appendChild)u[l?"borderLeftWidth":"borderTopWidth"]=e+t;else{if(r=o.parentNode||y.body,n=r._gsCache,c=O.ticker.frame,n&&l&&n.time===c)return n.width*e/100;u[l?"width":"height"]=e+t}r.appendChild(m),s=parseFloat(m[l?"offsetWidth":"offsetHeight"]),r.removeChild(m),l&&"%"===t&&a.cacheWidths!==!1&&(n=r._gsCache=r._gsCache||{},n.time=c,n.width=100*(s/e)),0!==s||f||(s=p(o,h,e,t,!0))}return d?-s:s},st=u.calculateOffset=function(e,t,n){if("absolute"!==i(e,"position",n))return 0;var r="left"===t?"Left":"Top",a=i(e,"margin"+r,n);return e["offset"+r]-(p(e,t,parseFloat(a),a.replace($,""))||0)},C=function(r,t){var i,n,e={};if(t=t||A(r,null))if(i=t.length)for(;--i>-1;)e[t[i].replace(ut,tt)]=t.getPropertyValue(t[i]);else for(i in t)e[i]=t[i];else if(t=r.currentStyle||r.style)for(i in t)"string"==typeof i&&void 0===e[i]&&(e[i.replace(ut,tt)]=t[i]);return v||(e.opacity=rt(r)),n=E(r,t,!1),e.rotation=n.rotation,e.skewX=n.skewX,e.scaleX=n.scaleX,e.scaleY=n.scaleY,e.x=n.x,e.y=n.y,_&&(e.z=n.z,e.rotationX=n.rotationX,e.rotationY=n.rotationY,e.scaleZ=n.scaleZ),e.filters&&delete e.filters,e},K=function(o,i,l,n,c){var t,e,r,a={},s=o.style;for(e in l)"cssText"!==e&&"length"!==e&&isNaN(e)&&(i[e]!==(t=l[e])||c&&c[e])&&-1===e.indexOf("Origin")&&("number"==typeof t||"string"==typeof t)&&(a[e]="auto"!==t||"left"!==e&&"top"!==e?""!==t&&"auto"!==t&&"none"!==t||"string"!=typeof i[e]||""===i[e].replace(z,"")?t:0:st(o,e),void 0!==s[e]&&(r=new H(s,e,s[e],r)));if(n)for(e in n)"className"!==e&&(a[e]=n[e]);return{difs:a,firstMPT:r}},At={width:["Left","Right"],height:["Top","Bottom"]},Ot=["marginLeft","marginRight","marginTop","marginBottom"],kt=function(e,s,t){var n=parseFloat("width"===s?e.offsetWidth:e.offsetHeight),r=At[s],a=r.length;for(t=t||A(e,null);--a>-1;)n-=parseFloat(i(e,"padding"+r[a],t,!0))||0,n-=parseFloat(i(e,"border"+r[a]+"Width",t,!0))||0;return n},Z=function(e,n){(null==e||""===e||"auto"===e||"auto auto"===e)&&(e="0 0");var r=e.split(" "),t=-1!==e.indexOf("left")?"0%":-1!==e.indexOf("right")?"100%":r[0],i=-1!==e.indexOf("top")?"0%":-1!==e.indexOf("bottom")?"100%":r[1];return null==i?i="0":"center"===i&&(i="50%"),("center"===t||isNaN(parseFloat(t))&&-1===(t+"").indexOf("="))&&(t="50%"),n&&(n.oxp=-1!==t.indexOf("%"),n.oyp=-1!==i.indexOf("%"),n.oxr="="===t.charAt(1),n.oyr="="===i.charAt(1),n.ox=parseFloat(t.replace(z,"")),n.oy=parseFloat(i.replace(z,""))),t+" "+i+(r.length>2?" "+r[2]:"")},nt=function(e,t){return"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(t)},c=function(e,t){return null==e?t:"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*Number(e.substr(2))+t:parseFloat(e)},S=function(i,r,l,s){var t,a,e,n,o=1e-6;return null==i?n=r:"number"==typeof i?n=i:(t=360,a=i.split("_"),e=Number(a[0].replace(z,""))*(-1===i.indexOf("rad")?1:b)-("="===i.charAt(1)?0:r),a.length&&(s&&(s[l]=r+e),-1!==i.indexOf("short")&&(e%=t,e!==e%(t/2)&&(e=0>e?e+t:e-t)),-1!==i.indexOf("_cw")&&0>e?e=(e+9999999999*t)%t-(0|e/t)*t:-1!==i.indexOf("ccw")&&e>0&&(e=(e-9999999999*t)%t-(0|e/t)*t)),n=r+e),o>n&&n>-o&&(n=0),n},w={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},J=function(e,t,i){return e=0>e?e+1:e>1?e-1:e,0|255*(1>6*e?t+6*(i-t)*e:.5>e?i:2>3*e?t+6*(i-t)*(2/3-e):t)+.5},Y=function(e){var i,t,s,r,a,n;return e&&""!==e?"number"==typeof e?[e>>16,255&e>>8,255&e]:(","===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),w[e]?w[e]:"#"===e.charAt(0)?(4===e.length&&(i=e.charAt(1),t=e.charAt(2),s=e.charAt(3),e="#"+i+i+t+t+s+s),e=parseInt(e.substr(1),16),[e>>16,255&e>>8,255&e]):"hsl"===e.substr(0,3)?(e=e.match(P),r=Number(e[0])%360/360,a=Number(e[1])/100,n=Number(e[2])/100,t=.5>=n?n*(a+1):n+a-n*a,i=2*n-t,e.length>3&&(e[3]=Number(e[3])),e[0]=J(r+1/3,i,t),e[1]=J(r,i,t),e[2]=J(r-1/3,i,t),e):(e=e.match(P)||w.transparent,e[0]=Number(e[0]),e[1]=Number(e[1]),e[2]=Number(e[2]),e.length>3&&(e[3]=Number(e[3])),e)):w.black},x="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(e in w)x+="|"+e+"\\b";x=RegExp(x+")","gi");var ht=function(e,o,h,a){if(null==e)return function(e){return e};var n,s=o?(e.match(x)||[""])[0]:"",i=e.split(s).join("").match(B)||[],l=e.substr(0,e.indexOf(i[0])),c=")"===e.charAt(e.length-1)?")":"",r=-1!==e.indexOf(" ")?" ":",",t=i.length,u=t>0?i[0].replace(P,""):"";return t?n=o?function(o){var _,p,e,f;if("number"==typeof o)o+=u;else if(a&&d.test(o)){for(f=o.replace(d,"|").split("|"),e=0;f.length>e;e++)f[e]=n(f[e]);return f.join(",")}if(_=(o.match(x)||[s])[0],p=o.split(_).join("").match(B)||[],e=p.length,t>e--)for(;t>++e;)p[e]=h?p[0|(e-1)/2]:i[e];return l+p.join(r)+r+_+c+(-1!==o.indexOf("inset")?" inset":"")}:function(s){var o,p,e;if("number"==typeof s)s+=u;else if(a&&d.test(s)){for(p=s.replace(d,"|").split("|"),e=0;p.length>e;e++)p[e]=n(p[e]);return p.join(",")}if(o=s.match(B)||[],e=o.length,t>e--)for(;t>++e;)o[e]=h?o[0|(e-1)/2]:i[e];return l+o.join(r)+c}:function(e){return e}},X=function(e){return e=e.split(","),function(r,a,c,s,o,l,i){var t,n=(a+"").split(" ");for(i={},t=0;4>t;t++)i[e[t]]=n[t]=n[t]||n[(t-1)/2>>0];return s.parse(r,i,o,l)}},H=(u._setPluginRatio=function(s){this.plugin.setRatio(s);for(var i,e,n,a,r=this.data,o=r.proxy,t=r.firstMPT,l=1e-6;t;)i=o[t.v],t.r?i=Math.round(i):l>i&&i>-l&&(i=0),t.t[t.p]=i,t=t._next;if(r.autoRotate&&(r.autoRotate.rotation=o.rotation),1===s)for(t=r.firstMPT;t;){if(e=t.t,e.type){if(1===e.type){for(a=e.xs0+e.s+e.xs1,n=1;e.l>n;n++)a+=e["xn"+n]+e["xs"+(n+1)];e.e=a}}else e.e=e.s+e.xs0;t=t._next}},function(t,i,n,e,r){this.t=t,this.p=i,this.v=n,this.r=r,e&&(e._prev=this,this._next=e)}),s=(u._parseToProxy=function(p,u,a,e,d,s){var o,t,i,n,h,r=e,l={},c={},f=a._transform,_=j;for(a._transform=null,j=u,e=h=a.parse(p,u,e,d),j=_,s&&(a._transform=f,r&&(r._prev=null,r._prev&&(r._prev._next=null)));e&&e!==r;){if(1>=e.type&&(t=e.p,c[t]=e.s+e.c,l[t]=e.s,s||(n=new H(e,"s",t,n,e.r),e.c=0),1===e.type))for(o=e.l;--o>0;)i="xn"+o,t=e.p+"_"+i,c[t]=e.data[i],l[t]=e[i],s||(n=new H(e,i,t,n,e.rxp[i]));e=e._next}return{proxy:l,end:c,firstMPT:n,pt:h}},u.CSSPropTween=function(i,a,e,n,t,u,h,c,l,o,r){this.t=i,this.p=a,this.s=e,this.c=n,this.n=h||a,i instanceof s||G.push(this.n),this.r=c,this.type=u||0,l&&(this.pr=l,T=!0),this.b=void 0===o?e:o,this.e=void 0===r?e+n:r,t&&(this._next=t,t._prev=this)}),D=a.parseComplex=function(M,C,u,_,A,T,e,k,S,b){u=u||T||"",e=new s(M,C,0,0,e,b?2:1,null,!1,k,u,_),_+="";var n,c,h,t,i,g,y,f,l,x,o,a,r=u.split(", ").join(",").split(" "),p=_.split(", ").join(",").split(" "),m=r.length,E=W!==!1;for((-1!==_.indexOf(",")||-1!==u.indexOf(","))&&(r=r.join(" ").replace(d,", ").split(" "),p=p.join(" ").replace(d,", ").split(" "),m=r.length),m!==p.length&&(r=(T||"").split(" "),m=r.length),e.plugin=S,e.setRatio=b,n=0;m>n;n++)if(t=r[n],i=p[n],f=parseFloat(t),f||0===f)e.appendXtra("",f,nt(i,f),i.replace(pt,""),E&&-1!==i.indexOf("px"),!0);else if(A&&("#"===t.charAt(0)||w[t]||ot.test(t)))a=","===i.charAt(i.length-1)?"),":")",t=Y(t),i=Y(i),l=t.length+i.length>6,l&&!v&&0===i[3]?(e["xs"+e.l]+=e.l?" transparent":"transparent",e.e=e.e.split(p[n]).join("transparent")):(v||(l=!1),e.appendXtra(l?"rgba(":"rgb(",t[0],i[0]-t[0],",",!0,!0).appendXtra("",t[1],i[1]-t[1],",",!0).appendXtra("",t[2],i[2]-t[2],l?",":a,!0),l&&(t=4>t.length?1:t[3],e.appendXtra("",t,(4>i.length?1:i[3])-t,a,!1)));else if(g=t.match(P)){if(y=i.match(pt),!y||y.length!==g.length)return e;for(h=0,c=0;g.length>c;c++)o=g[c],x=t.indexOf(o,h),e.appendXtra(t.substr(h,x-h),Number(o),nt(y[c],o),"",E&&"px"===t.substr(x+o.length,2),0===c),h=x+o.length;e["xs"+e.l]+=t.substr(h)}else e["xs"+e.l]+=e.l?" "+t:t;if(-1!==_.indexOf("=")&&e.data){for(a=e.xs0+e.data.s,n=1;e.l>n;n++)a+=e["xs"+n]+e.data["xn"+n];e.e=a+e["xs"+n]}return e.l||(e.type=-1,e.xs0=e.e),e.xfirst||e},o=9;for(e=s.prototype,e.l=e.pr=0;--o>0;)e["xn"+o]=0,e["xs"+o]="";e.xs0="",e._next=e._prev=e.xfirst=e.data=e.plugin=e.setRatio=e.rxp=null,e.appendXtra=function(a,i,n,o,r,l){var e=this,t=e.l;return e["xs"+t]+=l&&t?" "+a:a||"",n||0===t||e.plugin?(e.l++,e.type=e.setRatio?2:1,e["xs"+e.l]=o||"",t>0?(e.data["xn"+t]=i+n,e.rxp["xn"+t]=r,e["xn"+t]=i,e.plugin||(e.xfirst=new s(e,"xn"+t,i,n,e.xfirst||e,0,e.n,r,e.pr),e.xfirst.xs0=0),e):(e.data={s:i+n},e.rxp={},e.s=i,e.c=n,e.r=r,e)):(e["xs"+t]+=i+(o||""),e)};var mt=function(t,e){e=e||{},this.p=e.prefix?M(t)||t:t,f[t]=f[this.p]=this,this.format=e.formatter||ht(e.defaultValue,e.color,e.collapsible,e.multi),e.parser&&(this.parse=e.parser),this.clrs=e.color,this.multi=e.multi,this.keyword=e.keyword,this.dflt=e.defaultValue,this.pr=e.priority||0},t=u._registerComplexSpecialProp=function(a,e,i){"object"!=typeof e&&(e={parser:i});var t,s,n=a.split(","),r=e.defaultValue;for(i=i||[r],t=0;n.length>t;t++)e.prefix=0===t&&e.prefix,e.defaultValue=i[t]||r,s=new mt(n[t],e)},xt=function(e){if(!f[e]){var i=e.charAt(0).toUpperCase()+e.substr(1)+"Plugin";t(e,{parser:function(a,s,e,o,t,l,c){var n=(r.GreenSockGlobals||r).com.greensock.plugins[i];return n?(n._cssRegister(),f[e].parse(a,s,e,o,t,l,c)):(ct("Error: "+i+" js file not loaded."),t)}})}};e=mt.prototype,e.parseComplex=function(p,r,e,u,h,c){var i,n,t,o,l,s,a=this.keyword;if(this.multi&&(d.test(e)||d.test(r)?(n=r.replace(d,"|").split("|"),t=e.replace(d,"|").split("|")):a&&(n=[r],t=[e])),t){for(o=t.length>n.length?t.length:n.length,i=0;o>i;i++)r=n[i]=n[i]||this.dflt,e=t[i]=t[i]||this.dflt,a&&(l=r.indexOf(a),s=e.indexOf(a),l!==s&&(e=-1===s?t:n,e[i]+=" "+a));r=n.join(", "),e=t.join(", ")}return D(p,this.p,r,e,this.clrs,this.dflt,u,this.pr,h,c)},e.parse=function(e,t,s,o,r,a){return this.parseComplex(e.style,this.format(i(e,this.p,n,!1,this.dflt)),this.format(t),r,a)},a.registerSpecialProp=function(i,n,e){t(i,{parser:function(r,a,t,o,l,c){var i=new s(r,t,0,0,l,2,t,!1,e);return i.plugin=c,i.setRatio=n(r,a,o._tween,t),i},priority:e})};var yt="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),l=M("transform"),bt=dt+"transform",V=M("transformOrigin"),_=null!==M("perspective"),at=u.Transform=function(){this.skewY=0},E=u.getTransform=function(m,$,P,J){if(m._gsTransform&&P&&!J)return m._gsTransform;var o,t,v,R,H,L,j,w,y,Y,X,z,N,e=P?m._gsTransform||new at:new at,rt=0>e.scaleX,A=2e-5,u=1e5,M=179.99,E=M*h,nt=_?parseFloat(i(m,V,$,!1,"0 0 0").split(" ")[2])||e.zOrigin||0:0;if(l?o=i(m,bt,$,!0):m.currentStyle&&(o=m.currentStyle.filter.match(Rt),o=o&&4===o.length?[o[0].substr(4),Number(o[2].substr(4)),Number(o[1].substr(4)),o[3].substr(4),e.x||0,e.y||0].join(","):""),o&&"none"!==o&&"matrix(1, 0, 0, 1, 0, 0)"!==o){for(t=(o||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],v=t.length;--v>-1;)R=Number(t[v]),t[v]=(H=R-(R|=0))?(0|H*u+(0>H?-.5:.5))/u+R:R;if(16===t.length){var C=t[8],p=t[9],c=t[10],tt=t[12],K=t[13],S=t[14];if(e.zOrigin&&(S=-e.zOrigin,tt=C*S-t[12],K=p*S-t[13],S=c*S+e.zOrigin-t[14]),!P||J||null==e.rotationX){var D,k,W,s,r,Q,q,T=t[0],f=t[1],F=t[2],st=t[3],B=t[4],d=t[5],x=t[6],it=t[7],g=t[11],n=Math.atan2(x,c),Z=-E>n||n>E;e.rotationX=n*b,n&&(s=Math.cos(-n),r=Math.sin(-n),D=B*s+C*r,k=d*s+p*r,W=x*s+c*r,C=B*-r+C*s,p=d*-r+p*s,c=x*-r+c*s,g=it*-r+g*s,B=D,d=k,x=W),n=Math.atan2(C,T),e.rotationY=n*b,n&&(Q=-E>n||n>E,s=Math.cos(-n),r=Math.sin(-n),D=T*s-C*r,k=f*s-p*r,W=F*s-c*r,p=f*r+p*s,c=F*r+c*s,g=st*r+g*s,T=D,f=k,F=W),n=Math.atan2(f,d),e.rotation=n*b,n&&(q=-E>n||n>E,s=Math.cos(-n),r=Math.sin(-n),T=T*s+B*r,k=f*s+d*r,d=f*-r+d*s,x=F*-r+x*s,f=k),q&&Z?e.rotation=e.rotationX=0:q&&Q?e.rotation=e.rotationY=0:Q&&Z&&(e.rotationY=e.rotationX=0),e.scaleX=(0|Math.sqrt(T*T+f*f)*u+.5)/u,e.scaleY=(0|Math.sqrt(d*d+p*p)*u+.5)/u,e.scaleZ=(0|Math.sqrt(x*x+c*c)*u+.5)/u,e.skewX=0,e.perspective=g?1/(0>g?-g:g):0,e.x=tt,e.y=K,e.z=S}}else if(!(_&&!J&&t.length&&e.x===t[4]&&e.y===t[5]&&(e.rotationX||e.rotationY)||void 0!==e.x&&"none"===i(m,"display",$))){var et=t.length>=6,U=et?t[0]:1,I=t[1]||0,O=t[2]||0,G=et?t[3]:1;e.x=t[4]||0,e.y=t[5]||0,L=Math.sqrt(U*U+I*I),j=Math.sqrt(G*G+O*O),w=U||I?Math.atan2(I,U)*b:e.rotation||0,y=O||G?Math.atan2(O,G)*b+w:e.skewX||0,Y=L-Math.abs(e.scaleX||0),X=j-Math.abs(e.scaleY||0),Math.abs(y)>90&&270>Math.abs(y)&&(rt?(L*=-1,y+=0>=w?180:-180,w+=0>=w?180:-180):(j*=-1,y+=0>=y?180:-180)),z=(w-e.rotation)%180,N=(y-e.skewX)%180,(void 0===e.skewX||Y>A||-A>Y||X>A||-A>X||z>-M&&M>z&&!1|z*u||N>-M&&M>N&&!1|N*u)&&(e.scaleX=L,e.scaleY=j,e.rotation=w,e.skewX=y),_&&(e.rotationX=e.rotationY=e.z=0,e.perspective=parseFloat(a.defaultTransformPerspective)||0,e.scaleZ=1)}e.zOrigin=nt;for(v in e)A>e[v]&&e[v]>-A&&(e[v]=0)}else e={x:0,y:0,z:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,perspective:0,rotation:0,rotationX:0,rotationY:0,zOrigin:0};return P&&(m._gsTransform=e),e.xPercent=e.yPercent=0,e},St=function(C){var d,_,e=this.data,x=-e.rotation*h,E=x+e.skewX*h,a=1e5,s=(0|Math.cos(x)*e.scaleX*a)/a,r=(0|Math.sin(x)*e.scaleX*a)/a,n=(0|Math.sin(E)*-e.scaleY*a)/a,l=(0|Math.cos(E)*e.scaleY*a)/a,y=this.t.style,v=this.t.currentStyle;if(v){_=r,r=-n,n=-_,d=v.filter,y.filter="";var t,i,c=this.t.offsetWidth,u=this.t.offsetHeight,b="absolute"!==v.position,m="progid:DXImageTransform.Microsoft.Matrix(M11="+s+", M12="+r+", M21="+n+", M22="+l,w=e.x+c*e.xPercent/100,T=e.y+u*e.yPercent/100;if(null!=e.ox&&(t=(e.oxp?.01*c*e.ox:e.ox)-c/2,i=(e.oyp?.01*u*e.oy:e.oy)-u/2,w+=t-(t*s+i*r),T+=i-(t*n+i*l)),b?(t=c/2,i=u/2,m+=", Dx="+(t-(t*s+i*r)+w)+", Dy="+(i-(t*n+i*l)+T)+")"):m+=", sizingMethod='auto expand')",y.filter=-1!==d.indexOf("DXImageTransform.Microsoft.Matrix(")?d.replace(Tt,m):m+" "+d,(0===C||1===C)&&1===s&&0===r&&0===n&&1===l&&(b&&-1===m.indexOf("Dx=0, Dy=0")||Q.test(d)&&100!==parseFloat(RegExp.$1)||-1===d.indexOf("gradient("&&d.indexOf("Alpha"))&&y.removeAttribute("filter")),!b){var g,f,S,A=8>k?1:-1;for(t=e.ieOffsetX||0,i=e.ieOffsetY||0,e.ieOffsetX=Math.round((c-((0>s?-s:s)*c+(0>r?-r:r)*u))/2+w),e.ieOffsetY=Math.round((u-((0>l?-l:l)*u+(0>n?-n:n)*c))/2+T),o=0;4>o;o++)f=Ot[o],g=v[f],_=-1!==g.indexOf("px")?parseFloat(g):p(this.t,f,parseFloat(g),g.replace($,""))||0,S=_!==e[f]?2>o?-e.ieOffsetX:-e.ieOffsetY:2>o?t-e.ieOffsetX:i-e.ieOffsetY,y[f]=(e[f]=Math.round(_-S*(0===o||2===o?1:A)))+"px"}}},U=u.set3DTransformRatio=function(R){var w,v,y,m,b,x,p,f,A,T,d,s,k,E,_,S,t,n,i,r,D,I,P,e=this.data,L=this.t.style,a=e.rotation*h,o=e.scaleX,c=e.scaleY,u=e.scaleZ,O=e.x,j=e.y,M=e.z,g=e.perspective;if(!(1!==R&&0!==R||"auto"!==e.force3D||e.rotationY||e.rotationX||1!==u||g||M))return void it.call(this,R);if(_t){var C=1e-4;C>o&&o>-C&&(o=u=2e-5),C>c&&c>-C&&(c=u=2e-5),!g||e.z||e.rotationX||e.rotationY||(g=0)}if(a||e.skewX)n=Math.cos(a),i=Math.sin(a),w=n,b=i,e.skewX&&(a-=e.skewX*h,n=Math.cos(a),i=Math.sin(a),"simple"===e.skewType&&(r=Math.tan(e.skewX*h),r=Math.sqrt(1+r*r),n*=r,i*=r)),v=-i,x=n;else{if(!(e.rotationY||e.rotationX||1!==u||g))return void(L[l]=(e.xPercent||e.yPercent?"translate("+e.xPercent+"%,"+e.yPercent+"%) translate3d(":"translate3d(")+O+"px,"+j+"px,"+M+"px)"+(1!==o||1!==c?" scale("+o+","+c+")":""));w=x=1,v=b=0}d=1,y=m=p=f=A=T=s=k=E=0,_=g?-1/g:0,S=e.zOrigin,t=1e5,a=e.rotationY*h,a&&(n=Math.cos(a),i=Math.sin(a),A=d*-i,k=_*-i,y=w*i,p=b*i,d*=n,_*=n,w*=n,b*=n),a=e.rotationX*h,a&&(n=Math.cos(a),i=Math.sin(a),r=v*n+y*i,D=x*n+p*i,I=T*n+d*i,P=E*n+_*i,y=v*-i+y*n,p=x*-i+p*n,d=T*-i+d*n,_=E*-i+_*n,v=r,x=D,T=I,E=P),1!==u&&(y*=u,p*=u,d*=u,_*=u),1!==c&&(v*=c,x*=c,T*=c,E*=c),1!==o&&(w*=o,b*=o,A*=o,k*=o),S&&(s-=S,m=y*s,f=p*s,s=d*s+S),m=(r=(m+=O)-(m|=0))?(0|r*t+(0>r?-.5:.5))/t+m:m,f=(r=(f+=j)-(f|=0))?(0|r*t+(0>r?-.5:.5))/t+f:f,s=(r=(s+=M)-(s|=0))?(0|r*t+(0>r?-.5:.5))/t+s:s,L[l]=(e.xPercent||e.yPercent?"translate("+e.xPercent+"%,"+e.yPercent+"%) matrix3d(":"matrix3d(")+[(0|w*t)/t,(0|b*t)/t,(0|A*t)/t,(0|k*t)/t,(0|v*t)/t,(0|x*t)/t,(0|T*t)/t,(0|E*t)/t,(0|y*t)/t,(0|p*t)/t,(0|d*t)/t,(0|_*t)/t,m,f,s,g?1+-s/g:1].join(",")+")"},it=u.set2DTransformRatio=function(s){var i,a,t,r,n,e=this.data,d=this.t,o=d.style,c=e.x,u=e.y;return e.rotationX||e.rotationY||e.z||e.force3D===!0||"auto"===e.force3D&&1!==s&&0!==s?(this.setRatio=U,void U.call(this,s)):void(e.rotation||e.skewX?(i=e.rotation*h,a=i-e.skewX*h,t=1e5,r=e.scaleX*t,n=e.scaleY*t,o[l]=(e.xPercent||e.yPercent?"translate("+e.xPercent+"%,"+e.yPercent+"%) matrix(":"matrix(")+(0|Math.cos(i)*r)/t+","+(0|Math.sin(i)*r)/t+","+(0|Math.sin(a)*-n)/t+","+(0|Math.cos(a)*n)/t+","+c+","+u+")"):o[l]=(e.xPercent||e.yPercent?"translate("+e.xPercent+"%,"+e.yPercent+"%) matrix(":"matrix(")+e.scaleX+",0,0,"+e.scaleY+","+c+","+u+")")};t("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent",{parser:function(w,R,u,x,r,M,A){if(x._transform)return r;var o,b,d,h,g,v,p,t=x._transform=E(w,n,!0,A.parseTransform),T=w.style,C=1e-6,k=yt.length,e=A,f={};if("string"==typeof e.transform&&l)d=m.style,d[l]=e.transform,d.display="block",d.position="absolute",y.body.appendChild(m),o=E(m,null,!1),y.body.removeChild(m);else if("object"==typeof e){if(o={scaleX:c(null!=e.scaleX?e.scaleX:e.scale,t.scaleX),scaleY:c(null!=e.scaleY?e.scaleY:e.scale,t.scaleY),scaleZ:c(e.scaleZ,t.scaleZ),x:c(e.x,t.x),y:c(e.y,t.y),z:c(e.z,t.z),xPercent:c(e.xPercent,t.xPercent),yPercent:c(e.yPercent,t.yPercent),perspective:c(e.transformPerspective,t.perspective)},p=e.directionalRotation,null!=p)if("object"==typeof p)for(d in p)e[d]=p[d];else e.rotation=p;"string"==typeof e.x&&-1!==e.x.indexOf("%")&&(o.x=0,o.xPercent=c(e.x,t.xPercent)),"string"==typeof e.y&&-1!==e.y.indexOf("%")&&(o.y=0,o.yPercent=c(e.y,t.yPercent)),o.rotation=S("rotation"in e?e.rotation:"shortRotation"in e?e.shortRotation+"_short":"rotationZ"in e?e.rotationZ:t.rotation,t.rotation,"rotation",f),_&&(o.rotationX=S("rotationX"in e?e.rotationX:"shortRotationX"in e?e.shortRotationX+"_short":t.rotationX||0,t.rotationX,"rotationX",f),o.rotationY=S("rotationY"in e?e.rotationY:"shortRotationY"in e?e.shortRotationY+"_short":t.rotationY||0,t.rotationY,"rotationY",f)),o.skewX=null==e.skewX?t.skewX:S(e.skewX,t.skewX),o.skewY=null==e.skewY?t.skewY:S(e.skewY,t.skewY),(b=o.skewY-t.skewY)&&(o.skewX+=b,o.rotation+=b)}for(_&&null!=e.force3D&&(t.force3D=e.force3D,v=!0),t.skewType=e.skewType||t.skewType||a.defaultSkewType,g=t.force3D||t.z||t.rotationX||t.rotationY||o.z||o.rotationX||o.rotationY||o.perspective,g||null==e.scale||(o.scaleZ=1);--k>-1;)u=yt[k],h=o[u]-t[u],(h>C||-C>h||null!=j[u])&&(v=!0,r=new s(t,u,t[u],h,r),u in f&&(r.e=f[u]),r.xs0=0,r.plugin=M,x._overwriteProps.push(r.n));return h=e.transformOrigin,(h||_&&g&&t.zOrigin)&&(l?(v=!0,u=V,h=(h||i(w,u,n,!1,"50% 50%"))+"",r=new s(T,u,0,0,r,-1,"transformOrigin"),r.b=T[u],r.plugin=M,_?(d=t.zOrigin,h=h.split(" "),t.zOrigin=(h.length>2&&(0===d||"0px"!==h[2])?parseFloat(h[2]):d)||0,r.xs0=r.e=h[0]+" "+(h[1]||"50%")+" 0px",r=new s(t,"zOrigin",0,0,r,-1,r.n),r.b=d,r.xs0=r.e=t.zOrigin):r.xs0=r.e=h):Z(h+"",t)),v&&(x._transformType=g||3===this._transformType?3:2),r},prefix:!0}),t("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),t("borderRadius",{defaultValue:"0px",parser:function(l,m,T,C,v){m=this.format(m);var b,s,y,r,e,t,f,o,x,w,a,h,_,d,u,g,c=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],E=l.style;for(x=parseFloat(l.offsetWidth),w=parseFloat(l.offsetHeight),b=m.split(" "),s=0;c.length>s;s++)this.p.indexOf("border")&&(c[s]=M(c[s])),e=r=i(l,c[s],n,!1,"0px"),-1!==e.indexOf(" ")&&(r=e.split(" "),e=r[0],r=r[1]),t=y=b[s],f=parseFloat(e),h=e.substr((f+"").length),_="="===t.charAt(1),_?(o=parseInt(t.charAt(0)+"1",10),t=t.substr(2),o*=parseFloat(t),a=t.substr((o+"").length-(0>o?1:0))||""):(o=parseFloat(t),a=t.substr((o+"").length)),""===a&&(a=L[T]||h),a!==h&&(d=p(l,"borderLeft",f,h),u=p(l,"borderTop",f,h),"%"===a?(e=100*(d/x)+"%",r=100*(u/w)+"%"):"em"===a?(g=p(l,"borderLeft",1,"em"),e=d/g+"em",r=u/g+"em"):(e=d+"px",r=u+"px"),_&&(t=parseFloat(e)+o+a,y=parseFloat(r)+o+a)),v=D(E,c[s],e+" "+r,t+" "+y,!1,"0px",v);return v},prefix:!0,formatter:ht("0px 0px 0px 0px",!1,!0)}),t("backgroundPosition",{defaultValue:"0 0",parser:function(t,f,m,g,p,_){var s,d,r,l,u,o,c="background-position",a=n||A(t,null),e=this.format((a?k?a.getPropertyValue(c+"-x")+" "+a.getPropertyValue(c+"-y"):a.getPropertyValue(c):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),h=this.format(f);if(-1!==e.indexOf("%")!=(-1!==h.indexOf("%"))&&(o=i(t,"backgroundImage").replace(wt,""),o&&"none"!==o)){for(s=e.split(" "),d=h.split(" "),F.setAttribute("src",o),r=2;--r>-1;)e=s[r],l=-1!==e.indexOf("%"),l!==(-1!==d[r].indexOf("%"))&&(u=0===r?t.offsetWidth-F.width:t.offsetHeight-F.height,s[r]=l?parseFloat(e)/100*u+"px":100*(parseFloat(e)/u)+"%");e=s.join(" ")}return this.parseComplex(t.style,e,h,p,_)},formatter:Z}),t("backgroundSize",{defaultValue:"0 0",formatter:Z}),t("perspective",{defaultValue:"0px",prefix:!0}),t("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),t("transformStyle",{prefix:!0}),t("backfaceVisibility",{prefix:!0}),t("userSelect",{prefix:!0}),t("margin",{parser:X("marginTop,marginRight,marginBottom,marginLeft")}),t("padding",{parser:X("paddingTop,paddingRight,paddingBottom,paddingLeft")}),t("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(a,e,c,h,o,l){var s,t,r;return 9>k?(t=a.currentStyle,r=8>k?" ":",",s="rect("+t.clipTop+r+t.clipRight+r+t.clipBottom+r+t.clipLeft+")",e=this.format(e).split(",").join(r)):(s=this.format(i(a,this.p,n,!1,this.dflt)),e=this.format(e)),this.parseComplex(a.style,s,e,o,l)}}),t("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),t("autoRound,strictUnits",{parser:function(t,i,n,r,e){return e}}),t("border",{defaultValue:"0px solid #000",parser:function(e,t,s,o,r,a){return this.parseComplex(e.style,this.format(i(e,"borderTopWidth",n,!1,"0px")+" "+i(e,"borderTopStyle",n,!1,"solid")+" "+i(e,"borderTopColor",n,!1,"#000")),this.format(t),r,a)},color:!0,formatter:function(e){var t=e.split(" ");return t[0]+" "+(t[1]||"solid")+" "+(e.match(x)||["#000"])[0]}}),t("borderWidth",{parser:X("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),t("float,cssFloat,styleFloat",{parser:function(i,n,r,o,a){var e=i.style,t="cssFloat"in e?"cssFloat":"styleFloat";return new s(e,t,0,0,a,-1,r,!1,0,e[t],n)}});var Mt=function(a){var r,t=this.t,e=t.filter||i(this.data,"filter"),n=0|this.s+this.c*a;100===n&&(-1===e.indexOf("atrix(")&&-1===e.indexOf("radient(")&&-1===e.indexOf("oader(")?(t.removeAttribute("filter"),r=!i(this.data,"filter")):(t.filter=e.replace(Et,""),r=!0)),r||(this.xn1&&(t.filter=e=e||"alpha(opacity="+n+")"),-1===e.indexOf("pacity")?0===n&&this.xn1||(t.filter=e+" alpha(opacity="+n+")"):t.filter=e.replace(Q,"opacity="+n))};t("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(a,t,c,h,e,u){var r=parseFloat(i(a,"opacity",n,!1,"1")),o=a.style,l="autoAlpha"===c;return"string"==typeof t&&"="===t.charAt(1)&&(t=("-"===t.charAt(0)?-1:1)*parseFloat(t.substr(2))+r),l&&1===r&&"hidden"===i(a,"visibility",n)&&0!==t&&(r=0),v?e=new s(o,"opacity",r,t-r,e):(e=new s(o,"opacity",100*r,100*(t-r),e),e.xn1=l?1:0,o.zoom=1,e.type=2,e.b="alpha(opacity="+e.s+")",e.e="alpha(opacity="+(e.s+e.c)+")",e.data=a,e.plugin=u,e.setRatio=Mt),l&&(e=new s(o,"visibility",0,0,e,-1,null,!1,0,0!==r?"inherit":"hidden",0===t?"hidden":"inherit"),e.xs0="inherit",h._overwriteProps.push(e.n),h._overwriteProps.push(c)),e}});var N=function(t,e){e&&(t.removeProperty?("ms"===e.substr(0,2)&&(e="M"+e.substr(1)),t.removeProperty(e.replace(lt,"-$1").toLowerCase())):t.removeAttribute(e))},Lt=function(t){if(this.t._gsClassPT=this,1===t||0===t){this.t.setAttribute("class",0===t?this.b:this.e);for(var e=this.data,i=this.t.style;e;)e.v?i[e.p]=e.v:N(i,e.p),e=e._next;1===t&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};t("className",{parser:function(t,r,f,c,e,p,d){var a,u,h,l,i,o=t.getAttribute("class")||"",_=t.style.cssText;if(e=c._classNamePT=new s(t,f,0,0,e,2),e.setRatio=Lt,e.pr=-11,T=!0,e.b=o,u=C(t,n),h=t._gsClassPT){for(l={},i=h.data;i;)l[i.p]=1,i=i._next;h.setRatio(1)}return t._gsClassPT=e,e.e="="!==r.charAt(1)?r:o.replace(RegExp("\\s*\\b"+r.substr(2)+"\\b"),"")+("+"===r.charAt(0)?" "+r.substr(2):""),c._tween._duration&&(t.setAttribute("class",e.e),a=K(t,u,C(t),d,l),t.setAttribute("class",o),e.data=a.firstMPT,t.style.cssText=_,e=e.xfirst=c.parse(t,a.difs,e,p)),e}});var Pt=function(a){if((1===a||0===a)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var t,e,i,n,r=this.t.style,s=f.transform.parse;if("all"===this.e)r.cssText="",n=!0;else for(t=this.e.split(","),i=t.length;--i>-1;)e=t[i],f[e]&&(f[e].parse===s?n=!0:e="transformOrigin"===e?V:f[e].p),N(r,e);n&&(N(r,l),this.t._gsTransform&&delete this.t._gsTransform)}};for(t("clearProps",{parser:function(t,i,n,r,e){return e=new s(t,n,0,0,e,2),e.setRatio=Pt,e.e=i,e.pr=-10,e.data=r._tween,T=!0,e}}),e="bezier,throwProps,physicsProps,physics2D".split(","),o=e.length;o--;)xt(e[o]);e=a.prototype,e._firstPT=null,e._onInitTween=function(r,h,y){if(!r.nodeType)return!1;this._target=r,this._tween=y,this._vars=h,W=h.autoRound,T=!1,L=h.suffixMap||a.suffixMap,n=A(r,""),G=this._overwriteProps;var c,t,e,u,m,g,p,d,f,o=r.style;if(gt&&""===o.zIndex&&(c=i(r,"zIndex",n),("auto"===c||""===c)&&this._addLazySet(o,"zIndex",0)),"string"==typeof h&&(u=o.cssText,c=C(r,n),o.cssText=u+";"+h,c=K(r,c,C(r)).difs,!v&&Ct.test(h)&&(c.opacity=parseFloat(RegExp.$1)),h=c,o.cssText=u),this._firstPT=t=this.parse(r,h,null),this._transformType){for(f=3===this._transformType,l?q&&(gt=!0,""===o.zIndex&&(p=i(r,"zIndex",n),("auto"===p||""===p)&&this._addLazySet(o,"zIndex",0)),ft&&this._addLazySet(o,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(f?"visible":"hidden"))):o.zoom=1,e=t;e&&e._next;)e=e._next;d=new s(r,"transform",0,0,null,2),this._linkCSSP(d,null,e),d.setRatio=f&&_?U:l?it:St,d.data=this._transform||E(r,n,!0),G.pop()}if(T){for(;t;){for(g=t._next,e=u;e&&e.pr>t.pr;)e=e._next;(t._prev=e?e._prev:m)?t._prev._next=t:u=t,(t._next=e)?e._prev=t:m=t,t=g}this._firstPT=u}return!0},e.parse=function(h,d,o,m){var e,v,r,a,c,t,u,l,_,g,y=h.style;for(e in d)t=d[e],v=f[e],v?o=v.parse(h,t,e,this,o,m,d):(c=i(h,e,n)+"",_="string"==typeof t,"color"===e||"fill"===e||"stroke"===e||-1!==e.indexOf("Color")||_&&ot.test(t)?(_||(t=Y(t),t=(t.length>3?"rgba(":"rgb(")+t.join(",")+")"),o=D(y,e,c,t,!0,"transparent",o,0,m)):!_||-1===t.indexOf(" ")&&-1===t.indexOf(",")?(r=parseFloat(c),u=r||0===r?c.substr((r+"").length):"",(""===c||"auto"===c)&&("width"===e||"height"===e?(r=kt(h,e,n),u="px"):"left"===e||"top"===e?(r=st(h,e,n),u="px"):(r="opacity"!==e?0:1,u="")),g=_&&"="===t.charAt(1),g?(a=parseInt(t.charAt(0)+"1",10),t=t.substr(2),a*=parseFloat(t),l=t.replace($,"")):(a=parseFloat(t),l=_?t.substr((a+"").length)||"":""),""===l&&(l=e in L?L[e]:u),t=a||0===a?(g?a+r:a)+l:d[e],u!==l&&""!==l&&(a||0===a)&&r&&(r=p(h,e,r,u),"%"===l?(r/=p(h,e,100,"%")/100,d.strictUnits!==!0&&(c=r+"%")):"em"===l?r/=p(h,e,1,"em"):"px"!==l&&(a=p(h,e,a,l),l="px"),g&&(a||0===a)&&(t=a+r+l)),g&&(a+=r),!r&&0!==r||!a&&0!==a?void 0!==y[e]&&(t||"NaN"!=t+""&&null!=t)?(o=new s(y,e,a||r||0,0,o,-1,e,!1,0,c,t),o.xs0="none"!==t||"display"!==e&&-1===e.indexOf("Style")?t:c):ct("invalid "+e+" tween value: "+d[e]):(o=new s(y,e,r,a-r,o,0,e,W!==!1&&("px"===l||"zIndex"===e),0,c,t),o.xs0=l)):o=D(y,e,c,t,!0,null,o,0,m)),m&&o&&!o.plugin&&(o.plugin=m);return o},e.setRatio=function(n){var t,r,i,e=this._firstPT,a=1e-6;if(1!==n||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(n||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;e;){if(t=e.c*n+e.s,e.r?t=Math.round(t):a>t&&t>-a&&(t=0),e.type)if(1===e.type)if(i=e.l,2===i)e.t[e.p]=e.xs0+t+e.xs1+e.xn1+e.xs2;else if(3===i)e.t[e.p]=e.xs0+t+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3;else if(4===i)e.t[e.p]=e.xs0+t+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3+e.xn3+e.xs4;else if(5===i)e.t[e.p]=e.xs0+t+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3+e.xn3+e.xs4+e.xn4+e.xs5;else{for(r=e.xs0+t+e.xs1,i=1;e.l>i;i++)r+=e["xn"+i]+e["xs"+(i+1)];e.t[e.p]=r}else-1===e.type?e.t[e.p]=e.xs0:e.setRatio&&e.setRatio(n);else e.t[e.p]=t+e.xs0;e=e._next}else for(;e;)2!==e.type?e.t[e.p]=e.b:e.setRatio(n),e=e._next;else for(;e;)2!==e.type?e.t[e.p]=e.e:e.setRatio(n),e=e._next},e._enableTransforms=function(e){this._transformType=e||3===this._transformType?3:2,this._transform=this._transform||E(this._target,n,!0)};var It=function(){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};e._addLazySet=function(t,i,n){var e=this._firstPT=new s(t,i,0,0,this._firstPT,2);e.e=n,e.setRatio=It,e.data=this},e._linkCSSP=function(e,t,i,n){return e&&(t&&(t._prev=e),e._next&&(e._next._prev=e._prev),e._prev?e._prev._next=e._next:this._firstPT===e&&(this._firstPT=e._next,n=!0),i?i._next=e:n||null!==this._firstPT||(this._firstPT=e),e._next=t,e._prev=i),e},e._kill=function(i){var e,r,t,n=i;if(i.autoAlpha||i.alpha){n={};for(r in i)n[r]=i[r];n.opacity=1,n.autoAlpha&&(n.visibility=1)}return i.className&&(e=this._classNamePT)&&(t=e.xfirst,t&&t._prev?this._linkCSSP(t._prev,e._next,t._prev._prev):t===this._firstPT&&(this._firstPT=e._next),e._next&&this._linkCSSP(e._next,e._next._next,t._prev),this._classNamePT=null),R.prototype._kill.call(this,n)};var I=function(i,a,n){var s,t,e,r;if(i.slice)for(t=i.length;--t>-1;)I(i[t],a,n);else for(s=i.childNodes,t=s.length;--t>-1;)e=s[t],r=e.type,e.style&&(a.push(C(e)),n&&n.push(e)),1!==r&&9!==r&&11!==r||!e.childNodes.length||I(e,a,n)};return a.cascadeTo=function(n,s,o){var t,i,a,e=O.to(n,s,o),l=[e],c=[],h=[],r=[],u=O._internals.reservedProps;for(n=e._targets||e.target,I(n,c,r),e.render(s,!0),I(n,h),e.render(0,!0),e._enabled(!0),t=r.length;--t>-1;)if(i=K(r[t],c[t],h[t]),i.firstMPT){i=i.difs;for(a in o)u[a]&&(i[a]=o[a]);l.push(O.to(r[t],s,i))}return l},R.activate([a]),a},!0),function(){var t=r._gsDefine.plugin({propName:"roundProps",priority:-1,API:2,init:function(t,i,e){return this._tween=e,!0}}),e=t.prototype;e._onInitAllProps=function(){for(var r,e,i,t=this._tween,a=t.vars.roundProps instanceof Array?t.vars.roundProps:t.vars.roundProps.split(","),n=a.length,s={},o=t._propLookup.roundProps;--n>-1;)s[a[n]]=1;for(n=a.length;--n>-1;)for(r=a[n],e=t._firstPT;e;)i=e._next,e.pg?e.t._roundProps(s,!0):e.n===r&&(this._add(e.t,r,e.s,e.c),i&&(i._prev=e._prev),e._prev?e._prev._next=i:t._firstPT===e&&(t._firstPT=i),e._next=e._prev=null,t._propLookup[r]=o),e=i;return!1},e._add=function(i,e,t,n){this._addTween(i,e,t,t+n,e,!0),this._overwriteProps.push(e)}}(),r._gsDefine.plugin({propName:"attr",API:2,version:"0.3.3",init:function(i,n){var e,r,t;if("function"!=typeof i.setAttribute)return!1;this._target=i,this._proxy={},this._start={},this._end={};for(e in n)this._start[e]=this._proxy[e]=r=i.getAttribute(e),t=this._addTween(this._proxy,e,parseFloat(r),n[e],e),this._end[e]=t?t.s+t.c:n[e],this._overwriteProps.push(e);return!0},set:function(e){this._super.setRatio.call(this,e);for(var t,i=this._overwriteProps,n=i.length,r=1===e?this._end:e?this._proxy:this._start;--n>-1;)t=i[n],this._target.setAttribute(t,r[t]+"")}}),r._gsDefine.plugin({propName:"directionalRotation",version:"0.2.1",API:2,init:function(a,r){"object"!=typeof r&&(r={rotation:r}),this.finals={};var t,n,s,l,e,o,i=r.useRadians===!0?2*Math.PI:360,c=1e-6;for(t in r)"useRadians"!==t&&(o=(r[t]+"").split("_"),n=o[0],s=parseFloat("function"!=typeof a[t]?a[t]:a[t.indexOf("set")||"function"!=typeof a["get"+t.substr(3)]?t:"get"+t.substr(3)]()),l=this.finals[t]="string"==typeof n&&"="===n.charAt(1)?s+parseInt(n.charAt(0)+"1",10)*Number(n.substr(2)):Number(n)||0,e=l-s,o.length&&(n=o.join("_"),-1!==n.indexOf("short")&&(e%=i,e!==e%(i/2)&&(e=0>e?e+i:e-i)),-1!==n.indexOf("_cw")&&0>e?e=(e+9999999999*i)%i-(0|e/i)*i:-1!==n.indexOf("ccw")&&e>0&&(e=(e-9999999999*i)%i-(0|e/i)*i)),(e>c||-c>e)&&(this._addTween(a,t,s,s+e,t),this._overwriteProps.push(t)));return!0},set:function(t){var e;if(1!==t)this._super.setRatio.call(this,t);else for(e=this._firstPT;e;)e.f?e.t[e.p](this.finals[e.p]):e.t[e.p]=this.finals[e.p],e=e._next}})._autoCSS=!0,r._gsDefine("easing.Back",["easing.Ease"],function(i){var l,a,h,f=r.GreenSockGlobals||r,g=f.com.greensock,c=2*Math.PI,_=Math.PI/2,n=g._class,e=function(r,a){var e=n("easing."+r,function(){},!0),t=e.prototype=new i;return t.constructor=e,t.getRatio=a,e},u=i.register||function(){},o=function(e,i,r,a){var t=n("easing."+e,{easeOut:new i,easeIn:new r,easeInOut:new a},!0);return u(t,e),t},d=function(t,i,e){this.t=t,this.v=i,e&&(this.next=e,e.prev=this,this.c=e.v-i,this.gap=e.t-t)},p=function(r,a){var e=n("easing."+r,function(e){this._p1=e||0===e?e:1.70158,this._p2=1.525*this._p1},!0),t=e.prototype=new i;return t.constructor=e,t.getRatio=a,t.config=function(t){return new e(t)},e},m=o("Back",p("BackOut",function(e){return(e-=1)*e*((this._p1+1)*e+this._p1)+1}),p("BackIn",function(e){return e*e*((this._p1+1)*e-this._p1)}),p("BackInOut",function(e){return 1>(e*=2)?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)})),s=n("easing.SlowMo",function(e,t,i){t=t||0===t?t:.7,null==e?e=.7:e>1&&(e=1),this._p=1!==e?t:0,this._p1=(1-e)/2,this._p2=e,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),t=s.prototype=new i;return t.constructor=s,t.getRatio=function(e){var t=e+(.5-e)*this._p;return this._p1>e?this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t:e>this._p3?this._calcEnd?1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e:this._calcEnd?1:t},s.ease=new s(.7,.7),t.config=s.config=function(e,t,i){return new s(e,t,i)},l=n("easing.SteppedEase",function(e){e=e||1,this._p1=1/e,this._p2=e+1},!0),t=l.prototype=new i,t.constructor=l,t.getRatio=function(e){return 0>e?e=0:e>=1&&(e=.999999999),(this._p2*e>>0)*this._p1},t.config=l.config=function(e){return new l(e)},a=n("easing.RoughEase",function(e){e=e||{};for(var t,n,r,a,u,o,c=e.taper||"none",p=[],m=0,h=0|(e.points||20),s=h,f=e.randomize!==!1,g=e.clamp===!0,_=e.template instanceof i?e.template:null,l="number"==typeof e.strength?.4*e.strength:.4;--s>-1;)t=f?Math.random():1/h*s,n=_?_.getRatio(t):t,"none"===c?r=l:"out"===c?(a=1-t,r=a*a*l):"in"===c?r=t*t*l:.5>t?(a=2*t,r=.5*a*a*l):(a=2*(1-t),r=.5*a*a*l),f?n+=Math.random()*r-.5*r:s%2?n+=.5*r:n-=.5*r,g&&(n>1?n=1:0>n&&(n=0)),p[m++]={x:t,y:n};for(p.sort(function(e,t){return e.x-t.x}),o=new d(1,1,null),s=h;--s>-1;)u=p[s],o=new d(u.x,u.y,o);this._prev=new d(0,0,0!==o.t?o:o.next)},!0),t=a.prototype=new i,t.constructor=a,t.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&e.t>=t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},t.config=function(e){return new a(e)},a.ease=new a,o("Bounce",e("BounceOut",function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}),e("BounceIn",function(e){return 1/2.75>(e=1-e)?1-7.5625*e*e:2/2.75>e?1-(7.5625*(e-=1.5/2.75)*e+.75):2.5/2.75>e?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}),e("BounceInOut",function(e){var t=.5>e;return e=t?1-2*e:2*e-1,e=1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5})),o("Circ",e("CircOut",function(e){return Math.sqrt(1-(e-=1)*e)}),e("CircIn",function(e){return-(Math.sqrt(1-e*e)-1)}),e("CircInOut",function(e){return 1>(e*=2)?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)})),h=function(r,a,s){var e=n("easing."+r,function(e,t){this._p1=e||1,this._p2=t||s,this._p3=this._p2/c*(Math.asin(1/this._p1)||0)},!0),t=e.prototype=new i;return t.constructor=e,t.getRatio=a,t.config=function(t,i){return new e(t,i)},e},o("Elastic",h("ElasticOut",function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*c/this._p2)+1},.3),h("ElasticIn",function(e){return-(this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*c/this._p2))},.3),h("ElasticInOut",function(e){return 1>(e*=2)?-.5*this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*c/this._p2):.5*this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*c/this._p2)+1},.45)),o("Expo",e("ExpoOut",function(e){return 1-Math.pow(2,-10*e)}),e("ExpoIn",function(e){return Math.pow(2,10*(e-1))-.001}),e("ExpoInOut",function(e){return 1>(e*=2)?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))})),o("Sine",e("SineOut",function(e){return Math.sin(e*_)}),e("SineIn",function(e){return-Math.cos(e*_)+1}),e("SineInOut",function(e){return-.5*(Math.cos(Math.PI*e)-1)})),n("easing.EaseLookup",{find:function(e){return i.map[e]}},!0),u(f.SlowMo,"SlowMo","ease,"),u(a,"RoughEase","ease,"),u(l,"SteppedEase","ease,"),m},!0)}),r._gsDefine&&r._gsQueue.pop()(),function(i,Y){"use strict";var S=i.GreenSockGlobals=i.GreenSockGlobals||i;if(!S.TweenLite){var r,a,e,n,o,N=function(n){var e,i=n.split("."),t=S;for(e=0;i.length>e;e++)t[i[e]]=t=t[i[e]]||{};return t},d=N("com.greensock"),s=1e-10,W=function(t){var e,i=[],n=t.length;for(e=0;e!==n;i.push(t[e++]));return i},q=function(){},v=function(){var e=Object.prototype.toString,t=e.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&e.call(i)===t)}}(),y={},F=function(e,n,t,a){this.sc=y[e]?y[e].sc:[],y[e]=this,this.gsClass=null,this.func=t;var r=[];this.check=function(d){for(var l,c,h,o,s=n.length,u=s;--s>-1;)(l=y[n[s]]||new F(n[s],[])).gsClass?(r[s]=l.gsClass,u--):d&&l.sc.push(this);if(0===u&&t)for(c=("com.greensock."+e).split("."),h=c.pop(),o=N(c.join("."))[h]=this.gsClass=t.apply(t,r),a&&(S[h]=o,"function"==typeof define&&define.amd?define((i.GreenSockAMDPath?i.GreenSockAMDPath+"/":"")+e.split(".").pop(),[],function(){return o}):e===Y&&"undefined"!=typeof module&&module.exports&&(module.exports=o)),s=0;this.sc.length>s;s++)this.sc[s].check()},this.check(!0)},D=i._gsDefine=function(e,t,i,n){return new F(e,t,i,n)},u=d._class=function(t,e,i){return e=e||function(){},D(t,[],function(){return e},i),e};D.globals=S;var G=[0,0,1,1],A=[],c=u("easing.Ease",function(t,e,i,n){this._func=t,this._type=i||0,this._power=n||0,this._params=e?G.concat(e):G},!0),x=c.map={},O=c.register=function(i,c,h,l){for(var r,e,n,t,a=c.split(","),s=a.length,o=(h||"easeIn,easeOut,easeInOut").split(",");--s>-1;)for(e=a[s],r=l?u("easing."+e,null,!0):d.easing[e]||{},n=o.length;--n>-1;)t=o[n],x[e+"."+t]=x[t+e]=r[t]=i.getRatio?i:i[t]||new i};for(e=c.prototype,e._calcEnd=!1,e.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var i=this._type,n=this._power,e=1===i?1-t:2===i?t:.5>t?2*t:2*(1-t);return 1===n?e*=e:2===n?e*=e*e:3===n?e*=e*e*e:4===n&&(e*=e*e*e*e),1===i?1-e:2===i?e:.5>t?e/2:1-e/2},r=["Linear","Quad","Cubic","Quart","Quint,Strong"],a=r.length;--a>-1;)e=r[a]+",Power"+a,O(new c(null,null,1,a),e,"easeOut",!0),O(new c(null,null,2,a),e,"easeIn"+(0===a?",easeNone":"")),O(new c(null,null,3,a),e,"easeInOut");x.linear=d.easing.Linear.easeIn,x.swing=d.easing.Quad.easeInOut;var z=u("events.EventDispatcher",function(e){this._listeners={},this._eventTarget=e||this});e=z.prototype,e.addEventListener=function(s,l,c,h,i){i=i||0;var r,t,e=this._listeners[s],a=0;for(null==e&&(this._listeners[s]=e=[]),t=e.length;--t>-1;)r=e[t],r.c===l&&r.s===c?e.splice(t,1):0===a&&i>r.pr&&(a=t+1);e.splice(a,0,{c:l,s:c,up:h,pr:i}),this!==n||o||n.wake()},e.removeEventListener=function(i,n){var e,t=this._listeners[i];if(t)for(e=t.length;--e>-1;)if(t[e].c===n)return void t.splice(e,1)},e.dispatchEvent=function(r){var i,t,e,n=this._listeners[r];if(n)for(i=n.length,t=this._eventTarget;--i>-1;)e=n[i],e.up?e.c.call(e.s||t,{type:r,target:t}):e.c.call(e.s||t)};var T=i.requestAnimationFrame,M=i.cancelAnimationFrame,E=Date.now||function(){return(new Date).getTime()},C=E();for(r=["ms","moz","webkit","o"],a=r.length;--a>-1&&!T;)T=i[r[a]+"RequestAnimationFrame"],M=i[r[a]+"CancelAnimationFrame"]||i[r[a]+"CancelRequestAnimationFrame"];u("Ticker",function(_,f){var i,h,t,l,a,e=this,d=E(),r=f!==!1&&T,c=500,p=33,u=function(s){var n,o,r=E()-C;r>c&&(d+=r-p),C+=r,e.time=(C-d)/1e3,n=e.time-a,(!i||n>0||s===!0)&&(e.frame++,a+=n+(n>=l?.004:l-n),o=!0),s!==!0&&(t=h(u)),o&&e.dispatchEvent("tick")};z.call(e),e.time=e.frame=0,e.tick=function(){u(!0)},e.lagSmoothing=function(e,t){c=e||1/s,p=Math.min(t,c,0)},e.sleep=function(){null!=t&&(r&&M?M(t):clearTimeout(t),h=q,t=null,e===n&&(o=!1))},e.wake=function(){null!==t?e.sleep():e.frame>10&&(C=E()-c+5),h=0===i?q:r&&T?T:function(t){return setTimeout(t,0|1e3*(a-e.time)+1)},e===n&&(o=!0),u(2)},e.fps=function(t){return arguments.length?(i=t,l=1/(i||60),a=this.time+l,void e.wake()):i},e.useRAF=function(t){return arguments.length?(e.sleep(),r=t,void e.fps(i)):r},e.fps(_),setTimeout(function(){r&&(!t||5>e.frame)&&e.useRAF(!1)},1500)}),e=d.Ticker.prototype=new d.events.EventDispatcher,e.constructor=d.Ticker;var l=u("core.Animation",function(i,e){if(this.vars=e=e||{},this._duration=this._totalDuration=i||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=e.immediateRender===!0,this.data=e.data,this._reversed=e.reversed===!0,p){o||n.wake();var t=this.vars.useFrames?_:p;t.add(this,t._time),this.vars.paused&&this.paused(!0)}});n=l.ticker=new d.Ticker,e=l.prototype,e._dirty=e._gc=e._initted=e._paused=!1,e._totalTime=e._time=0,e._rawPrevTime=-1,e._next=e._last=e._onUpdate=e._timeline=e.timeline=null,e._paused=!1;var B=function(){o&&E()-C>2e3&&n.wake(),setTimeout(B,2e3)};B(),e.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},e.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},e.resume=function(e,t){return null!=e&&this.seek(e,t),this.paused(!1)},e.seek=function(e,t){return this.totalTime(Number(e),t!==!1)},e.restart=function(e,t){return this.reversed(!1).paused(!1).totalTime(e?-this._delay:0,t!==!1,!0)},e.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},e.render=function(){},e.invalidate=function(){return this},e.isActive=function(){var t,e=this._timeline,i=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime())>=i&&i+this.totalDuration()/this._timeScale>t},e._enabled=function(e,t){return o||n.wake(),this._gc=!e,this._active=this.isActive(),t!==!0&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},e._kill=function(){return this._enabled(!1,!1)},e.kill=function(e,t){return this._kill(e,t),this},e._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},e._swapSelfInParams=function(e){for(var t=e.length,i=e.concat();--t>-1;)"{self}"===e[t]&&(i[t]=this);return i},e.eventCallback=function(e,n,i,r){if("on"===(e||"").substr(0,2)){var t=this.vars;if(1===arguments.length)return t[e];null==n?delete t[e]:(t[e]=n,t[e+"Params"]=v(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,t[e+"Scope"]=r),"onUpdate"===e&&(this._onUpdate=n)}return this},e.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},e.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==e&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},e.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},e.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(e>this._duration?this._duration:e,t)):this._time},e.totalTime=function(t,a,r){if(o||n.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>t&&!r&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var i=this._totalDuration,e=this._timeline;if(t>i&&!r&&(t=i),this._startTime=(this._paused?this._pauseTime:e._time)-(this._reversed?i-t:t)/this._timeScale,e._dirty||this._uncache(!1),e._timeline)for(;e._timeline;)e._timeline._time!==(e._startTime+e._totalTime)/e._timeScale&&e.totalTime(e._totalTime,!0),e=e._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==t||0===this._duration)&&(this.render(t,a,!1),f.length&&w())}return this},e.progress=e.totalProgress=function(e,t){return arguments.length?this.totalTime(this.duration()*e,t):this._time/this.duration()},e.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},e.timeScale=function(e){if(!arguments.length)return this._timeScale;if(e=e||s,this._timeline&&this._timeline.smoothChildTiming){var t=this._pauseTime,i=t||0===t?t:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/e}return this._timeScale=e,this._uncache(!1)},e.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},e.paused=function(e){if(!arguments.length)return this._paused;if(e!=this._paused&&this._timeline){o||e||n.wake();var t=this._timeline,i=t.rawTime(),r=i-this._pauseTime;!e&&t.smoothChildTiming&&(this._startTime+=r,this._uncache(!1)),this._pauseTime=e?i:null,this._paused=e,this._active=this.isActive(),!e&&0!==r&&this._initted&&this.duration()&&this.render(t.smoothChildTiming?this._totalTime:(i-this._startTime)/this._timeScale,!0,!0)}return this._gc&&!e&&this._enabled(!0,!1),this};var k=u("core.SimpleTimeline",function(e){l.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0});e=k.prototype=new l,e.constructor=k,e.kill()._gc=!1,e._first=e._last=null,e._sortChildren=!1,e.add=e.insert=function(e,n){var t,i;if(e._startTime=Number(n||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),t=this._last,this._sortChildren)for(i=e._startTime;t&&t._startTime>i;)t=t._prev;return t?(e._next=t._next,t._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=t,this._timeline&&this._uncache(!0),this},e._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),e._next=e._prev=e.timeline=null,this._timeline&&this._uncache(!0)),this},e.render=function(t,i,n){var r,e=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;e;)r=e._next,(e._active||t>=e._startTime&&!e._paused)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(t-e._startTime)*e._timeScale,i,n):e.render((t-e._startTime)*e._timeScale,i,n)),e=r},e.rawTime=function(){return o||n.wake(),this._totalTime};var t=u("TweenLite",function(e,c,h){if(l.call(this,c,h),this.render=t.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:t.selector(e)||e;var r,n,a,u=e.jquery||e.length&&e!==i&&e[0]&&(e[0]===i||e[0].nodeType&&e[0].style&&!e.nodeType),o=this.vars.overwrite;if(this._overwrite=o=null==o?U[t.defaultOverwrite]:"number"==typeof o?o>>0:U[o],(u||e instanceof Array||e.push&&v(e))&&"number"!=typeof e[0])for(this._targets=a=W(e),this._propLookup=[],this._siblings=[],r=0;a.length>r;r++)n=a[r],n?"string"!=typeof n?n.length&&n!==i&&n[0]&&(n[0]===i||n[0].nodeType&&n[0].style&&!n.nodeType)?(a.splice(r--,1),this._targets=a=a.concat(W(n))):(this._siblings[r]=b(n,this,!1),1===o&&this._siblings[r].length>1&&L(n,this,null,1,this._siblings[r])):(n=a[r--]=t.selector(n),"string"==typeof n&&a.splice(r+1,1)):a.splice(r--,1);else this._propLookup={},this._siblings=b(e,this,!1),1===o&&this._siblings.length>1&&L(e,this,null,1,this._siblings);(this.vars.immediateRender||0===c&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-s,this.render(-this._delay))},!0),R=function(e){return e.length&&e!==i&&e[0]&&(e[0]===i||e[0].nodeType&&e[0].style&&!e.nodeType)},X=function(t,n){var e,i={};for(e in t)j[e]||e in n&&"transform"!==e&&"x"!==e&&"y"!==e&&"width"!==e&&"height"!==e&&"className"!==e&&"border"!==e||!(!g[e]||g[e]&&g[e]._autoCSS)||(i[e]=t[e],delete t[e]);t.css=i};e=t.prototype=new l,e.constructor=t,e.kill()._gc=!1,e.ratio=0,e._firstPT=e._targets=e._overwrittenProps=e._startAt=null,e._notifyPluginsOfEnabled=e._lazy=!1,t.version="1.13.1",t.defaultEase=e._ease=new c(null,null,1,1),t.defaultOverwrite="auto",t.ticker=n,t.autoSleep=!0,t.lagSmoothing=function(e,t){n.lagSmoothing(e,t)},t.selector=i.$||i.jQuery||function(e){var n=i.$||i.jQuery;return n?(t.selector=n,n(e)):"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e)};var f=[],P={},I=t._internals={isArray:v,isSelector:R,lazyTweens:f},g=t._plugins={},m=I.tweenLookup={},H=0,j=I.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1},U={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},_=l._rootFramesTimeline=new k,p=l._rootTimeline=new k,w=I.lazyRender=function(){var e=f.length;for(P={};--e>-1;)r=f[e],r&&r._lazy!==!1&&(r.render(r._lazy,!1,!0),r._lazy=!1);f.length=0};p._startTime=n.time,_._startTime=n.frame,p._active=_._active=!0,setTimeout(w,1),l._updateRoot=t.render=function(){var r,i,e;if(f.length&&w(),p.render((n.time-p._startTime)*p._timeScale,!1,!1),_.render((n.frame-_._startTime)*_._timeScale,!1,!1),f.length&&w(),!(n.frame%120)){for(e in m){for(i=m[e].tweens,r=i.length;--r>-1;)i[r]._gc&&i.splice(r,1);0===i.length&&delete m[e]}if(e=p._first,(!e||e._paused)&&t.autoSleep&&!_._first&&1===n._listeners.tick.length){for(;e&&e._paused;)e=e._next;e||n.sleep()}}},n.addEventListener("tick",l._updateRoot);var b=function(n,r,a){var e,i,t=n._gsTweenID;if(m[t||(n._gsTweenID=t="t"+H++)]||(m[t]={target:n,tweens:[]}),r&&(e=m[t].tweens,e[i=e.length]=r,a))for(;--i>-1;)e[i]===r&&e.splice(i,1);return m[t].tweens},L=function(f,i,p,n,a){var t,r,e,d;if(1===n||n>=4){for(d=a.length,t=0;d>t;t++)if((e=a[t])!==i)e._gc||e._enabled(!1,!1)&&(r=!0);else if(5===n)break;return r}var h,u=i._startTime+s,c=[],o=0,l=0===i._duration;for(t=a.length;--t>-1;)(e=a[t])===i||e._gc||e._paused||(e._timeline!==i._timeline?(h=h||V(i,0,l),0===V(e,h,l)&&(c[o++]=e)):u>=e._startTime&&e._startTime+e.totalDuration()/e._timeScale>u&&((l||!e._initted)&&2e-10>=u-e._startTime||(c[o++]=e)));for(t=o;--t>-1;)e=c[t],2===n&&e._kill(p,f)&&(r=!0),(2!==n||!e._firstPT&&e._initted)&&e._enabled(!1,!1)&&(r=!0);return r},V=function(n,i,a){for(var t=n._timeline,r=t._timeScale,e=n._startTime;t._timeline;){if(e+=t._startTime,r*=t._timeScale,t._paused)return-100;t=t._timeline}return e/=r,e>i?e-i:a&&e===i||!n._initted&&2*s>e-i?s:(e+=n.totalDuration()/n._timeScale/r)>i+s?0:e-i-s};e._init=function(){var s,h,e,r,a,i=this.vars,l=this._overwrittenProps,u=this._duration,o=!!i.immediateRender,n=i.ease;if(i.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),a={};for(r in i.startAt)a[r]=i.startAt[r];if(a.overwrite=!1,a.immediateRender=!0,a.lazy=o&&i.lazy!==!1,a.startAt=a.delay=null,this._startAt=t.to(this.target,0,a),o)if(this._time>0)this._startAt=null;else if(0!==u)return}else if(i.runBackwards&&0!==u)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{e={};for(r in i)j[r]&&"autoCSS"!==r||(e[r]=i[r]);if(e.overwrite=0,e.data="isFromStart",e.lazy=o&&i.lazy!==!1,e.immediateRender=o,this._startAt=t.to(this.target,0,e),o){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1)}if(this._ease=n=n?n instanceof c?n:"function"==typeof n?new c(n,i.easeParams):x[n]||t.defaultEase:t.defaultEase,i.easeParams instanceof Array&&n.config&&(this._ease=n.config.apply(n,i.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(s=this._targets.length;--s>-1;)this._initProps(this._targets[s],this._propLookup[s]={},this._siblings[s],l?l[s]:null)&&(h=!0);else h=this._initProps(this.target,this._propLookup,this._siblings,l);if(h&&t._onPluginEvent("_onInitAllProps",this),l&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),i.runBackwards)for(e=this._firstPT;e;)e.s+=e.c,e.c=-e.c,e=e._next;this._onUpdate=i.onUpdate,this._initted=!0},e._initProps=function(e,s,o,l){var t,c,h,a,r,n;if(null==e)return!1;P[e._gsTweenID]&&w(),this.vars.css||e.style&&e!==i&&e.nodeType&&g.css&&this.vars.autoCSS!==!1&&X(this.vars,e);for(t in this.vars){if(n=this.vars[t],j[t])n&&(n instanceof Array||n.push&&v(n))&&-1!==n.join("").indexOf("{self}")&&(this.vars[t]=n=this._swapSelfInParams(n,this));else if(g[t]&&(a=new g[t])._onInitTween(e,this.vars[t],this)){for(this._firstPT=r={_next:this._firstPT,t:a,p:"setRatio",s:0,c:1,f:!0,n:t,pg:!0,pr:a._priority},c=a._overwriteProps.length;--c>-1;)s[a._overwriteProps[c]]=this._firstPT;(a._priority||a._onInitAllProps)&&(h=!0),(a._onDisable||a._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=s[t]=r={_next:this._firstPT,t:e,p:t,f:"function"==typeof e[t],n:t,pg:!1,pr:0},r.s=r.f?e[t.indexOf("set")||"function"!=typeof e["get"+t.substr(3)]?t:"get"+t.substr(3)]():parseFloat(e[t]),r.c="string"==typeof n&&"="===n.charAt(1)?parseInt(n.charAt(0)+"1",10)*Number(n.substr(2)):Number(n)-r.s||0;r&&r._next&&(r._next._prev=r)}return l&&this._kill(l,e)?this._initProps(e,s,o,l):this._overwrite>1&&this._firstPT&&o.length>1&&L(e,this,s,this._overwrite,o)?(this._kill(s,e),this._initProps(e,s,o,l)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(P[e._gsTweenID]=!0),h)},e.render=function(e,l,n){var h,a,i,p,c=this._time,r=this._duration,o=this._rawPrevTime;if(e>=r)this._totalTime=this._time=r,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(h=!0,a="onComplete"),0===r&&(this._initted||!this.vars.lazy||n)&&(this._startTime===this._timeline._duration&&(e=0),(0===e||0>o||o===s)&&o!==e&&(n=!0,o>s&&(a="onReverseComplete")),this._rawPrevTime=p=!l||e||o===e?e:s);else if(1e-7>e)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==c||0===r&&o>0&&o!==s)&&(a="onReverseComplete",h=this._reversed),0>e?(this._active=!1,0===r&&(this._initted||!this.vars.lazy||n)&&(o>=0&&(n=!0),this._rawPrevTime=p=!l||e||o===e?e:s)):this._initted||(n=!0);else if(this._totalTime=this._time=e,this._easeType){var t=e/r,u=this._easeType,d=this._easePower;(1===u||3===u&&t>=.5)&&(t=1-t),3===u&&(t*=2),1===d?t*=t:2===d?t*=t*t:3===d?t*=t*t*t:4===d&&(t*=t*t*t*t),this.ratio=1===u?1-t:2===u?t:.5>e/r?t/2:1-t/2}else this.ratio=this._ease.getRatio(e/r);if(this._time!==c||n){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!n&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=c,this._rawPrevTime=o,f.push(this),void(this._lazy=e);this._time&&!h?this.ratio=this._ease.getRatio(this._time/r):h&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==c&&e>=0&&(this._active=!0),0===c&&(this._startAt&&(e>=0?this._startAt.render(e,l,n):a||(a="_dummyGS")),this.vars.onStart&&(0!==this._time||0===r)&&(l||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||A))),i=this._firstPT;i;)i.f?i.t[i.p](i.c*this.ratio+i.s):i.t[i.p]=i.c*this.ratio+i.s,i=i._next;this._onUpdate&&(0>e&&this._startAt&&this._startTime&&this._startAt.render(e,l,n),l||(this._time!==c||h)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||A)),a&&(!this._gc||n)&&(0>e&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(e,l,n),h&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!l&&this.vars[a]&&this.vars[a].apply(this.vars[a+"Scope"]||this,this.vars[a+"Params"]||A),0===r&&this._rawPrevTime===s&&p!==s&&(this._rawPrevTime=0))}},e._kill=function(n,i){if("all"===n&&(n=null),null==n&&(null==i||i===this.target))return this._lazy=!1,this._enabled(!1,!1);i="string"!=typeof i?i||this._targets||this.target:t.selector(i)||i;var r,s,o,e,a,l,c,h;if((v(i)||R(i))&&"number"!=typeof i[0])for(r=i.length;--r>-1;)this._kill(n,i[r])&&(l=!0);else{if(this._targets){for(r=this._targets.length;--r>-1;)if(i===this._targets[r]){a=this._propLookup[r]||{},this._overwrittenProps=this._overwrittenProps||[],s=this._overwrittenProps[r]=n?this._overwrittenProps[r]||{}:"all";break}}else{if(i!==this.target)return!1;a=this._propLookup,s=this._overwrittenProps=n?this._overwrittenProps||{}:"all"}if(a){c=n||a,h=n!==s&&"all"!==s&&n!==a&&("object"!=typeof n||!n._tempKill);for(o in c)(e=a[o])&&(e.pg&&e.t._kill(c)&&(l=!0),e.pg&&0!==e.t._overwriteProps.length||(e._prev?e._prev._next=e._next:e===this._firstPT&&(this._firstPT=e._next),e._next&&(e._next._prev=e._prev),e._next=e._prev=null),delete a[o]),h&&(s[o]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return l},e.invalidate=function(){return this._notifyPluginsOfEnabled&&t._onPluginEvent("_onDisable",this),this._firstPT=null,this._overwrittenProps=null,this._onUpdate=null,this._startAt=null,this._initted=this._active=this._notifyPluginsOfEnabled=this._lazy=!1,this._propLookup=this._targets?{}:[],this},e._enabled=function(i,a){if(o||n.wake(),i&&this._gc){var e,r=this._targets;if(r)for(e=r.length;--e>-1;)this._siblings[e]=b(r[e],this,!0);else this._siblings=b(this.target,this,!0)}return l.prototype._enabled.call(this,i,a),this._notifyPluginsOfEnabled&&this._firstPT?t._onPluginEvent(i?"_onEnable":"_onDisable",this):!1},t.to=function(e,i,n){return new t(e,i,n)},t.from=function(i,n,e){return e.runBackwards=!0,e.immediateRender=0!=e.immediateRender,new t(i,n,e)},t.fromTo=function(n,r,i,e){return e.startAt=i,e.immediateRender=0!=e.immediateRender&&0!=i.immediateRender,new t(n,r,e)},t.delayedCall=function(r,e,i,n,a){return new t(e,0,{delay:r,onComplete:e,onCompleteParams:i,onCompleteScope:n,onReverseComplete:e,onReverseCompleteParams:i,onReverseCompleteScope:n,immediateRender:!1,useFrames:a,overwrite:0})},t.set=function(e,i){return new t(e,0,i)},t.getTweensOf=function(n,a){if(null==n)return[];n="string"!=typeof n?n:t.selector(n)||n;var e,i,r,s;if((v(n)||R(n))&&"number"!=typeof n[0]){for(e=n.length,i=[];--e>-1;)i=i.concat(t.getTweensOf(n[e],a));for(e=i.length;--e>-1;)for(s=i[e],r=e;--r>-1;)s===i[r]&&i.splice(e,1)}else for(i=b(n).concat(),e=i.length;--e>-1;)(i[e]._gc||a&&!i[e].isActive())&&i.splice(e,1);return i},t.killTweensOf=t.killDelayedCallsTo=function(i,e,n){"object"==typeof e&&(n=e,e=!1);for(var r=t.getTweensOf(i,e),a=r.length;--a>-1;)r[a]._kill(n,i)};var h=u("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=h.prototype},!0);if(e=h.prototype,h.version="1.10.1",h.API=2,e._firstPT=null,e._addTween=function(n,i,r,e,s,o){var a,t;return null!=e&&(a="number"==typeof e||"="!==e.charAt(1)?Number(e)-r:parseInt(e.charAt(0)+"1",10)*Number(e.substr(2)))?(this._firstPT=t={_next:this._firstPT,t:n,p:i,s:r,c:a,f:"function"==typeof n[i],n:s||i,r:o},t._next&&(t._next._prev=t),t):void 0},e.setRatio=function(n){for(var t,e=this._firstPT,i=1e-6;e;)t=e.c*n+e.s,e.r?t=Math.round(t):i>t&&t>-i&&(t=0),e.f?e.t[e.p](t):e.t[e.p]=t,e=e._next},e._kill=function(i){var t,n=this._overwriteProps,e=this._firstPT;if(null!=i[this._propName])this._overwriteProps=[];else for(t=n.length;--t>-1;)null!=i[n[t]]&&n.splice(t,1);for(;e;)null!=i[e.n]&&(e._next&&(e._next._prev=e._prev),e._prev?(e._prev._next=e._next,e._prev=null):this._firstPT===e&&(this._firstPT=e._next)),e=e._next;return!1},e._roundProps=function(t,i){for(var e=this._firstPT;e;)(t[this._propName]||null!=e.n&&t[e.n.split(this._propName+"_").join("")])&&(e.r=i),e=e._next},t._onPluginEvent=function(i,r){var a,t,n,s,o,e=r._firstPT;if("_onInitAllProps"===i){for(;e;){for(o=e._next,t=n;t&&t.pr>e.pr;)t=t._next;(e._prev=t?t._prev:s)?e._prev._next=e:n=e,(e._next=t)?t._prev=e:s=e,e=o}e=r._firstPT=n}for(;e;)e.pg&&"function"==typeof e.t[i]&&e.t[i]()&&(a=!0),e=e._next;return a},h.activate=function(e){for(var t=e.length;--t>-1;)e[t].API===h.API&&(g[(new e[t])._propName]=e[t]);return!0},D.plugin=function(e){if(!(e&&e.propName&&e.init&&e.API))throw"illegal plugin definition.";var i,n=e.propName,s=e.priority||0,o=e.overwriteProps,r={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},t=u("plugins."+n.charAt(0).toUpperCase()+n.substr(1)+"Plugin",function(){h.call(this,n,s),this._overwriteProps=o||[]},e.global===!0),a=t.prototype=new h(n);a.constructor=t,t.API=e.API;for(i in r)"function"==typeof e[i]&&(a[r[i]]=e[i]);return t.version=e.version,h.activate([t]),t},r=i._gsQueue){for(a=0;r.length>a;a++)r[a]();for(e in y)y[e].func||i.console.log("GSAP encountered missing dependency: com.greensock."+e)}o=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax"),void function(t){"use strict";var l=t.GreenSockGlobals||t,f=function(n){for(var i=n.split("."),e=l,t=0;t<i.length;t++)e[i[t]]||(e[i[t]]={}),e=e[i[t]];return e},p=f("com.greensock.utils"),n=function(e){var t=e.nodeType,i="";if(3==t||4==t)return e.nodeValue;if(1==t||9==t||11==b){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=n(e)}return i},e=function(n,r,e,a){if(e||(e=t.getComputedStyle(n,null)),e){var i=e.getPropertyValue(r.replace(/([A-Z])/g,"-$1").toLowerCase());return i||e.length?i:e[r]}var i=void 0;if(n.currentStyle){e=n.currentStyle;var i=e[r]}return a?i:parseInt(i,10)||0},s=function(e){return e.length&&e[0]&&(e[0].nodeType&&e[0].style&&!e.nodeType||e[0].length&&e[0][0])?!0:!1},h=function(r){var i,e,t,n=[],a=r.length;for(i=0;a>i;i++)if(e=r[i],s(e))for(t=e.length,t=0;t<e.length;t++)n.push(e[t]);else n.push(e);return n},c=")eefec303079ad17405c",o=/(?:<br>|<br\/>|<br \/>)/gi,u=document.all&&!document.addEventListener,d="<div style='position:relative;display:inline-block;"+(u?"*display:inline;*zoom:1;'":"'"),a=function(e){e=e||"";var t=-1!==e.indexOf("++"),i=1;return function(){return d+(e?" class='"+e+(t?i++:"")+"'>":">")}},i=p.SplitText=l.SplitText=function(e,t){if("string"==typeof e&&(e=i.selector(e)),!e)throw"cannot split a null element.";this.elements=s(e)?h(e):[e],this.chars=[],this.words=[],this.lines=[],this._originals=[],this.vars=t||{},this.split(t)},_=function(i,y,D,H,F){o.test(i.innerHTML)&&(i.innerHTML=i.innerHTML.replace(o,c));var w,p,b,s,_,E,x,r,f,l,m,j,O,A=n(i),M=y.type||y.split||"chars,words,lines",g=-1!==M.indexOf("lines")?[]:null,v=-1!==M.indexOf("words"),T=-1!==M.indexOf("chars"),h="absolute"===y.position||y.absolute===!0,q=h?"&#173; ":" ",P=-999,d=t.getComputedStyle(i),I=e(i,"paddingLeft",d),N=e(i,"borderBottomWidth",d)+e(i,"borderTopWidth",d),U=e(i,"borderLeftWidth",d)+e(i,"borderRightWidth",d),G=e(i,"paddingTop",d)+e(i,"paddingBottom",d),W=e(i,"paddingLeft",d)+e(i,"paddingRight",d),B=e(i,"textAlign",d,!0),k=i.clientHeight,S=i.clientWidth,u=A.length,R="</div>",L=a(y.wordsClass),V=a(y.charsClass),z=-1!==(y.linesClass||"").indexOf("++"),C=y.linesClass;for(z&&(C=C.split("++").join("")),b=L(),s=0;u>s;s++)E=A.charAt(s),")"===E&&A.substr(s,20)===c?(b+=R+"<BR/>",s!==u-1&&(b+=" "+L()),s+=19):" "===E&&" "!==A.charAt(s-1)&&s!==u-1?(b+=R,s!==u-1&&(b+=q+L())):b+=T&&" "!==E?V()+E+"</div>":E;for(i.innerHTML=b+R,_=i.getElementsByTagName("*"),u=_.length,x=[],s=0;u>s;s++)x[s]=_[s];if(g||h)for(s=0;u>s;s++)r=x[s],p=r.parentNode===i,(p||h||T&&!v)&&(f=r.offsetTop,g&&p&&f!==P&&"BR"!==r.nodeName&&(w=[],g.push(w),P=f),h&&(r._x=r.offsetLeft,r._y=f,r._w=r.offsetWidth,r._h=r.offsetHeight),g&&(v!==p&&(T||(w.push(r),r._x-=I)),p&&s&&(x[s-1]._wordEnd=!0)));for(s=0;u>s;s++)r=x[s],p=r.parentNode===i,"BR"!==r.nodeName?(h&&(m=r.style,v||p||(r._x+=r.parentNode._x,r._y+=r.parentNode._y),m.left=r._x+"px",m.top=r._y+"px",m.position="absolute",m.display="block",m.width=r._w+1+"px",m.height=r._h+"px"),v?p?H.push(r):T&&D.push(r):p?(i.removeChild(r),x.splice(s--,1),u--):!p&&T&&(f=!g&&!h&&r.nextSibling,i.appendChild(r),f||i.appendChild(document.createTextNode(" ")),D.push(r))):g||h?(i.removeChild(r),x.splice(s--,1),u--):v||i.appendChild(r);if(g){for(h&&(l=document.createElement("div"),i.appendChild(l),j=l.offsetWidth+"px",f=l.offsetParent===i?0:i.offsetLeft,i.removeChild(l)),m=i.style.cssText,i.style.cssText="display:none;";i.firstChild;)i.removeChild(i.firstChild);for(O=!h||!v&&!T,s=0;s<g.length;s++){for(w=g[s],l=document.createElement("div"),l.style.cssText="display:block;text-align:"+B+";position:"+(h?"absolute;":"relative;"),C&&(l.className=C+(z?s+1:"")),F.push(l),u=w.length,_=0;u>_;_++)"BR"!==w[_].nodeName&&(r=w[_],l.appendChild(r),O&&(r._wordEnd||v)&&l.appendChild(document.createTextNode(" ")),h&&(0===_&&(l.style.top=r._y+"px",l.style.left=I+f+"px"),r.style.top="0px",f&&(r.style.left=r._x-f+"px")));v||T||(l.innerHTML=n(l).split(String.fromCharCode(160)).join(" ")),h&&(l.style.width=j,l.style.height=r._h+"px"),i.appendChild(l)}i.style.cssText=m}h&&(k>i.clientHeight&&(i.style.height=k-G+"px",k>i.clientHeight&&(i.style.height=k+N+"px")),S>i.clientWidth&&(i.style.width=S-W+"px",S>i.clientWidth&&(i.style.width=S+U+"px")))},r=i.prototype;r.split=function(t){this.isSplit&&this.revert(),this.vars=t||this.vars,this._originals.length=this.chars.length=this.words.length=this.lines.length=0;for(var e=0;e<this.elements.length;e++)this._originals[e]=this.elements[e].innerHTML,_(this.elements[e],this.vars,this.chars,this.words,this.lines);return this.isSplit=!0,this},r.revert=function(){if(!this._originals)throw"revert() call wasn't scoped properly.";for(var e=this._originals.length;--e>-1;)this.elements[e].innerHTML=this._originals[e];return this.chars=[],this.words=[],this.lines=[],this.isSplit=!1,this},i.selector=t.$||t.jQuery||function(){return t.$?(i.selector=t.$,t.$("")):document?document.getElementById("#"==="".charAt(0)?"".substr(1):""):""}}(window),void function(){function t(e,t){(!e||"keyup"!=e.type||"undefined"==typeof e.keyCode||0!=e.keyCode&&13==e.keyCode)&&(t.destroy_listeners(),t.parentNode&&t.parentNode.removeChild(t),t.callback_ok())}function n(e,t){(!e||"keyup"!=e.type||"undefined"==typeof e.keyCode||0!=e.keyCode&&27==e.keyCode)&&(t.destroy_listeners(),t.parentNode&&t.parentNode.removeChild(t),t.callback_cancel())}function r(i,e){if("undefined"==typeof i)var e=e.primary,i=e.secondary;var n={};for(var t in i)n[t]=i[t];for(var t in e)n[t]=e[t];return n}var e={};e.ok="Ok",e.cancel="Cancel",e.point_event="click",e.parent=document.body,e.zindex=1e4,e.reverse_buttons=!1,e.autofocus=!0,e.autoexit=!0,e.custom_css={},e.css_prefix="smoke",e.value=void 0,e.callback=void 0,e.observe_mutation=!0,e.window_opened=void 0,e.window_closed=void 0,e.build=function(c,t){("undefined"==typeof e.parent||null==e.parent)&&(e.parent=document.body);var S="undefined"!=typeof t.ok?t.ok:e.ok,C="undefined"!=typeof t.cancel?t.cancel:e.cancel,y="undefined"!=typeof t.point_event?t.point_event:e.point_event,p="undefined"!=typeof t.parent?t.parent:e.parent,E="undefined"!=typeof t.zindex?t.zindex:e.zindex,w=("undefined"!=typeof t.reverse_buttons?t.reverse_buttons:e.reverse_buttons,"undefined"!=typeof t.autoexit?t.autoexit:e.autoexit),b="undefined"!=typeof t.autofocus?t.autofocus:e.autofocus,g="undefined"!=typeof t.custom_css?t.custom_css:e.custom_css,r="undefined"!=typeof t.css_prefix?t.css_prefix:e.css_prefix,v="undefined"!=typeof t.value?t.value:e.value,x="undefined"!=typeof t.callback?t.callback:e.callback,k="undefined"!=typeof t.observe_mutation?t.observe_mutation:e.observe_mutation,l=("undefined"!=typeof t.window_opened?t.window_opened:e.window_opened,"undefined"!=typeof t.window_closed?t.window_closed:e.window_closed,!1);t.point_event=y,t.callback=x;var i=document.createElement("div");i.className=r+"-base",i.style.zIndex=E,p.appendChild(i);var h=i.dialog_wrapper=document.createElement("div");h.className=r+"-dialog_wrapper",i.appendChild(h),w&&h.addEventListener(y,function(n){"undefined"!=typeof n.changedTouches&&(n=n.changedTouches[0]),n.currentTarget==n.target&&(i.parentNode.removeChild(i),t.callback(!1,n),!l&&e.window_closed&&(e.window_closed(i,c,t),l=!0))});var s=i.dialog=document.createElement("div");s.className=r+"-dialog",h.appendChild(s);var d=i.text=i.dialog.text=document.createElement("div");if(d.className=r+"-dialog-text",d.innerHTML=c,s.appendChild(d),"prompt"==t.type){var a=i.prompt=i.dialog.prompt=document.createElement("div");a.className=r+"-prompt",a.input=document.createElement("input"),a.input.type="text",a.input.className=r+"-prompt-input","undefined"!=typeof v&&(a.input.value=v),a.appendChild(a.input),s.appendChild(a)}var n=i.buttons=i.dialog.buttons=document.createElement("div");n.className=r+"-dialog-buttons",n.ok=document.createElement("button"),n.ok.className=r+"-dialog-buttons-ok",n.ok.innerHTML=S,"alert"==t.type&&n.appendChild(n.ok),("prompt"==t.type||"confirm"==t.type)&&(n.cancel=document.createElement("button"),n.cancel.className=r+"-dialog-buttons-cancel",n.cancel.innerHTML=C,t.reverse_buttons?(n.appendChild(n.cancel),n.appendChild(n.ok)):(n.appendChild(n.ok),n.appendChild(n.cancel))),s.appendChild(n);for(var _ in g){var T=_.split("."),u=i;T.forEach(function(e){u=u[e]});var o=g[_];"string"==typeof o&&(o=[o]),o.forEach(function(e){u.classList.add(e)})}if("function"!=typeof t.callback&&(t.callback=function(){}),i.params=t,e["finishbuilding_"+t.type](i,t),"undefined"!=typeof i.prompt&&0!=b&&i.prompt.input.focus(),k){var f=window.MutationObserver||window.WebkitMutationObserver;if("undefined"!=typeof f){var m=new f(function(s){for(var n=0,o=s.length;o>n;n++){var r=s[n];if("childList"!=r.type)return;for(var a=0,h=r.removedNodes.length;h>a;a++)if(r.removedNodes[a]==i)return!l&&e.window_closed&&(e.window_closed(i,c,t),l=!0),void i.destroy_listeners(m)}});m.observe(p,{attributes:!1,childList:!0,subtree:!1})}}return e.window_opened&&e.window_opened(i,c,t),i},e.finishbuilding_alert=function(e){e.callback_ok=function(){e.params.callback()},e.destroy_listeners=function(e){e&&e.disconnect(),document.removeEventListener("keyup",i)};var i=e.ok=function(i){t(i,e)};document.addEventListener("keyup",i),e.buttons.ok.addEventListener(e.params.point_event,i),e.buttons.ok.smoke_pure_obj=e},e.finishbuilding_confirm=function(e){e.callback_ok=function(){e.params.callback(!0)},e.callback_cancel=function(){e.params.callback(!1)},e.destroy_listeners=function(e){e&&e.disconnect(),document.removeEventListener("keyup",i),document.removeEventListener("keyup",r)};var i=e.ok=function(i){t(i,e)},r=e.cancel=function(t){n(t,e)};document.addEventListener("keyup",i),e.buttons.ok.addEventListener(e.params.point_event,i),document.addEventListener("keyup",r),e.buttons.cancel.addEventListener(e.params.point_event,r),e.buttons.ok.smoke_pure_obj=e,e.buttons.cancel.smoke_pure_obj=e},e.finishbuilding_prompt=function(e){e.callback_ok=function(){e.params.callback(e.prompt.input.value)},e.callback_cancel=function(){e.params.callback(!1)},e.destroy_listeners=function(e){e&&e.disconnect(),document.removeEventListener("keyup",i),document.removeEventListener("keyup",r)};var i=e.ok=function(i){t(i,e)},r=e.cancel=function(t){n(t,e)};document.addEventListener("keyup",i),e.buttons.ok.addEventListener(e.params.point_event,i),document.addEventListener("keyup",r),e.buttons.cancel.addEventListener(e.params.point_event,r),e.buttons.ok.smoke_pure_obj=e,e.buttons.cancel.smoke_pure_obj=e},e.action_list=[{name:"alert"},{name:"confirm"},{name:"prompt"}];for(var i=0;i<e.action_list.length;i++)void function(t){e[t]=function(i,n,a){return e.build(i,r({callback:n,type:t},a))}}(e.action_list[i].name);"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define("smoke",[],function(){return e}):this.smoke=e}(),/(msie|trident)/i.test(navigator.userAgent)){var St=Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML").get,kt=Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML").set;Object.defineProperty(HTMLElement.prototype,"innerHTML",{get:function(){return St.call(this)},set:function(i){for(var e=this.childNodes,n=e.length,t=n;t>0;t--)this.removeChild(e[0]);kt.call(this,i)}})}["forEach"].forEach(function(e){NodeList.prototype[e]=HTMLCollection.prototype[e]=function(t,i){return Array.prototype.slice.call(this)[e](t,i)}}),/(msie|trident)/i.test(navigator.userAgent)&&Object.defineProperty(HTMLImageElement.prototype,"start",{writable:!0}),HTMLElement.prototype.isAttached=function(){for(var e=this;;){if(e=e.parentNode,e==document.documentElement)return!0;if(null==e)return!1}},HTMLElement.prototype.setTimeout=function(e,t){function i(e){for(;;){if(e=e.parentNode,e==document.documentElement)return!0;if(null==e)return!1}}function n(){var t=Array.prototype.slice.call(arguments);i(r)&&e.apply(null,t)}var r=this,a=window.setTimeout(n,t);return a},HTMLElement.prototype.setInterval=function(e,t){},Math.randInt=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},Math.randBMT=function(){var t,n,e=0,i=0;do e=2*Math.random()-1,i=2*Math.random()-1,t=e*e+i*i;while(0==t||t>1);n=Math.sqrt(-2*Math.log(t)/t);var e=(e*n+1)/2;return e>1?e=1:0>e&&(e=0),e},Math.weightedSample=function(e){var t=0;for(var i in e)t+=e[i];t*=Math.random();for(var i in e)if(t-=e[i],0>t)return i},String.prototype.capitalize=function(){function e(){return arguments[0].toUpperCase()}return this.toLowerCase().replace(/^[a-z]|\s[a-z]/g,e)},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},HTMLElement.prototype.playAudio=function(){function i(e){for(;;){if(e=e.parentNode,e==document.documentElement)return!0;if(null==e)return!1}}function t(){return i(n)?void setTimeout(t,50):(e.stop(),void("undefined"!=typeof e.release&&e.release()))}var n=this;t();var r=Array.prototype.slice.call(arguments),e=T.apply(null,r);return e},"undefined"!=typeof o&&1==o&&window.screen.lockOrientation&&window.screen.lockOrientation("landscape");var E;1==!!window.IS_READY?E=x():window.addEventListener("load",function(){return window.IS_READY=!0,"undefined"!=typeof o&&1==o?void document.addEventListener("deviceready",function(){E=x()}):void(E=x())}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined.");if("function"!=typeof t||"[object Function]"!==Object.prototype.toString.call(t))throw new TypeError("Array#findIndex: predicate must be a function.");for(var i=Object(this),n=i.length>>>0,r=arguments[1],e=0;n>e;e++){var a=i[e];if(t.call(r,a,e,i))return e}return-1}),Array.prototype.find||(Array.prototype.find=function(e){if("function"!=typeof e)throw new TypeError("Predicate must be a function.");var t=Object(this),n=t.length<0?0:t.length>>>0;if(0===n)return void 0;if("function"!=typeof e||"[object Function]"!==Object.prototype.toString.call(e))throw new TypeError("Array#find: predicate must be a function.");for(var a=arguments[1],i=0;n>i;i++){var r=t[i];if(e.call(a,r,i,t))return r}return void 0});var e=function(t){return e.use(t)};e.utils={extend:function(t){for(var a=Array.prototype.slice.call(arguments,1),n=0;n<a.length;n++){var i=a[n];if(t instanceof Object&&i instanceof Object&&t!==i)for(var r in i)t[r]=e.utils.extend(t[r],i[r]);else t=i}return t}},e.utils.extend(e,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,default_service:null,force:!0,page_uri:window.location.href},service:function(e){return"undefined"!=typeof e?this.utils.store("sync_service",e):this.utils.store("sync_service")},services:{},use:function(t){var e=this.utils.objectCreate(this);return e.settings=this.utils.objectCreate(this.settings),t&&(e.settings.default_service=t),e.utils.Event.call(e),e},init:function(t,i){var n=this.utils;if(!t)return this.services;for(var e in t)t.hasOwnProperty(e)&&"object"!=typeof t[e]&&(t[e]={id:t[e]});n.extend(this.services,t);for(e in this.services)this.services.hasOwnProperty(e)&&(this.services[e].scope=this.services[e].scope||{});return i&&(n.extend(this.settings,i),"redirect_uri"in i&&(this.settings.redirect_uri=n.url(i.redirect_uri).href)),this},login:function(){var t=this.use(),a=t.utils,e=a.args({network:"s",options:"o",callback:"f"},arguments);t.args=e;var s,i=e.options=a.merge(t.settings,e.options||{});if(e.network=t.settings.default_service=e.network||t.settings.default_service,t.on("complete",e.callback),"string"!=typeof e.network||!(e.network in t.services))return t.emitAfter("error complete",{error:{code:"invalid_network",message:"The provided network was not recognized"}}),t;var r=t.services[e.network],u=!1,f=a.globalEvent(function(i){var e;e=i?JSON.parse(i):{error:{code:"cancelled",message:"The authentication was not completed"}},u=!0,e.error?t.emit("complete error failed auth.failed",{error:e.error}):(a.store(e.network,e),t.emit("complete success login auth.login auth",{network:e.network,authResponse:e}))}),c=a.url(i.redirect_uri).href,l=r.oauth.response_type||i.response_type;"code"!==l||r.oauth.grant||(l="token"),e.qs={client_id:r.id,response_type:l,redirect_uri:c,display:i.display,scope:"basic",state:{client_id:r.id,network:e.network,display:i.display,callback:f,state:i.state,redirect_uri:c}};var n=a.store(e.network),o=(i.scope||"").toString();if(o=(o?o+",":"")+e.qs.scope,n&&"scope"in n&&n.scope instanceof String&&(o+=","+n.scope),e.qs.state.scope=a.unique(o.split(/[,\s]+/)).join(","),e.qs.scope=o.replace(/[^,\s]+/gi,function(e){if(e in r.scope)return r.scope[e];for(var n in t.services){var i=t.services[n].scope;if(i&&e in i)return""}return e}).replace(/[,\s]+/gi,","),e.qs.scope=a.unique(e.qs.scope.split(/,+/)).join(r.scope_delim||","),i.force===!1&&n&&"access_token"in n&&n.access_token&&"expires"in n&&n.expires>(new Date).getTime()/1e3){var d=a.diff(n.scope||[],e.qs.state.scope||[]);if(0===d.length)return t.emitAfter("complete success login",{unchanged:!0,network:e.network,authResponse:n}),t}if("page"===i.display&&i.page_uri&&(e.qs.state.page_uri=a.url(i.page_uri).href),"login"in r&&"function"==typeof r.login&&r.login(e),("token"!==l||parseInt(r.oauth.version,10)<2||"none"===i.display&&r.oauth.grant&&n&&n.refresh_token)&&(e.qs.state.oauth=r.oauth,e.qs.state.oauth_proxy=i.oauth_proxy),e.qs.state=JSON.stringify(e.qs.state),1===parseInt(r.oauth.version,10)?s=a.qs(i.oauth_proxy,e.qs):"none"===i.display&&r.oauth.grant&&n&&n.refresh_token?(e.qs.refresh_token=n.refresh_token,s=a.qs(i.oauth_proxy,e.qs)):s=a.qs(r.oauth.auth,e.qs),t.emit("notice","Authorization URL "+s),"none"===i.display)a.iframe(s);else if("popup"===i.display)var h=a.popup(s,c,i.window_width||500,i.window_height||550),p=setInterval(function(){if((!h||h.closed)&&(clearInterval(p),!u)){var i={code:"cancelled",message:"Login has been cancelled"};h||(i={code:"blocked",message:"Popup was blocked"}),t.emit("complete failed error",{error:i,network:e.network})}},100);else window.location=s;return t},logout:function(){var t=this.use(),r=t.utils,i=r.args({name:"s",options:"o",callback:"f"},arguments);if(i.options=i.options||{},t.on("complete",i.callback),i.name=i.name||t.settings.default_service,!i.name||i.name in t.services)if(i.name&&r.store(i.name)){var s=function(n){t.utils.store(i.name,""),t.emitAfter("complete logout success auth.logout auth",e.utils.merge({network:i.name},n||{}))},a={};if(i.options.force){var n=t.services[i.name].logout;if(n)if("function"==typeof n&&(n=n(s)),"string"==typeof n)r.iframe(n),a.force=null,a.message="Logout success on providers site was indeterminate";else if(void 0===n)return t}s(a)}else if(i.name)t.emitAfter("complete error",{error:{code:"invalid_session",message:"There was no session to remove"}});else{for(var o in t.services)t.services.hasOwnProperty(o)&&t.logout(o);t.service(!1)}else t.emitAfter("complete error",{error:{code:"invalid_network",message:"The network was unrecognized"}});return t},getAuthResponse:function(e){return e=e||this.settings.default_service,e&&e in this.services?this.utils.store(e)||null:(this.emit("complete error",{error:{code:"invalid_network",message:"The network was unrecognized"}}),null)},events:{}}),e.utils.extend(e.utils,{qs:function(e,t){if(t){var i;for(var n in t)if(e.indexOf(n)>-1){var r="[\\?\\&]"+n+"=[^\\&]*";i=new RegExp(r),e=e.replace(i,"")}}return e+(this.isEmpty(t)?"":(e.indexOf("?")>-1?"&":"?")+this.param(t))},param:function(n){var r,a,e={};if("string"==typeof n){if(a=n.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var s=0;s<a.length;s++)r=a[s].match(/([^=]+)=(.*)/),e[r[1]]=decodeURIComponent(r[2]);return e}var t=n;e=[];for(var i in t)t.hasOwnProperty(i)&&t.hasOwnProperty(i)&&e.push([i,"?"===t[i]?"?":encodeURIComponent(t[i])].join("="));return e.join("&")},store:function(e){function n(){var t={};try{t=JSON.parse(e.getItem("hello"))||{}}catch(i){}return t}function r(t){e.setItem("hello",JSON.stringify(t))}var i=[e,window.sessionStorage],t=0;for(e=i[t++];e;)try{e.setItem(t,t),e.removeItem(t);break}catch(a){e=i[t++]}return e||(e={getItem:function(e){e+="=";for(var n=document.cookie.split(";"),t=0;t<n.length;t++){var i=n[t].replace(/(^\s+|\s+$)/,"");if(i&&0===i.indexOf(e))return i.substr(e.length)}return null},setItem:function(e,t){document.cookie=e+"="+t}}),function(e,i){var t=n();if(e&&void 0===i)return t[e]||null;if(e&&null===i)try{delete t[e]}catch(a){t[e]=null}else{if(!e)return t;t[e]=i}return r(t),t||null}}(window.localStorage),append:function(r,t,n){var i="string"==typeof r?document.createElement(r):r;if("object"==typeof t)if("tagName"in t)n=t;else for(var e in t)if(t.hasOwnProperty(e))if("object"==typeof t[e])for(var a in t[e])t[e].hasOwnProperty(a)&&(i[e][a]=t[e][a]);else"html"===e?i.innerHTML=t[e]:/^on/.test(e)?i[e]=t[e]:i.setAttribute(e,t[e]);return"body"===n?!function s(){document.body?document.body.appendChild(i):setTimeout(s,16)}():"object"==typeof n?n.appendChild(i):"string"==typeof n&&document.getElementsByTagName(n)[0].appendChild(i),i},iframe:function(e){this.append("iframe",{src:e,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},args:function(t,i){var a={},r=0,n=null,e=null;for(e in t)if(t.hasOwnProperty(e))break;if(1===i.length&&"object"==typeof i[0]&&"o!"!=t[e])for(e in i[0])if(t.hasOwnProperty(e)&&e in t)return i[0];for(e in t)if(t.hasOwnProperty(e))if(n=typeof i[r],"function"==typeof t[e]&&t[e].test(i[r])||"string"==typeof t[e]&&(t[e].indexOf("s")>-1&&"string"===n||t[e].indexOf("o")>-1&&"object"===n||t[e].indexOf("i")>-1&&"number"===n||t[e].indexOf("a")>-1&&"object"===n||t[e].indexOf("f")>-1&&"function"===n))a[e]=i[r++];else if("string"==typeof t[e]&&t[e].indexOf("!")>-1)return!1;return a},url:function(e){if(e){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(e,window.location);var t=document.createElement("a");return t.href=e,t}return window.location},diff:function(n,t){for(var i=[],e=0;e<t.length;e++)-1===this.indexOf(n,t[e])&&i.push(t[e]);return i},indexOf:function(e,i){if(e.indexOf)return e.indexOf(i);for(var t=0;t<e.length;t++)if(e[t]===i)return t;return-1},unique:function(e){if("object"!=typeof e)return[];for(var i=[],t=0;t<e.length;t++)e[t]&&0!==e[t].length&&-1===this.indexOf(i,e[t])&&i.push(e[t]);return i},isEmpty:function(e){if(!e)return!0;if(e&&e.length>0)return!1;if(e&&0===e.length)return!0;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},objectCreate:function(){function e(){}return Object.create?Object.create:function(t){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}(),Event:function(){var t=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(r,i){if(i&&"function"==typeof i)for(var n=r.split(t),e=0;e<n.length;e++)this.events[n[e]]=[i].concat(this.events[n[e]]||[]);return this},this.off=function(t,e){return this.findEvents(t,function(t,i){e&&this.events[t][i]!==e||(this.events[t][i]=null)}),this},this.emit=function(i){var t=Array.prototype.slice.call(arguments,1);t.push(i);for(var n=function(e,n){t[t.length-1]="*"===e?i:e,this.events[e][n].apply(this,t)},e=this;e&&e.findEvents;)e.findEvents(i+",*",n),e=e.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout(function(){e.emit.apply(e,t)},0),this},this.findEvents=function(r,a){var s=r.split(t);for(var i in this.events)if(this.events.hasOwnProperty(i)&&e.utils.indexOf(s,i)>-1)for(var n=0;n<this.events[i].length;n++)this.events[i][n]&&a.call(this,i,n)},this},globalEvent:function(t,e){return e=e||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[e]=function(){try{bool=t.apply(this,arguments)}catch(i){console.error(i)}if(bool)try{delete window[e]}catch(i){}},e},popup:function(t,s,n,r){var a=document.documentElement,o=void 0!==window.screenLeft?window.screenLeft:screen.left,d=void 0!==window.screenTop?window.screenTop:screen.top,l=window.innerWidth||a.clientWidth||screen.width,c=window.innerHeight||a.clientHeight||screen.height,h=(l-n)/2+o,u=(c-r)/2+d,i=function(o){var t=window.open(o,"_blank","resizeable=true,height="+r+",width="+n+",left="+h+",top="+u);if(t&&t.addEventListener){var a=e.utils.url(s),l=a.origin||a.protocol+"//"+a.hostname;t.addEventListener("loadstart",function(s){var r=s.url;if(0===r.indexOf(l)){var n=e.utils.url(r),a={location:{assign:function(e){t.addEventListener("exit",function(){setTimeout(function(){i(e)},1e3)})},search:n.search,hash:n.hash,href:n.href},close:function(){t.close&&t.close()}};e.utils.responseHandler(a,window),a.close()}})}return t&&t.focus&&t.focus(),t};return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(t=s+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(t))),i(t)},responseHandler:function(t,r){function s(e,s,t){if(i.store(e.network,e),!("display"in e&&"page"===e.display)){if(t){var n=e.callback;try{delete e.callback}catch(o){}if(i.store(e.network,e),n in t){var r=JSON.stringify(e);try{t[n](r)}catch(o){}}}a()}}function a(){try{t.close()}catch(e){}t.addEventListener&&t.addEventListener("load",function(){t.close()})}var e,i=this,n=t.location,o=function(e){n.assign?n.assign(e):t.location=e};if(e=i.param(n.search),e&&(e.code&&e.state||e.oauth_token&&e.proxy_url)){var l=JSON.parse(e.state);e.redirect_uri=l.redirect_uri||n.href.replace(/[\?\#].*$/,"");var c=(l.oauth_proxy||e.proxy_url)+"?"+i.param(e);return void o(c)}if(e=i.merge(i.param(n.search||""),i.param(n.hash||"")),e&&"state"in e){try{var h=JSON.parse(e.state);i.extend(e,h)}catch(d){console.error("Could not decode state parameter")}if("access_token"in e&&e.access_token&&e.network)e.expires_in&&0!==parseInt(e.expires_in,10)||(e.expires_in=0),e.expires_in=parseInt(e.expires_in,10),e.expires=(new Date).getTime()/1e3+(e.expires_in||31536e3),s(e,t,r);else if("error"in e&&e.error&&e.network)e.error={code:e.error,message:e.error_message||e.error_description},s(e,t,r);else if(e.callback&&e.callback in r){var u="result"in e&&e.result?JSON.parse(e.result):!1;r[e.callback](u),a()}e.page_uri&&(t.location=e.page_uri)}else if("oauth_redirect"in e)return void o(decodeURIComponent(e.oauth_redirect))}}),e.utils.Event.call(e),e.subscribe=e.on,e.trigger=e.emit,e.unsubscribe=e.off,e.utils.responseHandler(window,window.opener||window.parent),function(e){var i={},t={};e.on("auth.login, auth.logout",function(t){t&&"object"==typeof t&&t.network&&(i[t.network]=e.utils.store(t.network)||{})}),function n(){var o=(new Date).getTime()/1e3,s=function(t){e.emit("auth."+t,{network:n,authResponse:r})};for(var n in e.services)if(e.services.hasOwnProperty(n)){if(!e.services[n].id)continue;var r=e.utils.store(n)||{},c=e.services[n],a=i[n]||{};if(r&&"callback"in r){var h=r.callback;try{delete r.callback}catch(u){}e.utils.store(n,r);try{window[h](r)}catch(u){}}if(r&&"expires"in r&&r.expires<o){var l=c.refresh||r.refresh_token;!l||n in t&&!(t[n]<o)?l||n in t||(s("expired"),t[n]=!0):(e.emit("notice",n+" has expired trying to resignin"),e.login(n,{display:"none",force:!1}),t[n]=o+600);continue}if(a.access_token===r.access_token&&a.expires===r.expires)continue;!r.access_token&&a.access_token?s("logout"):r.access_token&&!a.access_token?s("login"):r.expires!==a.expires&&s("update"),i[n]=r,n in t&&delete t[n]}setTimeout(n,1e3)}()}(e),e.api=function(){function c(n){n=n.replace(/\@\{([a-z\_\-]+)(\|.+?)?\}/gi,function(r,t,i){var n=i?i.replace(/^\|/,""):"";return t in e.query?(n=e.query[t],delete e.query[t]):i||s("missing_attribute","The attribute "+t+" is missing from the request"),n}),n.match(/^https?:\/\//)||(n=t.base+n),e.url=n,r.request(e,function(n,s){if(n===!0?n={success:!0}:n||(n={}),"delete"===e.method&&(n=!n||r.isEmpty(n)?{success:!0}:n),t.wrap&&(e.path in t.wrap||"default"in t.wrap)){var o=e.path in t.wrap?e.path:"default",a=((new Date).getTime(),t.wrap[o](n,s,e));a&&(n=a)}n&&"paging"in n&&n.paging.next&&("?"===n.paging.next[0]?n.paging.next=e.path+n.paging.next:n.paging.next+="#"+e.path),i.emit("complete "+(!n||"error"in n?"error":"success"),n)})}function s(e,t){return i.emitAfter("complete error",{error:{code:e,message:t}})}var e=this.utils.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments),i=this.use(),r=i.utils;i.args=e,e.method=(e.method||"get").toLowerCase(),e.headers=e.headers||{},e.query=e.query||{},("get"===e.method||"delete"===e.method)&&(r.extend(e.query,e.data),e.data={});var d=e.data=e.data||{};if(i.on("complete",e.callback),!e.path)return s("invalid_path","Missing the path parameter from the request");e.path=e.path.replace(/^\/+/,"");var o=(e.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(o in i.services){e.network=o;var p=new RegExp("^"+o+":?/?");e.path=e.path.replace(p,"")}e.network=i.settings.default_service=e.network||i.settings.default_service;var t=i.services[e.network];if(!t)return s("invalid_network","Could not match the service requested: "+e.network);if(e.method in t&&e.path in t[e.method]&&t[e.method][e.path]===!1)return s("invalid_path","The provided path is not available on the selected network");e.oauth_proxy||(e.oauth_proxy=i.settings.oauth_proxy),"proxy"in e||(e.proxy=e.oauth_proxy&&t.oauth&&1===parseInt(t.oauth.version,10)),"timeout"in e||(e.timeout=i.settings.timeout),"onuploadprogress"in e||(e.onuploadprogress=function(e){i.emit("uploadprogress",e)}),"onprogress"in e||(e.onprogress=function(e){i.emit("progress",e)});var l=i.getAuthResponse(e.network);l&&l.access_token&&(e.query.access_token=l.access_token);var h,n=e.path;e.options=r.clone(e.query),e.data=r.clone(d);var a=t[{"delete":"del"}[e.method]||e.method]||{};if("get"===e.method){var u=n.split(/[\?#]/)[1];u&&(r.extend(e.query,r.param(u)),n=n.replace(/\?.*?(#|$)/,"$1"))}return(h=n.match(/#(.+)/,""))?(n=n.split("#")[0],e.path=h[1]):n in a?(e.path=n,n=a[n]):"default"in a&&(n=a["default"]),e.redirect_uri=i.settings.redirect_uri,e.oauth=t.oauth,e.xhr=t.xhr,e.jsonp=t.jsonp,e.form=t.form,"function"==typeof n?n(e,c):c(n),i},e.utils.extend(e.utils,{request:function(e,i){function n(e,r){var n;e.oauth&&1===parseInt(e.oauth.version,10)&&(n=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(t.extend(e.query,e.data),e.data=null);var i=t.qs(e.url,e.query);e.proxy&&(i=t.qs(e.oauth_proxy,{path:i,access_token:n||"",then:"get"===e.method.toLowerCase()?"redirect":"proxy",method:e.method.toLowerCase(),suppress_response_codes:!0})),r(i)}var t=this;if(t.isEmpty(e.data)||"FileList"in window||!t.hasBinary(e.data)||(e.xhr=!1,e.jsonp=!1),"withCredentials"in new XMLHttpRequest&&(!("xhr"in e)||e.xhr&&("function"!=typeof e.xhr||e.xhr(e,e.query))))return void n(e,function(r){var n=t.xhr(e.method,r,e.headers,e.data,i);n.onprogress=e.onprogress||null,n.upload&&e.onuploadprogress&&(n.upload.onprogress=e.onuploadprogress)});var a=e.query;if(e.query=t.clone(e.query),e.callbackID=t.globalEvent(),e.jsonp!==!1){if(e.query.callback=e.callbackID,"function"==typeof e.jsonp&&e.jsonp(e,e.query),"get"===e.method)return void n(e,function(n){t.jsonp(n,i,e.callbackID,e.timeout)});e.query=a}if(e.form!==!1){e.query.redirect_uri=e.redirect_uri,e.query.state=JSON.stringify({callback:e.callbackID});var r;if("function"==typeof e.form&&(r=e.form(e,e.query)),"post"===e.method&&r!==!1)return void n(e,function(n){t.post(n,e.data,r,i,e.callbackID,e.timeout)})}i({error:{code:"invalid_request",message:"There was no mechanism for handling this request"}})},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},domInstance:function(t,e){var i="HTML"+(t||"").replace(/^[a-z]/,function(e){return e.toUpperCase()})+"Element";return e?window[i]?e instanceof window[i]:window.Element?e instanceof window.Element&&(!t||e.tagName&&e.tagName.toLowerCase()===t):!(e instanceof Object||e instanceof Array||e instanceof String||e instanceof Number)&&e.tagName&&e.tagName.toLowerCase()===t:!1},clone:function(e){if(null===e||"object"!=typeof e||e instanceof Date||"nodeName"in e||this.isBinary(e))return e;var t;if(this.isArray(e)){t=[];for(var i=0;i<e.length;i++)t.push(this.clone(e[i]));return t}t={};for(var n in e)t[n]=this.clone(e[n]);return t},xhr:function(n,l,a,e,o){function c(i){for(var e,t={},n=/([a-z\-]+):\s?(.*);?/gi;e=n.exec(i);)t[e[1]]=e[2];return t}var t=new XMLHttpRequest,s=!1;"blob"===n&&(s=n,n="GET"),n=n.toUpperCase(),t.onload=function(){var e=t.response;try{e=JSON.parse(t.responseText)}catch(r){401===t.status&&(e={error:{code:"access_denied",message:t.statusText}})}var i=c(t.getAllResponseHeaders());i.statusCode=t.status,o(e||("GET"===n?{error:{code:"empty_response",message:"Could not get resource"}}:{}),i)},t.onerror=function(){var e=t.responseText;try{e=JSON.parse(t.responseText)}catch(i){}o(e||{error:{code:"access_denied",message:"Could not get resource"}})};var i;if("GET"===n||"DELETE"===n)e=null;else if(!(!e||"string"==typeof e||e instanceof FormData||e instanceof File||e instanceof Blob)){var r=new FormData;for(i in e)e.hasOwnProperty(i)&&(e[i]instanceof HTMLInputElement?"files"in e[i]&&e[i].files.length>0&&r.append(i,e[i].files[0]):e[i]instanceof Blob?r.append(i,e[i],e.name):r.append(i,e[i]));e=r}if(t.open(n,l,!0),s&&("responseType"in t?t.responseType=s:t.overrideMimeType("text/plain; charset=x-user-defined")),a)for(i in a)t.setRequestHeader(i,a[i]);return t.send(e),t},jsonp:function(o,c,e,l){var n,t,r=this,h=0,a=document.getElementsByTagName("head")[0],s={error:{message:"server_error",code:"server_error"}},i=function(){h++||window.setTimeout(function(){c(s),a.removeChild(t)},0)};e=r.globalEvent(function(e){return s=e,!0},e),o=o.replace(new RegExp("=\\?(&|$)"),"="+e+"$1"),t=r.append("script",{id:e,name:e,src:o,async:!0,onload:i,onerror:i,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&i()}}),window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(n=r.append("script",{text:"document.getElementById('"+cb_name+"').onerror();"}),t.async=!1),l&&window.setTimeout(function(){s={error:{message:"timeout",code:"timeout"}},i()},l),a.appendChild(t),n&&a.appendChild(n)},post:function(y,t,_,g,l,f){var u,a=this,c=document,e=null,h=[],n=0,i=null,m=0,d=function(e){m++||g(e)};a.globalEvent(d,l);var s;try{s=c.createElement('<iframe name="'+l+'">')}catch(v){s=c.createElement("iframe")}if(s.name=l,s.id=l,s.style.display="none",_&&_.callbackonload&&(s.onload=function(){d({response:"posted",message:"Content was posted"})}),f&&setTimeout(function(){d({error:{code:"timeout",message:"The post operation timed out"}})},f),c.body.appendChild(s),a.domInstance("form",t)){for(e=t.form,n=0;n<e.elements.length;n++)e.elements[n]!==t&&e.elements[n].setAttribute("disabled",!0);t=e}if(a.domInstance("form",t))for(e=t,n=0;n<e.elements.length;n++)e.elements[n].disabled||"file"!==e.elements[n].type||(e.encoding=e.enctype="multipart/form-data",e.elements[n].setAttribute("name","file"));else{for(i in t)t.hasOwnProperty(i)&&a.domInstance("input",t[i])&&"file"===t[i].type&&(e=t[i].form,e.encoding=e.enctype="multipart/form-data");e||(e=c.createElement("form"),c.body.appendChild(e),u=e);var r;for(i in t)if(t.hasOwnProperty(i)){var p=a.domInstance("input",t[i])||a.domInstance("textArea",t[i])||a.domInstance("select",t[i]);if(p&&t[i].form===e)p&&t[i].name!==i&&(t[i].setAttribute("name",i),t[i].name=i);else{var o=e.elements[i];if(r)for(o instanceof NodeList||(o=[o]),n=0;n<o.length;n++)o[n].parentNode.removeChild(o[n]);r=c.createElement("input"),r.setAttribute("type","hidden"),r.setAttribute("name",i),r.value=p?t[i].value:a.domInstance(null,t[i])?t[i].innerHTML||t[i].innerText:t[i],e.appendChild(r)}}for(n=0;n<e.elements.length;n++)r=e.elements[n],r.name in t||r.getAttribute("disabled")===!0||(r.setAttribute("disabled",!0),h.push(r))}e.setAttribute("method","POST"),e.setAttribute("target",l),e.target=l,e.setAttribute("action",y),setTimeout(function(){e.submit(),setTimeout(function(){try{u&&u.parentNode.removeChild(u)}catch(t){try{console.error("HelloJS: could not remove iframe")}catch(i){}}for(var e=0;e<h.length;e++)h[e]&&(h[e].setAttribute("disabled",!1),h[e].disabled=!1)},0)},100)},hasBinary:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var i=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,n=e.match(i);if(!n)return e;for(var r=atob(e.replace(i,"")),a=[],t=0;t<r.length;t++)a.push(r.charCodeAt(t));return new Blob([new Uint8Array(a)],{type:n[1]})}}),function(t){var i=t.api,e=t.utils;e.extend(e,{dataToJSON:function(r){var n=this,i=window,e=r.data;if(n.domInstance("form",e)?e=n.nodeListToJSON(e.elements):"NodeList"in i&&e instanceof NodeList?e=n.nodeListToJSON(e):n.domInstance("input",e)&&(e=n.nodeListToJSON([e])),("File"in i&&e instanceof i.File||"Blob"in i&&e instanceof i.Blob||"FileList"in i&&e instanceof i.FileList)&&(e={file:e}),!("FormData"in i&&e instanceof i.FormData))for(var t in e)if(e.hasOwnProperty(t))if("FileList"in i&&e[t]instanceof i.FileList)1===e[t].length&&(e[t]=e[t][0]);else{if(n.domInstance("input",e[t])&&"file"===e[t].type)continue;n.domInstance("input",e[t])||n.domInstance("select",e[t])||n.domInstance("textArea",e[t])?e[t]=e[t].value:n.domInstance(null,e[t])&&(e[t]=e[t].innerHTML||e[t].innerText)}return r.data=e,e},nodeListToJSON:function(i){for(var n={},t=0;t<i.length;t++){var e=i[t];!e.disabled&&e.name&&(n[e.name]="file"===e.type?e:e.value||e.innerHTML)}return n}}),t.api=function(){var t=e.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return t.data&&e.dataToJSON(t),i.call(this,t)}}(e),function(){function t(t){return function(){var r=t.apply(this,arguments),a=i(function(e,t){r.on("success",e).on("error",t).on("*",function(){var e=Array.prototype.slice.call(arguments);e.unshift(e.pop()),n.emit.apply(n,e)})}),n=e.utils.Event.call(a.proxy);return n}}Function.prototype.bind||(Function.prototype.bind=function(n){function e(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=[].slice,r=t.call(arguments,1),a=this,i=function(){return a.apply(this instanceof e?this:n||window,r.concat(t.call(arguments)))};return e.prototype=this.prototype,i.prototype=new e,i});var i=function(){var t=0,i=1,n=2,e=function(i){return this instanceof e?(this.id="Thenable/1.0.6",this.state=t,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof i&&i.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new e(i)};e.prototype={fulfill:function(e){return r(this,i,"fulfillValue",e)},reject:function(e){return r(this,n,"rejectReason",e)},then:function(n,r){var t=this,i=new e;return t.onFulfilled.push(o(n,i,"fulfill")),t.onRejected.push(o(r,i,"reject")),a(t),i.proxy}};var r=function(e,i,n,r){return e.state===t&&(e.state=i,e[n]=r,a(e)),e},a=function(e){e.state===i?s(e,"onFulfilled",e.fulfillValue):e.state===n&&s(e,"onRejected",e.rejectReason)},s=function(e,t,r){if(0!==e[t].length){var n=e[t];e[t]=[];var i=function(){for(var e=0;e<n.length;e++)n[e](r)};"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick(i):"function"==typeof setImmediate?setImmediate(i):setTimeout(i,0)}},o=function(t,e,i){return function(n){if("function"!=typeof t)e[i].call(e,n);else{var r;try{r=t(n)}catch(a){return void e.reject(a)}l(e,r)}}},l=function(e,t){if(e===t||e.proxy===t)return void e.reject(new TypeError("cannot resolve promise with itself"));var n;if("object"==typeof t&&null!==t||"function"==typeof t)try{n=t.then}catch(r){return void e.reject(r)}if("function"!=typeof n)e.fulfill(t);else{var i=!1;try{n.call(t,function(n){i||(i=!0,n===t?e.reject(new TypeError("circular thenable chain")):l(e,n))},function(t){i||(i=!0,e.reject(t))})}catch(r){i||e.reject(r)}}};return e}();e.login=t(e.login),e.api=t(e.api),e.logout=t(e.logout)}(e),function(e){function i(e){e&&"error"in e&&(e.error={code:"server_error",message:e.error.message||e.error})}function n(t){if(!("object"!=typeof t||"Blob"in window&&t instanceof Blob||"ArrayBuffer"in window&&t instanceof ArrayBuffer||"error"in t)){var i=t.root+t.path.replace(/\&/g,"%26");t.thumb_exists&&(t.thumbnail=e.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/thumbnails/"+i+"?format=jpeg&size=m")+"&access_token="+e.getAuthResponse("dropbox").access_token),t.type=t.is_dir?"folder":t.mime_type,t.name=t.path.replace(/.*\//g,""),t.is_dir?t.files="metadata/"+i:(t.downloadLink=e.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/files/"+i)+"&access_token="+e.getAuthResponse("dropbox").access_token,t.file="https://api-content.dropbox.com/1/files/"+i),t.id||(t.id=t.path.replace(/^\//,""))}}function t(e){return function(t,i){delete t.query.limit,i(e)}}e.init({dropbox:{login:function(e){e.options.window_width=1e3,e.options.window_height=1e3},oauth:{version:"1.0",auth:"https://www.dropbox.com/1/oauth/authorize",request:"https://api.dropbox.com/1/oauth/request_token",token:"https://api.dropbox.com/1/oauth/access_token"},base:"https://api.dropbox.com/1/",root:"sandbox",get:{me:"account/info","me/files":t("metadata/@{root|sandbox}/@{parent}"),"me/folder":t("metadata/@{root|sandbox}/@{id}"),"me/folders":t("metadata/@{root|sandbox}/"),"default":function(e,t){e.path.match("https://api-content.dropbox.com/1/files/")&&(e.method="blob"),t(e.path)}},post:{"me/files":function(t,i){var n=t.data.parent,r=t.data.name;t.data={file:t.data.file},"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),i("https://api-content.dropbox.com/1/files_put/@{root|sandbox}/"+n+"/"+r)},"me/folders":function(t,i){var n=t.data.name;t.data={},i("fileops/create_folder?root=@{root|sandbox}&"+e.utils.param({path:n}))}},del:{"me/files":"fileops/delete?root=@{root|sandbox}&path=@{id}","me/folder":"fileops/delete?root=@{root|sandbox}&path=@{id}"},wrap:{me:function(e){return i(e),e.uid?(e.name=e.display_name,e.first_name=e.name.split(" ")[0],e.last_name=e.name.split(" ")[1],e.id=e.uid,delete e.uid,delete e.display_name,e):e},"default":function(e){if(i(e),e.is_dir&&e.contents){e.data=e.contents,delete e.contents;for(var t=0;t<e.data.length;t++)e.data[t].root=e.root,n(e.data[t])}return n(e),e.is_deleted&&(e.success=!0),e}},xhr:function(e){if(e.data&&e.data.file){var t=e.data.file;t&&(e.data=t.files?t.files[0]:t)}return"delete"===e.method&&(e.method="post"),!0},form:function(t,e){delete e.state,delete e.redirect_uri}}})}(e),function(e){function r(e){return e.id&&(e.thumbnail=e.picture="http://graph.facebook.com/"+e.id+"/picture"),e}function t(e){if("data"in e)for(var t=0;t<e.data.length;t++)r(e.data[t]);return e}function i(i){if("boolean"==typeof i&&(i={success:i}),i&&"data"in i)for(var a=e.getAuthResponse("facebook").access_token,r=0;r<i.data.length;r++){var t=i.data[r];t.picture&&(t.thumbnail=t.picture),t.cover_photo&&(t.thumbnail=n+t.cover_photo+"/picture?access_token="+a),"album"===t.type&&(t.files=t.photos=n+t.id+"/photos"),t.can_upload&&(t.upload_location=n+t.id+"/photos")}return i}var n="https://graph.facebook.com/";e.init({facebook:{name:"Facebook",login:function(e){e.options.window_width=580,e.options.window_height=400},oauth:{version:2,auth:"https://www.facebook.com/dialog/oauth/",grant:"https://graph.facebook.com/oauth/access_token"},refresh:!0,logout:function(i){var n=e.utils.globalEvent(i),r=encodeURIComponent(e.settings.redirect_uri+"?"+e.utils.param({callback:n,result:JSON.stringify({force:!0}),state:"{}"})),t=(e.utils.store("facebook")||{}).access_token;return e.utils.iframe("https://www.facebook.com/logout.php?next="+r+"&access_token="+t),t?void 0:!1},scope:{basic:"public_profile",email:"email",birthday:"user_birthday",events:"user_events",photos:"user_photos,user_videos",videos:"user_photos,user_videos",friends:"user_friends",files:"user_photos,user_videos",publish_files:"user_photos,user_videos,publish_actions",publish:"publish_actions",offline_access:"offline_access"},base:"https://graph.facebook.com/",get:{me:"me","me/friends":"me/friends","me/following":"me/friends","me/followers":"me/friends","me/share":"me/feed","me/like":"me/likes","me/files":"me/albums","me/albums":"me/albums","me/album":"@{id}/photos","me/photos":"me/photos","me/photo":"@{id}"},post:{"me/share":"me/feed","me/albums":"me/albums","me/album":"@{id}/photos"},del:{"me/photo":"@{id}"},wrap:{me:r,"me/friends":t,"me/following":t,"me/followers":t,"me/albums":i,"me/files":i,"default":i},xhr:function(t,i){return("get"===t.method||"post"===t.method)&&(i.suppress_response_codes=!0),"post"===t.method&&t.data&&"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),!0},jsonp:function(t,n){var i=t.method;"get"===i||e.utils.hasBinary(t.data)?"delete"===t.method&&(n.method="delete",t.method="post"):(t.data.method=i,t.method="get")},form:function(){return{callbackonload:!0}}}})}(e),function(n){function a(r,e,a){var i=(a?"":"flickr:")+"?method="+r+"&api_key="+n.init().flickr.id+"&format=json";for(var t in e)e.hasOwnProperty(t)&&(i+="&"+t+"="+e[t]);return i}function h(t){var e=n.getAuthResponse("flickr");e&&e.user_nsid?t(e.user_nsid):n.api(a("flickr.test.login"),function(e){t(i(e,"user").id)})}function e(t,e){return e||(e={}),function(n,i){h(function(n){e.user_id=n,i(a(t,e,!0))})}}function r(e,t){var i="https://www.flickr.com/images/buddyicon.gif";return e.nsid&&e.iconserver&&e.iconfarm&&(i="https://farm"+e.iconfarm+".staticflickr.com/"+e.iconserver+"/buddyicons/"+e.nsid+(t?"_"+t:"")+".jpg"),i}function l(t,i,n,r,e){return e=e?"_"+e:"","https://farm"+i+".staticflickr.com/"+n+"/"+t+"_"+r+e+".jpg"}function t(e){e&&e.stat&&"ok"!=e.stat.toLowerCase()&&(e.error={code:"invalid_request",message:e.message})}function c(t){if(t.photoset||t.photos){var r="photoset"in t?"photoset":"photos";t=i(t,r),o(t),t.data=t.photo,delete t.photo;for(var n=0;n<t.data.length;n++){var e=t.data[n];e.name=e.title,e.picture=l(e.id,e.farm,e.server,e.secret,""),e.source=l(e.id,e.farm,e.server,e.secret,"b"),e.thumbnail=l(e.id,e.farm,e.server,e.secret,"m")}}return t}function i(e,t){return t in e?e=e[t]:"error"in e||(e.error={code:"invalid_request",message:e.message||"Failed to get data from Flickr"}),e}function s(e){if(t(e),e.contacts){e=i(e,"contacts"),o(e),e.data=e.contact,delete e.contact;for(var a=0;a<e.data.length;a++){var n=e.data[a];n.id=n.nsid,n.name=n.realname||n.username,n.thumbnail=r(n,"m")}}return e}function o(e){e.page&&e.pages&&e.page!==e.pages&&(e.paging={next:"?page="+ ++e.page})}n.init({flickr:{name:"Flickr",oauth:{version:"1.0a",auth:"https://www.flickr.com/services/oauth/authorize?perms=read",request:"https://www.flickr.com/services/oauth/request_token",token:"https://www.flickr.com/services/oauth/access_token"},base:"https://api.flickr.com/services/rest",get:{me:e("flickr.people.getInfo"),"me/friends":e("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/following":e("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/followers":e("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/albums":e("flickr.photosets.getList",{per_page:"@{limit|50}"}),"me/photos":e("flickr.people.getPhotos",{per_page:"@{limit|50}"})},wrap:{me:function(e){if(t(e),e=i(e,"person"),e.id){if(e.realname){e.name=e.realname._content;var n=e.name.split(" ");e.first_name=n[0],e.last_name=n[1]}e.thumbnail=r(e,"l"),e.picture=r(e,"l")}return e},"me/friends":s,"me/followers":s,"me/following":s,"me/albums":function(e){if(t(e),e=i(e,"photosets"),o(e),e.photoset){e.data=e.photoset,delete e.photoset;for(var r=0;r<e.data.length;r++){var n=e.data[r];n.name=n.title._content,n.photos="https://api.flickr.com/services/rest"+a("flickr.photosets.getPhotos",{photoset_id:n.id},!0)}}return e},"me/photos":function(e){return t(e),c(e)},"default":function(e){return t(e),c(e)}},xhr:!1,jsonp:function(e,t){"get"==e.method&&(delete t.callback,t.jsoncallback=e.callbackID)}}})}(e),function(n){function e(e){!e.meta||400!==e.meta.code&&401!==e.meta.code||(e.error={code:"access_denied",message:e.meta.errorDetail})}function t(e){e&&e.id&&(e.thumbnail=e.photo.prefix+"100x100"+e.photo.suffix,e.name=e.firstName+" "+e.lastName,e.first_name=e.firstName,e.last_name=e.lastName,e.contact&&e.contact.email&&(e.email=e.contact.email))}function i(i,e){var t=e.access_token;return delete e.access_token,e.oauth_token=t,e.v=20121125,!0}n.init({foursquare:{name:"FourSquare",oauth:{version:2,auth:"https://foursquare.com/oauth2/authenticate",grant:"https://foursquare.com/oauth2/access_token"},refresh:!0,base:"https://api.foursquare.com/v2/",get:{me:"users/self","me/friends":"users/self/friends","me/followers":"users/self/friends","me/following":"users/self/friends"},wrap:{me:function(i){return e(i),i&&i.response&&(i=i.response.user,t(i)),i},"default":function(i){if(e(i),i&&"response"in i&&"friends"in i.response&&"items"in i.response.friends){i.data=i.response.friends.items,delete i.response;for(var n=0;n<i.data.length;n++)t(i.data[n])}return i}},xhr:i,jsonp:i}})}(e),function(i){function e(e,t){var i=t?t.statusCode:e&&"meta"in e&&"status"in e.meta&&e.meta.status;(401===i||403===i)&&(e.error={code:"access_denied",message:e.message||(e.data?e.data.message:"Could not get response")},delete e.message)}function t(e){e.id&&(e.thumbnail=e.picture=e.avatar_url,e.name=e.login)}function n(e,t){if(e.data&&e.data.length&&t&&t.Link){var i=t.Link.match(/<(.*?)>;\s*rel=\"next\"/);i&&(e.paging={next:i[1]})}}i.init({github:{name:"GitHub",oauth:{version:2,auth:"https://github.com/login/oauth/authorize",grant:"https://github.com/login/oauth/access_token",response_type:"code"},scope:{basic:"",email:"user:email"},base:"https://api.github.com/",get:{me:"user","me/friends":"user/following?per_page=@{limit|100}","me/following":"user/following?per_page=@{limit|100}","me/followers":"user/followers?per_page=@{limit|100}","me/like":"user/starred?per_page=@{limit|100}"},wrap:{me:function(i,n){return e(i,n),t(i),i},"default":function(i,a,s){if(e(i,a),"[object Array]"===Object.prototype.toString.call(i)){i={data:i},n(i,a,s);for(var r=0;r<i.data.length;r++)t(i.data[r])}return i}},xhr:function(e){return"get"!==e.method&&e.data&&(e.headers=e.headers||{},e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),!0}}})}(e),function(n,a){"use strict";function i(e){return parseInt(e,10)}function l(e){e.error||(e.name||(e.name=e.title||e.message),e.picture||(e.picture=e.thumbnailLink),e.thumbnail||(e.thumbnail=e.thumbnailLink),"application/vnd.google-apps.folder"===e.mimeType&&(e.type="folder",e.files="https://www.googleapis.com/drive/v2/files?q=%22"+e.id+"%22+in+parents"))}function r(t){e(t);var n=function(e){var i,r=e.media$group.media$content.length?e.media$group.media$content[0]:{},t=0,n={id:e.id.$t,name:e.title.$t,description:e.summary.$t,updated_time:e.updated.$t,created_time:e.published.$t,picture:r?r.url:null,thumbnail:r?r.url:null,width:r.width,height:r.height};if("link"in e)for(t=0;t<e.link.length;t++){var a=e.link[t];if(a.rel.match(/\#feed$/)){n.upload_location=n.files=n.photos=a.href;break}}if("category"in e&&e.category.length)for(i=e.category,t=0;t<i.length;t++)i[t].scheme&&i[t].scheme.match(/\#kind$/)&&(n.type=i[t].term.replace(/^.*?\#/,""));if("media$thumbnail"in e.media$group&&e.media$group.media$thumbnail.length){for(i=e.media$group.media$thumbnail,n.thumbnail=e.media$group.media$thumbnail[0].url,n.images=[],t=0;t<i.length;t++)n.images.push({source:i[t].url,width:i[t].width,height:i[t].height});i=e.media$group.media$content.length?e.media$group.media$content[0]:null,i&&n.images.push({source:i.url,width:i.width,height:i.height})}return n},r=[];if("feed"in t&&"entry"in t.feed){for(i=0;i<t.feed.entry.length;i++)r.push(n(t.feed.entry[i]));t.data=r,delete t.feed}else{if("entry"in t)return n(t.entry);if("items"in t){for(var i=0;i<t.items.length;i++)l(t.items[i]);t.data=t.items,delete t.items}else l(t)}return t}function o(e){e.name=e.displayName||e.name,e.picture=e.picture||(e.image?e.image.url:null),e.thumbnail=e.picture}function t(i){if(e(i),"feed"in i&&"entry"in i.feed){for(var s=n.getAuthResponse("google").access_token,r=0;r<i.feed.entry.length;r++){var t=i.feed.entry[r];if(t.id=t.id.$t,t.name=t.title.$t,delete t.title,t.gd$email&&(t.email=t.gd$email&&t.gd$email.length>0?t.gd$email[0].address:null,t.emails=t.gd$email,delete t.gd$email),t.updated&&(t.updated=t.updated.$t),t.link){var a=t.link.length>0?t.link[0].href+"?access_token="+s:null;a&&(t.picture=a,t.thumbnail=a),delete t.link}t.category&&delete t.category}i.data=i.feed.entry,delete i.feed}return i}function e(e){if("feed"in e&&e.feed.openSearch$itemsPerPage){var t=i(e.feed.openSearch$itemsPerPage.$t),n=i(e.feed.openSearch$startIndex.$t),r=i(e.feed.openSearch$totalResults.$t);r>n+t&&(e.paging={next:"?start="+(n+t)})}else"nextPageToken"in e&&(e.paging={next:"?pageToken="+e.nextPageToken})}function h(){function l(t){var n=new FileReader;n.onload=function(n){i(btoa(n.target.result),t.type+e+"Content-Transfer-Encoding: base64")},n.readAsBinaryString(t)}function i(i,r){t.push(e+"Content-Type: "+r+e+e+i),n--,o()}var t=[],s=(1e10*Math.random()).toString(32),n=0,e="\r\n",c=e+"--"+s,o=function(){},r=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;this.append=function(s,c){"string"!=typeof s&&"length"in Object(s)||(s=[s]);for(var o=0;o<s.length;o++){n++;var t=s[o];if(t instanceof a.File||t instanceof a.Blob)l(t);else if("string"==typeof t&&t.match(r)){var h=t.match(r);i(t.replace(r,""),h[1]+e+"Content-Transfer-Encoding: base64")}else i(t,c)}},this.onready=function(e){(o=function(){0===n&&(t.unshift(""),t.push("--"),e(t.join(c),s),t=[])})()}}function c(e,r){var i={};e.data&&e.data instanceof a.HTMLInputElement&&(e.data={file:e.data}),!e.data.name&&Object(Object(e.data.file).files).length&&"post"===e.method&&(e.data.name=e.data.file.files[0].name),"post"===e.method?e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],file:e.data.file}:(i=e.data,e.data={},i.parent&&(e.data.parents=[{id:e.data.parent||"root"}]),i.file&&(e.data.file=i.file),i.name&&(e.data.title=i.name));var t;if("file"in e.data&&(t=e.data.file,delete e.data.file,"object"==typeof t&&"files"in t&&(t=t.files),!t||!t.length))return void r({error:{code:"request_invalid",message:"There were no files attached with this request to upload"}});var n=new h;n.append(JSON.stringify(e.data),"application/json"),t&&n.append(t),n.onready(function(t,n){e.headers["content-type"]='multipart/related; boundary="'+n+'"',e.data=t,r("upload/drive/v2/files"+(i.id?"/"+i.id:"")+"?uploadType=multipart")})}function u(e){if("object"==typeof e.data)try{e.data=JSON.stringify(e.data),e.headers["content-type"]="application/json"}catch(t){}}var s=(n.utils,"https://www.google.com/m8/feeds/contacts/default/full?alt=json&max-results=@{limit|1000}&start-index=@{start|1}");n.init({google:{name:"Google Plus",login:function(e){"none"===e.qs.display&&(e.qs.display=""),"code"===e.qs.response_type&&(e.qs.access_type="offline")},oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/auth",grant:"https://accounts.google.com/o/oauth2/token"},scope:{basic:"https://www.googleapis.com/auth/plus.me profile",email:"email",birthday:"",events:"",photos:"https://picasaweb.google.com/data/",videos:"http://gdata.youtube.com",friends:"https://www.google.com/m8/feeds, https://www.googleapis.com/auth/plus.login",files:"https://www.googleapis.com/auth/drive.readonly",publish:"",publish_files:"https://www.googleapis.com/auth/drive",create_event:"",offline_access:""},scope_delim:" ",base:"https://www.googleapis.com/",get:{me:"plus/v1/people/me","me/friends":"plus/v1/people/me/people/visible?maxResults=@{limit|100}","me/following":s,"me/followers":s,"me/contacts":s,"me/share":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/feed":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/albums":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}","me/album":function(e,t){var i=e.query.id;delete e.query.id,t(i.replace("/entry/","/feed/"))},"me/photos":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}","me/files":"drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}","me/folders":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}","me/folder":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}"},post:{"me/files":c,"me/folders":function(e,t){e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],mimeType:"application/vnd.google-apps.folder"},t("drive/v2/files")}},put:{"me/files":c},del:{"me/files":"drive/v2/files/@{id}","me/folder":"drive/v2/files/@{id}"},wrap:{me:function(e){return e.id&&(e.last_name=e.family_name||(e.name?e.name.familyName:null),e.first_name=e.given_name||(e.name?e.name.givenName:null),e.emails&&e.emails.length&&(e.email=e.emails[0].value),o(e)),e},"me/friends":function(t){if(t.items){e(t),t.data=t.items,delete t.items;for(var i=0;i<t.data.length;i++)o(t.data[i])}return t},"me/contacts":t,"me/followers":t,"me/following":t,"me/share":function(t){return e(t),t.data=t.items,delete t.items,t},"me/feed":function(t){return e(t),t.data=t.items,delete t.items,t},"me/albums":r,"me/photos":r,"default":r},xhr:function(e){return("post"===e.method||"put"===e.method)&&u(e),!0},form:!1}})}(e,window),function(n){function i(e){e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message})}function e(e){if(t(e),e&&"data"in e)for(var i=0;i<e.data.length;i++)r(e.data[i]);return e}function r(e){e.id&&(e.thumbnail=e.profile_picture,e.name=e.full_name||e.username)}function t(e){"pagination"in e&&(e.paging={next:e.pagination.next_url},delete e.pagination)}n.init({instagram:{name:"Instagram",login:function(e){e.qs.display=""},oauth:{version:2,auth:"https://instagram.com/oauth/authorize/",grant:"https://api.instagram.com/oauth/access_token"},refresh:!0,scope:{basic:"basic",friends:"relationships",publish:"likes comments"},scope_delim:" ",base:"https://api.instagram.com/v1/",get:{me:"users/self","me/feed":"users/self/feed?count=@{limit|100}","me/photos":"users/self/media/recent?min_id=0&count=@{limit|100}","me/friends":"users/self/follows?count=@{limit|100}","me/following":"users/self/follows?count=@{limit|100}","me/followers":"users/self/followed-by?count=@{limit|100}"},post:{"me/like":function(e,t){var i=e.data.id;e.data={},t("media/"+i+"/likes")}},del:{"me/like":"media/@{id}/likes"},wrap:{me:function(e){return i(e),"data"in e&&(e.id=e.data.id,e.thumbnail=e.data.profile_picture,e.name=e.data.full_name||e.data.username),e},"me/friends":e,"me/following":e,"me/followers":e,"me/photos":function(n){if(i(n),t(n),"data"in n)for(var r=0;r<n.data.length;r++){var e=n.data[r];"image"===e.type?(e.thumbnail=e.images.thumbnail.url,e.picture=e.images.standard_resolution.url,e.name=e.caption?e.caption.text:null):(n.data.splice(r,1),r--)}return n},"default":function(e){return t(e),e}},xhr:function(e){var t=e.method,i="get"!==t;return i&&("post"!==t&&"put"!==t||!e.query.access_token||(e.data.access_token=e.query.access_token,delete e.query.access_token),e.proxy=i),i},form:!1}})}(e),function(s){function e(e){e&&"errorCode"in e&&(e.error={code:e.status,message:e.message})}function t(e){e.error||(e.first_name=e.firstName,e.last_name=e.lastName,e.name=e.formattedName||e.first_name+" "+e.last_name,e.thumbnail=e.pictureUrl)}function i(i){if(e(i),n(i),i.values){i.data=i.values;for(var r=0;r<i.data.length;r++)t(i.data[r]);delete i.values}return i}function n(e){"_count"in e&&"_start"in e&&e._count+e._start<e._total&&(e.paging={next:"?start="+(e._start+e._count)+"&count="+e._count})}function o(e,t){"{}"===JSON.stringify(e)&&200===t.statusCode&&(e.success=!0)}function r(e){e.access_token&&(e.oauth2_access_token=e.access_token,delete e.access_token)}function a(e,t){e.headers["x-li-format"]="json";var i=e.data.id;e.data=("delete"!==e.method).toString(),e.method="put",t("people/~/network/updates/key="+i+"/is-liked")}s.init({linkedin:{oauth:{version:2,response_type:"code",auth:"https://www.linkedin.com/uas/oauth2/authorization",grant:"https://www.linkedin.com/uas/oauth2/accessToken"},refresh:!0,scope:{basic:"r_fullprofile",email:"r_emailaddress",friends:"r_network",publish:"rw_nus"},scope_delim:" ",base:"https://api.linkedin.com/v1/",get:{me:"people/~:(picture-url,first-name,last-name,id,formatted-name)","me/friends":"people/~/connections?count=@{limit|500}","me/followers":"people/~/connections?count=@{limit|500}","me/following":"people/~/connections?count=@{limit|500}","me/share":"people/~/network/updates?count=@{limit|250}"},post:{"me/share":function(e,i){var t={visibility:{code:"anyone"}};e.data.id?t.attribution={share:{id:e.data.id}}:(t.comment=e.data.message,t.content={"submitted-url":e.data.link,"submitted-image-url":e.data.picture}),e.data=JSON.stringify(t),i("people/~/shares?format=json")},"me/like":a},del:{"me/like":a},wrap:{me:function(i){return e(i),t(i),i},"me/friends":i,"me/following":i,"me/followers":i,"me/share":function(i){if(e(i),n(i),i.values){i.data=i.values,delete i.values;for(var r=0;r<i.data.length;r++){var a=i.data[r];t(a),a.message=a.headline}}return i},"default":function(t,i){e(t),o(t,i),n(t)}},jsonp:function(t,e){r(e),"get"===t.method&&(e.format="jsonp",e["error-callback"]=t.callbackID)},xhr:function(e,t){return"get"!==e.method?(r(t),e.headers["Content-Type"]="application/json",e.headers["x-li-format"]="json",e.proxy=!0,!0):!1}}})}(e),function(i){function e(e){e.id&&(e.picture=e.avatar_url,e.thumbnail=e.avatar_url,e.name=e.username||e.full_name)}function n(e){"next_href"in e&&(e.paging={next:e.next_href})}function t(i,e){var t=e.access_token;return delete e.access_token,e.oauth_token=t,e["_status_code_map[302]"]=200,!0}i.init({soundcloud:{name:"SoundCloud",oauth:{version:2,auth:"https://soundcloud.com/connect",grant:"https://soundcloud.com/oauth2/token"},base:"https://api.soundcloud.com/",get:{me:"me.json","me/friends":"me/followings.json","me/followers":"me/followers.json","me/following":"me/followings.json","default":function(e,t){t(e.path+".json")}},wrap:{me:function(t){return e(t),t},"default":function(t){if(t instanceof Array){t={data:t};for(var i=0;i<t.data.length;i++)e(t.data[i])}return n(t),t}},xhr:t,jsonp:t}})}(e),function(e){function t(e,t){e.data&&(i(e.query,e.data),e.data=null),t(e.path)}function i(i,e){for(var t in e)e.hasOwnProperty(t)&&(i[t]=e[t])}e.init({tumblr:{login:function(e){e.options.window_width=600,e.options.window_height=510},oauth:{version:"1.0a",auth:"https://www.tumblr.com/oauth/authorize",request:"https://www.tumblr.com/oauth/request_token",token:"https://www.tumblr.com/oauth/access_token"},base:"https://api.tumblr.com/v2/",get:{me:"user/info","me/like":"user/likes","default":function(t,i){t.path.match(/(^|\/)blog\//)&&(delete t.query.access_token,t.query.api_key=e.services.tumblr.id),i(t.path)}},post:{"me/like":function(e,i){e.path="user/like",t(e,i)}},del:{"me/like":function(e,i){e.method="post",e.path="user/unlike",t(e,i)}},wrap:{me:function(e){return e&&e.response&&e.response.user&&(e=e.response.user),e},"me/like":function(e){return e&&e.response&&e.response.liked_posts&&(e.data=e.response.liked_posts,delete e.response),e},"default":function(e){if(e.response){var t=e.response;t.posts&&(e.data=t.posts)}return e}},xhr:function(e){return"get"!==e.method?!0:!1}}})}(e),function(r){function a(e){if(e.id){if(e.name){var t=e.name.split(" ");e.first_name=t[0],e.last_name=t[1]}e.thumbnail=e.profile_image_url}}function t(e){if(i(e),n(e),e.users){e.data=e.users;for(var t=0;t<e.data.length;t++)a(e.data[t]);delete e.users}return e}function i(e){if(e.errors){var t=e.errors[0];e.error={code:"request_failed",message:t.message}}}function n(e){"next_cursor_str"in e&&(e.paging={next:"?cursor="+e.next_cursor_str})}function s(e){return r.utils.isArray(e)?{data:e}:e}var e="https://api.twitter.com/";r.init({twitter:{oauth:{version:"1.0a",auth:e+"oauth/authenticate",request:e+"oauth/request_token",token:e+"oauth/access_token"},base:e+"1.1/",get:{me:"account/verify_credentials.json","me/friends":"friends/list.json?count=@{limit|200}","me/following":"friends/list.json?count=@{limit|200}","me/followers":"followers/list.json?count=@{limit|200}","me/share":"statuses/user_timeline.json?count=@{limit|200}","me/like":"favorites/list.json?count=@{limit|200}"},post:{"me/share":function(t,i){var e=t.data;t.data=null,e.file?(t.data={status:e.message,"media[]":e.file},i("statuses/update_with_media.json")):i(e.id?"statuses/retweet/"+e.id+".json":"statuses/update.json?include_entities=1&status="+e.message)},"me/like":function(e,t){var i=e.data.id;e.data=null,t("favorites/create.json?id="+i)}},del:{"me/like":function(){p.method="post";var e=p.data.id;p.data=null,callback("favorites/destroy.json?id="+e)}},wrap:{me:function(e){return i(e),a(e),e},"me/friends":t,"me/followers":t,"me/following":t,"me/share":function(e){return i(e),n(e),!e.error&&"length"in e?{data:e}:e},"default":function(e){return e=s(e),n(e),e}},xhr:function(e){return"get"!==e.method}}})}(e),function(e){function i(t){if(t.id){var i=e.getAuthResponse("windows").access_token;if(t.emails&&(t.email=t.emails.preferred),t.is_friend!==!1){var n=t.user_id||t.id;t.thumbnail=t.picture="https://apis.live.net/v5.0/"+n+"/picture?access_token="+i}}}function t(e){if("data"in e)for(var t=0;t<e.data.length;t++)i(e.data[t]);return e}e.init({windows:{name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!0,logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:"wl.signin,wl.basic",email:"wl.emails",birthday:"wl.birthday",events:"wl.calendars",photos:"wl.photos",videos:"wl.photos",friends:"wl.contacts_emails",files:"wl.skydrive",publish:"wl.share",publish_files:"wl.skydrive_update",create_event:"wl.calendars_update,wl.events_create",offline_access:"wl.offline_access"},base:"https://apis.live.net/v5.0/",get:{me:"me","me/friends":"me/friends","me/following":"me/contacts","me/followers":"me/friends","me/contacts":"me/contacts","me/albums":"me/albums","me/album":"@{id}/files","me/photo":"@{id}","me/files":"@{parent|me/skydrive}/files","me/folders":"@{id|me/skydrive}/files","me/folder":"@{id|me/skydrive}/files"},post:{"me/albums":"me/albums","me/album":"@{id}/files/","me/folders":"@{id|me/skydrive/}","me/files":"@{parent|me/skydrive/}/files"},del:{"me/album":"@{id}","me/photo":"@{id}","me/folder":"@{id}","me/files":"@{id}"},wrap:{me:function(e){return i(e),e},"me/friends":t,"me/contacts":t,"me/followers":t,"me/following":t,"me/albums":function(e){if("data"in e)for(var t=0;t<e.data.length;t++){var i=e.data[t];i.photos=i.files="https://apis.live.net/v5.0/"+i.id+"/photos"}return e},"default":function(e){if("data"in e)for(var t=0;t<e.data.length;t++){var i=e.data[t];i.picture&&(i.thumbnail=i.picture)}return e}},xhr:function(t){return"get"===t.method||"delete"===t.method||e.utils.hasBinary(t.data)||("string"==typeof t.data.file?t.data.file=e.utils.toBlob(t.data.file):(t.data=JSON.stringify(t.data),t.headers={"Content-Type":"application/json"})),!0},jsonp:function(t){"get"===t.method||e.utils.hasBinary(t.data)||(t.data.method=t.method,t.method="get")}}})}(e),function(r){function t(e){e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message})}function i(e,o,l){t(e),n(e,o,l);var r,i;if(e.query&&e.query.results&&e.query.results.contact){e.data=e.query.results.contact,delete e.query,e.data instanceof Array||(e.data=[e.data]);for(var a=0;a<e.data.length;a++){r=e.data[a],r.id=null;for(var s=0;s<r.fields.length;s++)i=r.fields[s],"email"===i.type&&(r.email=i.value),"name"===i.type&&(r.first_name=i.value.givenName,r.last_name=i.value.familyName,r.name=i.value.givenName+" "+i.value.familyName),"yahooid"===i.type&&(r.id=i.value)}}return e}function n(e,i,t){e.query&&e.query.count&&t.options&&(e.paging={next:"?start="+(e.query.count+(+t.options.start||1))})}var e=function(e){return"https://query.yahooapis.com/v1/yql?q="+(e+" limit @{limit|100} offset @{start|0}").replace(/\s/g,"%20")+"&format=json"};r.init({yahoo:{oauth:{version:"1.0a",auth:"https://api.login.yahoo.com/oauth/v2/request_auth",request:"https://api.login.yahoo.com/oauth/v2/get_request_token",token:"https://api.login.yahoo.com/oauth/v2/get_token"},login:function(e){e.options.window_width=560},base:"https://social.yahooapis.com/v1/",get:{me:e("select * from social.profile(0) where guid=me"),"me/friends":e("select * from social.contacts(0) where guid=me"),"me/following":e("select * from social.contacts(0) where guid=me")},wrap:{me:function(e){if(t(e),e.query&&e.query.results&&e.query.results.profile){e=e.query.results.profile,e.id=e.guid,e.last_name=e.familyName,e.first_name=e.givenName||e.nickname;var i=[];e.first_name&&i.push(e.first_name),e.last_name&&i.push(e.last_name),e.name=i.join(" "),e.email=e.emails?e.emails.handle:null,e.thumbnail=e.image?e.image.imageUrl:null}return e},"me/friends":i,"me/following":i,"default":function(e){return n(e),e}}}})}(e),"function"==typeof define&&define.amd&&define(function(){return e}),"object"==typeof module&&module.exports&&(module.exports=e)}();