void function(){function At(t){function n(s,n,u,d){if("undefined"!=typeof e.app_url_vars){for(var p in e.app_url_vars)delete e.app_url_vars[p];c(e.app_url_vars,s)}var t=o(s,{record_undefined_values:!1});"undefined"!=typeof n&&("undefined"!=typeof n.title&&(e.title=n.title),"undefined"!=typeof n.url&&(e.url=n.url),"undefined"!=typeof n.callback&&(e.callback=n.callback),"undefined"==typeof e.url&&(e.url=location.protocol+"//"+location.host+location.pathname+e.base_filename,e.url+=t)),1==u?(r[t]={},r[t].title=e.title,r[t].url=e.url,r[t].callback=e.callback):e[i]=s[i];var h=r[t].title,f=r[t].url,l=r[t].callback;delete e.url,delete e.callback,document.title="undefined"!=typeof h?h:"",(1==u||d)&&history[(a?"replace":"push")+"State"](s,h,f),e.current_state=s,1==a&&(a=!1),d||("undefined"!=typeof e.onstatechange?e.onstatechange(s,function(){"undefined"!=typeof l&&l()}):"undefined"!=typeof l&&l())}function o(i,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.record_undefined_values&&(t.record_undefined_values=!0);var e="";for(var r in i)("undefined"!=typeof i[r]||1==t.record_undefined_values)&&(e+="&"+r+"="+i[r]);return""!=e&&(e="?"+e.slice(1,e.length)),e}function l(e){if("object"!=typeof e||null==e)var e={};for(var r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=r.length,t=0;n>t;t++){var i=r[t].split("=");"undefined"!=typeof i[1]&&(e[i[0]]=decodeURIComponent(i[1]))}return e}function c(e,t){if("undefined"==typeof t)return e;for(var i in t)e[i]=t[i];return e}function s(e){if("object"!=typeof e||null==e)return e;var i=e instanceof Array?[]:{};for(var r in e){var t=e[r];i[r]="object"==typeof t&&t instanceof Array?t.slice():t}return i}var e=this;"undefined"==typeof t&&(t={}),e.overwrite_first_state="undefined"!=typeof t.overwrite_first_state&&0==t.overwrite_first_state?!1:!0;var i="undefined"!=typeof t.var_name?t.var_name:"page";e.base_filename="undefined"!=typeof t.base_filename?t.base_filename:"",e.onbeforestatechange=t.onbeforestatechange,e.onstatechange=t.onstatechange,e.initial_page=t.initial_page,e.app_url_vars=t.app_url_vars,e.can_do_popstate=t.can_do_popstate,e.current_state={};var r={},a=!0;window.addEventListener("popstate",function(t){return"undefined"==typeof e.can_do_popstate||e.can_do_popstate(t.state)?void(null!=t.state&&n(t.state,void 0,!1)):void n(e.current_state,void 0,!1,!0)}),e.load_page=function(t,r){"undefined"==typeof t&&(t={}),"undefined"==typeof r&&(r={}),t=s(t),r=s(r),1==a&&1==e.overwrite_first_state&&(l(t),"undefined"==typeof e[i]&&(e[i]=e.initial_page)),"undefined"==typeof t[i]&&(t[i]=e[i]),"undefined"!=typeof e.onbeforestatechange?e.onbeforestatechange(t,r,function(){n(t,r,!0)}):n(t,r,!0)}}function W(e){return e.which?3==e.which:e.button?2==e.button:!1}function Et(e){return e.detail?-1*e.detail:e.wheelDelta/40}function P(e){function r(t){0!=i&&"undefined"!=typeof e.end_effect&&e.end_effect(t)}function n(r){if(r.touches.length<2)return void(i=!1);if("touchmove"==r.type){if(0==i)return;var p=i}else if("undefined"!=typeof e.start_condition&&e.start_condition(r)===!1)return;var u=l(r.touches[0],t),n=u[0],o=u[1],d=l(r.touches[1],t),c=d[0],h=d[1];return(e.always_recalculate_zoom_target===!0||0==i)&&(a=(n+c)/2,s=(o+h)/2),i=Math.sqrt(Math.pow(Math.abs(n-c),2)+Math.pow(Math.abs(o-h),2)),"touchstart"==r.type?void("undefined"!=typeof e.start_effect&&e.start_effect(r,n,o,c,h)):(e.result_function(i/p,a,s),void("undefined"!=typeof e.move_effect&&e.move_effect(r)))}if("undefined"==typeof this||this===window)return new P(e);var t=e.target,i=!1,a=void 0,s=void 0;t.addEventListener("touchend",r),t.addEventListener("touchcancel",r),t.addEventListener("touchleave",r),t.addEventListener("touchstart",n),t.addEventListener("touchmove",n)}function a(e){if("object"!=typeof e||null==e)return e;var t=e instanceof Array?[]:{};for(var i in e)t[i]=e[i];return t}function T(t){if("object"!=typeof t||null==t)return t;var i=t instanceof Array?[]:{};for(var r in t){var e=t[r];if("object"==typeof e)if(e instanceof Array){i[r]=[];for(var n=0,a=e.length;a>n;n++)i[r].push("object"==typeof e[n]?T(e[n]):e[n])}else i[r]=T(e);else i[r]=e}return i}function l(e,t){"undefined"==typeof t&&(t=e.target);var i=t.getBoundingClientRect();return[e.clientX-i.left,e.clientY-i.top]}function t(e){function r(){var r=i.responseText;if(200!=i.status&&0==o)r={error:!0,errormessage:r};else if(1!=n&&""!=r)try{r=JSON.parse(r)}catch(a){return r={error:!0,errormessage:r},0==t?r:void(e.error&&e.error(r))}{if(""==r||1!=r.error)return 0==t?r:void("undefined"!=typeof e.success&&e.success(r));if("undefined"!=typeof e.error)return 0==t?r:e.error(r)}}var n=e.send_data_as_plaintext||e.plaintext||!1,t=!0;"undefined"!=typeof e.is_asynchronous&&(t=e.is_asynchronous),"undefined"!=typeof e.async&&(t=e.async);var a="undefined"!=typeof e.charset?e.charset:"",s="undefined"!=typeof e.data?e.data:"",o="undefined"!=typeof e.ignore_request_status?e.ignore_request_status:!1,l=Tt(e.file,s,n,a,t,void 0,void 0,e.request_method),i=l.http_request;return 0==t?r():void(i.onreadystatechange=function(){4==i.readyState&&r()})}function Tt(a,t,r,i,n,o,c,s){("undefined"==typeof r||r!==!0)&&(r=!1),("undefined"==typeof n||0!=n)&&(n=!0),i="undefined"==typeof i?"":"; charset="+i;var e=new XMLHttpRequest;if(e||alert("Cannot create an XMLHTTP instance for some reason. Please try reloading the page."),"undefined"==typeof s)var s=null===t?"GET":"POST";if("GET"==s){if("string"==typeof t){var l="&"!=t[0]?"&":"";a+=(-1==a.indexOf("?")?"?":l)+t}t=null}return e.open(s,a,n),"undefined"!=typeof o&&(e.responseType=o),r===!0?(e.setRequestHeader("Content-type","application/x-www-form-urlencoded"+i),"undefined"!=typeof e.overrideMimeType&&e.overrideMimeType("text/plain; charset=x-user-defined")):e.setRequestHeader("Content-type","application/x-www-form-urlencoded"+i),e.send(t),{http_request:e}}function wt(){var e=document.createElement("input");document.body.appendChild(e),e.focus(),document.body.removeChild(e),e=null}function B(i,t){var e=window.getComputedStyle(i),n=""!=e.boxSizing?e.boxSizing:e.mozBoxSizing;if("border-box"!=n)var r=0;else var r=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);return"undefined"!=typeof t&&"undefined"!=typeof t.margin&&1==t.margin&&(r+=parseFloat(e.marginLeft)+parseFloat(e.marginRight)),i.clientWidth+r+parseFloat(e.borderLeftWidth)+parseFloat(e.borderRightWidth)}function o(i,t){var e=window.getComputedStyle(i),n=""!=e.boxSizing?e.boxSizing:e.mozBoxSizing;if("border-box"!=n)var r=0;else var r=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom);return"undefined"!=typeof t&&"undefined"!=typeof t.margin&&1==t.margin&&(r+=parseFloat(e.marginTop)+parseFloat(e.marginBottom)),i.clientHeight+r+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)}function M(i,e){if("undefined"==typeof i)var e=e.primary,i=e.secondary;var r={};for(var t in i)r[t]=i[t];for(var t in e)r[t]=e[t];return r}function n(e){e.setAttribute("unselectable","on"),e.style.WebkitTapHighlightColor="rgba(255, 255, 255, 0)",e.style.WebkitHighlightColor="transparent",e.style.MozUserSelect="none",e.style.OUserSelect="none",e.style.KhtmlUserSelect="none",e.style.WebkitUserSelect="none",e.style.MsUserSelect="none",e.style.userSelect="none"}function c(e){e.setAttribute("unselectable","off"),e.style.WebkitTapHighlightColor="",e.style.WebkitHighlightColor="",e.style.MozUserSelect="text",e.style.OUserSelect="text",e.style.KhtmlUserSelect="text",e.style.WebkitUserSelect="text",e.style.MsUserSelect="text",e.style.userSelect="text"}function u(e){("object"!=typeof e||null==e)&&(e={});for(var r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=r.length,t=0;n>t;t++){var i=r[t].split("=");"undefined"!=typeof i[1]&&(e[i[0]]=decodeURIComponent(i[1]))}return e}function bt(i,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.record_undefined_values&&(t.record_undefined_values=!0);var e="";for(var r in i)("undefined"!=typeof i[r]||1==t.record_undefined_values)&&(e+="&"+r+"="+i[r]);return""!=e&&(e="?"+e.slice(1,e.length)),e}function xt(e){var t=e.indexOf("://");if(-1==t)return e;t=-1==t?0:t+3;var i=e.indexOf("/",t)+1;return 0==i?e:e.substring(i)}function vt(e){var s=/^https?:\/\/[a-z\:0-9.]+/,n="",a=s.exec(e);null!=a&&(n=a[0]),n.length>0&&(e=e.replace(n,"").substr(1));var i=document.getElementsByTagName("head");if(i=i[i.length-1],null!=i){var t=document.getElementsByTagName("base");if(t=t[t.length-1],null!=t){var r=t.getAttribute("href");r=r.substr(r.indexOf("/")+1)+"/",e=e.replace(r,"")}}return e}function w(i,t){if("undefined"==typeof t&&(t={}),t.play_howl)return new D(i,t);if("undefined"!=typeof t.container&&"undefined"!=typeof t.container[i]&&!t.force_refresh){var e=t.container[i];return e.loop=t.loop||!1,e.volume=t.volume||1,e.start="undefined"!=typeof t.start?t.start:!0,e.stopped=!1,1==e.start?(e.audio.play(),1==e.loop&&e.addEventListener("ended",e.play)):1==e.loop&&(e.audio.loop=!0),e}if("undefined"==typeof this||this==window)return new w(i,t);var e=this;if("undefined"!=typeof t.container&&(t.container[i]=e),Object.defineProperty(e,"duration",{get:function(){return e.audio.duration}}),Object.defineProperty(e,"currentTime",{get:function(){return e.audio.currentTime},set:function(t){function i(){e.audio.removeEventListener("loadedmetadata",i),e.audio.currentTime=t}return 0!=e.audio.readyState?void(e.audio.currentTime=t):void e.audio.addEventListener("loadedmetadata",i)}}),Object.defineProperty(e,"volume",{get:function(){return e.audio.volume},set:function(t){e.audio.volume=t}}),Object.defineProperty(e,"paused",{get:function(){return e.audio.paused}}),e.addEventListener=function(){return e.audio.addEventListener(arguments[0],arguments[1],!1||arguments[2])},e.removeEventListener=function(){return e.audio.removeEventListener(arguments[0],arguments[1],!1||arguments[2])},e.play=e.play_track=function(){e.audio.play()},e.stop=function(){e.stopped=!0,e.audio.pause(),0!=e.audio.readyState&&(e.audio.currentTime=0),e.removeEventListener("ended",e.play_track)},e.pause=function(){e.stopped=!0,e.audio.pause(),e.removeEventListener("ended",e.play)},e.play=function(){e.resume()},e.resume=function(){1==e.stopped?(e.stopped=!1,e.play()):e.audio.play(),1==e.loop&&(e.audio.loop=!0,e.audio.addEventListener("ended",e.play))},e.set_loop=function(t){1==t?(e.loop=!0,e.audio.loop=!0,e.addEventListener("ended",e.play)):(e.loop=!1,e.audio.loop=!1,e.removeEventListener("ended",e.play))},e.restart=function(){e.play()},e.set_volume=function(t){e.volume=t},e.loop=t.loop,"undefined"==typeof e.loop&&(e.loop=!1),e.start=t.start,"undefined"==typeof e.start&&(e.start=!0),e.loaded=!0,e.filename=i,e.stopped=!1,e.audio=new Audio,"undefined"!=typeof t.no_source_tags&&1==t.no_source_tags||".ogg"!=n&&".mp3"!=n&&".wav"!=n)e.audio.src=e.filename;else{var n=e.filename.slice(-4),r=document.createElement("source");switch(n){case".ogg":r.type="audio/ogg";break;case".mp3":r.type="audio/mpeg";break;case".wav":r.type="audio/wav"}r.src=e.filename,e.audio.appendChild(r)}return e.volume=t.volume||1,1==e.start?(e.audio.play(),1==e.loop&&e.addEventListener("ended",e.play)):1==e.loop&&(e.audio.loop=!0),e}function D(r,t){if("undefined"==typeof t&&(t={}),"undefined"!=typeof t.container&&"undefined"!=typeof t.container[r]&&!t.force_refresh){var e=t.container[r];return e.volume=t.volume||1,("undefined"==typeof t.start||1==t.start)&&e.play(),e}if("undefined"==typeof this||this==window)return new D(r,t);var e=this;"undefined"!=typeof t.container&&(t.container[r]=e),Object.defineProperty(e,"duration",{get:function(){return e.audio.duration}}),Object.defineProperty(e,"currentTime",{get:function(){return e.audio.position},set:function(t){function i(){e.audio.position=t,e.removeEventListener("load",i)}return e.loaded?void(e.audio.position=t):void e.addEventListener("load",i)}}),Object.defineProperty(e,"volume",{get:function(){return e.audio.volume},set:function(t){e.audio.volume=t}}),e.pause=function(){e.audio.pause(),e.paused=!0},e.play=function(){e.audio.play(),e.paused=!1},e.stop=function(){e.audio.pause(),e.paused=!0,e.currentTime=0},e.loaded=!1,e.src=r,e.paused=!0;var i=[];return e.addEventListener=function(){i.push([arguments[0],arguments[1],arguments[2]||!1])},e.removeEventListener=function(){var e=arguments,t=i.findIndex(function(t){return t[0]!==e[0]?!1:t[1]!==e[1]?!1:t[2]!==(e[2]||!1)?!1:!0});-1!=t&&i.splice(t,1)},e.audio=new Howl({src:e.src,buffersize:t.preload_buffer_size,bufferfile:t.preload_buffer_file,autoplay:"undefined"==typeof t.start||1==t.start,onend:function(){e.paused=!0,i.forEach(function(e){"ended"==e[0]&&e[1]()})},onload:function(){e.loaded=!0,i.forEach(function(e){"load"==e[0]&&e[1]()})},onloaderror:function(){e.paused=!0,i.forEach(function(e){"loaderror"==e[0]&&e[1]()})},onpause:function(){e.paused=!0,i.forEach(function(e){"pause"==e[0]&&e[1]()})},onplay:function(){e.paused=!1,i.forEach(function(e){"play"==e[0]&&e[1]()})}}),e.volume=t.volume||1,e}function j(t,i){var r=window.getComputedStyle(t).textShadow,e=r.split("rgb");e.shift(),e.forEach(function(e,t,r){var n=e.slice(0,e.length-2).split(") ")[1];r[t]=i+" "+n}),t.style.textShadow=e}function v(l){var e=l.element,s=e.innerHTML,i=l.size,r=l.color;"string"==typeof i&&(i=[i]),"string"==typeof r&&(r=[r]);var c=window.getComputedStyle(e).lineHeight;if("normal"==c)var d=0;else{var o=parseInt(c);Number.isNaN(o)&&(o=0);var t=document.createElement("div");t.style.whiteSpace="nowrap",t.style.fontSize="100px",t.innerHTML=e.innerHTML,document.body.appendChild(t),t.style.fontFamily=window.getComputedStyle(e).fontFamily;var h=e.style.lineHeight;e.style.lineHeight=t.getBoundingClientRect().height/100,document.body.removeChild(t);var d=(parseFloat(window.getComputedStyle(e).lineHeight)-o)/2;e.style.lineHeight=h}e.innerHTML="";for(var a=0,u=s.length;u>a;a++){var n=document.createElement("span");n.style.position="relative",e.appendChild(n),n.innerHTML='<span style="position:relative; z-index:'+i.length+'"/>'+s[a]+"</span>",i.forEach(function(t,o){var l=t.substr(t.match(/([A-Z])/i).index,t.length),e=document.createElement("div");e.style.position="absolute",e.style.left=0,e.style.top=d+"px",e.style.zIndex=i.length-o-1,e.style.color=r[o],e.style.WebkitTextStrokeColor=r[o],e.style.WebkitTextStrokeWidth=2*parseFloat(t)+l,e.innerHTML=s[a],n.appendChild(e)})}}function C(e){function n(e,i){function t(){if("undefined"!=typeof e.naturalWidth&&0!=e.complete&&0!=e.naturalWidth)e.width=e.naturalWidth,e.height=e.naturalHeight,i();else{setTimeout(t,20)}}t()}function i(){var i=document.createElement("canvas"),s=i.getContext("2d");if(e.image instanceof HTMLImageElement&&e.fix_ie_bug?(i.width=t.naturalWidth,i.height=t.naturalHeight):(i.width=t.width,i.height=t.height),s.fillStyle=e.color,s.fillRect(0,0,i.width,i.height),"undefined"==typeof e.image||e.image instanceof HTMLImageElement||"undefined"!=typeof e.create_new&&1==e.create_new){var n=document.createElement("canvas"),a=n.getContext("2d");e.image instanceof HTMLImageElement&&e.fix_ie_bug?(n.width=t.naturalWidth,n.height=t.naturalHeight):(n.width=t.width,n.height=t.height),a.globalCompositeOperation="source-over",a.drawImage(t,0,0)}if(e.image instanceof HTMLCanvasElement&&("undefined"==typeof e.create_new||1!=e.create_new))var n=e.image,a=n.getContext("2d");return a.globalCompositeOperation="source-in",a.drawImage(i,0,0),"undefined"!=typeof e.callback&&e.callback(n),1==r?n:void 0}var r="undefined"!=typeof e.return_result&&1==e.return_result?!0:!1;if("undefined"==typeof e.image){var t=new Image;if(t.src=e.image_src,1==r)return i();e.fix_ie_bug?n(t,i):t.addEventListener("load",i)}else{var t=e.image;if(e.image instanceof HTMLImageElement){if("undefined"!=typeof e.image_src&&(t.src=e.image_src),1==r)return i();e.fix_ie_bug?n(t,i):t.addEventListener("load",i)}if(e.image instanceof HTMLCanvasElement){if(1==r)return i();i()}}}function m(e){function i(a,s){var i=s.getContext("2d");"undefined"!=typeof e.lineWidth&&(i.lineWidth=e.lineWidth),"undefined"!=typeof e.strokeStyle&&(i.strokeStyle=e.strokeStyle),"undefined"!=typeof e.lineJoin&&(i.lineJoin=e.lineJoin),"undefined"!=typeof e.lineCap&&(i.lineCap=e.lineCap),i.beginPath(),i.translate(e.x*t,e.y*t);for(var n=0;n<a.length;n++){var o=a[n].command,r=a[n].points;switch(o){case"L":i.lineTo(r[0],r[1]);break;case"M":i.moveTo(r[0],r[1]);break;case"C":i.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"z":i.closePath()}}if(("undefined"==typeof e.lineWidth||0!=e.lineWidth)&&i.stroke(),"undefined"!=typeof e.fillPatternImage||"undefined"!=typeof e.fillStyle){if("undefined"!=typeof e.fillPatternImage){var l=i.createPattern(e.fillPatternImage,"no-repeat");"undefined"!=typeof e.fillPatternOffset&&(i.save(),i.translate(-e.fillPatternOffset[0]*t,0),i.translate(0,-e.fillPatternOffset[1]*t)),i.fillStyle=l}else i.fillStyle=e.fillStyle;i.fill()}"undefined"!=typeof e.fillPatternOffset&&i.restore()}function r(f){var s=f,u=["M","L","C"];s=s.replace(new RegExp(" ","g"),",");for(var r=0;r<u.length;r++)s=s.replace(new RegExp(u[r],"g"),"|"+u[r]);var d=s.split("|"),h=[],a=0,n=0;for(r=1;r<d.length;r++){var i=d[r],o=i.charAt(0);i=i.slice(1),i=i.replace(new RegExp(",-","g"),"-"),i=i.replace(new RegExp("-","g"),",-"),i=i.replace(new RegExp("e,-","g"),"e-");var e=i.split(",");e.length>0&&""===e[0]&&e.shift();for(var c=0;c<e.length;c++)e[c]=parseFloat(e[c])*t;for(;e.length>0&&!isNaN(e[0]);){var p=null,l=[],_=a,m=n;switch(o){case"L":a=e.shift(),n=e.shift(),l.push(a,n);break;case"M":a=e.shift(),n=e.shift(),p="M",l.push(a,n),o="L";break;case"C":l.push(e.shift(),e.shift(),e.shift(),e.shift()),a=e.shift(),n=e.shift(),l.push(a,n)}h.push({command:p||o,points:l,start:{x:_,y:m}})}("z"===o||"Z"===o)&&h.push({command:"z",points:[],start:void 0})}return h}var t=(e.x||0,e.y||0,e.scale||1),n=e.data,a=e.canvas,s=r(n);i(s,a)}function yt(t){function i(o,n,i){function a(){s.forEach(function(e){e.classList[i](r)})}for(var t=o.target,l="*"+("add"==i?":hover":"."+r),c=Array.prototype.slice.call(document.body.querySelectorAll(l)),s=[];;){if(null==t||t==document.documentElement)break;-1!=c.indexOf(t)&&s.push(t),t=t.parentNode}e[n]&&e[n][i]?setTimeout(a,e[n][i]):a()}var t=t||{},n=t.handle_touch_events||!0,a=t.handle_mouse_events||!0,r=t.hover_class||"hover",e=t.delay_preferences||{};a&&(document.body.addEventListener("mouseover",function(e){i(e,"mouse","add")}),document.body.addEventListener("mouseout",function(e){i(e,"mouse","remove")})),n&&(document.body.addEventListener("touchstart",function(e){i(e,"touch","add")}),document.body.addEventListener("touchend",function(e){i(e,"touch","remove")}),document.body.addEventListener("touchmove",function(i){function a(r,n){for(var t=[],i=[];;){var e=document.elementFromPoint(r,n);if(null==e||e==document.documentElement)break;t.push(e),i.push(e.style.pointerEvents),e.style.pointerEvents="none"}return t.forEach(function(e,t){e.style.pointerEvents=i[t]}),t}var t=i.target,s=Array.prototype.slice.call(document.body.querySelectorAll("*.hover")),n=null;i=i.changedTouches[0];for(var o=a(i.pageX,i.pageY);;){if(null==t||t==document.documentElement)break;-1!=s.indexOf(t)&&-1==o.indexOf(t)&&(n=t),t=t.parentNode}null!=n&&(e.touch&&e.touch.remove?setTimeout(function(){n.classList.remove(r)},e.touch.remove):n.classList.remove(r))}))}function gt(e){var t=navigator.userAgent.toLowerCase();e.is_iphone=null!=t.match(/iphone/i),e.is_ipad=null!=t.match(/ipad/i),e.is_idevice=e.is_iphone||e.is_ipad,e.is_android=null!=t.match(/android/i),e.is_chromium=null!=t.match(/chrome/i),e.is_windows_phone=null!=t.match(/Windows Phone/i),e.is_phone_or_tablet="ontouchstart"in window||e.is_idevice||e.is_android||e.is_windows_phone}function ft(t,r){function n(){return s<t.length?void(o=setTimeout(n,30)):void r()}function a(e){if(e.offsetWidth!=e.original_width)s+=1,e.parentNode.removeChild(e),e=null;else{setTimeout(function(){a(e)},30)}}for(var s=0,i=0;i<t.length;i++){var e=document.createElement("span");e.innerHTML="giItT1WQy@!-/#",e.style.fontFamily="sans-serif",e.style.position="absolute",e.style.left="-10000px",e.style.top="-10000px",e.style.fontSize="300px",e.style.fontVariant="normal",e.style.fontWeight="normal",e.style.letterSpacing="0",document.body.appendChild(e),e.original_width=e.getBoundingClientRect().width,e.style.fontFamily=t[i],a(e)}if("undefined"!=typeof r){var o=null;n()}}function R(t,e,i){function r(s,u,d){var e=+((u+s)/2).toFixed(2);t.style.fontSize=e+c;var a=t.getBoundingClientRect(),p=t.scrollHeight+(parseInt(a.height/i)-a.height/i),f=t.scrollWidth+(parseInt(a.width/i)-a.width/i);if(s===e||u===e)return d;if(h>n){if(p>o||f>l)return n+=1,r(s,e,d);if(o>=p&&l>=f)return n+=1,r(e,u,e)}return d}"undefined"==typeof e&&(e={});var c="undefined"!=typeof e.unit_type?e.unit_type:"px",i="undefined"!=typeof e.transform_scale?e.transform_scale:1,h="undefined"!=typeof e.iteration_max?e.iteration_max:200,s=t.parentNode.getBoundingClientRect(),o=s.height/i,l=s.width/i,n=0,a=r("undefined"!=typeof e.min_size?e.min_size:0,"undefined"!=typeof e.max_size?e.max_size:120,"undefined"!=typeof e.best_size?e.best_size:0);"undefined"!=typeof e.min_size&&a<e.min_size&&(a=e.min_size),t.style.fontSize=a+c}function x(){function l(){var e=this;e.mr_jigtato=i,this.DEBUG=!1,"undefined"!=typeof IS_DEBUG_MODE&&(this.DEBUG=IS_DEBUG_MODE),this.errormessage=function(e,i,t){"undefined"==typeof t&&(t={}),i=i||t.callback||function(){},"string"!=typeof e&&(e=e.errormessage),smoke.alert(e,i,t)},this.log_user_action=function(r){var i="undefined"!=typeof window.device?window.device:i;if("undefined"==typeof i.model&&(i.model=""),"undefined"==typeof i.uuid&&(i.uuid=""),"undefined"!=typeof e.account.user_id)var n="&user_id="+e.account.user_id+"&internal_access_token="+e.account.internal_access_token;else var n="";t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=log_user_action"+n+"&message="+encodeURIComponent(r)+"&device_model="+i.model+"&device_uuid="+i.uuid,success:function(){},error:function(){},request_method:"GET"})},gt(this),this.contact_info="info@flyingsoftgames.com",this.is_kiosk="true"==u().is_kiosk?!0:!1,this.use_mini_images="false"==u().use_mini_images?!0:!0,this.events={},this.IS_COCOONJS=!!window.CocoonJS,this.IS_CORDOVA=!!s,this.IS_WEBVIEW=!!window.CocoonJS||!!s,this["/"]=e.IS_WEBVIEW?"":"/",this.events.POINT=this.is_phone_or_tablet?"touchstart":"click",this.events.POINT_START=this.is_phone_or_tablet?"touchstart":"mousedown",this.events.POINT_MOVE=this.is_phone_or_tablet?"touchmove":"mousemove",this.events.POINT_END=this.is_phone_or_tablet?"touchend":"mouseup",this.collision_scale=.5,this.audio_dir=e["/"]+"audio",this.ad_removal_price=27,this.service_name="google_play",this.google_play_store_package_name="com.flyingsoft.safari.jigsaw.free",this.google_play_store_url="details?id="+e.play_store_package_name,this.google_play_store_url=e.IS_CORDOVA?"market://"+this.play_store_url:"http://play.google.com/store/apps/"+this.play_store_url,this.get_gem_amount_from_server=function(i){var i=i||{},n=i.success||function(){},r=i.error||e.errormessage;return"undefined"==typeof e.account.internal_access_token?void r():void t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=get_gem_amount&internal_access_token="+e.account.internal_access_token+"&user_id="+e.account.user_id,error:r,request_method:"POST",async:!0,success:function(e){n(+e)}})},this.get_gem_purchased_amount_from_server=function(i){var i=i||{},n=i.success||function(){},r=i.error||e.errormessage;return"undefined"==typeof e.account.internal_access_token?void r():void t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=get_gem_purchased_amount&internal_access_token="+e.account.internal_access_token+"&user_id="+e.account.user_id,error:r,request_method:"POST",async:!0,success:function(e){n(+e)}})},e.IS_CORDOVA&&"undefined"!=typeof window.plugins.AppVersion&&window.plugins.AppVersion.getVersionCode({success:function(t){e.version_code=t}}),this.android={},this.account={},this.open_url=function(t){return e.IS_COCOONJS?void CocoonJS.App.openURL(t):e.IS_CORDOVA?void window.open(t,"_system"):void(window.location.href=t)},e.jigsaw_get_scaled_piece_margin=function(){return e.jigsaw_piece_margin};var r={};r.jigsaw_colored_borders=function(t,i){switch(e.jigsaw_piece_margin=8,e.jigsaw_piece_margin_style=t?"rgba(0,0,127,1)":void 0,i){case"margin":return e.jigsaw_piece_margin;case"margin_style":return e.jigsaw_piece_margin_style}},r.music_on=function(){e.ambient_music&&e.ambient_music[e.music_on&&e.ambient_music_on?"play":"pause"]()},r.ambient_music_on=function(){e.ambient_music&&e.ambient_music[e.music_on&&e.ambient_music_on?"play":"pause"]()},void function(){function t(e,i,r){for(var n in e){var t=e[n];t[i]&&(t.volume=r/10)}}r.sound_effects_volume=function(i){t(e.audio_container,"is_sound_effect",i)},r.music_volume=function(i){t(e.audio_container,"is_music",i)},r.ambient_music_volume=function(i){t(e.audio_container,"is_ambient_music",i)}}();var o=[{name:"account.purchased_ad_removal","default":!1,resettable:!1},{name:"challenge_code_processed","default":!1,resettable:!1},{name:"game_type","default":""},{name:"gem_amount","default":0},{name:"run_audio_in_background","default":!1},{name:"sound_effects_on","default":!0},{name:"music_on","default":!0},{name:"ambient_music_on","default":!0},{name:"ambient_music_playlist_name","default":void 0},{name:"sound_effects_volume","default":10},{name:"music_volume","default":10},{name:"ambient_music_volume","default":10},{name:"ambient_music_on_question_asked","default":!1,resettable:!1},{name:"jigsaw_colored_borders_question_asked","default":!1,resettable:!1},{name:"jigsaw_use_3d_effect_question_asked","default":!1,resettable:!1},{name:"challenge_code_request_asked","default":!1,resettable:!1},{name:"thank_you_screen_mentioned","default":!1,resettable:!1},{name:"jigsaw_pinch_controls_not_run","default":!0,resettable:!1},{name:"gem_screen_not_opened","default":!0,resettable:!1},{name:"use_categories","default":!1},{name:"freestyle_mode","default":!0},{name:"show_timer","default":!0},{name:"show_ad_counter","default":-1,resettable:!1},{name:"own_ad_shown","default":!1,resettable:!1},{name:"account.game_was_rated","default":!1,resettable:!1},{name:"select_menu_sort_index","default":{}},{name:"select_menu_sort_direction","default":{}},{name:"select_menu_current_page","default":{}},{name:"select_menu_current_category","default":{}},{name:"select_packs_menu_current_page","default":{}},{name:"gray-filter_incomplete_images","default":!0},{name:"gray-filter_unacquired_packs","default":!0},{name:"jigsaw_center_piece_on_move","default":!1},{name:"jigsaw_arrange_pieces_on_entire_area","default":2},{name:"jigsaw_use_large_square_images","default":!0},{name:"jigsaw_show_hint_image","default":!0},{name:"jigsaw_show_hint_rect","default":!0},{name:"jigsaw_minimal_ui","default":!0},{name:"jigsaw_image_size_type","default":1},{name:"jigsaw_piece_scale_to_actual_index","default":0},{name:"jigsaw_piece_scale_to_actual","default":.75},{name:"jigsaw_required_precision","default":5},{name:"jigsaw_use_3d_effect","default":!0},{name:"jigsaw_combine_pieces","default":!0},{name:"jigsaw_colored_borders","default":!0},{name:"jigsaw_piece_margin","default":function(){return r.jigsaw_colored_borders(e.jigsaw_colored_borders,"margin")}},{name:"jigsaw_piece_margin_style","default":function(){return r.jigsaw_colored_borders(e.jigsaw_colored_borders,"margin_style")}},{name:"jigsaw_animate_piece_placement","default":!0},{name:"jigsaw_heat_seeking_color_index","default":1},{name:"jigsaw_reduce_texture_size","default":0},{name:"show_trophy_ribbon","default":!0}];if(e.jigsaw_piece_scale_to_actual_options=[.5,.6,.75,1],e.jigsaw_heat_seeking_color_options=[void 0,"cyan","red"],o.forEach(function(n){var t=n.name,i=t.indexOf(".");if(-1!=i)var s=t.substr(0,i),o=t.substr(i+1);if("undefined"!=typeof localStorage["settings."+t]&&"undefined"!=localStorage["settings."+t])var a=e[t]=JSON.parse(localStorage["settings."+t]);else if(e[t]in e||(e[t]="function"==typeof n.default?n.default():n.default),-1!=i)var a=e[s][o];else var a=e[t];Object.defineProperty(e,t,{get:function(){return a},set:function(e){a=e,r[t]&&r[t](e),localStorage["settings."+t]=JSON.stringify(e)}}),-1!=i?e[s][o]=a:e[t]=a}),e.reset_default_settings=function(){o.forEach(function(t){if(!t.resettable||0!=t.resettable){var i=t.name,r=i.indexOf(".");if(-1!=r){var n=i.substr(0,r),a=i.substr(r+1);e[n][a]="function"==typeof t.default?t.default():t.default}else e[i]="function"==typeof t.default?t.default():t.default}})},this.try_requesting_fullscreen=!1,this.use_jpeg_if_available=!0,this.image_ext=this.use_jpeg_if_available?"jpg":"png","undefined"!=typeof smoke&&(smoke.point_event=this.events.POINT,smoke.autofocus=e.IS_CORDOVA?!1:!0),this.use_social_media_buttons=!1,this.skip_set_selection_screen=!0,this.get_root_directory=function(){return s?"/android_asset/www":""},this.get_set_directory=function(t,i){return i?"cdvfile://localhost/persistent/sets/"+t:(d?"content://"+k+".free.expansion/":e["/"])+"sets/"+t},this.get_image_url_from_server=function(a,r,t){if("trophy"==t)return"http://www.flyingsoftgames.com/mr_jigtato/sets/"+a+"/trophies/"+r+".png";var n=i.game_data.entry_list[r].category;return"undefined"!=typeof e.account.user_id&&(e.account.user_id>606||1==e.account.user_id)&&"mini-grey"==t&&(t="mini"),"http://www.flyingsoftgames.com/mr_jigtato/resources/puzzle/"+n+"/"+r+("mini"==t?"-mini.jpg":"mini-grey"==t?"-mini-grey.png":".jpg")+"?"+("undefined"!=typeof e.account.user_id?"&user_id="+e.account.user_id:"")+("undefined"!=typeof e.account.internal_access_token?"&internal_access_token="+e.account.internal_access_token:"")+"&category_name="+n},this.get_image_url_from_local=function(s,t,r){if("trophy"!=r)var a=i.game_data.entry_list[t].category;var n=(d?"content://"+k+".free.expansion/":e["/"])+"sets/"+s;switch("undefined"!=typeof e.account.user_id&&(e.account.user_id>606||1==e.account.user_id)&&"mini-grey"==r&&(r="mini"),r){case"trophy":return n+"/puzzle/trophies/"+t+".png";case"mini":return n+"/puzzle/categories/"+a+"/mini/"+t+"-mini.jpg";case"mini-grey":return n+"/puzzle/categories/"+a+"/mini-grey/"+t+"-mini.png";case"default":default:return n+"/puzzle/categories/"+a+"/"+t+".jpg"}},this.get_image=function(i,n,r,t){function a(){i.removeEventListener("error",a);var s=JSON.parse(localStorage["image_is_not_local_cache."+t]);s[r]=!0,localStorage["image_is_not_local_cache."+t]=JSON.stringify(s),i.src=e.get_image_url_from_server(n,r,t)}"undefined"==typeof t&&(t="default"),"undefined"==typeof localStorage["image_is_not_local_cache."+t]&&(localStorage["image_is_not_local_cache."+t]=JSON.stringify({}));var s=JSON.parse(localStorage["image_is_not_local_cache."+t]);return s[r]?void(i.src=e.get_image_url_from_server(n,r,t)):(i.src=e.get_image_url_from_local(n,r,t),void i.addEventListener("error",a))},e.jigsaw_piece_margin=8,this.audio_container={},this.select_mode_visited_count=0,e.ambient_music=function(){var t={};return t.load_ambient_music=function(r,l){var n=l.split(","),a=n[0].trim().toLowerCase(),s=n[1].trim().toLowerCase();if(!t.loaded){if(t.loaded=!0,t.playlist_list=r,"undefined"!=typeof e.ambient_music_playlist_name)var o=r.find(function(t){return t.name.toLowerCase()==e.ambient_music_playlist_name.toLowerCase()});else{if("{random}"==a)var o=r[Math.floor(Math.random()*i.length)];else var o=r[r.findIndex(function(e){return e.name.trim().toLowerCase()==a})||0];e.ambient_music_playlist_name=o.name}var i=o.list;t.playlist=i,t.current_track_index="{random}"==s?Math.floor(Math.random()*i.length):i.findIndex(function(e){return e.title.trim().toLowerCase()==s})||0,t.current_track_index=(t.current_track_index+i.length-1)%i.length,t.play_next_track()}},t.play_next_track=function(){t.pause(),t.current_track=null,t.current_track&&t.playlist.length>1&&t.release&&t.release();var r=t.playlist;t.current_track_index=(t.current_track_index+1)%r.length,t.current_track=e.playAudio(e.get_set_directory(i.set_name)+"/audio/"+r[t.current_track_index].file,{audio_type:"ambient_music",restart:!0,blocking:!1}),t.current_track&&(t.current_track.addEventListener("ended",t.play_next_track),e.music_on&&e.ambient_music_on||t.pause(),"undefined"!=typeof e.set_audio_menu_title&&e.set_audio_menu_title())},t.play_next_playlist=function(){t.pause(),t.current_track&&t.release&&t.release();var i=t.playlist_list,a=i.findIndex(function(t){return t.name.toLowerCase()==e.ambient_music_playlist_name.toLowerCase()}),n=i[(a+1)%i.length];e.ambient_music_playlist_name=n.name;var r=t.playlist=n.list;t.current_track_index=Math.floor(Math.random()*r.length),t.current_track_index=(t.current_track_index+r.length-1)%r.length,t.play_next_track()},t.play=function(){return t.current_track?void t.current_track.play():(t.current_track_index=(t.current_track_index+t.playlist.length-1)%t.playlist.length,void t.play_next_track())},t.pause=function(){t.current_track&&t.current_track.pause()},t}(),e.playAudio=function(r,t){function s(){i.paused||i.pause(),c&&clearInterval(c),i.removeEventListener("ended",s),e.music_on&&e.ambient_music_on&&e.ambient_music&&e.ambient_music.current_track&&e.ambient_music.current_track.play()}var t=a(t||{});t.container=e.audio_container;var n=t.audio_type||"sound_effect",o=e[n+("sound_effect"==n?"s":"")+"_on"];if(t.play_howl=!1,t.play_howl&&"ambient_music"==n&&(t.preload_buffer_file=r.substr(0,r.length-4)+"-preview"+r.substr(-4)),o||"undefined"!=typeof t.start&&0==t.start)if(t.element)var l=t.element,i=l.playAudio(r,t);else var i=w(r,t);if(!o)return i;switch(t.restart&&(i.currentTime=0),n){case"sound_effect":i.volume=e.sound_effects_volume/10;break;case"music":i.volume=e.music_volume/10;break;case"ambient_music":i.volume=e.ambient_music_volume/10}if(i["is_"+n]=!0,"undefined"==typeof t.blocking||1==t.blocking){var c=void 0;if(e.music_on&&e.ambient_music_on&&e.ambient_music&&e.ambient_music.current_track&&e.ambient_music.current_track.pause(),i.addEventListener("ended",s),t.element)var l=t.element,c=setInterval(function(){l.isAttached()||s()},200)}return i},void function(r,n){function t(i){if(!n()){var a=e;if(e=!("blur"==i.type)&&"visible"==document.visibilityState,a!=e)for(var s in r){var t=r[s];0==e?(t.stored_paused_state=t.paused,t.stored_paused_state||t.pause()):t.stored_paused_state||t.play()}}}var i;["","moz","ms","webkit"].some(function(e){return"undefined"!=typeof document[""==e?"hidden":e+"Hidden"]?(i=e+"visibilitychange",!0):void 0}),"undefined"!=typeof i&&document.addEventListener(i,t),window.addEventListener("blur",t),window.addEventListener("focus",t);var e=!0}(e.audio_container,function(){return e.run_audio_in_background}),e.is_phone_or_tablet||yt({handle_mouse_events:!0,handle_touch_events:!1}),!e.IS_WEBVIEW){var n=document.getElementsByTagName("head")[0].querySelector("base");if(null==n){var n=document.createElement("base");n.href="/",document.getElementsByTagName("head")[0].appendChild(n)}}if(e.is_phone_or_tablet&&(document.body.addEventListener("touchstart",function(e){e.target.classList.contains("hoverable")&&e.target.classList.add("hover")}),document.body.addEventListener("touchend",function(e){e.target.classList.contains("hoverable")&&e.target.classList.remove("hover")}),document.body.addEventListener("touchleave",function(e){e.target.classList.contains("hoverable")&&e.target.classList.remove("hover")}),document.body.addEventListener("touchcancel",function(e){e.target.classList.contains("hoverable")&&e.target.classList.remove("hover")})),void function(){function e(){i.save_player_data_to_server(),setTimeout(e,t)}var t=72e5;setTimeout(e,t)}(),(e.IS_COCOONJS||e.IS_CORDOVA)&&document.addEventListener(e.events.POINT,function(i){var t=i.target;if("a"==t.tagName.toLowerCase()||null!=t.parentNode&&"undefined"!=typeof t.parentNode.tagName&&"a"==t.parentNode.tagName.toLowerCase()){i.preventDefault();var r=t.href||t.parentNode.href;return r&&e.open_url(r),!1}}),window.gs=e,e.IS_CORDOVA){!e.account.purchased_ad_removal&&e.IS_WEBVIEW&&"undefined"!=typeof f&&(e.ad_control_list=[],e.ad_control_list.destroy=function(){e.ad_control_list.forEach(function(e){e.destroy()}),e.ad_control_list=[],delete e.ad_control,delete e.ad_control_list},e.ad_control_list_weights={admob:50,adbuddiz:50},Object.keys(e.ad_control_list_weights).forEach(function(r){var t=f({gs:e,ad_network:r});t.init(),e.ad_control_list.push(t),void function(){t.disabled_ad_timeout={},t.onrun=function(){t.disabled_ad_timeout.ad_wait&&(clearTimeout(t.disabled_ad_timeout.ad_wait),delete t.disabled_ad_timeout.ad_wait),t.disabled_ad_timeout.ad_wait=setTimeout(function(){st({gs:e,mr_jigtato:i})},8e3)},t.ondisplay=function(){clearTimeout(t.disabled_ad_timeout.ad_wait),delete t.disabled_ad_timeout.ad_wait}}()}));var l=window.plugins.GooglePlayQuery;l.getURI({success:function(t){e.android.INSTALL_REFERRER=t}})}return e.IS_CORDOVA&&(e.smoke_window_list=[],smoke.window_opened=function(t){e.smoke_window_list.push(t)},smoke.window_closed=function(t){e.smoke_window_list.splice(e.smoke_window_list.indexOf(t),1)}),e.IS_CORDOVA||(e.gps={},e.gps.initialize=function(e){var e=e||function(){};hello.init({google:"694160809438-53in4hb7cbnp732jei4g4lm5omgl2jgm.apps.googleusercontent.com"}),hello("google").login({display:"popup",scope:"basic"}).then(e.success,e.error)},e.gps.getPlayerId=function(e){hello("google").api("userinfo/v2/me").then(function(t){e.success(t.id)},e.error)},e.gps.getAccessToken=function(e){var t=hello("google").getAuthResponse();e.success(t.access_token)}),e.IS_CORDOVA||window.addEventListener("beforeunload",i.save_player_data_to_server),e.get_google_play_access_token=function(t){function r(){i(e.google_play_access_token)}var t=t||function(){},i="undefined"!=typeof t.callback?t.callback:function(){};if("undefined"!=typeof e.google_play_access_token)return void i(e.google_play_access_token);if(e.IS_CORDOVA)var n=window.plugins.GooglePlayToken||window.plugins.GooglePlayServices;else var n=e.gps;n.getAccessToken({error:r,success:function(t){e.google_play_access_token=t,i(e.google_play_access_token)}})},this}function c(i,e){function t(e){return e.charAt(0).toUpperCase()+e.slice(1)}return document.original_title+("undefined"==typeof e.title?"":": "+t(e.title))}window.onerror=function(i,n,a,s){var e="undefined"!=typeof window.device?window.device:e;"undefined"==typeof e.model&&(e.model=""),"undefined"==typeof e.uuid&&(e.uuid=""),t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=send_javascript_error&errormessage="+encodeURIComponent(i)+"&url="+encodeURIComponent(n)+"&line_number="+a+"&column_number="+s+"&device_model="+encodeURIComponent(e.model)+"&device_uuid="+e.uuid,success:function(){},error:function(){},request_method:"GET"})},"undefined"==typeof s&&(s=!1),"undefined"==typeof d&&(d=!1);var p=1420276045;"undefined"==typeof localStorage.app_version_date&&(localStorage.app_version_date=JSON.stringify(+p)),s&&window.plugins&&window.plugins.AppVersion&&window.plugins.AppVersion.getVersionCode&&window.plugins.AppVersion.getVersionCode({error:function(){},success:function(e){function t(){"undefined"!=typeof r&&(r.version_code=e,clearInterval(i))}var e=+e;156>e&&alert("Please update Safari Jigsaw to the latest version!");var i=setInterval(t,50)}}),"undefined"==typeof window.device&&(window.device={version:"",uuid:"",model:""}),s&&at();var i={};i.load_game_data=function(c){function a(e){"undefined"==typeof e&&(e=1),s-=1,0==s&&h()}function h(){if(i.game_data=t,i.game_data.trophy_list=n,void function(){var i=t.entry_list,a=0;for(var r in i){var e=i[r];if("undefined"==typeof e.puzzle_position&&(e.puzzle_position=a),a+=1,"undefined"!=typeof e.template){var s=i[e.template];for(var n in s)"undefined"==typeof e[n]&&(e[n]=T(s[n]));delete e.is_only_template}}for(var r in i)i[r].is_only_template&&delete i[r]}(),"undefined"!=typeof t.web_font_list){var a=[];t.web_font_list.forEach(function(t){a.push(r.get_set_directory(e)+"/"+t)}),ft(a)}i.update_game_data_from_server(c)}var e="undefined"!=typeof L?L:"default";localStorage.set_name=i.set_name=e;var s=2,o=!1,l=!1,n=void 0;I({gs:r,IS_DEBUG_MODE:o,DO_NOT_USE_REMOTE_FILE:l,remote_dir:"http://safarijigsaw.com/sets/"+e,initial_local_dir:r.get_set_directory(e),persistent_local_dir:r.get_set_directory(e,!0),target_filename:e+"-trophies.json",error:r.errormessage,success:function(t){n=t.trophy_list;for(var e in n)n[e].filename=e;a()}});var t=void 0;I({gs:r,IS_DEBUG_MODE:o,DO_NOT_USE_REMOTE_FILE:l,remote_dir:"http://safarijigsaw.com/sets/"+e,initial_local_dir:r.get_set_directory(e),persistent_local_dir:r.get_set_directory(e,!0),target_filename:e+".json",error:r.errormessage,success:function(e){t=e,a()}})},i.update_game_data_from_server=function(n){function e(e){"undefined"==typeof e&&(e=1),a-=1,0==a&&s()}function s(){var t=i.game_data.entry_list,e=[];"undefined"!=typeof r.free_puzzles&&e.push(r.free_puzzles),"undefined"!=typeof r.paid_puzzles&&e.push(r.paid_puzzles),e.forEach(function(e){"undefined"!=typeof e&&e.forEach(function(e){"undefined"!=typeof t[e]&&(t[e].enabled=!0)})}),l()}var n=n||{},o=n.new_state_page||"",l=n.callback||function(){},a=3;t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=get_global_data",error:e,request_method:"POST",async:!0,success:function(t){return null==t?void e():("undefined"!=typeof t.ad_removal_price&&(r.ad_removal_price=t.ad_removal_price),"undefined"!=typeof t.puzzle_pack_list&&(r.puzzle_pack_list=t.puzzle_pack_list),r.free_puzzles=t.free_puzzles,void e())}}),"jigsaw"==o?e():h({gs:r,success:e,error:e});i.load_set_css(e)},i.reset_player_data=function(){if("undefined"!=typeof i.player_data)var e=i.player_data;else var e={};for(var r in e)delete e[r];e.selected_difficulty=0,e.jigsaw={},e.jigsaw.trophies=[],e.jigsaw.ranks={},e.jigsaw.best_times=[{},{}],i.player_data=e,localStorage.player_data=localStorage.initial_player_data_string=JSON.stringify(i.player_data);var t=localStorage["puzzle_states.$keys"];if("undefined"!=typeof t){t=JSON.parse(t);for(var r in t)localStorage.removeItem("puzzle_states."+r)}localStorage["puzzle_states.$keys"]=JSON.stringify({})},i.save_player_data_to_server=function(n){{var n=n||{};n.error||function(){},n.success||function(){}}if("undefined"!=typeof r.account.internal_access_token){var a={};a.player_data=i.player_data;var o=localStorage["puzzle_states.$keys"],l=a.puzzle_states={};if("undefined"!=typeof o){var c=a.puzzle_states_keys=JSON.parse(o);for(var s in c)"undefined"!=typeof localStorage["puzzle_states."+s]&&(l[s]=JSON.parse(localStorage["puzzle_states."+s]))}t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=save_player_data&user_id="+r.account.user_id+"&internal_access_token="+r.account.internal_access_token,data:"&player_data="+e.compressToBase64(JSON.stringify(a)),error:r.errormessage,request_method:"POST",async:!0,success:n.success})}},i.load_player_data_from_server=function(n){function s(o){i.reset_player_data();var t=JSON.parse(e.decompressFromBase64(o.replace(/ /g,"+")));if(null==t)return void a();i.player_data=t.player_data,localStorage.player_data=JSON.stringify(i.player_data);var r=t.puzzle_states_keys,l=t.puzzle_states;if("undefined"!=typeof r&&(localStorage["puzzle_states.$keys"]=JSON.stringify(r)),"undefined"!=typeof r)for(var n in r){var s=JSON.stringify(l[n]);"undefined"!=typeof s&&(localStorage["puzzle_states."+n]=s)}a()}var n=n||{},a=("function"==typeof n.error?n.error:function(){},"function"==typeof n.success?n.success:function(){});"undefined"!=typeof r.account.internal_access_token&&t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=load_player_data&user_id="+r.account.user_id+"&internal_access_token="+r.account.internal_access_token,error:r.errormessage,request_method:"POST",async:!0,success:s})};{var o=90;+localStorage.game_version}+localStorage.game_version!=o&&(localStorage.game_version=o),"undefined"!=typeof localStorage.player_data&&"true"!=u().force_reset&&"true"!=u().hard_reset?i.player_data=JSON.parse(localStorage.player_data):("undefined"==typeof localStorage.player_data&&(i.first_run_when_logged_in=!0),i.reset_player_data()),i.set_name=localStorage.set_name;var r=i.gs=new l;i.parent=document.body,document.original_title=document.title,document.original_title=document.original_title.substring(0,document.original_title.indexOf(":")),r.url_vars={};var _=i.history_control=new At({onbeforestatechange:function(e,t,n){r.try_requesting_fullscreen&&!r.IS_WEBVIEW&&r.is_phone_or_tablet&&F(document.documentElement),"jigsaw"==e.page&&"undefined"==typeof e.level&&(e.page="select_jigsaw"),"undefined"==typeof localStorage.set_name&&(e.page="select_mode"),(""==e.page||"index.php"==e.page||"index.html"==e.page.substr(e.page.lastIndexOf("/")+1))&&(e.page="select_mode"),"jigsaw"!=e.page&&"undefined"!=typeof e.level&&delete e.level,"undefined"==typeof t.url&&(t.url=e.page);var a=1==r.is_kiosk?!0:void 0;switch(t.url=e.page+bt({testmode:e.testmode,is_kiosk:a,level:e.level,use_mini_images:e.use_mini_images},{record_undefined_values:!1}),r.kiip_loaded||(r.kiip_loaded=!0,void function(){"undefined"!=typeof window.Kiip&&(window.kiipInstance=new Kiip("600a5666aef46ed6adfcd04c39888721"),"true"==e.testmode&&(console.log("window.kiipInstance.setTestMode ()"),window.kiipInstance.setTestMode()),window.kiipInstance&&window.kiipInstance.setContainer("content_div"))}()),e.page){case"select_mode":t.title="Select Mode";break;case"select_jigsaw":t.title="Select Jigsaw";break;case"jigsaw":t.title="Jigsaw";break;case"mixnmatch":t.title="Mix N' Match"}t.title=c(e,t),"undefined"!=typeof i.game_data?n():i.load_game_data({new_state_page:e.page,callback:n})},can_do_popstate:function(){if("undefined"==typeof r||!r.IS_CORDOVA)return!0;if(0==r.smoke_window_list.length)return!0;var e=r.smoke_window_list[r.smoke_window_list.length-1];return e.close?e.close():e.cancel?e.cancel():e.ok&&e.ok(),!1},onstatechange:function(e,t){if(n.cleanup){n.cleanup()}switch(e.page){case"select_mode":if(r.IS_CORDOVA&&(r.select_mode_visited_count+=1,r.select_mode_visited_count>1&&r.is_android))return r.ad_control_list&&r.ad_control_list.destroy(),void i.save_player_data_to_server({success:navigator.app.exitApp,error:navigator.app.exitApp});ht({content_div:n,mr_jigtato:i,global_settings:r});break;case"select_jigsaw":ut({content_div:n,mr_jigtato:i,global_settings:r,callback:function(){}});break;case"jigsaw":pt({content_div:n,mr_jigtato:i,global_settings:r,level_id:e.level}),!r.account.purchased_ad_removal&&r.IS_WEBVIEW&&"undefined"!=typeof f&&ct({gs:r,mr_jigtato:i});break;case"mixnmatch":play_mixnmatch_screen({content_div:n,mr_jigtato:i,global_settings:r,level_id:e.level})}t()},initial_page:function(){var e=vt(window.location.href);return"/"==e[e.length-1]&&(e=e.substr(1,e.length-1)),-1!=e.indexOf("?")&&(e=e.substr(0,e.indexOf("?"))),e}(),var_name:"page",app_url_vars:r.url_vars}),n=document.createElement("div");if(n.className="jt-content_div",n.id="content_div",i.parent=document.body,i.parent.appendChild(n),smoke.parent=n,r.is_phone_or_tablet){smoke.custom_css={"buttons.ok":"hoverable"};var m=smoke.prompt;smoke.prompt=function(t,i,r){var e=m(t,i,r);return e.dialog.classList.add("smoke-dialog-at_the_top"),setTimeout(function(){e.prompt.input.focus()},500),e}}return nt({content_div:n,is_mobile:r.is_phone_or_tablet}),wt(),i.play_intro_audio=function(a){var h=a.level_id,s=a.count,t=i.game_data,o=t.entry_list[h],e="undefined"!=typeof o.audio_template?t.audio_template_list[o.audio_template]:o.audio;if("undefined"!=typeof e){if("object"!=typeof e)var n=e;else if("undefined"==typeof s)var n=Math.weightedSample(e);else{var l=0;for(var u in e)l+=1;s%=l;var c=0;for(var u in e){if(c==s)break;c+=1}var n=u}if("undefined"==typeof t.entry_audio_directory)var n=r.get_set_directory(i.set_name)+"/audio/"+n+".ogg";else var n=r.get_set_directory(i.set_name)+"/"+t.entry_audio_directory+"/"+n+".ogg";r.sound_effects_on&&(i.last_intro_audio=n,r.playAudio(n,{element:a.parent,restart:!0}))}},i.load_set_css=function(n){function s(t){var s=r.get_set_directory(a)+"/";t=t.replace(/url\('/g,"url('"+s),t=t.replace(/url\(\"/g,'url("'+s),e.innerHTML=t,e.charset="utf-8",e.media="screen",e.type="text/css",e.rel="stylesheet",o.insertBefore(e,o.lastChild),i.unload_set_css(),i.custom_css_div=e,n&&n(e)}var a=localStorage.set_name;if(i.custom_css_div)return n&&n(i.custom_css_div),i.custom_css_div;var o=document.getElementsByTagName("head")[0],l=t({success:s,error:function(e){r.errormessage(e,init.callback)},file:r.get_set_directory(a)+"/"+a+".css",charset:"utf-8",plaintext:!0,request_method:"GET",async:"undefined"!=typeof n}),e=document.createElement("style");return"undefined"==typeof n&&s(l),e},i.unload_set_css=function(){if("undefined"!=typeof i.custom_css_div){var e=i.custom_css_div;e.disabled="disabled",e.parentNode.removeChild(e),delete i.custom_css_div}},Object.defineProperty(i,"background_image_url",{get:function(){for(var e in i.game_data.background_list){var t=i.game_data.background_list[e];break}return r.get_set_directory(i.set_name)+"/"+t}}),i.get_trophy_item=function(e){var t=e.game_type,r=e.level_id,n=e.difficulty_level;switch(t){case"jigsaw":default:var a=i.game_data.entry_list[r].trophies[n]}return i.game_data.trophy_list[a]},i.menu={},i.menu.generic={},i.menu.generic.about={text:"About & Credit List",action:function(r,e,t){X({mr_jigtato:i,gs:i.gs,callback:e,menu:t})}},i.menu.generic.ogle_trophies={text:"Ogle Trophies",action:function(r,e,t){U({mr_jigtato:i,gs:i.gs,callback:e,menu:t})}},i.menu.generic.share={text:"Share",action:function(r,e,t){q({mr_jigtato:i,gs:i.gs,callback:e,menu:t})}},i.menu.generic.open_audio_settings_menu={text:"Audio Settings",action:$},i.menu.jigsaw={},i.menu.jigsaw.open_visual_settings_menu={text:"Visual Settings",action:et},i.menu.jigsaw.toggle_freestyle_mode={text:function(){return"Freestyle Mode "+(i.gs.freestyle_mode?"On":"Off")},action:function(t,r){var e=t.currentTarget;i.gs.freestyle_mode=!i.gs.freestyle_mode,e.innerHTML=e.text(),r()}},i.menu.jigsaw.toggle_categories={text:function(){return"Categories "+(i.gs.use_categories?"Enabled":"Disabled")},action:function(r,n,a){var e=r.currentTarget;i.gs.use_categories=!i.gs.use_categories,e.innerHTML=e.text();var t=a.init.current_game;t&&t.game_title.autoshow_title({duration:500}),n()}},i.menu.jigsaw.open_misc_config_menu={text:"Misc. Config",action:tt},i.menu.jigsaw.show_mini_hint_image={text:"Show Hint Image",action:it},_.load_page(),i}function ct(r){function a(){e.own_ad_shown=!0,e.ad_control&&(e.ad_control.running=!0);var a="<p> Like this game?</p>";a+='<p>This game is an independent developer production -- made by 1 developer. If you like this game, please rate it. The more good ratings this game has, the easier it will be for others to find! You can also email me with questions or comments at: <a href="mailto:'+e.contact_info+'">'+e.contact_info+"</a>.</p>";var i=smoke.confirm(a,function(i){e.ad_control&&(e.ad_control.running=!1),0!=i&&("undefined"!=typeof e.google_play_access_token&&t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new.php?action=set_game_was_rated&internal_access_token="+e.account.internal_access_token+"&user_id="+e.account.user_id+"service_name="+e.service_name}),e.account.game_was_rated=!1,e.open_url(e.google_play_store_url))}),r=i.dialog.text.childNodes[1];i.dialog.text.childNodes[0].classList.add("jt-common-instruction_text-title"),r.classList.add("jt-common-instruction_text"),r.style.fontSize="55px",r.style.lineHeight="150%",r.style.height="auto",i.dialog.text.style.height=window.getComputedStyle(i.dialog.text).maxHeight,i.buttons.ok.innerHTML="Rate it.",i.buttons.cancel.innerHTML="Don't rate it.",n(i.buttons),i.buttons.ok.classList.add("hoverable"),i.buttons.cancel.classList.add("hoverable")}var e=r.gs,s=r.mr_jigtato,o=s.game_data.jigsaw.difficulty_levels[s.player_data.selected_difficulty],l=o.tile_x,c=o.tile_y,i=(e.show_ad_counter,Math.sqrt(l*c)/12);i>1&&(i=1),e.show_ad_counter+=i,e.ad_control=e.ad_control_list[Object.keys(e.ad_control_list_weights).indexOf(Math.weightedSample(e.ad_control_list_weights))],e.ad_control_list.forEach(function(t){t.is_active=t==e.ad_control}),e.show_ad_counter>=1?(e.show_ad_counter=e.show_ad_counter-parseInt(e.show_ad_counter),Math.random()>.1?e.ad_control&&e.ad_control.run():0==e.account.game_was_rated?a():e.ad_control.run()):Math.random()<=.1&&0==e.account.game_was_rated&&a()}function st(r){{var t=r.gs;r.mr_jigtato}t.own_ad_shown=!0,t.ad_control&&(t.ad_control.running=!0);var n="<p> Like this game?</p>";n+="<p>This game is an independent developer production -- made by 1 developer. It is supported by ads, puzzle pack purchases, and an ad removal purchase. Please consider purchasing some gems or upgrades to feed Tiny Tim. This window will self-destruct in 12 seconds.";var e=smoke.alert(n,function(){});e.buttons.ok.parentNode.removeChild(e.buttons.ok);var i=e.dialog.text.childNodes[1];e.dialog.text.childNodes[0].classList.add("jt-common-instruction_text-title"),i.classList.add("jt-common-instruction_text"),i.style.fontSize="55px",i.style.lineHeight="150%",i.style.height=i.style.maxHeight="862px",e.dialog.text.style.height=window.getComputedStyle(e.dialog.text).maxHeight,setTimeout(function(){t.ad_control&&(t.ad_control.running=!1),null!=e.parentNode&&e.parentNode.removeChild(e)},12e3)}function nt(r){var e=r.content_div,t=r.is_mobile;if(e.original_width=e.clientWidth,e.original_height=e.clientHeight,e.desired_scale=1,e.set_scale=function(t){"undefined"==typeof t&&(t=e.content_scale);var i=e;i.style.WebkitTransform=i.style.MSTransform=i.style.transform="scale("+t+", "+t+") rotate(360deg)";var r=B(e),n=o(e);e.style.marginLeft=Math.round((window.innerWidth-r)/2)+"px",e.style.marginTop=Math.round((window.innerHeight-n)/2)+"px",e.content_scale=t,e.draw_area&&e.draw_area.reposition_and_resize(),window.scrollTo(window.scrollX,0)},e.resize_to_page=function(r){if("undefined"==typeof r&&(r={}),"undefined"==typeof r.evt&&(r.evt={}),null==e.parentNode)return void clearInterval(l);if(t&&h())if(Math.abs(window.orientation)!=Math.abs(c))var p=s,f=a-i*!n;else var p=a,f=s-i*n;var g=e.original_width,_=e.original_height,y="undefined"!=typeof p?p:window.innerWidth,m="undefined"!=typeof f?f:window.innerHeight,o=y/g,u=m/_,d=o;d*_>m&&(d=u),(e.desired_scale_x!=o||e.desired_scale_y!=u)&&(e.desired_scale_x=o,e.desired_scale_y=u,e.desired_scale=d,e.set_scale(e.desired_scale))},!t)var l=setInterval(function(){e.resize_to_page()},50);if(t){var i=Math.abs(window.innerWidth/window.outerWidth*(window.outerHeight-window.screen.availHeight)),n=window.innerWidth>window.innerHeight,c=window.orientation,a=window.innerWidth,s=window.innerHeight+i,h=function(){return!!document.querySelector(".smoke-base > .smoke-dialog_wrapper > .smoke-dialog > .smoke-prompt")};window.addEventListener("resize",function(t){e.resize_to_page({evt:t})})}e.resize_to_page(),window.scrollTo(0,0)}function rt(r){function i(t){e.isAttached()||e.destroy(),n=!("blur"==t.type)&&"visible"==document.visibilityState}var a=r.parent,e=document.createElement("div");e.direction="undefined"!=typeof r.direction?r.direction:1,e.counter="undefined"!=typeof r.counter?r.counter:0,e.do_stop_on_next_tick=!1,e.className="jt-play-timer",e.style.visibility="hidden",a.appendChild(e),e.progress=function(t){if(!t){if(1==e.do_stop_on_next_tick)return e.do_stop_on_next_tick=!1,void e.stop();n&&(e.counter+=e.direction)}e.display(),e.interval=setTimeout(e.progress,1e3)},e.stop=function(){0!=e.interval&&(clearTimeout(e.interval),e.interval=0),e.display()},e.stop_on_next_tick=function(){e.do_stop_on_next_tick=!0},e.start=function(){0!=e.interval&&(clearTimeout(e.interval),e.interval=0),e.counter=0,e.resume()},e.resume=function(){e.display(),0==e.interval&&e.progress(!0)},e.display=function(){e.style.visibility="visible";var t=Math.floor(e.counter/60);9>=t&&(t="0"+t);var i=e.counter%60;9>=i&&(i="0"+i),e.innerHTML=t+":"+i,e.setAttribute("current_text",e.innerHTML)},e.destroy=function(){document.removeEventListener(t,i),window.removeEventListener("blur",i),window.removeEventListener("focus",i)},e.interval=0;var t;"undefined"!=typeof document.hidden?t="visibilitychange":"undefined"!=typeof document.mozHidden?t="mozvisibilitychange":"undefined"!=typeof document.msHidden?t="msvisibilitychange":"undefined"!=typeof document.webkitHidden&&(t="webkitvisibilitychange"),"undefined"!=typeof t&&window.addEventListener(t,i),window.addEventListener("blur",i),window.addEventListener("focus",i);var n=!0;return e}function Z(t){var u=t.parent,p=t.menu_class,a=t.sort_attributes,c=t.entry_list,d=t.level_array,h=t.level_id,s=t.set_name,o=t.gs,i=t.sort_index[s],r=t.sort_direction[s],l=a[i].attribute_name,e=document.createElement("div");return e.className=p,e.classList.add("hoverable"),u.appendChild(e),n(e),e.refresh_text=function(){var t=a[i];e.innerHTML=0==r?t.up:t.down},e.advance_sort_mode=function(){a[i];0==r?r=1:(r=0,i=(i+1)%a.length,l=a[i].attribute_name),t.sort_direction[s]=r,t.sort_index[s]=i,o.select_menu_sort_direction=o.select_menu_sort_direction,o.select_menu_sort_index=o.select_menu_sort_index,e.refresh_text(),e.sort_levels()},e.sort_levels=function(){var i=a[t.sort_index[s]].default_sort_direction;d.sort(function(n,a){var e=c[n[h]][l],t=c[a[h]][l];return i-r==0?e>t?1:t>e?-1:0:t>e?1:e>t?-1:0}),e.onsort&&e.onsort()},e.refresh_text(),e.addEventListener(o.events.POINT,e.advance_sort_mode),e}function z(t){for(var r in t.init)t[r]=t.init[r];var a=t.parent,n=t.global_settings,i=t.menu_class,e=document.createElement("div");return e.classList.add("hoverable"),"string"==typeof i&&(i=[i]),i.forEach(function(t){e.classList.add(t)}),a.appendChild(e),("undefined"==typeof t.use_menu_button||1==t.use_menu_button)&&(e.morph_to_menu_button=function(){e.is_menu=!0,e.classList.remove("jt-common-back_button"),e.classList.add("jt-common-menu_button"),e.innerHTML="M",e.setAttribute("current_text","M")}),("undefined"==typeof t.use_back_button||1==t.use_back_button)&&(e.morph_to_back_button=function(){e.is_menu=!1,e.classList.add("jt-common-back_button"),e.classList.remove("jt-common-menu_button"),e.innerHTML="B",e.setAttribute("current_text","B")}),"undefined"==typeof t.start_with_back_button||0==t.start_with_back_button?e.morph_to_menu_button():e.morph_to_back_button(),e.addEventListener(n.events.POINT,function(){t.current_game;return 1==e.is_menu?void t.target.open():void(n.IS_WEBVIEW?window.history.back():t.mr_jigtato.history_control.load_page({page:"undefined"!=typeof t.back_button_page?t.back_button_page:"select_jigsaw"}))}),e}function g(t){var e=document.createElement("div");e.className="smoke-base";for(var l in t.init)l in t||(t[l]=t.init[l]);var u=t.parent,r=t.global_settings,a=t.current_game,h=t.menu_item_list;e.init=t,u.appendChild(e),e.style.display="none";var o=document.createElement("div");o.className="smoke-dialog_wrapper",e.appendChild(o);var s=document.createElement("div");s.className="smoke-dialog jt-play-settings_menu",o.appendChild(s),"undefined"!=typeof t.title&&(e.title_div=document.createElement("div"),e.title_div.className="jt-button jt-play-settings_menu-title",s.appendChild(e.title_div),e.title_div.innerHTML=t.title);var i=document.createElement("div");i.className="jt-play-settings_menu-grid",s.appendChild(i),e.settings_div_grid=i,"undefined"!=typeof h&&h.forEach(function(t){var n=document.createElement("div");n.text=t.text,n.innerHTML="function"==typeof t.text?t.text():t.text,i.appendChild(n),n.addEventListener(r.events.POINT,function(i){e.style.display="none",t.action(i,function(){e.style.display=""},e)})}),e.refresh=function(){i.children.forEach(function(e){e.children.forEach(function(e){"undefined"!=typeof e.text&&(e.innerHTML="function"==typeof e.text?e.text():e.text)})})};var c=e.back_button=document.createElement("div");return c.innerHTML="Back",i.appendChild(c),c.addEventListener(r.events.POINT,function(){e.close({callback:t.callback})}),e.open=function(){r.IS_CORDOVA&&r.smoke_window_list.push(e),a&&a.timer_obj&&a.timer_obj.stop_on_next_tick(),e.style.display="",i.style.height="auto",i.style.bottom="-100%",TweenMax.to(i,0,{ease:Linear.ease,css:{bottom:"0"}})},e.close=function(t){r.IS_CORDOVA&&void function(){var t=r.smoke_window_list.indexOf(e);-1!=t&&r.smoke_window_list.splice(t,1)}(),TweenMax.to(i,0,{ease:Linear.ease,css:{bottom:"-100%"}}),setTimeout(function(){a&&!e.parent_menu&&a.timer_obj&&a.timer_obj.resume(),e.style.display="none","undefined"!=typeof t&&"undefined"!=typeof t.callback&&t.callback(e)},0)},e.position_buttons=function(){var n=Math.ceil(i.children.length/t.column_size),e=0,a=0,r=null;i.children.forEach(function(s){0==e&&(r=document.createElement("div"),t.column_width&&(r.style.width=t.column_width),i.appendChild(r)),e+=1,e==n&&(e=0,a+=1),s.classList.add("jt-button"),s.classList.add("hoverable"),r.appendChild(s)})},n(e),e}function Q(t){function s(){switch(e.game_type){case"jigsaw":i.push(r.menu.jigsaw.toggle_freestyle_mode),i.push({text:function(){return"Center On Move "+(e.jigsaw_center_piece_on_move?"On":"Off")},action:function(i,r){var t=i.currentTarget;e.jigsaw_center_piece_on_move=!e.jigsaw_center_piece_on_move,t.innerHTML=t.text(),r()}}),i.push({text:function(){return'"Arrange Pieces" Places Pieces '+(1==e.jigsaw_arrange_pieces_on_entire_area?"On Entire Area":0==e.jigsaw_arrange_pieces_on_entire_area?"On Either Side":"Using Best Fit")},action:function(i,r){var t=i.currentTarget;e.jigsaw_arrange_pieces_on_entire_area=(e.jigsaw_arrange_pieces_on_entire_area+1)%3,t.innerHTML=t.text(),n&&(2!=e.jigsaw_arrange_pieces_on_entire_area&&(n.game_instance.jigsaw_arrange_pieces_on_entire_area=e.jigsaw_arrange_pieces_on_entire_area),n.refresh_gui_display()),r()}}),i.push({text:function(){return"Reduce Texture Size "+(4==e.jigsaw_reduce_texture_size?"Off":">= Difficulty "+(1+e.jigsaw_reduce_texture_size))},action:function(i,r){var t=i.currentTarget;e.jigsaw_reduce_texture_size=(e.jigsaw_reduce_texture_size+1)%5,t.innerHTML=t.text(),r()}})}i.push({text:"Reset Default Settings",action:function(t,e){H({current_game:n,mr_jigtato:r,callback:e})}}),i.push({text:"Load Player Data From Server",action:function(){smoke.confirm('<span style="color:red; weight:bold">Warning</span>: this will overwrite you current local data with data from the server. Proceed?',function(i){0!=i&&r.load_player_data_from_server({error:e.errormessage,success:function(){if("undefined"!=typeof t.select_screen){var e=t.select_screen;e.create_puzzle_selection_array(),e.refresh_puzzle_list(),e.create_selection_tab_container(),e.sort_button.sort_levels()}}})})}}),i.push({text:"Save Player Data to Server",action:function(){r.save_player_data_to_server({error:e.errormessage,success:function(){smoke.alert("Player data saved to server.")}})}}),i.push({text:"Reset Player Data",action:function(i,e){V({current_game:n,select_screen:t.select_screen,mr_jigtato:r,callback:e})}})}var r=t.mr_jigtato,e=t.gs,n=t.current_game;"undefined"==typeof t.menu_item_list&&(t.menu_item_list=[]);var i=t.menu_item_list;s();{var a=new g(t);a.settings_div_grid}return a.position_buttons(),a}function J(r){function a(){i.push({text:function(){return"Timer "+(e.show_timer?"Visible":"Hidden")},action:function(r,n,a){var t=r.currentTarget;e.show_timer=!e.show_timer,t.innerHTML=t.text();var i=a.init.current_game;i&&(i.timer_obj.style.display=e.show_timer?"":"none"),n()}}),r.show_hint_image_options&&i.push({text:function(){return"Hint Image "+(e.jigsaw_show_hint_rect?e.jigsaw_show_hint_image?"Transparent":"Blank":"Off")},action:function(r,n){var i=r.currentTarget;e.jigsaw_show_hint_rect?e.jigsaw_show_hint_image?e.jigsaw_show_hint_image=!1:e.jigsaw_show_hint_rect=!1:(e.jigsaw_show_hint_rect=!0,e.jigsaw_show_hint_image=!0),i.innerHTML=i.text(),t&&(t.game_instance.jigsaw_show_hint_image=e.jigsaw_show_hint_image,t.game_instance.jigsaw_show_hint_rect=e.jigsaw_show_hint_rect,t.refresh_gui_display(),t.save_puzzle_state()),n()}}),i.push({text:function(){return"(Normal UI) Trophy Ribbon "+(e.show_trophy_ribbon?"Visible":"Hidden")},action:function(r,n){var i=r.currentTarget;e.show_trophy_ribbon=!e.show_trophy_ribbon,i.innerHTML=i.text(),t&&t.refresh_gui_display(),n()}}),i.push({text:function(){return"Minimal UI "+(e.jigsaw_minimal_ui?"On":"Off")},action:function(r,n){var i=r.currentTarget;if(e.jigsaw_minimal_ui=!e.jigsaw_minimal_ui,i.innerHTML=i.text(),n(),t){var a=t.main_image.base_image.width;t.set_base_image_size();var s=t.main_image.base_image.width;t.refresh_gui_display(),t.redraw_main_image_and_pieces({piece_rescale:s/a,callback:function(){t.refresh_gui_display(),t.save_puzzle_state()}})}}}),i.push({text:function(){return(0==e.jigsaw_image_size_type?"Compact":1==e.jigsaw_image_size_type?"Large":"Larger")+" Images "},action:function(r,n){var i=r.currentTarget;if(e.jigsaw_image_size_type=(e.jigsaw_image_size_type+1)%3,i.innerHTML=i.text(),n(),t){var a=t.main_image.base_image.width;t.set_base_image_size();var s=t.main_image.base_image.width;t.refresh_gui_display(),t.redraw_main_image_and_pieces({piece_rescale:s/a,callback:function(){t.refresh_gui_display(),t.save_puzzle_state()}})}}}),i.push({text:function(){return"Piece scale at: "+parseInt(100*+e.jigsaw_piece_scale_to_actual)+"%"},action:function(r,n){var i=r.currentTarget;e.jigsaw_piece_scale_to_actual_index=(e.jigsaw_piece_scale_to_actual_index+1)%e.jigsaw_piece_scale_to_actual_options.length,e.jigsaw_piece_scale_to_actual=e.jigsaw_piece_scale_to_actual_options[e.jigsaw_piece_scale_to_actual_index],i.innerHTML=i.text(),t&&(t.category_deck.container.children.forEach(function(e){t.size_pieces(e.piece_container.children)}),t.screen_refresh()),n()}}),i.push({text:function(){return"2.5D Pieces "+(e.jigsaw_use_3d_effect?"On":"Off")},action:function(r,n){var i=r.currentTarget;e.jigsaw_use_3d_effect=!e.jigsaw_use_3d_effect,i.innerHTML=i.text(),n(),t&&(t.game_instance.piece_margin=e.jigsaw_get_scaled_piece_margin(t.game_instance),t.game_instance.piece_margin_style=e.jigsaw_piece_margin_style,t.redraw_main_image_and_pieces())}}),i.push({text:function(){return"Combine Pieces "+(e.jigsaw_combine_pieces?"On":"Off")},action:function(r,n){n();var i=r.currentTarget;e.jigsaw_combine_pieces=!e.jigsaw_combine_pieces,i.innerHTML=i.text(),t&&t.redraw_main_image_and_pieces()}}),i.push({text:function(){return"Colored Borders "+(e.jigsaw_colored_borders?"On":"Off")},action:function(r,n){var i=r.currentTarget;e.jigsaw_colored_borders=!e.jigsaw_colored_borders,i.innerHTML=i.text(),n(),t&&(t.game_instance.piece_margin=e.jigsaw_get_scaled_piece_margin(t.game_instance),t.game_instance.piece_margin_style=e.jigsaw_piece_margin_style,t.redraw_main_image_and_pieces())}}),i.push({text:function(){return"Animate Placement "+(e.jigsaw_animate_piece_placement?"On":"Off")},action:function(i,r){var t=i.currentTarget;e.jigsaw_animate_piece_placement=!e.jigsaw_animate_piece_placement,t.innerHTML=t.text(),r()}}),i.push({text:function(){var t=e.jigsaw_heat_seeking_color_options[e.jigsaw_heat_seeking_color_index];return"Heat Seeking Color "+("undefined"==typeof t?"Off":t.capitalize())},action:function(i,r){var t=i.currentTarget;e.jigsaw_do_heat_seeking=!e.jigsaw_do_heat_seeking,e.jigsaw_heat_seeking_color_index=(e.jigsaw_heat_seeking_color_index+1)%e.jigsaw_heat_seeking_color_options.length,t.innerHTML=t.text(),r()}})}var e=r.gs,t=r.current_game;"undefined"==typeof r.menu_item_list&&(r.menu_item_list=[]);var i=r.menu_item_list;a();{var n=new g(r);n.settings_div_grid}return n.position_buttons(),n}function Y(i){function a(){t.push({text:function(){return"Sound FX "+(e.sound_effects_on?"Enabled":"Disabled")},action:function(i,r){var t=i.currentTarget;e.sound_effects_on=!e.sound_effects_on,t.innerHTML=t.text(),r()}}),t.push({text:function(){return"Music "+(e.music_on?"Enabled":"Disabled")},action:function(i,r){var t=i.currentTarget;e.music_on=!e.music_on,t.innerHTML=t.text(),r()}}),t.push({text:function(){return"Ambient Music "+(e.ambient_music_on?"Enabled":"Disabled")},action:function(r,t){var i=r.currentTarget;e.ambient_music_on=!e.ambient_music_on,i.innerHTML=i.text(),e.ambient_music_on?smoke.alert('Note: ambient music won\'t play if the "music" setting is set to "disabled."',t):t()}}),t.push({text:"Play Next Music Track",action:function(i,t){e.ambient_music.play_next_track(),n(),t()}}),t.push({text:function(){return(e.run_audio_in_background?"Do":"Don't")+" Run Audio In Background"},action:function(i,r){var t=i.currentTarget;e.run_audio_in_background=!e.run_audio_in_background,t.innerHTML=t.text(),r()}}),t.push({text:function(){return"Sound Volume: "+e.sound_effects_volume},action:function(r,t){var i=r.currentTarget;e.sound_effects_volume=(e.sound_effects_volume+1)%11+(10==e.sound_effects_volume),i.innerHTML=i.text(),t(),t()}}),t.push({text:function(){return"Music Volume: "+e.music_volume},action:function(r,t){var i=r.currentTarget;e.music_volume=(e.music_volume+1)%11+(10==e.music_volume),i.innerHTML=i.text(),t(),t()}}),t.push({text:function(){return"Ambient Music Volume: "+e.ambient_music_volume},action:function(i,r){var t=i.currentTarget;e.ambient_music_volume=(e.ambient_music_volume+1)%11+(10==e.ambient_music_volume),t.innerHTML=t.text(),r()}}),t.push({text:function(){return"Current Playlist: "+e.ambient_music_playlist_name},action:function(r,t){var i=r.currentTarget;t(),e.ambient_music.play_next_playlist(),i.innerHTML=i.text(),t()}})}{var e=i.gs;i.current_game}"undefined"==typeof i.menu_item_list&&(i.menu_item_list=[]);var t=i.menu_item_list;a();var r=new g(i),n=(r.settings_div_grid,e.set_audio_menu_title=function(){var t=e.ambient_music.playlist,i=e.ambient_music.current_track_index;r.title_div.innerHTML='"'+t[i].title+'", by '+t[i].author});return n(),r.position_buttons(),r}function S(t){var e=(t.parent,t.gs),o=t.current_game,s=t.menu_item_list;s.push({text:function(){return"Music "+(e.music_on?"Enabled":"Disabled")},action:function(i,r){var t=i.currentTarget;e.music_on=!e.music_on,t.innerHTML=t.text(),r()}}),e.challenge_code_processed||s.push({text:"Challenge Code",action:function(t,i){var r=t.currentTarget;h({gs:e,error:function(){smoke.alert("You must log in to Google Play to use this feature!")},success:function(){y({gs:e,callback:function(){e.challenge_code_processed&&(r.style.display="none"),i()}})}})}});var i=new g(t),n=i.settings_div_grid,r=document.createElement("div");if(r.innerHTML="How to Play",r.addEventListener(e.events.POINT,function(){function o(){r.back.style.visibility=0==n?"hidden":"visible",r.next.style.visibility=n==a.length-1?"hidden":"visible",s.text.innerHTML=a[n],s.text.classList.add("jt-common-instruction_text")}var a=t.mr_jigtato.game_data.jigsaw.instructions;i.style.display="none";var n=0,s=smoke.alert("",function(){i.style.display=""}),r=s.buttons;r.back=s.buttons.ok.cloneNode(!0),r.back.style.cssFloat="left",r.back.innerHTML="< Back",r.appendChild(r.back),r.next=s.buttons.ok.cloneNode(!0),r.next.style.cssFloat="right",r.next.innerHTML="Next >",r.appendChild(r.next),r.back.addEventListener(e.events.POINT,function(){n=(n+a.length-1)%a.length,o(n)}),r.next.addEventListener(e.events.POINT,function(){n=(n+a.length+1)%a.length,o(n)}),o(n),c(s)}),!e.is_kiosk&&e.use_social_media_buttons){var a=document.createElement("div");a.innerHTML=(1==t.social_media_hidden?"Show":"Hide")+" Social Buttons",n.insertBefore(r,i.back_button),a.addEventListener(e.events.POINT,function(){t.social_media_hidden=!t.social_media_hidden,o.social_sharing_button_container.style.display=t.social_media_hidden?"none":"",a.innerHTML=(1==t.social_media_hidden?"Show":"Hide")+" Social Buttons"})}return n.insertBefore(r,n.childNodes[0]),i.position_buttons(),i}function lt(e){e.audio_list.forEach(function(t){e.parent.playAudio(e.dir+t,{start:!1,volume:e.volume||1,audio_type:e.type})})}function V(e){"undefined"==typeof e.callback&&(e.callback=function(){});var t=smoke.confirm('<span style="color: #cc0000; font-weight: bold">Warning:</span> This will clear/reset all player data: progress, trophies, trophies, best times, etc. Continue?',function(t){return 0==t?void e.callback():(e.mr_jigtato.reset_player_data(),e.current_game&&e.current_game.trophy_ribbon&&e.current_game.trophy_ribbon.update(),e.select_screen&&e.select_screen.refresh_puzzle_list(),void smoke.alert("All player data has been reset.",e.callback))});c(t)}function H(e){function t(){e.mr_jigtato.gs.reset_default_settings(),smoke.alert("Settings have been reset to default.",i)}"undefined"==typeof e.callback&&(e.callback=function(){});var i=e.callback;if("undefined"!=typeof e.current_game){i=function(){e.mr_jigtato.gs.IS_WEBVIEW?window.history.back():e.mr_jigtato.history_control.load_page({page:"select_jigsaw"}),e.callback()};var r=!1;r?smoke.alert("Resetting will send you back to the puzzle selection screen.",t):t()}else t()}function X(r){function l(){e.back.style.visibility=0==i?"hidden":"visible",e.next.style.visibility=i==n.length-1?"hidden":"visible",s.text.innerHTML=n[i],s.text.parentNode.classList[1==i?"add":"remove"]("jt-play-show_credits-dialog")}"undefined"==typeof r.callback&&(r.callback=function(){});var a=r.gs,h=r.mr_jigtato,o=h.game_data,u=h.set_name,n=[],d=r.gs.is_kiosk?a.contact_info:'<a href="mailto:'+a.contact_info+'">'+a.contact_info+"</a>";n[0]=o.about_text+d+". </p>",r.callback,n[1]="Loading...",t({error:function(e){a.errormessage(e,r.callback)},file:a.get_set_directory(u)+"/"+u+"-credits.txt",charset:"utf-8",plaintext:!0,request_method:"GET",success:function(t){var i=r.menu.init.current_game;if(i){var s=i.game_instance,e=r.menu.init.level_id,l=s.difficulty_level,c=o.entry_list[e].name,h=o.entry_list[e].credit,a=o.trophy_list[o.entry_list[e].trophies[l]],u=a.display_name.capitalizeFirstLetter(),d=a.credit;n[1]=t+'<span style="width: 1rem; height: .5rem; display: block"></span><h2> Puzzle image credits </h2><p><b>'+c+"</b>: "+h+'</p><span style="width: 1rem; height: .5rem; display: block"></span><h2> Trophy image credits </h2><p><b>'+u+"</b>: "+d+"</p>"}else n[1]=t}});var s=smoke.alert(o.about_text+a.contact_info+". </p>",r.callback),e=s.buttons;e.back=s.buttons.ok.cloneNode(!0),e.back.style.cssFloat="left",e.back.innerHTML="< Back",e.appendChild(e.back),e.next=s.buttons.ok.cloneNode(!0),e.next.style.cssFloat="right",e.next.innerHTML="Next >",e.appendChild(e.next),e.back.addEventListener(a.events.POINT,function(){i=(i+n.length-1)%n.length,l(i)}),e.next.addEventListener(a.events.POINT,function(){i=(i+n.length+1)%n.length,l(i)});var i=0;l(i),c(s),a.is_phone_or_tablet&&(s.dialog.text.style.backgroundColor="transparent")}function U(a){function o(l){var o=l.currentTarget,a=o.trophy_item,s=i.game_data.entry_list[o.level_id];t.innerHTML="";var e=document.createElement("span");e.className="jt-play-trophy_room-item_name",e.style.color=a.text_color,e.innerHTML=a.display_name.capitalizeFirstLetter(),t.appendChild(e),r.is_chromium||r.is_android?(e.style.textShadow="none",e.style.WebkitTextStrokeColor=a.text_outline_color.split(",")[0].trim(),v({element:e,size:"3px",color:""})):j(e,a.text_outline_color||"black");var c=document.createTextNode(".. earned for completing the puzzle ");t.appendChild(c);var n=document.createElement("span");n.className="jt-play-trophy_room-puzzle_name",n.style.color=s.title_color,n.innerHTML='"'+s.name+'"',t.appendChild(n),r.is_chromium||r.is_android?(n.style.textShadow="none",n.style.WebkitTextStrokeColor=s.border_color.split(",")[0].trim(),v({element:n,size:"3px",color:""})):j(n,s.border_color||"black");var h=document.createTextNode(' on difficulty level "'+i.game_data.jigsaw.difficulty_levels[o.trophy_index].name+'".');t.appendChild(h)}var r=a.gs;"undefined"==typeof a.callback&&(a.callback=function(){});var d=smoke.alert("",a.callback);c(d);var e=d.childNodes[0].childNodes[0].childNodes[0],u=e.nextSibling;e.parentNode.classList.add("jt-play-trophy_room-dialog");var n=document.createElement("div");n.className="smoke-dialog-text jt-play-trophy_room-title",e.parentNode.insertBefore(n,e);var l=document.createElement("div");l.className="jt-play-trophy_room-title-image",n.appendChild(l);var s=document.createElement("div");s.className="jt-play-trophy_room-title-text",s.innerHTML="Trophy Room",n.appendChild(s);var h=document.createElement("div");h.className="jt-play-trophy_room-title-image",n.appendChild(h),u.classList.add("jt-play-trophy_room-dialog-buttons"),n.appendChild(u);var t=document.createElement("div");t.className="smoke-dialog-text jt-play-trophy_room-description",e.parentNode.insertBefore(t,e.nextSibling),t.innerHTML="Touch, click, or hover over a trophy to see details!",e.classList.add("jt-play-trophy_room-container");var i=a.mr_jigtato,p=(i.game_data.jigsaw,i.player_data),f=p.jigsaw.trophies,_=i.set_name;return f.forEach(function(s){var n=s.split("|")[0],a=s.split("|")[1],l=i.get_trophy_item({game_type:"jigsaw",level_id:n,difficulty_level:a}),t=E({mr_jigtato:i,gs:r,set_name:_,level_id:n,difficulty_level:a,trophy_class:"jt-play-main_image_border_width"});e.appendChild(t),t.trophy_item=l,t.level_id=n,t.trophy_index=a,t.addEventListener(r.events.POINT,o),t.addEventListener("mouseover",o)}),e}function q(e){"undefined"==typeof e.callback&&(e.callback=function(){});var t=smoke.alert("<p>If you liked this game, share it!</p>",e.callback).text;N({parent:t,button_class:"jt-social_button"})}function N(r){var e=window.location.toString(),n=e.indexOf("//")+1,n=e.indexOf("/",n+1)+1,e=e.substr(0,n),s={},a={twitter:'<a count="none" href="https://twitter.com/share" class="twitter-share-button" data-url="'+e+'" data-size="large" data-count="none"></a>',facebook:'<div style="left:0; top:0; width:20px; height:20px" class="fb-share-button" data-href="'+e+'" data-width="100" data-type="icon"></div>',googleplus:'<g:plusone count="false" style="width:80px; height: 80px" data-size="tall" expandTo="top" data-href="'+e+'"></g:plusone>'};for(var i in a){var t=document.createElement("div");t.className=r.button_class+" jt-social_button-"+i,t.button_name=i,s[i]=t,t.innerHTML=a[i],r.parent.appendChild(t)}"undefined"!=typeof twttr&&twttr.widgets.load(),"undefined"!=typeof FB&&FB.XFBML.parse(document.getElementsByClassName("fb-share-button")[0].parentNode),"undefined"!=typeof gapi&&gapi.plusone.go()}function F(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function K(){var e="true"==u().is_kiosk?!0:!1;e||void function(e,r){var t,n=e.getElementsByTagName(r)[0],a=e.createDocumentFragment(),i=function(n,i){e.getElementById(i)||(t=e.createElement(r),t.src=n,i&&(t.id=i),a.appendChild(t))};i("http://apis.google.com/js/plusone.js"),i("//platform.twitter.com/widgets.js"),i("//connect.facebook.net/en_US/all.js#xfbml=1&appId=1484397078438785"),n.parentNode.insertBefore(a,n)}(document,"script")}function E(t){var r=t.gs,a=t.set_name,s=t.level_id,n=t.mr_jigtato,o=("undefined"!=typeof t.game_type?t.game_type:"jigsaw",n.game_data.jigsaw),i=n.get_trophy_item({game_type:o,level_id:s,difficulty_level:t.difficulty_level}),e=document.createElement("img");e.className=t.trophy_class;var l="undefined"!=typeof t.parent?t.parent:document.body;e.style.backgroundColor=i.background_color,"undefined"!=typeof i.link&&(e.style.cursor="pointer",e.a=document.createElement("a"),e.a.target="_blank",e.a.href=i.link,e.addEventListener(r.events.POINT,function(){e.a[r.events.POINT]()})),l.appendChild(e);var c=e.getBoundingClientRect().width;return"undefined"!=typeof i.trophy_image_padding&&(e.style.padding=parseFloat(i.trophy_image_padding)*c/356+"px"),"undefined"!=typeof i.trophy_image_border_color&&(e.style.borderColor=i.trophy_image_border_color),r.get_image(e,a,i.filename,"trophy"),e}function $(n,s,i){var e=i.init.parent;if("undefined"==typeof e.audio_settings_menu||null==e.audio_settings_menu.parentNode){var t=a(i.init);delete t.menu_item_list,e.audio_settings_menu=Y({callback:function(e){e.style.display="none",e.parent_menu.style.display="",e.parent_menu.refresh()},parent:e,mr_jigtato:t.mr_jigtato,gs:t.gs,current_game:t.current_game,column_size:2,title:"",column_width:"760px",init:t})}var r=e.audio_settings_menu;r.refresh(),i.style.display="none",r.style.display="",r.parent_menu=i}function et(n,s,i){var t=i.init.parent;if("undefined"==typeof t.visual_settings_menu||null==t.visual_settings_menu.parentNode){var e=a(i.init);delete e.menu_item_list,t.visual_settings_menu=J({callback:function(e){e.style.display="none",e.parent_menu.style.display="",e.parent_menu.refresh()},parent:t,mr_jigtato:e.mr_jigtato,gs:e.gs,current_game:e.current_game,show_hint_image_options:e.show_hint_image_options,column_size:2,init:e})}var r=t.visual_settings_menu;r.refresh(),i.style.display="none",r.style.display="",r.parent_menu=i}function tt(n,s,t){var i=t.init.parent;if("undefined"==typeof i.misc_config_menu||null==i.misc_config_menu.parentNode){var e=a(t.init);delete e.menu_item_list,i.misc_config_menu=Q({callback:function(e){e.style.display="none",e.parent_menu.style.display="",e.parent_menu.refresh()},mr_jigtato:e.mr_jigtato,gs:e.gs,current_game:e.current_game,column_size:2,show_hint_image_options:e.show_hint_image_options,init:e})}var r=i.misc_config_menu;r.refresh(),t.style.display="none",r.style.display="",r.parent_menu=t}function it(p,h,t){t.style.display="none";var i=(t.init.current_game.main_image.base_image.src,smoke.alert("",function(){}));i.innerHTML="";var d=t.init.mr_jigtato.gs,o=t.init.content_div,e=document.createElement("img"),s=t.init.current_game.main_image;e.style.position="absolute",e.style.padding=0,e.src=s.base_image.src,e.className="smoke-dialog",i.appendChild(e);var u=s.width/s.height,a=1e3*u,n=1e3,l=(parseFloat(window.getComputedStyle(o).width)-a)/2,c=(parseFloat(window.getComputedStyle(o).height)-n)/2,r=parseFloat(window.getComputedStyle(e).borderLeftWidth);e.style.cursor="pointer",e.style.left=l-r+.1*a+"px",e.style.top=c-r+.1*n+"px",e.style.width=.8*a+"px",e.style.height=.8*n+"px",TweenMax.to(e,.5,{ease:Linear.easeIn,css:{left:l-r+"px",top:c-r+"px",width:a+"px",height:n+"px"}}),i.addEventListener(d.events.POINT,function(){i.parentNode.removeChild(i),t.style.display="",h()})}function h(t){var e=t.gs;if("undefined"!=typeof e.account.internal_access_token)return void t.success();if(e.IS_CORDOVA)var i=window.plugins.GooglePlayToken||window.plugins.GooglePlayServices;else var i=e.gps;i.initialize({error:t.error,success:function(i){e.IS_CORDOVA?(e.google_play_access_token=i,O(t)):e.get_google_play_access_token({callback:function(){O(t)}})}})}function O(i){var e=i.gs;return"undefined"==typeof e.google_play_access_token?void("undefined"!=typeof i.error&&i.error()):void t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=login&access_token="+e.google_play_access_token+"&service_name="+e.service_name+"&device_model="+device.model+"&device_uuid="+device.uuid,error:i.error,request_method:"POST",async:!0,success:function(r){if(null==r)return void i.error();if("undefined"!=typeof r.user_data){var t=r.user_data;"undefined"!=typeof t.game_was_rated&&(e.account.game_was_rated=t.game_was_rated),"undefined"!=typeof t.user_id&&(e.account.user_id=t.user_id),"undefined"!=typeof t.gem_amount&&(e.account.gem_amount=t.gem_amount),"undefined"!=typeof t.internal_access_token&&(e.account.internal_access_token=t.internal_access_token),"undefined"!=typeof t.email_address&&(e.account.email_address=t.email_address),"undefined"!=typeof t.users_to_puzzle_packs&&(e.account.users_to_puzzle_packs=t.users_to_puzzle_packs),"undefined"!=typeof t.purchased_ad_removal&&(e.account.purchased_ad_removal=1==t.purchased_ad_removal),e.IS_CORDOVA&&e.account.purchased_ad_removal&&e.ad_control_list&&e.ad_control_list.destroy(),ot({gs:e}),JSON.stringify(e.mr_jigtato.player_data)==localStorage.initial_player_data_string&&p.load_player_data_from_server()}void function(){function t(){e.get_google_play_access_token(),setTimeout(t,i)}var i=27e5;setTimeout(t,i)}(),e.paid_puzzles=r.paid_puzzles,"undefined"!=typeof r.message&&(e.pending_message=r.message),i.success()}})}function at(){function t(){e.registerDevice(function(e){console.log(e)},function(e){console.log(e)})}var e=window.plugins.pushNotification;"undefined"!=typeof e&&(document.addEventListener("push-notification",function(e){e.notification.title,e.notification.userdata}),e.onDeviceReady({projectid:"694160809438",appid:"D2CCB-D24E6"}),e.unregisterDevice(t,t))}function I(i){function a(i,e){"undefined"==typeof e&&(e=s.errormessage),t({file:i,request_method:"GET",async:!0,error:e,success:d})}function n(){if(s.IS_CORDOVA){a(c+"/"+e,function(){a(l+"/"+e)})}else a(o+"/"+e)}function m(){if(s.IS_CORDOVA){var t=new FileTransfer,i=encodeURI(o+"/"+e);t.download(i,c+"/"+e,n,n,!1,{headers:{}})}else n()}var s=i.gs,_=(i.IS_DEBUG_MODE,i.DO_NOT_USE_REMOTE_FILE),o=i.remote_dir,l=i.initial_local_dir,c=i.persistent_local_dir,e=i.target_filename,u=i.error,d=i.success;if(s.IS_DEBUG_MODE){var p=e.substr(0,split),f=e.substr(split+1);e=p+"-beta."+f}if(_)return void a(l+"/"+e,u);var h=1420082059;"undefined"==typeof localStorage.json_file_version_date&&(localStorage.json_file_version_date=JSON.stringify(+h));var r=new XMLHttpRequest;r.open("HEAD",o+"/"+e,!0),r.onreadystatechange=function(){if(4==r.readyState){if(200!=r.status)return void n();var s=r.getResponseHeader("Last-Modified"),t=s.split(" "),i=+new Date(t[2]+" "+t[1]+" "+t[3]+" "+t[4]+" "+t[5])/1e3,o="undefined"==typeof localStorage.json_file_version_date?0:JSON.parse(localStorage.json_file_version_date);h>=i?a(l+"/"+e,u):i>o?(localStorage.json_file_version_date=JSON.stringify(+i),m()):n()}},r.send(null)}function ot(a){function s(){for(var t in r){{r[t],e.google_play_store.product_list.ad_removal}i.when(t).approved(function(e){e.verify()}),i.when(t).verified(function(e){console.log("Verified: "+e.id+"."),console.log("Purchase complete: "+e.id+"."),e.finish()})}}var e=a.gs;if(e.IS_CORDOVA&&window.store){var i=window.store;i.validator=function(r,n){t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new.php?action=check_purchase&internal_access_token="+e.account.internal_access_token+"&user_id="+e.account.user_id+"&signature="+encodeURIComponent(r.transaction.signature)+"&receipt="+encodeURIComponent(r.transaction.receipt),success:function(t){console.dir(t),"undefined"!=typeof t&&("undefined"!=typeof t.purchased_ad_removal&&(e.ad_control_list&&e.ad_control_list.destroy(),e.purchased_ad_removal=!0),"undefined"!=typeof t.gem_amount&&(console.log("Gem purchase complete: "+(t.gem_amount-e.account.gem_amount)+" gems."),e.account.gem_amount=t.gem_amount)),r.finish_single_use_callback&&(r.finish_single_use_callback(r),delete r.finish_single_use_callback),n(!0)},error:function(e){n(!1,{error:{code:i.PURCHASE_EXPIRED,errormessage:e}})}})},i.error(function(t){e.errormessage("Google Play Store error "+t.code+": "+t.message)}),e.google_play_store={};var r=e.google_play_store.product_list={ad_removal:{consumable:!1},gems_10:{consumable:!0},gems_30:{consumable:!0},gems_50:{consumable:!0},gems_100:{consumable:!0}};for(var n in r)i.register({id:n,alias:n,type:i[r[n].consumable?"CONSUMABLE":"NON_CONSUMABLE"]}),r[n]=i.get(n);s(),console.dir(r),i.refresh()}}function G(){function t(e,t){arguments.length>0&&this.init(e,t)}function r(e,t){arguments.length>0&&this.init(e,t)}function e(){this.init(arguments)}var n={};return t.prototype.init=function(e,t){this.x=e,this.y=t},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.multiply=function(e){return new t(this.x*e,this.y*e)},r.prototype.init=function(e,t){this.x=e,this.y=t},e.TOLERANCE=1e-6,e.ACCURACY=6,e.prototype.init=function(t){this.coefs=new Array;for(var e=t.length-1;e>=0;e--)this.coefs.push(t[e])},e.prototype.eval=function(i){for(var e=0,t=this.coefs.length-1;t>=0;t--)e=e*i+this.coefs[t];return e},e.prototype.simplify=function(){for(var t=this.getDegree();t>=0&&Math.abs(this.coefs[t])<=e.TOLERANCE;t--)this.coefs.pop()},e.prototype.bisection=function(i,r){var t,n=this.eval(i),s=this.eval(r);if(Math.abs(n)<=e.TOLERANCE)t=i;else if(Math.abs(s)<=e.TOLERANCE)t=r;else if(0>=n*s)for(var l=Math.log(r-i),c=Math.log(10)*e.ACCURACY,h=Math.ceil((l+c)/Math.log(2)),o=0;h>o;o++){t=.5*(i+r);var a=this.eval(t);if(Math.abs(a)<=e.TOLERANCE)break;0>a*n?(r=t,s=a):(i=t,n=a)}return t},e.prototype.getDegree=function(){return this.coefs.length-1},e.prototype.getDerivative=function(){for(var i=new e,t=1;t<this.coefs.length;t++)i.coefs.push(t*this.coefs[t]);return i},e.prototype.getRoots=function(){var e;switch(this.simplify(),this.getDegree()){case 0:e=new Array;break;case 1:e=this.getLinearRoot();break;case 2:e=this.getQuadraticRoots();break;case 3:e=this.getCubicRoots();break;case 4:e=this.getQuarticRoots();break;default:e=new Array}return e},e.prototype.getRootsInInterval=function(n,a){var e,r=new Array;if(1==this.getDegree())e=this.bisection(n,a),null!=e&&r.push(e);else{var s=this.getDerivative(),t=s.getRootsInInterval(n,a);if(t.length>0){for(e=this.bisection(n,t[0]),null!=e&&r.push(e),i=0;i<=t.length-2;i++)e=this.bisection(t[i],t[i+1]),null!=e&&r.push(e);e=this.bisection(t[t.length-1],a),null!=e&&r.push(e)}else e=this.bisection(n,a),null!=e&&r.push(e)}return r},e.prototype.getLinearRoot=function(){var e=new Array,t=this.coefs[1];return 0!=t&&e.push(-this.coefs[0]/t),e},e.prototype.getQuadraticRoots=function(){var t=new Array;if(2==this.getDegree()){var r=this.coefs[2],e=this.coefs[1]/r,a=this.coefs[0]/r,i=e*e-4*a;if(i>0){var n=Math.sqrt(i);t.push(.5*(-e+n)),t.push(.5*(-e-n))}else 0==i&&t.push(.5*-e)}return t},e.prototype.getCubicRoots=function(){var i=new Array;if(3==this.getDegree()){var c=this.coefs[3],r=this.coefs[2]/c,p=this.coefs[1]/c,y=this.coefs[0]/c,l=(3*p-r*r)/3,h=(2*r*r*r-9*p*r+27*y)/27,a=r/3,s=h*h/4+l*l*l/27,n=h/2;if(Math.abs(s)<=e.TOLERANCE&&(disrim=0),s>0){var t,o,f=Math.sqrt(s);t=-n+f,o=t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3),t=-n-f,t>=0?o+=Math.pow(t,1/3):o-=Math.pow(-t,1/3),i.push(o-a)}else if(0>s){var u=Math.sqrt(-l/3),_=Math.atan2(Math.sqrt(-s),-n)/3,d=Math.cos(_),m=Math.sin(_),g=Math.sqrt(3);i.push(2*u*d-a),i.push(-u*(d+g*m)-a),i.push(-u*(d-g*m)-a)}else{var t;t=n>=0?-Math.pow(n,1/3):Math.pow(-n,1/3),i.push(2*t-a),i.push(-t-a)}}return i},e.prototype.getQuarticRoots=function(){var r=new Array;if(4==this.getDegree()){var l=this.coefs[4],t=this.coefs[3]/l,s=this.coefs[2]/l,h=this.coefs[1]/l,c=this.coefs[0]/l,m=new e(1,-s,t*h-4*c,-t*t*c+4*s*c-h*h).getCubicRoots(),_=m[0],o=t*t/4-s+_;if(Math.abs(o)<=e.TOLERANCE&&(o=0),o>0){var a=Math.sqrt(o),n=3*t*t/4-a*a-2*s,i=(4*t*s-8*h-t*t*t)/(4*a),u=n+i,d=n-i;if(Math.abs(u)<=e.TOLERANCE&&(u=0),Math.abs(d)<=e.TOLERANCE&&(d=0),u>=0){var p=Math.sqrt(u);r.push(-t/4+(a+p)/2),r.push(-t/4+(a-p)/2)}if(d>=0){var p=Math.sqrt(d);r.push(-t/4+(p-a)/2),r.push(-t/4-(p+a)/2)}}else if(0>o);else{var i=_*_-4*c;if(i>=-e.TOLERANCE){if(0>i&&(i=0),i=2*Math.sqrt(i),n=3*t*t/4-2*s,n+i>=e.TOLERANCE){var f=Math.sqrt(n+i);r.push(-t/4+f/2),r.push(-t/4-f/2)}if(n-i>=e.TOLERANCE){var f=Math.sqrt(n-i);r.push(-t/4+f/2),r.push(-t/4-f/2)}}}}return r},n.testCurveCurveIntersection=function(j,B,G,K,z,N,W,X){var I,O,E,D,i,n,a,h,o,c,l,s,j=new t(j[0],j[1]),B=new t(B[0],B[1]),G=new t(G[0],G[1]),K=new t(K[0],K[1]),z=new t(z[0],z[1]),N=new t(N[0],N[1]),W=new t(W[0],W[1]),X=new t(X[0],X[1]);I=j.multiply(-1),O=B.multiply(3),E=G.multiply(-3),D=I.add(O.add(E.add(K))),i=new r(D.x,D.y),I=j.multiply(3),O=B.multiply(-6),E=G.multiply(3),D=I.add(O.add(E)),n=new r(D.x,D.y),I=j.multiply(-3),O=B.multiply(3),E=I.add(O),a=new r(E.x,E.y),h=new r(j.x,j.y),I=z.multiply(-1),O=N.multiply(3),E=W.multiply(-3),D=I.add(O.add(E.add(X))),o=new r(D.x,D.y),I=z.multiply(3),O=N.multiply(-6),E=W.multiply(3),D=I.add(O.add(E)),c=new r(D.x,D.y),I=z.multiply(-3),O=N.multiply(3),E=I.add(O),l=new r(E.x,E.y),s=new r(z.x,z.y);for(var R=h.x*h.x,it=h.x*h.x*h.x,T=h.y*h.y,nt=h.y*h.y*h.y,g=a.x*a.x,F=a.x*a.x*a.x,y=a.y*a.y,U=a.y*a.y*a.y,f=n.x*n.x,L=n.x*n.x*n.x,p=n.y*n.y,b=n.y*n.y*n.y,d=i.x*i.x,m=i.x*i.x*i.x,u=i.y*i.y,_=i.y*i.y*i.y,M=s.x*s.x,ot=s.x*s.x*s.x,S=s.y*s.y,st=s.y*s.y*s.y,w=l.x*l.x,$=l.x*l.x*l.x,x=l.y*l.y,A=c.x*c.x,tt=c.x*c.x*c.x,v=c.y*c.y,C=o.x*o.x,lt=o.x*o.x*o.x,k=o.y*o.y,et=o.y*o.y*o.y,rt=new e(-m*et+_*lt-3*i.x*u*C*o.y+3*d*i.y*o.x*k,-6*i.x*c.x*u*o.x*o.y+6*d*i.y*c.y*o.x*o.y+3*c.x*_*C-3*m*c.y*k-3*i.x*u*c.y*C+3*d*c.x*i.y*k,-6*l.x*i.x*u*o.x*o.y-6*i.x*c.x*u*c.y*o.x+6*d*c.x*i.y*c.y*o.y+3*l.x*_*C+3*A*_*o.x+3*l.x*d*i.y*k-3*i.x*l.y*u*C-3*i.x*A*u*o.y+d*i.y*o.x*(6*l.y*o.y+3*v)+m*(-l.y*k-2*v*o.y-o.y*(2*l.y*o.y+v)),a.x*n.y*i.x*i.y*o.x*o.y-a.y*n.x*i.x*i.y*o.x*o.y+6*l.x*c.x*_*o.x+3*a.x*n.x*i.x*i.y*k+6*h.x*i.x*u*o.x*o.y-3*a.x*n.x*u*o.x*o.y-3*a.y*n.y*i.x*i.y*C-6*h.y*d*i.y*o.x*o.y-6*s.x*i.x*u*o.x*o.y+3*a.y*n.y*d*o.x*o.y-2*n.x*p*i.x*o.x*o.y-6*l.x*i.x*c.x*u*o.y-6*l.x*i.x*u*c.y*o.x-6*i.x*l.y*c.x*u*o.x+6*l.x*d*i.y*c.y*o.y+2*f*n.y*i.y*o.x*o.y+tt*_-3*h.x*_*C+3*h.y*m*k+3*s.x*_*C+b*i.x*C-L*i.y*k-3*h.x*d*i.y*k+3*h.y*i.x*u*C-2*a.x*n.y*d*k+a.x*n.y*u*C-a.y*n.x*d*k+2*a.y*n.x*u*C+3*s.x*d*i.y*k-n.x*p*i.y*C-3*s.y*i.x*u*C+f*n.y*i.x*k-3*i.x*A*u*c.y+d*i.y*o.x*(6*s.y*o.y+6*l.y*c.y)+d*c.x*i.y*(6*l.y*o.y+3*v)+m*(-2*l.y*c.y*o.y-s.y*k-c.y*(2*l.y*o.y+v)-o.y*(2*s.y*o.y+2*l.y*c.y)),6*a.x*n.x*i.x*i.y*c.y*o.y+a.x*n.y*i.x*c.x*i.y*o.y+a.x*n.y*i.x*i.y*c.y*o.x-a.y*n.x*i.x*c.x*i.y*o.y-a.y*n.x*i.x*i.y*c.y*o.x-6*a.y*n.y*i.x*c.x*i.y*o.x-6*h.x*c.x*_*o.x+6*s.x*c.x*_*o.x+6*h.y*m*c.y*o.y+2*b*i.x*c.x*o.x-2*L*i.y*c.y*o.y+6*h.x*i.x*c.x*u*o.y+6*h.x*i.x*u*c.y*o.x+6*h.y*i.x*c.x*u*o.x-3*a.x*n.x*c.x*u*o.y-3*a.x*n.x*u*c.y*o.x+2*a.x*n.y*c.x*u*o.x+4*a.y*n.x*c.x*u*o.x-6*h.x*d*i.y*c.y*o.y-6*h.y*d*c.x*i.y*o.y-6*h.y*d*i.y*c.y*o.x-4*a.x*n.y*d*c.y*o.y-6*s.x*i.x*c.x*u*o.y-6*s.x*i.x*u*c.y*o.x-2*a.y*n.x*d*c.y*o.y+3*a.y*n.y*d*c.x*o.y+3*a.y*n.y*d*c.y*o.x-2*n.x*p*i.x*c.x*o.y-2*n.x*p*i.x*c.y*o.x-2*n.x*p*c.x*i.y*o.x-6*s.y*i.x*c.x*u*o.x-6*l.x*i.x*l.y*u*o.x-6*l.x*i.x*c.x*u*c.y+6*s.x*d*i.y*c.y*o.y+2*f*n.y*i.x*c.y*o.y+2*f*n.y*c.x*i.y*o.y+2*f*n.y*i.y*c.y*o.x+3*l.x*A*_+3*w*_*o.x-3*i.x*l.y*A*u-3*w*i.x*u*o.y+d*c.x*i.y*(6*s.y*o.y+6*l.y*c.y)+d*i.y*o.x*(6*s.y*c.y+3*x)+l.x*d*i.y*(6*l.y*o.y+3*v)+m*(-2*s.y*c.y*o.y-o.y*(2*s.y*c.y+x)-l.y*(2*l.y*o.y+v)-c.y*(2*s.y*o.y+2*l.y*c.y)),a.x*l.x*n.y*i.x*i.y*o.y+a.x*n.y*i.x*l.y*i.y*o.x+a.x*n.y*i.x*c.x*i.y*c.y-a.y*n.x*l.x*i.x*i.y*o.y-a.y*n.x*i.x*l.y*i.y*o.x-a.y*n.x*i.x*c.x*i.y*c.y-6*a.y*l.x*n.y*i.x*i.y*o.x-6*h.x*l.x*_*o.x+6*s.x*l.x*_*o.x+2*l.x*b*i.x*o.x+6*h.x*l.x*i.x*u*o.y+6*h.x*i.x*l.y*u*o.x+6*h.x*i.x*c.x*u*c.y+6*h.y*l.x*i.x*u*o.x-3*a.x*n.x*l.x*u*o.y-3*a.x*n.x*l.y*u*o.x-3*a.x*n.x*c.x*u*c.y+2*a.x*l.x*n.y*u*o.x+4*a.y*n.x*l.x*u*o.x-6*h.y*l.x*d*i.y*o.y-6*h.y*d*l.y*i.y*o.x-6*h.y*d*c.x*i.y*c.y-6*s.x*l.x*i.x*u*o.y-6*s.x*i.x*l.y*u*o.x-6*s.x*i.x*c.x*u*c.y+3*a.y*l.x*n.y*d*o.y-3*a.y*n.y*i.x*A*i.y+3*a.y*n.y*d*l.y*o.x+3*a.y*n.y*d*c.x*c.y-2*n.x*l.x*p*i.x*o.y-2*n.x*l.x*p*i.y*o.x-2*n.x*p*i.x*l.y*o.x-2*n.x*p*i.x*c.x*c.y-6*s.y*l.x*i.x*u*o.x-6*l.x*i.x*l.y*c.x*u+6*s.y*d*l.y*i.y*o.x+2*f*l.x*n.y*i.y*o.y+2*f*n.y*l.y*i.y*o.x+2*f*n.y*c.x*i.y*c.y-3*h.x*A*_+3*s.x*A*_+3*w*c.x*_+b*i.x*A+3*h.y*i.x*A*u+a.x*n.y*A*u+2*a.y*n.x*A*u-n.x*p*A*i.y-3*s.y*i.x*A*u-3*w*i.x*u*c.y+f*n.y*i.x*(2*l.y*o.y+v)+a.x*n.x*i.x*i.y*(6*l.y*o.y+3*v)+l.x*d*i.y*(6*s.y*o.y+6*l.y*c.y)+L*i.y*(-2*l.y*o.y-v)+h.y*m*(6*l.y*o.y+3*v)+a.y*n.x*d*(-2*l.y*o.y-v)+a.x*n.y*d*(-4*l.y*o.y-2*v)+h.x*d*i.y*(-6*l.y*o.y-3*v)+d*c.x*i.y*(6*s.y*c.y+3*x)+s.x*d*i.y*(6*l.y*o.y+3*v)+m*(-2*s.y*l.y*o.y-c.y*(2*s.y*c.y+x)-s.y*(2*l.y*o.y+v)-l.y*(2*s.y*o.y+2*l.y*c.y)),-h.x*a.x*n.y*i.x*i.y*o.y+h.x*a.y*n.x*i.x*i.y*o.y+6*h.x*a.y*n.y*i.x*i.y*o.x-6*h.y*a.x*n.x*i.x*i.y*o.y-h.y*a.x*n.y*i.x*i.y*o.x+h.y*a.y*n.x*i.x*i.y*o.x+a.x*a.y*n.x*n.y*i.x*o.y-a.x*a.y*n.x*n.y*i.y*o.x+a.x*s.x*n.y*i.x*i.y*o.y+a.x*s.y*n.y*i.x*i.y*o.x+a.x*l.x*n.y*i.x*i.y*c.y+a.x*n.y*i.x*l.y*c.x*i.y-s.x*a.y*n.x*i.x*i.y*o.y-6*s.x*a.y*n.y*i.x*i.y*o.x-a.y*n.x*s.y*i.x*i.y*o.x-a.y*n.x*l.x*i.x*i.y*c.y-a.y*n.x*i.x*l.y*c.x*i.y-6*a.y*l.x*n.y*i.x*c.x*i.y-6*h.x*s.x*_*o.x-6*h.x*l.x*c.x*_-2*h.x*b*i.x*o.x+6*s.x*l.x*c.x*_+2*s.x*b*i.x*o.x+2*l.x*b*i.x*c.x+2*h.y*L*i.y*o.y-6*h.x*h.y*i.x*u*o.x+3*h.x*a.x*n.x*u*o.y-2*h.x*a.x*n.y*u*o.x-4*h.x*a.y*n.x*u*o.x+3*h.y*a.x*n.x*u*o.x+6*h.x*h.y*d*i.y*o.y+6*h.x*s.x*i.x*u*o.y-3*h.x*a.y*n.y*d*o.y+2*h.x*n.x*p*i.x*o.y+2*h.x*n.x*p*i.y*o.x+6*h.x*s.y*i.x*u*o.x+6*h.x*l.x*i.x*u*c.y+6*h.x*i.x*l.y*c.x*u+4*h.y*a.x*n.y*d*o.y+6*h.y*s.x*i.x*u*o.x+2*h.y*a.y*n.x*d*o.y-3*h.y*a.y*n.y*d*o.x+2*h.y*n.x*p*i.x*o.x+6*h.y*l.x*i.x*c.x*u-3*a.x*s.x*n.x*u*o.y+2*a.x*s.x*n.y*u*o.x+a.x*a.y*p*i.x*o.x-3*a.x*n.x*s.y*u*o.x-3*a.x*n.x*l.x*u*c.y-3*a.x*n.x*l.y*c.x*u+2*a.x*l.x*n.y*c.x*u+4*s.x*a.y*n.x*u*o.x+4*a.y*n.x*l.x*c.x*u-2*h.x*f*n.y*i.y*o.y-6*h.y*s.x*d*i.y*o.y-6*h.y*s.y*d*i.y*o.x-6*h.y*l.x*d*i.y*c.y-2*h.y*f*n.y*i.x*o.y-2*h.y*f*n.y*i.y*o.x-6*h.y*d*l.y*c.x*i.y-a.x*a.y*f*i.y*o.y-2*a.x*y*i.x*i.y*o.x+3*s.x*a.y*n.y*d*o.y-2*s.x*n.x*p*i.x*o.y-2*s.x*n.x*p*i.y*o.x-6*s.x*s.y*i.x*u*o.x-6*s.x*l.x*i.x*u*c.y-6*s.x*i.x*l.y*c.x*u+3*a.y*s.y*n.y*d*o.x+3*a.y*l.x*n.y*d*c.y+3*a.y*n.y*d*l.y*c.x-2*n.x*s.y*p*i.x*o.x-2*n.x*l.x*p*i.x*c.y-2*n.x*l.x*p*c.x*i.y-2*n.x*p*i.x*l.y*c.x-6*s.y*l.x*i.x*c.x*u-y*n.x*n.y*i.x*o.x+2*s.x*f*n.y*i.y*o.y+6*s.y*d*l.y*c.x*i.y+2*g*a.y*i.x*i.y*o.y+g*n.x*n.y*i.y*o.y+2*f*s.y*n.y*i.y*o.x+2*f*l.x*n.y*i.y*c.y+2*f*n.y*l.y*c.x*i.y+$*_+3*R*_*o.x-3*T*m*o.y+3*M*_*o.x+U*d*o.x-F*u*o.y-a.x*y*d*o.y+g*a.y*u*o.x-3*R*i.x*u*o.y+3*T*d*i.y*o.x-g*p*i.x*o.y+y*f*i.y*o.x-3*w*i.x*l.y*u-3*M*i.x*u*o.y+3*S*d*i.y*o.x+a.x*n.x*i.x*i.y*(6*s.y*o.y+6*l.y*c.y)+L*i.y*(-2*s.y*o.y-2*l.y*c.y)+h.y*m*(6*s.y*o.y+6*l.y*c.y)+a.y*n.x*d*(-2*s.y*o.y-2*l.y*c.y)+f*n.y*i.x*(2*s.y*o.y+2*l.y*c.y)+a.x*n.y*d*(-4*s.y*o.y-4*l.y*c.y)+h.x*d*i.y*(-6*s.y*o.y-6*l.y*c.y)+s.x*d*i.y*(6*s.y*o.y+6*l.y*c.y)+l.x*d*i.y*(6*s.y*c.y+3*x)+m*(-2*s.y*l.y*c.y-S*o.y-l.y*(2*s.y*c.y+x)-s.y*(2*s.y*o.y+2*l.y*c.y)),-h.x*a.x*n.y*i.x*i.y*c.y+h.x*a.y*n.x*i.x*i.y*c.y+6*h.x*a.y*n.y*i.x*c.x*i.y-6*h.y*a.x*n.x*i.x*i.y*c.y-h.y*a.x*n.y*i.x*c.x*i.y+h.y*a.y*n.x*i.x*c.x*i.y+a.x*a.y*n.x*n.y*i.x*c.y-a.x*a.y*n.x*n.y*c.x*i.y+a.x*s.x*n.y*i.x*i.y*c.y+a.x*s.y*n.y*i.x*c.x*i.y+a.x*l.x*n.y*i.x*l.y*i.y-s.x*a.y*n.x*i.x*i.y*c.y-6*s.x*a.y*n.y*i.x*c.x*i.y-a.y*n.x*s.y*i.x*c.x*i.y-a.y*n.x*l.x*i.x*l.y*i.y-6*h.x*s.x*c.x*_-2*h.x*b*i.x*c.x+2*s.x*b*i.x*c.x+2*h.y*L*i.y*c.y-6*h.x*h.y*i.x*c.x*u+3*h.x*a.x*n.x*u*c.y-2*h.x*a.x*n.y*c.x*u-4*h.x*a.y*n.x*c.x*u+3*h.y*a.x*n.x*c.x*u+6*h.x*h.y*d*i.y*c.y+6*h.x*s.x*i.x*u*c.y-3*h.x*a.y*n.y*d*c.y+2*h.x*n.x*p*i.x*c.y+2*h.x*n.x*p*c.x*i.y+6*h.x*s.y*i.x*c.x*u+6*h.x*l.x*i.x*l.y*u+4*h.y*a.x*n.y*d*c.y+6*h.y*s.x*i.x*c.x*u+2*h.y*a.y*n.x*d*c.y-3*h.y*a.y*n.y*d*c.x+2*h.y*n.x*p*i.x*c.x-3*a.x*s.x*n.x*u*c.y+2*a.x*s.x*n.y*c.x*u+a.x*a.y*p*i.x*c.x-3*a.x*n.x*s.y*c.x*u-3*a.x*n.x*l.x*l.y*u+4*s.x*a.y*n.x*c.x*u-2*h.x*f*n.y*i.y*c.y-6*h.y*s.x*d*i.y*c.y-6*h.y*s.y*d*c.x*i.y-6*h.y*l.x*d*l.y*i.y-2*h.y*f*n.y*i.x*c.y-2*h.y*f*n.y*c.x*i.y-a.x*a.y*f*i.y*c.y-2*a.x*y*i.x*c.x*i.y+3*s.x*a.y*n.y*d*c.y-2*s.x*n.x*p*i.x*c.y-2*s.x*n.x*p*c.x*i.y-6*s.x*s.y*i.x*c.x*u-6*s.x*l.x*i.x*l.y*u+3*a.y*s.y*n.y*d*c.x+3*a.y*l.x*n.y*d*l.y-2*n.x*s.y*p*i.x*c.x-2*n.x*l.x*p*i.x*l.y-y*n.x*n.y*i.x*c.x+2*s.x*f*n.y*i.y*c.y-3*a.y*w*n.y*i.x*i.y+6*s.y*l.x*d*l.y*i.y+2*g*a.y*i.x*i.y*c.y+g*n.x*n.y*i.y*c.y+2*f*s.y*n.y*c.x*i.y+2*f*l.x*n.y*l.y*i.y-3*h.x*w*_+3*s.x*w*_+3*R*c.x*_-3*T*m*c.y+3*M*c.x*_+w*b*i.x+U*d*c.x-F*u*c.y+3*h.y*w*i.x*u-a.x*y*d*c.y+a.x*w*n.y*u+2*a.y*n.x*w*u+g*a.y*c.x*u-n.x*w*p*i.y-3*s.y*w*i.x*u-3*R*i.x*u*c.y+3*T*d*c.x*i.y-g*p*i.x*c.y+y*f*c.x*i.y-3*M*i.x*u*c.y+3*S*d*c.x*i.y+f*n.y*i.x*(2*s.y*c.y+x)+a.x*n.x*i.x*i.y*(6*s.y*c.y+3*x)+L*i.y*(-2*s.y*c.y-x)+h.y*m*(6*s.y*c.y+3*x)+a.y*n.x*d*(-2*s.y*c.y-x)+a.x*n.y*d*(-4*s.y*c.y-2*x)+h.x*d*i.y*(-6*s.y*c.y-3*x)+s.x*d*i.y*(6*s.y*c.y+3*x)+m*(-2*s.y*x-S*c.y-s.y*(2*s.y*c.y+x)),-h.x*a.x*n.y*i.x*l.y*i.y+h.x*a.y*n.x*i.x*l.y*i.y+6*h.x*a.y*l.x*n.y*i.x*i.y-6*h.y*a.x*n.x*i.x*l.y*i.y-h.y*a.x*l.x*n.y*i.x*i.y+h.y*a.y*n.x*l.x*i.x*i.y-a.x*a.y*n.x*l.x*n.y*i.y+a.x*a.y*n.x*n.y*i.x*l.y+a.x*s.x*n.y*i.x*l.y*i.y+6*a.x*n.x*s.y*i.x*l.y*i.y+a.x*s.y*l.x*n.y*i.x*i.y-s.x*a.y*n.x*i.x*l.y*i.y-6*s.x*a.y*l.x*n.y*i.x*i.y-a.y*n.x*s.y*l.x*i.x*i.y-6*h.x*s.x*l.x*_-2*h.x*l.x*b*i.x+6*h.y*s.y*m*l.y+2*s.x*l.x*b*i.x+2*h.y*L*l.y*i.y-2*L*s.y*l.y*i.y-6*h.x*h.y*l.x*i.x*u+3*h.x*a.x*n.x*l.y*u-2*h.x*a.x*l.x*n.y*u-4*h.x*a.y*n.x*l.x*u+3*h.y*a.x*n.x*l.x*u+6*h.x*h.y*d*l.y*i.y+6*h.x*s.x*i.x*l.y*u-3*h.x*a.y*n.y*d*l.y+2*h.x*n.x*l.x*p*i.y+2*h.x*n.x*p*i.x*l.y+6*h.x*s.y*l.x*i.x*u+4*h.y*a.x*n.y*d*l.y+6*h.y*s.x*l.x*i.x*u+2*h.y*a.y*n.x*d*l.y-3*h.y*a.y*l.x*n.y*d+2*h.y*n.x*l.x*p*i.x-3*a.x*s.x*n.x*l.y*u+2*a.x*s.x*l.x*n.y*u+a.x*a.y*l.x*p*i.x-3*a.x*n.x*s.y*l.x*u+4*s.x*a.y*n.x*l.x*u-6*h.x*s.y*d*l.y*i.y-2*h.x*f*n.y*l.y*i.y-6*h.y*s.x*d*l.y*i.y-6*h.y*s.y*l.x*d*i.y-2*h.y*f*l.x*n.y*i.y-2*h.y*f*n.y*i.x*l.y-a.x*a.y*f*l.y*i.y-4*a.x*s.y*n.y*d*l.y-2*a.x*y*l.x*i.x*i.y+3*s.x*a.y*n.y*d*l.y-2*s.x*n.x*l.x*p*i.y-2*s.x*n.x*p*i.x*l.y-6*s.x*s.y*l.x*i.x*u-2*a.y*n.x*s.y*d*l.y+3*a.y*s.y*l.x*n.y*d-2*n.x*s.y*l.x*p*i.x-y*n.x*l.x*n.y*i.x+6*s.x*s.y*d*l.y*i.y+2*s.x*f*n.y*l.y*i.y+2*g*a.y*i.x*l.y*i.y+g*n.x*n.y*l.y*i.y+2*f*s.y*l.x*n.y*i.y+2*f*s.y*n.y*i.x*l.y+3*R*l.x*_-3*T*m*l.y+3*M*l.x*_+U*l.x*d-F*l.y*u-3*S*m*l.y-a.x*y*d*l.y+g*a.y*l.x*u-3*R*i.x*l.y*u+3*T*l.x*d*i.y-g*p*i.x*l.y+y*f*l.x*i.y-3*M*i.x*l.y*u+3*S*l.x*d*i.y,h.x*h.y*a.x*n.y*i.x*i.y-h.x*h.y*a.y*n.x*i.x*i.y+h.x*a.x*a.y*n.x*n.y*i.y-h.y*a.x*a.y*n.x*n.y*i.x-h.x*a.x*s.y*n.y*i.x*i.y+6*h.x*s.x*a.y*n.y*i.x*i.y+h.x*a.y*n.x*s.y*i.x*i.y-h.y*a.x*s.x*n.y*i.x*i.y-6*h.y*a.x*n.x*s.y*i.x*i.y+h.y*s.x*a.y*n.x*i.x*i.y-a.x*s.x*a.y*n.x*n.y*i.y+a.x*a.y*n.x*s.y*n.y*i.x+a.x*s.x*s.y*n.y*i.x*i.y-s.x*a.y*n.x*s.y*i.x*i.y-2*h.x*s.x*b*i.x+2*h.y*L*s.y*i.y-3*h.x*h.y*a.x*n.x*u-6*h.x*h.y*s.x*i.x*u+3*h.x*h.y*a.y*n.y*d-2*h.x*h.y*n.x*p*i.x-2*h.x*a.x*s.x*n.y*u-h.x*a.x*a.y*p*i.x+3*h.x*a.x*n.x*s.y*u-4*h.x*s.x*a.y*n.x*u+3*h.y*a.x*s.x*n.x*u+6*h.x*h.y*s.y*d*i.y+2*h.x*h.y*f*n.y*i.y+2*h.x*a.x*y*i.x*i.y+2*h.x*s.x*n.x*p*i.y+6*h.x*s.x*s.y*i.x*u-3*h.x*a.y*s.y*n.y*d+2*h.x*n.x*s.y*p*i.x+h.x*y*n.x*n.y*i.x+h.y*a.x*a.y*f*i.y+4*h.y*a.x*s.y*n.y*d-3*h.y*s.x*a.y*n.y*d+2*h.y*s.x*n.x*p*i.x+2*h.y*a.y*n.x*s.y*d+a.x*s.x*a.y*p*i.x-3*a.x*s.x*n.x*s.y*u-2*h.x*f*s.y*n.y*i.y-6*h.y*s.x*s.y*d*i.y-2*h.y*s.x*f*n.y*i.y-2*h.y*g*a.y*i.x*i.y-h.y*g*n.x*n.y*i.y-2*h.y*f*s.y*n.y*i.x-2*a.x*s.x*y*i.x*i.y-a.x*a.y*f*s.y*i.y+3*s.x*a.y*s.y*n.y*d-2*s.x*n.x*s.y*p*i.x-s.x*y*n.x*n.y*i.x+3*T*a.x*n.x*i.x*i.y+3*a.x*n.x*S*i.x*i.y+2*s.x*f*s.y*n.y*i.y-3*R*a.y*n.y*i.x*i.y+2*g*a.y*s.y*i.x*i.y+g*n.x*s.y*n.y*i.y-3*M*a.y*n.y*i.x*i.y-it*_+nt*m+ot*_-st*m-3*h.x*M*_-h.x*U*d+3*R*s.x*_+h.y*F*u+3*h.y*S*m+s.x*U*d+R*b*i.x-3*T*s.y*m-T*L*i.y+M*b*i.x-F*s.y*u-L*S*i.y-h.x*g*a.y*u+h.y*a.x*y*d-3*h.x*T*d*i.y-h.x*y*f*i.y+h.y*g*p*i.x-a.x*y*s.y*d+3*R*h.y*i.x*u+R*a.x*n.y*u+2*R*a.y*n.x*u-2*T*a.x*n.y*d-T*a.y*n.x*d+g*s.x*a.y*u-3*h.x*S*d*i.y+3*h.y*M*i.x*u+a.x*M*n.y*u-2*a.x*S*n.y*d+s.x*y*f*i.y-a.y*n.x*S*d-R*n.x*p*i.y-3*R*s.y*i.x*u+3*T*s.x*d*i.y+T*f*n.y*i.x-g*s.y*p*i.x+2*M*a.y*n.x*u+3*s.x*S*d*i.y-M*n.x*p*i.y-3*M*s.y*i.x*u+f*S*n.y*i.x),Z=rt.getRootsInInterval(0,1),Y=0;Y<Z.length;Y++){var P=Z[Y],V=new e(i.x,n.x,a.x,h.x-s.x-P*l.x-P*P*c.x-P*P*P*o.x).getRoots(),Q=new e(i.y,n.y,a.y,h.y-s.y-P*l.y-P*P*c.y-P*P*P*o.y).getRoots();if(!(V.length<=0||Q.length<=0))for(var at=1e-4,J=0;J<V.length;J++){var H=V[J];if(H>=0&&1>=H)for(var q=0;q<Q.length;q++)if(Math.abs(H-Q[q])<at)return!0}}return!1},n}function f(r){if(this==window)return new f(r);var e=this,i=void 0,r=r||{};return e.gs=r.gs,e.ad_network=r.ad_network,e.init=function(){if("admob"==e.ad_network&&(i=window.plugins.AdMob,e.onPresentInterstitialAd="onPresentInterstitialAd",e.onReceiveInterstitialAd="onReceiveInterstitialAd",e.onDismissInterstitialAd="onDismissInterstitialAd"),"mopub"==e.ad_network){if(i=window.plugins.MoPub,"undefined"==typeof i)return"admob"==e.ad_network,void e.init();e.onPresentInterstitialAd="onInterstitialPresent",e.onReceiveInterstitialAd="onInterstitialReceive",e.onDismissInterstitialAd="onInterstitialDismiss"}if("flurry"==e.ad_network){if(i=window.plugins.Flurry,"undefined"==typeof i)return"admob"==e.ad_network,void e.init();e.onPresentInterstitialAd="onPresentAd",e.onReceiveInterstitialAd="onReceiveAd",e.onDismissInterstitialAd="onDismissAd"}if("adbuddiz"==e.ad_network){if(i=window.plugins.AdBuddizPlugin,"undefined"==typeof i)return"admob"==e.ad_network,void e.init();e.onPresentInterstitialAd="onPresentInterstitialAd",e.onReceiveInterstitialAd="onReceiveInterstitialAd",e.onDismissInterstitialAd="onDismissInterstitialAd"}e.get_interstitial_options=function(){if("admob"==e.ad_network){var t="ca-app-pub-5419784921619686/9765547854",i="ca-app-pub-5419784921619686/5195747455";e.ad_id=Math.random()>.5?i:t}return"mopub"==e.ad_network&&(e.ad_id="e92b233b5d55427ab4a760a0eb027cd2"),"flurry"==e.ad_network&&(e.ad_id="Q2HW4NQTG4S9R5FNXF25"),"adbuddiz"==e.ad_network&&(e.ad_id="eca32c1d-a162-4c0a-96bc-20ddefb9662a"),{adId:e.ad_id,isTesting:!1,autoShow:!1}},e.create_interstitial(),document.addEventListener(e.onPresentInterstitialAd,e.on_present_interstitial_ad),document.addEventListener(e.onReceiveInterstitialAd,e.on_receive_interstitial_ad),document.addEventListener(e.onDismissInterstitialAd,e.on_dismiss_interstitial_ad),window.addEventListener("orientationchange",e.orientationchange),window.addEventListener("beforeunload",function(){"undefined"!=typeof e&&e.destroy()})},e.on_present_interstitial_ad=function(t){t.ad_network||(t.ad_network="admob"),t.ad_network==e.ad_network&&(e.displayed=!0,e.ondisplay&&e.ondisplay())},e.on_receive_interstitial_ad=function(t){t.ad_network||(t.ad_network="admob"),t.ad_network==e.ad_network&&(e.loaded=!0)},e.on_dismiss_interstitial_ad=function(t){t.ad_network||(t.ad_network="admob"),t.ad_network==e.ad_network&&(e.displayed=!1,e.loaded=!1,e.callback())},e.orientationchange=function(){function t(){return e.displayed?void setTimeout(t,50):(e.loaded=!1,void e.create_interstitial())}t()},e.destroy=function(){document.removeEventListener(e.onPresentInterstitialAd,e.on_present_interstitial_ad),document.removeEventListener(e.onReceiveInterstitialAd,e.on_receive_interstitial_ad),document.removeEventListener(e.onDismissInterstitialAd,e.on_dismiss_interstitial_ad),window.removeEventListener("orientationchange",e.orientationchange),i&&i.destroyInterstitialView&&i.destroyInterstitialView()},e.run=function(){e.running=!0,e.callback=function(){e.create_interstitial(),e.running=!1},e.loaded?(s&&t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.gs.DEBUG?"-beta":"")+".php?action=log_ad_show&screen_name=interstitial_ad&device_uuid="+device.uuid+"&ad_id="+e.ad_id,request_method:"POST",async:!0}),i&&i.showInterstitialAd()):i&&e.callback(),e.onrun&&e.onrun()},e.create_interstitial=function(){i&&i.createInterstitialView(e.get_interstitial_options(),function(){},function(){})},e}function ht(a){function u(){if(e.ambient_music.load_ambient_music(i.ambient_music,i.ambient_music_start),"undefined"!=typeof i.intro_audio&&""!=i.intro_audio){var o=document.createElement("div");o.style.display="none",r.appendChild(o);var d=e.get_set_directory(l)+"/"+i.intro_audio+".ogg";e.playAudio(d,{element:o,audio_type:"music",restart:!0})}r.innerHTML=c,r.children.forEach(function(e){n(e)}),"undefined"!=typeof i.intro_audio&&""!=i.intro_audio&&r.appendChild(o);var t=r.querySelector("span"),a=r.querySelector(".jt-game-header");if(null!=a&&(t.style.display="none",C({image:a,fix_ie_bug:!0,color:"#edd9a7",callback:function(e){a.parentNode.appendChild(e),a.parentNode.removeChild(a),a=e,e.style.height="100%",t.style.display="block"}})),void function(){function i(t){return"/"==t[0]?e.get_root_directory()+t:e.get_set_directory(l)+"/gui/front/"+t}var n=t.querySelectorAll("*"),r=Array.prototype.slice.call(n);r.push(t),r.forEach(function(t){var r=t.getAttribute("src");null!=r&&""!=r&&t.setAttribute("src",i(r));var e=xt(window.getComputedStyle(t).backgroundImage);""!=e&&"none"!=e&&(e=e.replace('url("',"").replace('")',""),e=e.replace("url('","").replace("')",""),e=e.replace("url(","").replace(")",""),e=e.substr(e.lastIndexOf("/")+1),t.style.backgroundImage='url("'+i(e)+'")')})}(),t.classList.add("jt-select_mode_screen-container"),"undefined"!=typeof i.mixnmatch){var h=document.createElement("div");h.className="jt-select_mode_screen-mixnmatch jt-button",h.innerHTML="Play Mix N' Match",t.appendChild(h),h.addEventListener(e.events.POINT,function(){s("mixnmatch")})}if("undefined"!=typeof i.jigsaw){var u=document.createElement("div");u.className="jt-select_mode_screen-jigsaw jt-button",u.innerHTML="Play Jigsaw",t.appendChild(u),u.addEventListener(e.events.POINT,function(){s("select_jigsaw")}),setTimeout(function(){s("select_jigsaw")},2500)}}function s(t){function i(t){1!=e.DEBUG&&e.challenge_code_request_asked||"undefined"==typeof e.account.internal_access_token?t():y({gs:e,callback:t,extra_text:" (You can also enter it later via the main menu)"})}function r(i){if(e.ambient_music_on_question_asked)i();else{var t=smoke.confirm('Keep ambient music on? (you can change this later by toggling "Audio Settings" > "Play Ambient Music".',function(t){e.ambient_music_on_question_asked=!0,e.ambient_music_on=t,i()});t.buttons.ok.innerHTML="Keep ambient music on.",t.buttons.cancel.innerHTML="Turn ambient music off.",n(t.buttons)}}function a(){o.history_control.load_page({page:t})}h||(h=!0,i(function(){r(a)}))}var r=a.content_div,o=a.mr_jigtato,i=o.game_data,l=o.set_name,e=a.global_settings;t({success:function(e){c=e,u()},error:e.errormessage,file:e.get_set_directory(l)+"/gui/front/front.htm",plaintext:!0,request_method:"GET"});var c="",h=!1}function ut(s){function u(){function A(){var t="undefined"==typeof e.account.gem_amount?"--":e.account.gem_amount;v.innerHTML=0!=e.version_code||e.version_code&&e.version_code<158?'<span style="position:relative; margin-left: 18px; top: -6px; line-height: 0; font-family:lato; font-size: 60px; vertical-align: middle">'+t+'</span><span style="position:relative; top: -3px; line-height: 0; font-family: flyingsoft-icons; font-size: 106px; vertical-align: middle">g</span>':"<span>"+t+'</span><span class="jt-gem">g</span>',u.setTimeout(A,5e3)}function P(){h({gs:e,error:function(){smoke.alert("You must log in to Google Play to use this feature!")},success:function(){j()}})}function j(){function p(a){var r=a.currentTarget,i=r.product,n=r.product.id;i.owned||i.state!=store.REGISTERED&&i.state!=store.INVALID&&(i.canPurchase||!i.owned)&&("gems"==n.substr(0,4)&&e.get_gem_purchased_amount({success:function(t){store.order(i.id,JSON.stringify({user_id:e.account.user_id,gem_purchased_amount:t}))}}),"ad_removal"==n&&(store.order(i.id,JSON.stringify({user_id:e.account.user_id})),i.finish_single_use_callback=t.update_text))}var d=smoke.alert("");e.gem_screen_not_opened&&(e.gem_screen_not_opened=!1,e.log_user_action("Gem screen: opened."));var i=d.dialog.text;i.classList.add("jt-iap");var n=document.createElement("div");n.className="jt-iap-title_text",i.appendChild(n),void function(){function t(){n.innerHTML="Use gems to acquire puzzle packs. You currently have "+e.account.gem_amount+" gems.",n.isAttached()||clearInterval(i)}var i=setInterval(t,500);t()}();var s=document.createElement("div");if(s.className="jt-button jt-iap-title_text",s.innerHTML="Get 10 gems for every friend who installs!",i.appendChild(s),s.addEventListener(e.events.POINT,function(){d.ok(),a.challenge_a_friend_button.toggle()}),e.IS_CORDOVA&&window.store){var o=document.createElement("div");o.className="jt-iap-button_area",i.appendChild(o);var r=e.google_play_store.product_list,_=[r.gems_10,r.gems_50,r.gems_30,r.gems_100],t=document.createElement("div");t.className="jt-button jt-iap-button_area-ad_removal_button",o.appendChild(t);var f=t.product=r.ad_removal;t.update_text=function(){t.innerHTML=e.account.purchased_ad_removal?"Thank you for your purchase: ads have been removed from the game.":f.description+": "+f.price+"."},t.update_text(),t.addEventListener(e.events.POINT,p);var h=document.createElement("div");h.className="jt-iap-button_area-gem_area",o.appendChild(h);var l,u=0;_.forEach(function(i){if("gems"==i.id.substr(0,4)){0==u&&(l=document.createElement("div"),l.className="jt-iap-button_area-gem_area-button_row",h.appendChild(l)),u=(u+1)%2;var t=document.createElement("div");t.className="jt-button jt-iap-button_area-gem_area-button_row-button",l.appendChild(t);var r=document.createElement("div");r.className="jt-iap-button_area-gem_area-button_row-button-title";var n=document.createElement("div");n.className="jt-gem jt-iap-button_area-gem_area-button_row-button-title-gem",n.innerHTML="g",r.appendChild(n),r.innerHTML+=i.description,t.appendChild(r);var a=document.createElement("div");a.className="jt-iap-button_area-gem_area-button_row-button-price",a.innerHTML=i.price,t.appendChild(a),t.product=i,t.addEventListener(e.events.POINT,p)}})}else if(e.IS_CORDOVA){var c=document.createElement("div");c.className="jt-iap-title_text",c.innerHTML="Note: this version doesn't support purchases. Please upgrade your game version.",i.appendChild(c)}}function w(s){s.selection_tab_container.children.forEach(function(e){if(e.tab_index==s.page)var t="add";else var t="remove";e.classList[t]("jt-button-lit")}),g.innerHTML="";var d=e.select_menu_current_page[i][f]=s.page;e.select_menu_current_page=e.select_menu_current_page;var h=s.level_array,o=s.items_per_page,_=d*o,l=(d+1)*o-1;h.length-1<l&&(l=h.length-1);for(var u=0,c=_;l>=c;c++){var m=h[c],t=document.createElement("div");t.className="jt-select_screen-selection-item",u%(o/2)==0&&(t.style.marginLeft=0),u%(o/2)==1&&(t.style.marginRight=0),u+=1;var y=t.level_id=m.level_id;t.addEventListener(e.events.POINT,p),t.select_screen=a,g.appendChild(t),n(t),t.image_wrapper=document.createElement("div"),t.image_wrapper.className="jt-select_screen-selection-item-image_wrapper",t.appendChild(t.image_wrapper),t.image=a.make_new_selection_image(y),t.image_wrapper.appendChild(t.image);var r=t.rewards_container={};r.top=document.createElement("div"),r.top.className="jt-select_screen-selection-item-rewards-container-top",t.image_wrapper.appendChild(r.top),r.bottom=document.createElement("div"),r.bottom.className="jt-select_screen-selection-item-rewards-container-bottom",t.appendChild(r.bottom)}D(g)}function D(n){{var r=t.player_data;r.selected_difficulty}n.children.forEach(function(n){var _=n.rewards_container.top;_.innerHTML="";var f=n.rewards_container.bottom;f.innerHTML="";var o=n.level_id,g=d.entry_list[o];if(g.reward_container)var T=g.reward_container;else var T=o;var c=[],w=!1;Array.prototype.slice.call([0,1,2,3]).forEach(function(e){c[e]=r.jigsaw.trophies.find(function(t){return t==T+"|"+e}),"undefined"!=typeof c[e]&&(w=!0)});var h=r.jigsaw.ranks[o],s="undefined"!=typeof h;if(e["gray-filter_incomplete_images"]){n.classList[s?"remove":"add"]("jt-select_screen-selection-item-greyed_out"),n.image_wrapper.classList[s?"add":"remove"]("jt-select_screen-selection-item-image_wrapper-greyed_out"),e.get_image(n.image,i,o,"mini"+(s?"":"-grey"));var v=n.image.complete;v||n.image.addEventListener("error",function(){n.image.style.display="none",n.image.addEventListener("load",function(){n.image.style.display="";localStorage["image_is_not_local_cache.mini"+(s?"":"-grey")]})})}if(s||"undefined"!=typeof c)for(var a=0;4>a;a++){if("undefined"!=typeof c&&"undefined"!=typeof c[a]){var y=E({mr_jigtato:t,gs:e,set_name:i,level_id:o,difficulty_level:a,trophy_class:"jt-select_screen-selection-item-rewards-trophy"});f.appendChild(y)}if("undefined"!=typeof h&&"undefined"!=typeof h[a]){var p=document.createElement("div");p.className="jt-select_screen-selection-item-rewards-rank_token_wrapper",_.appendChild(p);for(var x=h[a],b=l.rank[l.difficulty_levels[a].name],m=0;x>m;m++){var u=document.createElement("div");u.className="jt-select_screen-selection-item-rewards-rank_token",p.appendChild(u),u.style.backgroundImage='url("'+e.get_set_directory(i)+"/gui/"+b.filename+'")'}}}})}1==t.first_run&&t.load_player_data_from_server();var a={};a.make_new_selection_image=function(e){var t=document.createElement("img");return t.className="jt-select_screen-selection-item-image-"+("undefined"==typeof r[e].crop_margin?"centered":"cropped"),"undefined"!=typeof r[e].crop_margin&&(t.style.marginLeft=-r[e].crop_margin+"%"),"undefined"!=typeof r[e].top&&(t.style.top=-r[e].top+"%"),"undefined"!=typeof r[e].height&&(t.style.height=r[e].height+"%"),t},o.innerHTML="";var u=a.header=document.createElement("div");u.className="jt-select_screen-header",o.appendChild(u),n(u);var x=a.body=document.createElement("div");x.className="jt-select_screen-body",o.appendChild(x),u.icon_list=document.createElement("div"),u.icon_list.className="jt-select_screen-header-icon_list",u.appendChild(u.icon_list);var O=[t.menu.generic.about,t.menu.generic.ogle_trophies,t.menu.jigsaw.toggle_categories,t.menu.jigsaw.open_misc_config_menu,t.menu.jigsaw.open_visual_settings_menu,t.menu.generic.open_audio_settings_menu],I=S({gs:e,parent:o,menu_item_list:O,column_size:3,show_hint_image_options:!0,select_screen:a,init:s}),_=(z({parent:u.icon_list,target:I,menu_class:["jt-select_screen-menu_button"],init:s}),[]);"undefined"==typeof e.select_menu_sort_index[i]&&(e.select_menu_sort_index[i]=0),"undefined"==typeof e.select_menu_sort_direction[i]&&(e.select_menu_sort_direction[i]=0);var b=a.sort_button=Z({parent:u.icon_list,menu_class:"jt-common-menu_button jt-select_screen-sort_button",sort_attributes:t.game_data.sort_attributes,entry_list:r,level_array:_,level_id:"level_id",sort_index:e.select_menu_sort_index,sort_direction:e.select_menu_sort_direction,set_name:t.set_name,gs:e}),T=t.player_data,m=a.difficulty_level_button=document.createElement("div");m.className="jt-select_screen-header-difficulty_level jt-select_screen-header-size-1 jt-button hoverable",u.appendChild(m),m.update_text=function(){this.innerHTML=l.difficulty_levels[T.selected_difficulty].name.capitalize()},m.update_text(),m.addEventListener(e.events.POINT,function(){var e=l.difficulty_levels.length;T.selected_difficulty=(T.selected_difficulty+1)%e,localStorage.player_data=JSON.stringify(t.player_data),m.update_text()});var R=a.challenge_a_friend_button=mt({select_screen:a,content_div:o,mr_jigtato:t,gs:e});u.appendChild(R);var L=a.my_packs_button=dt({select_screen:a,content_div:o,mr_jigtato:t,gs:e});u.appendChild(L);var v=a.gem_purchase_button=document.createElement("div");v.className="jt-select_screen-header-show_hint_image jt-select_screen-header-size-1 jt-gem_amount_container jt-button hoverable",v.addEventListener(e.events.POINT,P),u.appendChild(v),A(),void function(){var n=t.game_data.category_list;if("undefined"==typeof e.select_menu_current_category[i]){var r=[];for(var a in n)r.push(a);e.select_menu_current_category[i]=r[Math.floor(Math.random()*r.length)]}}();var f=e.select_menu_current_category[i];"object"!=typeof e.select_menu_current_page[i]&&(e.select_menu_current_page[i]={}),"undefined"==typeof e.select_menu_current_page[i][f]&&(e.select_menu_current_page[i][f]=0);var y=12,C=a.create_puzzle_selection_array=function(){_.splice(0,_.length);for(var t in r){var e=r[t];e.level_id=t,e.is_only_template||(e.enabled||0!=!!e.predownloaded)&&e.category==f&&_.push(e)}};C();var g=a.selection_container=document.createElement("div");g.className="jt-select_screen-selection-container",x.appendChild(g);var B=a.create_tab_container=function(r){function l(){var n=t.game_data.category_list,r=[];for(var a in n)r.push(a);var l=r.indexOf(e.select_menu_current_category[i]);e.select_menu_current_category[i]=r[(l+1)%r.length],e.select_menu_current_category=e.select_menu_current_category,f=e.select_menu_current_category[i],"undefined"==typeof e.select_menu_current_page[i][f]&&(e.select_menu_current_page[i][f]=0),s.innerHTML=n[f].shortcut,C(),o(),b.sort_levels()}function o(){a.children.forEach(function(e){e!=s&&a.removeChild(e)});var o=Math.ceil(r.item_list.length/r.items_per_page);1==o&&(o=0);for(var l=0;o>l;l++){var i=document.createElement("div");i.className="jt-button",n(i),a.appendChild(i),i.innerHTML=l+1,i.tab_index=l,r.select_function&&i.addEventListener(e.events.POINT,c)}if(0==o){var d=t.game_data.category_list,u=0;for(var p in d)if(u+=1,u>1)break;1==u&&h.classList.add("jt-select_screen-selection-container-center")}}function c(e){r.select_function({page:e.currentTarget.tab_index,selection_tab_container:a})}var h=r.selection_container,a=document.createElement("div");if(a.className="jt-select_screen-selection-tab_container",r.parent.appendChild(a),"undefined"==typeof r.use_category_selection_tab||1==r.use_category_selection_tab){var s=document.createElement("div");s.className="jt-button",n(s),a.appendChild(s),s.addEventListener(e.events.POINT,l),s.innerHTML=t.game_data.category_list[f].shortcut}return o(),a},F=a.create_selection_tab_container=function(){a.selection_tab_container=B({parent:x,selection_container:g,item_list:_,items_per_page:y,select_function:function(e){w(M(e,{level_array:_,items_per_page:y}))}})};F(),b.onsort=function(){w({page:e.select_menu_current_page[i][f],level_array:_,items_per_page:y,selection_tab_container:a.selection_tab_container})},b.sort_levels();a.refresh_puzzle_list=function(){w({page:0,level_array:_,items_per_page:y,selection_tab_container:a.selection_tab_container})};if("undefined"!=typeof e.pending_message){var k=smoke.alert(e.pending_message);k.dialog.text.style.textIndent="1em",k.dialog.text.style.textAlign="left",delete e.pending_message}c&&c()}function p(i){function n(){e.try_requesting_fullscreen&&!e.IS_WEBVIEW&&e.is_phone_or_tablet&&F(document.documentElement);var r=i.currentTarget.level_id;t.history_control.load_page({page:"jigsaw",level:r})}i.stopPropagation(),i.preventDefault();var i=a(i),r=i.currentTarget.select_screen;return r.challenge_a_friend_button.is_active?(e.log_user_action("Tell-a-friend: puzzle selected."),void r.challenge_a_friend_button.select_puzzle(i.currentTarget)):void n()}var o=s.content_div,t=s.mr_jigtato,e=s.global_settings,d=t.game_data,r=t.game_data.entry_list,l=t.game_data.jigsaw,i=t.set_name;if("undefined"!=typeof s.callback){var c=s.callback;delete s.callback}e.game_type="jigsaw",e.ambient_music.load_ambient_music(t.game_data.ambient_music,t.game_data.ambient_music_start),(new Image).setAttribute("src",t.background_image_url),(new Image).setAttribute("src",e.get_set_directory(t.set_name)+"/gui/gui-loading.png"),u()}function dt(l){function p(){r.selection_container.style.display="none",r.selection_tab_container.style.display="none",a.initialized||(a.initialized=!0,d()),a.selection_container.style.display="",a.selection_tab_container.style.display=""}function f(){r.selection_container.style.display="",r.selection_tab_container.style.display="",a.selection_container.style.display="none",a.selection_tab_container.style.display="none"}function d(){function u(a){var w=a.selection_container,S=a.selection_tab_container;S.children.forEach(function(e){if(e.tab_index==a.page)var t="add";else var t="remove";e.classList[t]("jt-button-lit")}),w.innerHTML="";var E=(s.game_data.entry_list,e.select_packs_menu_current_page[o]=a.page);e.select_packs_menu_current_page=e.select_packs_menu_current_page;var b=a.item_array,u=a.items_per_page,C=E*u,p=(E+1)*u-1;b.length-1<p&&(p=b.length-1);for(var m=0,g=C;p>=g;g++){var i=b[g],t=document.createElement("div");t.className="jt-select_screen-selection-item jt-select_packs_screen-selection-item",m%(u/2)==0&&(t.style.marginLeft=0),m%(u/2)==1&&(t.style.marginRight=0),m+=1;var d="undefined"!=typeof e.account.users_to_puzzle_packs[i.puzzle_pack_id]||0==i.gem_cost,T=t.level_id=i.image_url;t.addEventListener(e.events.POINT,function(t){var i=t.currentTarget.pack,r="undefined"!=typeof e.account.users_to_puzzle_packs[i.puzzle_pack_id]||0==i.gem_cost;r?smoke.alert("You've already acquired this pack."):f(t)}),t.pack=i,t.select_screen=r,w.appendChild(t),n(t),t.image_wrapper=document.createElement("div"),t.image_wrapper.className="jt-select_screen-selection-item-image_wrapper jt-select_packs_screen-selection-item-image_wrapper",t.appendChild(t.image_wrapper),t.image=r.make_new_selection_image(T),t.image_wrapper.appendChild(t.image),e["gray-filter_incomplete_images"]&&(t.classList[d?"remove":"add"]("jt-select_screen-selection-item-greyed_out"),t.image_wrapper.classList[d?"add":"remove"]("jt-select_screen-selection-item-image_wrapper-greyed_out"),e.get_image(t.image,o,T,"mini"+(d?"":"-grey")));var h=document.createElement("div");h.className="jt-select_packs_screen-selection-item-info-container",t.appendChild(h);var v=document.createElement("div");v.className="jt-button jt-select_packs_screen-selection-item-info-title",h.appendChild(v),v.innerHTML=i.name.capitalize();var x=document.createElement("div");x.className="jt-select_packs_screen-selection-item-info-description",x.innerHTML=i.description,h.appendChild(x);var c=document.createElement("div");c.className="jt-button jt-select_packs_screen-selection-item-info-preview_button",c.innerHTML="Preview",c.addEventListener(e.events.POINT,_),c.pack=i,h.appendChild(c);var y=document.createElement("div");y.className="jt-select_screen-selection-item-rewards-container-bottom",t.appendChild(y);var l=document.createElement("div");l.className="jt-button jt-select_packs_screen-selection-item-purchase-container-inner jt-gem_amount_container",y.appendChild(l),d?l.innerHTML="Acquired":(l.classList.add("jt-select_packs_screen-selection-item-purchase-container-inner-gem_cost"),l.innerHTML="<span>"+i.gem_cost+'</span><span class="jt-gem">g</span>',l.innerHTML=0!=e.version_code||e.version_code&&e.version_code<158?'<span style="position:relative; margin-left: 18px; top: -6px; line-height: 0; font-family:lato; font-size: 60px; vertical-align: middle">'+i.gem_cost+'</span><span style="position:relative; top: -3px; line-height: 0; font-family: flyingsoft-icons; font-size: 106px; vertical-align: middle">g</span>':"<span>"+i.gem_cost+'</span><span class="jt-gem">g</span>')}}function f(e){d(e.currentTarget.pack)}function d(n){t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=puzzle_pack_purchase&user_id="+e.account.user_id+"&internal_access_token="+e.account.internal_access_token+"&puzzle_pack_id="+n.puzzle_pack_id,error:e.errormessage,request_method:"POST",async:!0,success:function(t){e.account.gem_amount=t.gem_amount,e.account.users_to_puzzle_packs[n.puzzle_pack_id]=n.puzzle_pack_id;var c=s.game_data.entry_list,a=t.puzzle_list;a.forEach(function(t){e.paid_puzzles.push(t)}),a.forEach(function(e){c[e].enabled=!0}),r.create_puzzle_selection_array(),r.refresh_puzzle_list(),r.create_selection_tab_container(),r.sort_button.sort_levels(),u({page:e.select_packs_menu_current_page[o],item_array:l,items_per_page:h,selection_container:i,selection_tab_container:p});smoke.alert('Thank you for purchasing "'+n.name.capitalize()+'"!')}})}function _(e){e.stopPropagation(),m(e.currentTarget.pack)}function m(i){function n(l){var c=l.puzzle_list,t=smoke.confirm("",function(e){a||1!=e||d(i)}),n=t.dialog.text;n.parentNode.classList.add("jt-pack_preview_screen-dialog"),n.classList.add("jt-pack_preview_screen-text");s.game_data.entry_list;c.forEach(function(a){var t=document.createElement("div");t.className="jt-select_screen-selection-item jt-pack_preview_screen-selection-item",n.appendChild(t);var i=document.createElement("div");i.className="jt-select_screen-selection-item-image_wrapper jt-select_packs_screen-selection-item-image_wrapper",t.appendChild(i);var s=r.make_new_selection_image(a);e.get_image(s,o,a,"mini"),i.appendChild(s)});var a="undefined"!=typeof e.account.users_to_puzzle_packs[i.puzzle_pack_id]||0==i.gem_cost;a?t.dialog.buttons.removeChild(t.dialog.buttons.cancel):t.dialog.buttons.ok.innerHTML="Purchase with "+i.gem_cost+" gems."}t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(e.DEBUG?"-beta":"")+".php?action=get_puzzle_pack_data&user_id="+e.account.user_id+"&internal_access_token="+e.account.internal_access_token+"&puzzle_pack_id="+i.puzzle_pack_id,error:e.errormessage,request_method:"POST",async:!0,success:n})}var i=a.selection_container=document.createElement("div");i.className="jt-select_screen-selection-container",c.appendChild(i);var l=[];for(var g in e.puzzle_pack_list)l.push(e.puzzle_pack_list[g]);l.sort(function(t,i){var r="undefined"!=typeof e.account.users_to_puzzle_packs[t.puzzle_pack_id]||0==t.gem_cost,n="undefined"!=typeof e.account.users_to_puzzle_packs[i.puzzle_pack_id]||0==i.gem_cost;return n>r?-1:r>n?1:0});var h=4,p=a.selection_tab_container=r.create_tab_container({parent:c,selection_container:i,item_list:l,items_per_page:h,select_function:function(e){u(M(e,{item_array:l,items_per_page:h,selection_container:i}))},use_category_selection_tab:!1});"undefined"==typeof e.select_packs_menu_current_page[o]&&(e.select_packs_menu_current_page[o]=0),u({page:e.select_packs_menu_current_page[o],item_array:l,items_per_page:h,selection_container:i,selection_tab_container:p})}var r=l.select_screen,s=(l.content_div,l.mr_jigtato),e=l.gs,o=(s.game_data,s.game_data.jigsaw,s.player_data,s.set_name),c=r.body,u=r.header,i=document.createElement("div");i.className="jt-select_screen-header-show_hint_image jt-select_screen-header-size-1 jt-button hoverable",i.innerHTML="My Packs",i.addEventListener(e.events.POINT,function(){i.toggle()}),i.toggle=function(){i.is_active?i.deactivate():i.activate()};var a={};return i.activate=function(){h({gs:e,error:function(){smoke.alert("You must log in to Google Play to use this feature!")},success:function(){i.is_active=!0,u.querySelectorAll(".jt-button").forEach(function(e){e!=i&&e!=r.gem_purchase_button&&(e.style.display="none")}),i.classList.remove("jt-select_screen-header-size-1"),i.classList.add("jt-select_screen-header-size-4"),p()}})},i.deactivate=function(){i.is_active=!1,u.querySelectorAll(".jt-button").forEach(function(e){e!=i&&e!=r.gem_purchase_button&&(e.style.display="")}),i.classList.add("jt-select_screen-header-size-1"),i.classList.remove("jt-select_screen-header-size-4"),f()},i}function pt(q){function Qt(){if("undefined"==typeof r.account.internal_access_token)return void(e.log_query_processed=!0);var i=localStorage.app_version_date;t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(r.DEBUG?"-beta":"")+".php?action=log_play_start&build_version="+i+"&user_id="+r.account.user_id+"&internal_access_token="+r.account.internal_access_token+"&device_version="+device.version+"&device_model="+device.model+"&device_uuid="+device.uuid+"&device_version="+device.version+"&screen_name=jigsaw&puzzle_name="+M+"&difficulty_level="+e.difficulty_level,success:function(t){null!=e&&(e.log_query_processed=!0,null!=t&&"undefined"!=typeof t.message&&null!=t.message&&""!=t.message&&("undefined"!=typeof t.gem_amount&&(r.account.gem_amount=t.gem_amount),"undefined"!=typeof t.message&&(e.pending_message=t.message,e.pending_message_audio_pre=t.message_audio_pre,e.pending_message_audio_post=t.message_audio_post,e.pending_message_ok_text=t.message_ok_text)))},error:function(){e.log_query_processed=!0},request_method:"POST",async:!0})}function bt(){e.force_screen_refresh+=1}function Ct(){e.force_screen_refresh-=1}function hi(){e.do_screen_refresh_run=!0,e.show_pieces_deferred=window.requestAnimationFrame(nt)}function ci(){e.do_screen_refresh_run=!1,window.cancelAnimationFrame(e.show_pieces_deferred)}function nt(y,p){function c(){p||(e.show_pieces_deferred=window.requestAnimationFrame(nt))}if(e.do_screen_refresh_run){if(!e.do_screen_refresh&&(e.force_screen_refresh<=0||!i.background_image_drawn))return void c();if(i.first_render_complete&&document.body.appendChild(i),i.first_render_complete=!0,e.do_screen_refresh=!1,e.do_category_refresh&&(h.refresh(),e.do_category_refresh=!1),void function(){if(i.cached_width||i.cached_height){if(i.cached_width){var e=i.cached_width;delete i.cached_width}else var e=i.width;if(i.cached_height){var t=i.cached_height;delete i.cached_height}else var t=i.height;i.renderer.resize(e,t)}}(),i.cached_width){var g=i.cached_width;delete i.cached_width}else var g=i.width;if(i.cached_height){var f=i.cached_height;delete i.cached_height}else var f=i.height;if(!i.background_image_drawn&&!w.initial_background_is_transparent){var t=i.getContext("2d");if(t)t.fillStyle="rgba(255,255,255,255)",t.fillRect(0,0,g,f);else{var t=i.getContext("webgl");t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT)}}var t=i.stage;i.load_opacity_transition<1?(i.load_opacity_transition+=.1,e.do_screen_refresh=!0,i.load_opacity_transition>1&&(i.load_opacity_transition=1)):i.initial_alpha_sequence_complete=!0;var n=e.zoom.scale,u=e.zoom.offset_x,d=e.zoom.offset_y;t.x=u,t.y=d,n&&(t.scale.x=n,t.scale.y=n),t.alpha=1;var l=e.piece_margin,o=2*e.piece_margin;if(i.piece_container&&(0==!!i.piece_sprite_container.is_cached||1==!!i.refresh_piece_styling)){i.piece_sprite_container.is_cached=!0,i.refresh_piece_styling=!1;{var _=-u/n,m=-d/n;_+i.width/n,m+i.height/n}i.piece_container.children.forEach(function(e){e.sprite.x=Math.round(e.left-l),e.sprite.y=Math.round(e.top-l),e.sprite.width=Math.round(e.calc_width+o),e.sprite.height=Math.round(e.calc_height+o)}),w.cache_jigsaw_pieces_into_giant_texture&&(i.piece_sprite_container.renderer=i.renderer,i.initial_alpha_sequence_complete&&(i.piece_sprite_container.do_cacheAsBitmap?(i.piece_sprite_container._destroyCachedSprite(),i.piece_sprite_container._generateCachedSprite(1/e.piece_logical_scale)):(i.piece_sprite_container._bounds.x=0,i.piece_sprite_container._bounds.y=0,i.piece_sprite_container._bounds.width=i.renderer.width/e.piece_logical_scale,i.piece_sprite_container._bounds.height=i.renderer.height/e.piece_logical_scale,i.piece_sprite_container.do_cacheAsBitmap=!0,i.piece_sprite_container._generateCachedSprite(1/e.piece_logical_scale))))}if(null!=s&&"visible"==s.visibility){var a=s.sprite;a.x=Math.round(s.left-l),a.y=Math.round(s.top-l),a.width=Math.round(s.calc_width+o),a.height=Math.round(s.calc_height+o)}if(i.loading_animation.display){var r=i.loading_animation;"undefined"==typeof r.rotation_base1&&(r.rotation_base1=0),r.rotation_base1=(r.rotation_base1+.0025)%1,r.outer.sprite.rotation=-r.rotation_base1*Math.PI*2,r.stage.alpha<1&&(r.stage.alpha=r.stage.alpha+.01)}i.renderer.render(i.real_stage),c()}}function Rt(e){return"undefined"==typeof e&&(e={}),k.stop(),4==h.container.childNodes.length?void smoke.alert("No more than 4 categories can be used at one time.",function(){k.resume()}):void smoke.prompt("Please enter the name of the new category.",function(t){if(""===t)return void smoke.alert("You can't set a blank name!",function(){k.resume()});if(k.resume(),"undefined"==typeof e.complete&&(e.complete=function(){}),t===!1)return void("undefined"!=typeof e.error&&(e.complete(),e.error()));var i=h.add_category(t);"undefined"!=typeof e.success&&(e.complete(),e.success(i)),H()})}function Ot(){var s=!r.jigsaw_minimal_ui&&r.show_trophy_ribbon?o(wt):0,l=o(d);if("undefined"!=typeof e.area){{"undefined"!=typeof e.area[0].margin_top?e.area[0].margin_top:0}if(e.jigsaw_arrange_pieces_on_entire_area){var t=parseFloat(window.getComputedStyle(g).width)/2;e.area[0].width=e.area[1].width=t,e.area[0].left=0,e.area[1].left=t}else{var t=(parseFloat(window.getComputedStyle(g).width)-T.width)/2;e.area[0].width=e.area[1].width=t,e.area[0].left=0,e.area[1].left=t+T.width}}var a=s+(r.jigsaw_minimal_ui?0:o(p)),c=r.jigsaw_minimal_ui||null==X.parentNode?0:o(X);if(d.style.height="",r.jigsaw_minimal_ui){e.area&&e.area.forEach(function(e){e.margin_top=128});var n=o(d.parentNode)}else{e.area&&e.area.forEach(function(e){e.margin_top=0});var n=o(d.parentNode)-a-c}d.style.top=a+"px",d.style.height=n+"px",X.style.top=parseFloat(d.style.top)+parseFloat(d.style.height)+"px",i.reposition_and_resize(),L(),"undefined"!=typeof T&&T.naturalHeight&&(e.area&&e.area.forEach(function(e){e.height=n*e.height_ratio}),u.top=(n-T.height+(T.height-T.height))/2),et(),h.container.children.forEach(function(t){t.piece_container.children.forEach(function(t){e.area[t.area];t.top=t.top*(n/l)}),y.size_pieces(t.piece_container.children)})}function et(){if(!i.bg.image.complete)return void i.setTimeout(et,50);if(0==!!i.bg.refresh_bg&&(i.bg.refresh_bg=!0,i.bg.width="undefined"!=typeof i.cached_width?i.cached_width:i.width,i.bg.height="undefined"!=typeof i.cached_height?i.cached_height:i.height,i.bg.getContext("2d").drawImage(i.bg.image,0,0,i.bg.image.naturalWidth,i.bg.image.naturalHeight,0,0,i.bg.width,i.bg.height),F({parent:i.stage,logical_parent:i.bg,canvas:i.bg,position:0}),L()),i.background_image_drawn=!0,"undefined"==typeof u)return void i.setTimeout(et,50);if("undefined"==typeof u.left)return void i.setTimeout(et,50);if(!u.base_image.complete)return void i.setTimeout(et,50);i.bg.refresh_bg=!0;var t=i.bg.getContext("2d");i.bg.width="undefined"!=typeof i.cached_width?i.cached_width:i.width,i.bg.height="undefined"!=typeof i.cached_height?i.cached_height:i.height,t.drawImage(i.bg.image,0,0,i.bg.image.naturalWidth,i.bg.image.naturalHeight,0,0,i.bg.width,i.bg.height);var n=u.left,a=u.top,s=u.width,o=u.height,r=(e.piece_margin,u.base_image);(1==r.style.opacity||e.jigsaw_show_hint_rect)&&(t.fillStyle="white",t.fillRect(n,a,s,o),(1==r.style.opacity||e.jigsaw_show_hint_image)&&(t.globalAlpha=r.style.opacity,t.drawImage(r,n,a,s,o),t.globalAlpha=1)),F({parent:i.stage,logical_parent:i.bg,canvas:i.bg,position:0})}function si(){var e=u.base_image;e.style.zIndex=1,e.style.position="absolute",e.style.left=0,e.style.top=0,e.style.opacity=.2}function ai(e){var e=e||{},s="undefined"!=typeof e.jigsaw_minimal_ui?e.jigsaw_minimal_ui:r.jigsaw_minimal_ui,o="undefined"!=typeof e.jigsaw_use_large_square_images?e.jigsaw_use_large_square_images:r.jigsaw_use_large_square_images,n="undefined"!=typeof e.jigsaw_image_size_type?e.jigsaw_image_size_type:r.jigsaw_image_size_type,t=e.base_image||T,i={};if(s){if(0==n)var a=880;if(1==n)var a=1e3;if(2==n)var a=1080}else{if(0==n)var a=800;if(1==n)var a=860;if(2==n)var a=880}return i.width=Math.round(a/1.33333),t.naturalHeight==t.naturalWidth?o&&(i.width=a,i.height=a):t.naturalHeight<t.naturalWidth&&(i.width=a*t.naturalWidth/t.naturalHeight),i.height=parseFloat(i.width*t.naturalHeight/t.naturalWidth),i}function jt(){function n(){return 0==!!i.first_render_complete||r.ad_control&&!r.ad_control.ignore&&r.ad_control.running||0==!!e.log_query_processed?void d.inner.setTimeout(n,50):void qt()}e.jigsaw_initial_show_hint_image=r.jigsaw_show_hint_image,e.jigsaw_show_hint_rect=r.jigsaw_show_hint_rect,e.jigsaw_show_hint_image=r.jigsaw_show_hint_image,e.piece_margin=r.jigsaw_get_scaled_piece_margin(e),e.piece_margin_style=r.jigsaw_piece_margin_style,d.inner.appendChild(x);var t=u.composite_image=document.createElement("canvas");if(t.set_size=function(){t.width=(T.width+2*e.piece_margin)/e.piece_logical_scale,t.height=(T.height+2*e.piece_margin)/e.piece_logical_scale,t.cached_sprite_data={width:u.width+2*e.piece_margin,height:u.height+2*e.piece_margin,x:u.left-e.piece_margin,y:u.top-e.piece_margin}},si(),"undefined"==typeof localStorage["puzzle_states."+$+"."+M+"."+O.selected_difficulty]){gt();var a=Math.round(1e6*Math.random());Math.seedrandom(a),h.add_category("General"),oi({source_image:T,width:T.width,height:T.height,size_x:e.tile_x,size_y:e.tile_y,draw_settings:w,callback:function(t){j=t,ii(j,h.current_category.piece_container),I=Array.prototype.slice.call(h.current_category.piece_container.children),St(I),st(h.current_category.piece_container),e.pieces_in_position_count=0,n()}})}else Mt({callback:n})}function qt(){function n(){r.jigsaw_minimal_ui?p.show_title_animation({callback:k.resume}):p.setTimeout(function(){p.autoshow_title({callback:k.resume})},1e3),y.event_listeners_loaded||(y.event_listeners_loaded=!0,x.addEventListener(r.events.POINT_START,Kt),document.addEventListener(r.events.POINT_MOVE,Dt),r.is_phone_or_tablet?(P({target:d.inner,result_function:Ut,start_condition:function(){return 0==!!i.controls_locked&&null==s},start_effect:function(){r.jigsaw_pinch_controls_not_run&&(r.log_user_action("Pinch controls: run for the first time."),r.jigsaw_pinch_controls_not_run=!1),x.drag_end(),x.pinch_active=!0},end_effect:function(){x.pinch_active=!1}}),x.addEventListener("touchend",Y),x.addEventListener("touchcancel",Y),x.addEventListener("touchleave",Y),g.addEventListener("touchend",Y)):(document.addEventListener("mouseup",Y),window.addEventListener("blur",pt),window.addEventListener("mouseout",Ft),d.inner.addEventListener("mousewheel",Gt),d.inner.addEventListener("DOMMouseScroll",Gt))),p.setTimeout(function(){"undefined"!=typeof r.ambient_music.last_on_state&&(1==r.ambient_music.last_on_state&&(r.ambient_music_on=!0),delete r.ambient_music.last_on_state),A.play_intro_audio({level_id:q.level_id,parent:d.inner})},400)}if(i.loading_animation.stop(),"undefined"==typeof e.pending_message||""==e.pending_message)n();else{var t=smoke.alert(e.pending_message,function(){e.pending_message_audio_post&&(r.playAudio(r.audio_dir+"/"+e.pending_message_audio_post+".ogg",{audio_type:"sound_effect",blocking:!1}),delete e.pending_message_audio_post),delete e.pending_message,n()});e.pending_message_audio_pre&&(r.playAudio(r.audio_dir+"/"+e.pending_message_audio_pre+".ogg",{audio_type:"sound_effect",blocking:!1}),delete e.pending_message_audio_pre),"undefined"!=typeof e.pending_ok_text&&(t.dialog.input.ok.innerHTML=e.pending_ok_text,delete e.pending_ok_text),t.dialog.text.style.textIndent="1em",t.dialog.text.style.textAlign="left"}}function ii(l,c){for(var n=[],r=e.tile_x*e.tile_y,i=new Array(r),t=0;r>t;t++)i[t]=t;for(var t=0;r>t;t++){var o=Math.randInt(0,r-1),h=i[o];i[o]=i[t],i[t]=h}for(var t=0,a=0;a<e.tile_x;a++)for(var s=0;s<e.tile_y;s++)n[i[t]]=l[a][s],t+=1;return n.forEach(function(e){c.appendChild(e)}),n}function st(c,s){L();var o="undefined"!=typeof s;"undefined"==typeof c&&(c=h.current_category.piece_container),"undefined"==typeof s&&(s=c.children);var s=Array.prototype.slice.call(s);1!=o&&(c.piece_matrix=[]);var l=c.piece_matrix;if(0!=s.length)for(var u=0,i=0,g=e.area.length;g>i;i++){var n=e.area[i],d=n.piece_row_max,p=n.piece_column_max,f=n.width/p;if(O.selected_difficulty<=1)var _=0,m=n.height/d;else var _=n.margin_top,m=(n.height-2*_)/d;1!=o&&(l[i]=[]);for(var r=0;d>r;r++){1!=o&&(l[i][r]=[]);for(var a=0;p>a;a++){var t=l[i][r][a]=s[u];if((1==o||"undefined"!=typeof l[i][r][a])&&!(1==o&&"undefined"!=typeof l[i][r][a]||t.puzzle_width.length>1||(t.area=i,t.row=r,t.column=a,t.left=f/2+a*f+n.left-t.calc_width/2,t.top=_+m/2+r*m+n.top-t.calc_height/2,t.piece_matrix=l,u+=1,1!=o||s.length!=u)))return}}}}function ti(){var e=document.createElement("div");return e.className="jt-play-trophy_ribbon",e.addEventListener(r.events.POINT,function(){U({mr_jigtato:A,gs:r,callback:function(){}})}),e.update=function(){e.innerHTML="";var i=O.jigsaw.trophies,c=A.set_name,n=37,s=i.length<=n?i.length:n;s==n&&e.classList.add("jt-play-trophy_ribbon-max_trophies");for(var a=0;s>a;a++){var o=i[a],h=o.split("|")[0],u=o.split("|")[1],l=A.get_trophy_item({game_type:r.game_type,level_id:h,difficulty_level:u}),t=document.createElement("img");t.className="jt-play-main_image_border_width",r.get_image(t,c,l.filename,"trophy"),t.style.backgroundColor=l.background_color,e.appendChild(t)}},e.update(),g.appendChild(e),e}function ei(){if(it.reward_container)var t=it.reward_container;else var t=M;var i=t+"|"+e.difficulty_level,n=A.get_trophy_item({game_type:r.game_type,level_id:t,difficulty_level:e.difficulty_level}),a=O.jigsaw.trophies;return-1!=a.indexOf(i)?{trophy_item:n,trophy_already_exists:!0}:(a.push(i),{trophy_item:n,trophy_already_exists:!1})}function Zt(l){var n=O.jigsaw.best_times[+e.jigsaw_initial_show_hint_image];"undefined"==typeof n[M]&&(n[M]={});var t=n[M][e.difficulty_level];"undefined"==typeof t&&(t=86400),t>l&&(t=n[M][e.difficulty_level]=l);var i=J.difficulty_levels[e.difficulty_level].point_cutoffs_visible;0==e.jigsaw_initial_show_hint_image&&(i*=J.difficulty_levels[e.difficulty_level].point_cutoffs_hidden_multiplier);for(var a=i.length;a>=0;a--){var c=Math.round(i[a]*e.get_piece_count());if(c>=l)break}var r=a+1,h=r==i.length?-1:Math.round(i[r]*e.get_piece_count()),s=O.jigsaw.ranks;"undefined"==typeof s[M]&&(s[M]={});var o=s[M][e.difficulty_level];return"undefined"==typeof o&&(o=-1),r>o&&(o=s[M][e.difficulty_level]=r),{best_time:t,rank_count:r,next_rank_point:h}}function Xt(){return e.pieces_in_position_count==e.tile_x*e.tile_y}function ri(){k.style.visibility="hidden",k.counter=0,e.zoom={scale:1,offset_x:0,offset_y:0},jt()}function Jt(t){var t=t||{};r.playAudio(r.audio_dir+"/answer-give up.ogg",{audio_type:"sound_effect",blocking:!1}),h.select_category(h.original_category),Array.prototype.slice.call(h.container.childNodes).forEach(function(e){e!=h.container.childNodes[0]&&h.remove_category(e)}),e.zoom={scale:1,offset_x:0,offset_y:0},i.piece_container=u;var n=(e.piece_margin,h.current_category.piece_container.children);n.forEach(function(e){u.appendChild(e),e.left=Math.randInt(0,u.base_image.width)-e.width_float+u.left,e.top=Math.randInt(0,u.base_image.height)-e.height_float+u.top;var t=e.puzzle_left_min+u.left,i=e.puzzle_top_min+u.top;e.calc_width=e.width_float,e.calc_height=e.height_float,TweenMax.to(e,.8,{parseTransform:!0,ease:Linear.ease,left:t,top:i,width:e.calc_width,height:e.calc_height})}),bt(),d.inner.setTimeout(Ct,800),d.inner.setTimeout(function(){Ht({callback:t.callback})},1e3),d.inner.setTimeout(function(){ct({user_gave_up:!0}),850})}function ct(h){function f(){Ht({hide_controls:!0}),b()}function b(){wt.update();var i=smoke.alert("",m);c(i);var s=i.dialog.text;s.classList.add("jt-play-trophy_reward-parent");var o=document.createElement("p");o.className="jt-play-trophy_reward-text",o.innerHTML=y?"This level gave you the following trophy:":"You've acquired a trophy on this level and difficulty:",s.appendChild(o);var n=document.createElement("p");n.className="jt-play-trophy_reward-trophy_name",n.style.color="undefined"!=typeof t.text_color?t.text_color:t.background_color,s.appendChild(n);var u=t.display_name.substr(t.display_name.length-1);if(n.innerHTML=t.display_name.capitalizeFirstLetter()+("!"==u||"."==u?"":"."),"undefined"!=typeof t.text_outline_color){var a=t.text_outline_color.split(",")[0].trim();r.is_chromium||r.is_android?(n.style.textShadow="none",n.style.WebkitTextStrokeColor=a,v({element:n,size:"4px",color:""})):n.style.textShadow="4px 4px "+a+", 4px 0 "+a+", 0 4px "+a+", -4px 0 "+a+", 0 -4px "+a+", -4px 4px "+a+", 4px -4px "+a+", -4px -4px "+a}if("undefined"!=typeof t.subtitle){var l=document.createElement("div");l.className="jt-play-trophy_reward-text",l.innerHTML=t.subtitle,s.appendChild(l)}var p="jt-play-main_image_border_width jt-play-trophy_reward-trophy_image",f=r.is_phone_or_tablet?"":"jt-play-trophy_reward-trophy_image-expanded",h=E({mr_jigtato:A,gs:r,set_name:Z,level_id:M,difficulty_level:e.difficulty_level,trophy_class:p+" "+f});s.appendChild(h),i.text.appendChild(i.buttons),o.style.opacity=n.style.opacity=l.style.opacity=i.buttons.ok.style.opacity=0,i.text.style.maxHeight="100%",i.text.style.marginBottom=0,i.text.style.height="862px",i.buttons.style.marginTop="426px",i.buttons.style.visibility="hidden",h.style.visibility="hidden",h.style.opacity=0,TweenMax.to(o,.5,{delay:0,parseTransform:!0,ease:Linear.ease,opacity:1}),d.inner.setTimeout(function(){h.style.visibility="visible"},600),TweenMax.to(h,.8,{delay:.6,parseTransform:!0,ease:Linear.ease,opacity:1,className:p}),TweenMax.to(n,1.1,{delay:.5,parseTransform:!0,ease:Cubic.easeIn,opacity:1}),TweenMax.to(l,.8,{delay:1.8,parseTransform:!0,ease:Cubic.easeIn,opacity:1}),d.inner.setTimeout(function(){i.buttons.style.visibility="visible"},2e3),TweenMax.to(i.buttons.ok,.2,{delay:2.7,parseTransform:!0,ease:Cubic.easeIn,opacity:1})}function m(){var e=J.rank[J.difficulty_levels[O.selected_difficulty].name];r.playAudio(r.get_set_directory(Z)+"/audio/"+e.rank_audio[n]+".m4a",{audio_type:"music",element:d.inner,restart:!0});var s=smoke.alert("");c(s),s.dialog.buttons.ok.addEventListener(r.events.POINT,function(){3==n&&window.kiipInstance&&(console.log(window.kiipInstance),window.kiipInstance.postMoment("rank_count: "+n+", selected_difficulty: "+O.selected_difficulty)),i.fireworks=new _t({gs:r,draw_area:i})});var t=s.dialog.text;t.classList.add("jt-play-show_rank-parent");var h=1==n?e.name:e.plural;t.innerHTML='<p> You completed the puzzle in <span class="jt-play-show_rank-text-bright">'+k.counter+'</span> seconds.</p><p> Your personal best is <span class="jt-play-show_rank-text-bright">'+x+"</span> seconds.</p>",t.innerHTML+=0==n?'<p> No <span class="jt-play-show_rank-text-bright">'+h+"</span> won this round!</p>":'<p> Your reward: <span class="jt-play-show_rank-text-bright">'+w[n]+"</span> "+h+".</p>";var o=document.createElement("div");o.className="jt-play-show_rank-image-container";for(var l=0;n>l;l++){var a=document.createElement("div");a.className="jt-play-show_rank-image-item",o.appendChild(a),a.style.opacity=.01,a.style.backgroundImage='url("'+r.get_set_directory(Z)+"/gui/"+e.filename+'")',void function(t,i){d.inner.setTimeout(function(){TweenMax.to(t,2,{parseTransform:!0,ease:Linear.ease,css:{opacity:1}}),d.inner.setTimeout(function(){t.addEventListener(r.events.POINT,function(){"undefined"!=typeof e.click_audio&&r.playAudio(r.get_set_directory(Z)+"/audio/"+e.click_audio+".ogg",{element:d.inner,audio_type:"music"})})},2e3)},i)}(a,500*l)}if(t.appendChild(o),0==n)var f='Complete the puzzle in <span class="jt-play-show_rank-text-bright">'+p+"</span> seconds or less to gain a "+e.name+"!";else if(-1!=p)var f='Complete the puzzle in <span class="jt-play-show_rank-text-bright">'+p+"</span> seconds or less to gain more "+e.plural+"!";else var f="You've achieved the highest rank for this puzzle and level!";var u=document.createElement("p");u.innerHTML=f,t.appendChild(u)}var h=h||{};localStorage.removeItem("puzzle_states."+$+"."+M+"."+O.selected_difficulty);var a=h.user_gave_up||!1;r.ambient_music.last_on_state=r.ambient_music_on,r.ambient_music_on=!1;var _=ft[Math.floor(Math.random()*ft.length)];if(0==a){r.playAudio(r.audio_dir+"/"+_,{audio_type:"sound_effect",blocking:!1})}if(k.stop(),g.style.overflow="hidden",a||(i.controls_locked=!0),1!=e.zoom.scale||0!=e.zoom.offset_x||0!=e.zoom.offset_y){var o=1e3;TweenMax.to(e.zoom,o/1e3,{parseTransform:!0,ease:Linear.ease,scale:1,offset_x:0,offset_y:0})}else var o=1e3;if(i.single_piece_left){var l=i.single_piece_left;delete i.single_piece_left,u.appendChild(l),i.piece_container=u,TweenMax.to(l,o/1e3,{parseTransform:!0,ease:Cubic.easeInOut,calc_width:l.width_float,calc_height:l.height_float,left:u.left,top:u.top,onComplete:function(){Ct()}}),bt()}if(a||setTimeout(function(){i.controls_locked=!1},o),1!=a){var s=ei(),t=s.trophy_item,y=s.trophy_already_exists,s=Zt(k.counter),x=s.best_time,n=s.rank_count,p=s.next_rank_point,w=["zero","one","two","three"];localStorage.player_data=JSON.stringify(O),0==a?d.inner.setTimeout(f,o+(h.show_trophy_delay||550)):d.inner.setTimeout(f,o+(h.show_trophy_delay||550))}}function Ht(e){var e=e||{};if(L(),u.children.forEach(function(e){e.side_set&&(u.removeChild(e),D(e))}),h.container.children.forEach(function(e){h.remove_category(e)}),u.base_image.style.opacity=1,D(u.composite_image),et(),e.hide_controls){var t=r.use_categories;r.use_categories=!1,p.autoshow_title(),r.use_categories=t,Yt.morph_to_back_button()}e.callback&&e.callback()}function Vt(t,n){h.item_under_mouse=null;var a=l(n,d.inner),o=a[0],c=a[1];t.left=(o/g.desired_scale-e.zoom.offset_x)/e.zoom.scale+(r.jigsaw_center_piece_on_move?-t.calc_width/2:-t.initial_offset_left-t.calc_width/2),t.top=(c/g.desired_scale-e.zoom.offset_y)/e.zoom.scale+(r.jigsaw_center_piece_on_move?-t.calc_height/2:-t.initial_offset_top-t.calc_height/2),L();var i=document.elementFromPoint(n.clientX,n.clientY);null!=i&&(i.is_category_deck_item&&(h.item_under_mouse=i),i.parentNode.is_category_deck_item&&(h.item_under_mouse=i.parentNode));var s=r.jigsaw_heat_seeking_color_options[r.jigsaw_heat_seeking_color_index];"undefined"!=typeof s&&Wt(s)}function Wt(t,n){if(null!=s&&(!n||s.last_border_color_x!=s.left||s.last_border_color_y!=s.top)&&(s.last_border_color_x=s.left,s.last_border_color_y=s.top,d.inner.setTimeout(function(){Wt(t,n)},500),s.border_adjust_count="undefined"==typeof s.border_adjust_count?0:s.border_adjust_count+1,10==s.border_adjust_count&&(s.border_adjust_count=0),0==s.border_adjust_count)){s.border_adjust_count=0;var o=s.left-u.left,l=s.top-u.top,e=Math.abs(o-s.puzzle_left_min)/i.width+Math.abs(l-s.puzzle_top_min)/i.height;e>1&&(e=1),e=Math.pow(e,.5);var r=parseInt(255*e),a=parseInt(127*e);if("red"==t)var c="rgba("+(255-r)+", 0,"+a+", 1)";if("cyan"==t){b=255-r+a,b>255&&(b=255);var c="rgba(0, "+(255-r)+","+b+", 1)"}dt(s.canvas,c),Lt(s)}}function Gt(e){function n(i){var t=i.wheelDelta,e=i.detail;return e?t?t/e/40*e>0?1:-1:-e/3:t/120}if(e.preventDefault(),!i.controls_locked){var t=l(e,d),a=t[0],s=t[1],r=1+Math.abs(n(e))/4.5,o=Et(e)>0?r:1/r;Ut(o,a,s)}}function Ut(n,i,r){var a=e.zoom.scale;i/=g.content_scale,r/=g.content_scale;var t=a*n;n>1?t>e.zoom.scalemax&&(t=e.zoom.scalemax):t<e.zoom.scalemin&&(t=e.zoom.scalemin);var s=(e.zoom.offset_x-i)*(t/e.zoom.scale)+i,o=(e.zoom.offset_y-r)*(t/e.zoom.scale)+r;e.zoom.scale=t,e.zoom.offset_x=s,e.zoom.offset_y=o}function Kt(t){if(t.preventDefault(),!i.controls_locked){var a=t.target;if("undefined"!=typeof t.targetTouches){if(t.touches.length>1){if(null!=s){var t=t.touches[Array.prototype.slice.call(t.touches).findIndex(function(e){return e.identifier!=s.touch_id})];a!=x||x.pinch_active||x.drag_start(t)}return}t=t.targetTouches[0]}else if(null!=s)return;if(!W(t)){var u=l(t,d.inner),f=(u[0]/g.desired_scale-e.zoom.offset_x)/e.zoom.scale,p=(u[1]/g.desired_scale-e.zoom.offset_y)/e.zoom.scale,c=[],y=h.current_category;if(y)for(var _=y.piece_container,o=0,m=_.children.length;m>o;o++){var n=_.children[o];if(!n.placed&&!(f<n.left||p<n.top||f>n.left+n.calc_width||p>n.top+n.calc_height)){var w=((f-n.left)/r.jigsaw_piece_scale_to_actual+e.piece_margin)/e.piece_logical_scale,T=((p-n.top)/r.jigsaw_piece_scale_to_actual+e.piece_margin)/e.piece_logical_scale,E=n.dummy_canvas.getContext("2d").isPointInPath(n.path,w,T);E&&c.push(n)}}if(0==c.length)return void(a!=x||x.pinch_active||x.drag_start(t));for(var a=c[0],v=+c[0].sprite.index,o=1,m=c.length;m>o;o++){var n=c[o];+n.zIndex<=v||(v=+n.zIndex,a=n)}L(),r.playAudio(r.audio_dir+"/global-pick up.ogg",{audio_type:"sound_effect",blocking:!1});var b=h.basket_button;if(b.is_selected)return void b.toggle_piece(a);if(D(a),F({logical_parent:a,canvas:a.canvas,is_2d:!0}),s=a,s.touch_id=t.identifier,s.pickup_left=s.left,s.pickup_top=s.top,s.calc_width=s.width_float,s.calc_height=s.height_float,i.piece_sprite_container.removeChild(a.sprite),i.stage.addChild(a.sprite),0==r.jigsaw_center_piece_on_move){var u=l(t,d.inner),f=u[0],p=u[1];s.initial_offset_left=(f/g.desired_scale-e.zoom.offset_x)/e.zoom.scale-a.virtual_left,s.initial_offset_top=(p/g.desired_scale-e.zoom.offset_y)/e.zoom.scale-a.virtual_top}document.body.style.cursor="pointer",a.visibility="hidden",s.visibility="visible",Vt(s,t)}}}function Ft(e){"undefined"!=typeof e.changedTouches&&(e=e.changedTouches[0]);var r=e.pageX,n=e.pageY,t=window.scrollX;"undefined"==typeof t&&(t=document.body.scrollLeft);var i=window.scrollY;"undefined"==typeof i&&(i=document.body.scrollTop),n>=0&&n<=window.innerHeight+i&&r>=0&&r<=window.innerWidth+t||Y(e)}function Y(o){if(null!=x){if("undefined"==typeof o.touches)x.drag_end();else{var L=o.touches[Array.prototype.slice.call(o.touches).findIndex(function(e){return e.identifier==x.touch_id})];if("undefined"==typeof L&&x.drag_end(),null!=s){var P=o.touches[Array.prototype.slice.call(o.touches).findIndex(function(e){return e.identifier==s.touch_id})];if("undefined"!=typeof P)return}}if(null!=s){"undefined"!=typeof o.changedTouches&&(o=o.changedTouches[0]);var y=!0,g=!1;if(null!=h.item_under_mouse){var M=h.current_category;if(M!=h.item_under_mouse){y=!1,g=!0;var v=h.item_under_mouse.piece_container;v.appendChild(s),st(v,[s])}}var A=h.current_category.piece_container.children,a=s,l=r.jigsaw_piece_scale_to_actual,b=2*r.jigsaw_required_precision,n=[],k=s.left+(1-l)/2*a.width_float-a.puzzle_left_min*l,R=s.top+(1-l)/2*a.height_float-a.puzzle_top_min*l;if(A.forEach(function(e){if(e!=a)for(var h=e.virtual_left-e.width_float*l/2-e.puzzle_left_min*l,d=e.virtual_top-e.height_float*l/2-e.puzzle_top_min*l,r=Math.abs(h-k),s=Math.abs(d-R),t=0,c=a.puzzle_width.length;c>t;t++)for(var g=a.puzzle_width[t],u=a.puzzle_height[t],i=0,p=e.puzzle_width.length;p>i;i++)if(!e.placed){var f=e.puzzle_width[i],_=e.puzzle_height[i],m=(g+f)/b,o=(u+_)/b;if(!(r>m||s>o||Math.abs(e.x[i]-a.x[t])+Math.abs(e.y[i]-a.y[t])!=1)){-1==n.indexOf(e)&&n.push(e);break}}}),n.length>0){var a=s,n=n.concat([a]),p=u.composite_image.width-2*e.piece_margin/e.piece_logical_scale,_=0,d=u.composite_image.height-2*e.piece_margin/e.piece_logical_scale,m=0;n.forEach(function(e){p>e.puzzle_left_min&&(p=e.puzzle_left_min),d>e.puzzle_top_min&&(d=e.puzzle_top_min),_<e.puzzle_left_min+e.width_float&&(_=e.puzzle_left_min+e.width_float),m<e.puzzle_top_min+e.height_float&&(m=e.puzzle_top_min+e.height_float)});var t=mt();return t.className="jt-jigsaw-piece_deck-piece",t.piece_id=a.piece_id,t.x=[],t.y=[],t.puzzle_width=[],t.puzzle_height=[],t.puzzle_left=[],t.puzzle_top=[],t.puzzle_left_min=p,t.puzzle_top_min=d,t.side_set=at(n,!0),t.shape_string=Q(at(n,r.jigsaw_combine_pieces),[-p,-d]),t.dummy_canvas=document.createElement("canvas"),t.path=new Path2D(t.shape_string),I.push(t),a.parentNode.appendChild(t),t.width_float=Math.round(1e3*(_-p))/1e3,t.height_float=Math.round(1e3*(m-d))/1e3,t.width=Math.ceil((t.width_float+2*e.piece_margin)/e.piece_logical_scale),t.height=Math.ceil((t.height_float+2*e.piece_margin)/e.piece_logical_scale),n.forEach(function(e){e.parentNode.removeChild(e)}),n.forEach(function(e){D(e),I.splice(I.indexOf(e),1),e.x.forEach(function(r,i){j[e.x[i]][e.y[i]]=t}),t.x=t.x.concat(e.x),t.y=t.y.concat(e.y),t.puzzle_width=t.puzzle_width.concat(e.puzzle_width),t.puzzle_height=t.puzzle_height.concat(e.puzzle_height),t.puzzle_left=t.puzzle_left.concat(e.puzzle_left),t.puzzle_top=t.puzzle_top.concat(e.puzzle_top)}),t.calc_width=t.width_float*r.jigsaw_piece_scale_to_actual,t.calc_height=t.height_float*r.jigsaw_piece_scale_to_actual,t.left=(t.puzzle_left_min-n[0].puzzle_left_min)*r.jigsaw_piece_scale_to_actual+n[0].left,t.top=(t.puzzle_top_min-n[0].puzzle_top_min)*r.jigsaw_piece_scale_to_actual+n[0].top,t.x.length==e.tile_x*e.tile_y&&(i.single_piece_left=t,ct()),ot(t),D(s),s=null,vt(),i.refresh_piece_styling=!0,void H()}if(y)for(var f=s,w=!1,T=s.calc_width/r.jigsaw_required_precision,E=s.calc_height/r.jigsaw_required_precision,C=s.left-u.left,S=s.top-u.top;;){if(C+T<f.puzzle_left_min)break;if(C-T>f.puzzle_left_min)break;if(S+E<f.puzzle_top_min)break;if(S-E>f.puzzle_top_min)break;w=!0;break}if(r.playAudio(r.audio_dir+"/global-put down.ogg",{audio_type:"sound_effect",blocking:!1}),!w)return void pt({is_transferred_to_different_category:g});if(ot(s),F({logical_parent:s,canvas:s.canvas}),r.jigsaw_animate_piece_placement){var c=s;i.piece_sprite_container.addChildAt(c.sprite,0),s=null;var O=c.puzzle_left_min+u.left,z=c.puzzle_top_min+u.top;bt(),c.placed=!0,TweenMax.to(c,.35,{parseTransform:!0,ease:Linear.ease,left:O,top:z,onComplete:function(){Ct(),zt(c)}})}else zt(s)}}}function zt(n){e.pieces_in_position_count+=n.x.length,n.parentNode.removeChild(n),document.body.style.cursor="",n.placed=!0;for(var y=[],b=[],S=[[0,0,!0],[-1,0,!0],[0,-1,!0],[1,0,!0],[0,1,!0],[1,1,!1],[-1,-1,!1],[1,-1,!1],[-1,1,!1],[-2,0,!1],[0,-2,!1],[2,0,!1],[0,2,!1],[2,1,!1],[-2,-1,!1],[2,-1,!1],[-2,1,!1],[1,2,!1],[-1,-2,!1],[1,-2,!1],[-1,2,!1],[2,2,!1],[-2,-2,!1],[2,-2,!1],[-2,2,!1]],d={},x=n.x,c=u.composite_image.width-2*e.piece_margin/e.piece_logical_scale,f=0,l=u.composite_image.height-2*e.piece_margin/e.piece_logical_scale,g=0,a=0;a<x.length;a++){var T=n.x[a],v=n.y[a];j[T][v]=Pt(n)}for(var a=0;a<x.length;a++){var T=n.x[a],v=n.y[a];S.forEach(function(t){var i=T+t[0];if("undefined"!=typeof j[i]){var n=v+t[1],e=j[i][n];if("undefined"!=typeof e&&e.placed){var r=!1;"undefined"==typeof d[e.piece_id]&&(r=!0,d[e.piece_id]=t[2],y.push(e)),1==t[2]&&(1==r||0==d[e.piece_id])&&(d[e.piece_id]=!0,b.push(e),c>e.puzzle_left_min&&(c=e.puzzle_left_min),l>e.puzzle_top_min&&(l=e.puzzle_top_min),f<e.puzzle_left_min+e.width_float&&(f=e.puzzle_left_min+e.width_float),g<e.puzzle_top_min+e.height_float&&(g=e.puzzle_top_min+e.height_float))}}})}var C=(at(y,!0),Q(at(y,r.jigsaw_combine_pieces),[-Math.floor(c),-Math.floor(l)])),t=document.createElement("canvas");t.width_float=Math.round(1e3*(f-c))/1e3,t.height_float=Math.round(1e3*(g-l))/1e3,t.width=Math.ceil((t.width_float+2*e.piece_margin)/e.piece_logical_scale),t.height=Math.ceil((t.height_float+2*e.piece_margin)/e.piece_logical_scale);var o=t.getContext("2d");o.save(),m({x:e.piece_margin,y:e.piece_margin,scale:1/e.piece_logical_scale,data:C,strokeStyle:"rgba(63,63,63,1)",lineWidth:0,canvas:t}),o.clip();var p=(u.composite_image.width-2*e.piece_margin/e.piece_logical_scale)*e.piece_logical_scale/u.base_image.naturalWidth;b.forEach(function(t){o.drawImage(u.base_image,t.puzzle_left_min/p,t.puzzle_top_min/p,t.width*e.piece_logical_scale/p,t.height*e.piece_logical_scale/p,(t.puzzle_left_min-c)/e.piece_logical_scale,(t.puzzle_top_min-l)/e.piece_logical_scale,t.width,t.height)}),o.restore(),o.save(),o.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),r.jigsaw_use_3d_effect&&_({canvas:t,draw_settings:w,stroke_width:w.stroke_width,cut_multiplier:w.cut_multiplier,shape_string:C,scale:1/e.piece_logical_scale,clear_stroke:"undefined"==typeof e.piece_margin_style,game_instance:e}),dt(t),o.restore();var E=u.composite_image.getContext("2d");E.globalCompositeOperation="source-over",E.drawImage(t,c/e.piece_logical_scale,l/e.piece_logical_scale,t.width,t.height),t.width=0,t.height=0;var h=u.composite_image;h.texture?Lt(h):F({parent:i.stage,canvas:h,position:1,is_2d:!0}),h.sprite.x=u.left-e.piece_margin,h.sprite.y=u.top-e.piece_margin,D(n),n==s&&(s=null),vt(),H(),Xt()&&ct()}function pt(e){if(null!=s){if(L(),"undefined"==typeof e&&(e={}),document.body.style.cursor="",e.is_transferred_to_different_category||i.piece_sprite_container.addChild(s.sprite),s.visibility="visible",!r.freestyle_mode||e.is_transferred_to_different_category)s.left=s.pickup_left,s.top=s.pickup_top;else{if(s.left=s.left+(s.calc_width-s.calc_width)/2,s.top=s.top+(s.calc_height-s.calc_height)/2,s.virtual_left-.25*s.calc_width<0)s.virtual_left=.25*s.calc_width;else{var t=parseFloat(window.getComputedStyle(d.inner).width);s.virtual_left+.25*s.calc_width>t&&(s.virtual_left=t-.25*s.calc_width)}if(s.virtual_top-.25*s.calc_height<0)s.virtual_top=.25*s.calc_height;else{var n=parseFloat(window.getComputedStyle(d.inner).height);s.virtual_top+.25*s.calc_height>n&&(s.virtual_top=n-.25*s.calc_height)}}delete s.border_adjust_count,delete s.pickup_left,delete s.pickup_top,ot(s),F({logical_parent:s,canvas:s.canvas}),s.calc_width=s.width_float*r.jigsaw_piece_scale_to_actual,s.calc_height=s.height_float*r.jigsaw_piece_scale_to_actual,s=null,h.item_under_mouse=null,vt(),H()}}function Dt(e){if("touchcancel"==e.type&&e.preventDefault(),!i.controls_locked){{e.target}if(e.touches){if(x.drag_active){var t=e.touches[Array.prototype.slice.call(e.touches).findIndex(function(e){return e.identifier==x.touch_id})];x.drag_update(t)}e=e.targetTouches[0]}else x.drag_update(e);null!=s&&Vt(s,e)}}function oi(b){function g(i,r,n,a,s,o){var e=f[i][r][n],t=f[a][s][o];return M.testCurveCurveIntersection(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3])?!0:M.testCurveCurveIntersection(e[3],e[4],e[5],e[6],t[0],t[1],t[2],t[3])?!0:M.testCurveCurveIntersection(e[0],e[1],e[2],e[3],t[3],t[4],t[5],t[6])?!0:M.testCurveCurveIntersection(e[3],e[4],e[5],e[6],t[3],t[4],t[5],t[6])?!0:!1}function it(n,s,l,c,p,_,f,g){for(var o=new Array,i=[new Array,new Array],d=0;2>d;d++){if(0==d)var r=6*n-12*l+6*p,u=-3*n+9*l-9*p+3*f,T=3*l-3*n;else var r=6*s-12*c+6*_,u=-3*s+9*c-9*_+3*g,T=3*c-3*s;if(Math.abs(u)<1e-12){if(Math.abs(r)<1e-12)continue;var e=-T/r;e>0&&1>e&&o.push(e)}else{var w=r*r-4*T*u,v=Math.sqrt(w);if(!(0>w)){var y=(-r+v)/(2*u);y>0&&1>y&&o.push(y);var m=(-r-v)/(2*u);m>0&&1>m&&o.push(m)}}}for(var x,b,t,a=o.length,h=a;a--;){var e=o[a];t=1-e,x=t*t*t*n+3*t*t*e*l+3*t*e*e*p+e*e*e*f,i[0][a]=x,b=t*t*t*s+3*t*t*e*c+3*t*e*e*_+e*e*e*g,i[1][a]=b}return i[0][h]=n,i[1][h]=s,i[0][h+1]=f,i[1][h+1]=g,{x0:Math.min.apply(null,i[0]),y0:Math.min.apply(null,i[1]),x1:Math.max.apply(null,i[0]),y1:Math.max.apply(null,i[1])}}for(var h=(b.success||function(){},b.source_image),m=b.size_x,v=b.size_y,N=b.width,B=b.height,z=b.draw_settings,y=[],M=G(),W=100/m,V=100/v,n=0;m>=n;n++){y[n]=[];for(var i=0;v>=i;i++){var tt=0==n||n==m?0:.25*Math.randBMT(),et=0==i||i==v?0:.25*Math.randBMT();y[n][i]=[(n+tt)*W,(i+et)*V]}}for(var J=[[[450,-150],[226,-59],void 0,void 0,2],[[330,-180],[155,-120],void 0,void 0,3],[[333,58],[120,-50],void 0,void 0,4],[[312,15],[75,54],void 0,void 0,4],[[275,65],[17,7],void 0,void 0,8],[[260,0],[40,0],void 0,void 0,9],[[312,15],[95,-33],void 0,void 0,9],[[280,-80],[108,-124],void 0,void 0,9],[[220,0],[80,0],void 0,void 0,20],[[223,-19],[80,0],[35,265],110,24]],O=[],s=0;s<J.length;s++)for(var A=J[s],T=0;T<A[4];T++)O.push([A[0],A[1],A[2],A[3]]);var f=[];for(vh=0;2>vh;vh++){f[vh]=[];for(var n=0;m+vh>n;n++){f[vh][n]=[];for(var i=0;v+(1-vh)>i;i++){var t=[[0,0],[220,0],[60,80],[150,80],[240,80],[80,0],[300,0]];if((0==i||i==v+1-vh-1)&&0==vh||(0==n||n==m+vh-1)&&1==vh)t=[t[0],t[t.length-1]];else{var $=Math.randInt(0,O.length-1),p=O[$];t[1]=[p[0][0]-10+20*Math.randBMT(),p[0][1]-10+20*Math.randBMT()],t[5]=[p[1][0]-10+20*Math.randBMT(),p[1][1]-10+20*Math.randBMT()],"undefined"!=typeof p[2]&&(t[2][0]=p[2][0],t[4][0]=p[2][1]);var Z=Math.randInt(0,1);if(1==Z){var Y=t[1][0];t[1][0]=300-t[5][0],t[5][0]=300-Y}if("undefined"!=typeof p[3])var K=p[3]-5+10*Math.randBMT();else if(0!=Math.randInt(0,4))var K=70+20*Math.randBMT();else var K=60+40*Math.randBMT();t[2][1]=t[3][1]=t[4][1]=K;var Q=Math.randInt(0,1);if(1==Q)for(var s=1,c=t.length;c-1>s;s++)t[s][1]=-t[s][1]}for(var s=0,c=t.length;c>s;s++){if(1==vh){var Y=t[s][0];t[s][0]=t[s][1],t[s][1]=Y}t[s][0]=t[s][0]/300*W+y[n][i][0],t[s][1]=t[s][1]/300*V+y[n][i][1]}var c=t.length;t[c-1]=0==vh?[y[n+1][i][0],y[n+1][i][1]]:[y[n][i+1][0],y[n][i+1][1]];for(var s=0;c>s;s++)t[s][0]=t[s][0].toFixed(4),t[s][1]=t[s][1].toFixed(4);for(var j=new Array(c),s=0;c>s;s++)j[s]=[t[s][0]/100*N,t[s][1]/100*B];if(f[vh][n][i]=j,j.length>2&&i>0&&n>0&&vh>0){var t=f[vh][n][i];if(M.testCurveCurveIntersection(t[0],t[1],t[2],t[3],t[3],t[4],t[5],t[6])&&Math.random()>.01){i-=1;continue}if(0==vh){if(g(vh,n,i,1-vh,n,i)&&Math.random()>.01){i-=1;continue}if(i>0&&g(vh,n,i,1-vh,n,i-1)&&Math.random()>.01){i-=1;continue}if(i>0&&m-1>n&&g(vh,n,i,1-vh,n+1,i-1)&&Math.random()>.01){i-=1;continue}if(m-1>n&&g(vh,n,i,1-vh,n+1,i)&&Math.random()>.01){i-=1;continue}}else{if(g(vh,n,i,1-vh,n,i)&&Math.random()>.01){i-=1;continue}if(n>0&&g(vh,n,i,1-vh,n-1,i)&&Math.random()>.01){i-=1;continue}if(n>0&&v-1>i&&g(vh,n,i,1-vh,n-1,i+1)&&Math.random()>.01){i-=1;continue}if(v-1>i&&g(vh,n,i,1-vh,n,i+1)&&Math.random()>.01){i-=1;continue}}}}}}for(var D=[],H="",X=0,n=0;m>n;n++){D[n]=[];for(var i=0;v>i;i++){for(var w=[],C=[],E="",S="",o={x0:N,y0:B,x1:0,y1:0},d=(f[0][n][i][0][0],f[0][n][i][0][1],[]),u=0;4>u;u++){var L=0,t=f[u%2==0?1:0][n+(2==u?1:0)][i+(3==u?1:0)],c=t.length;if(2>=c)var o={x0:t[0][0]<o.x0?t[0][0]:o.x0,y0:t[0][1]<o.y0?t[0][1]:o.y0,x1:t[1][0]>o.x1?t[1][0]:o.x1,y1:t[1][1]>o.y1?t[1][1]:o.y1};else for(var s=0;4>s;s+=3)var x=it(t[0+s][0],t[0+s][1],t[1+s][0],t[1+s][1],t[2+s][0],t[2+s][1],t[3+s][0],t[3+s][1]),o={x0:x.x0<o.x0?x.x0:o.x0,y0:x.y0<o.y0?x.y0:o.y0,x1:x.x1>o.x1?x.x1:o.x1,y1:x.y1>o.y1?x.y1:o.y1};var R=0==u&&c>2?" M ":" L ";c>2&&0!=u&&(R=""),S+=R,""!=R&&(C.length>0&&("M"!=E&&d.push({type:E,points:C}),C=[],0==L&&d.length>0&&(w.push({x:n,y:i,s:w.length,p:d}),d=[]),L+=1),E=R.trim());for(var s=u%3==0?c-1:0,T=0;c>T;T++)(0==u||2>=c||0!=T)&&(T%3==1&&c>2&&("M"!=E&&d.push({type:E,points:C}),C=[],0==L&&d.length>0&&(w.push({x:n,y:i,s:w.length,p:d}),d=[]),L+=1,E="C",S+=" C "),S+=t[s][0].toFixed(4)+","+t[s][1].toFixed(4),C.push([parseFloat(t[s][0].toFixed(4)),parseFloat(t[s][1].toFixed(4))]),T!=c-1&&(S+=" ")),u%3==0?s--:s++}d.push({type:E,points:C}),w.push({x:n,y:i,s:w.length,p:d}),S+="z",H+=S+" ";var q=a(o),o={x0:Math.round(1e3*o.x0)/1e3,y0:Math.round(1e3*o.y0)/1e3,x1:Math.round(1e3*o.x1)/1e3,y1:Math.round(1e3*o.y1)/1e3},F=Math.round(1e3*(o.x1-o.x0))/1e3,U=Math.round(1e3*(o.y1-o.y0))/1e3,l=mt();l.x=[n],l.y=[i],l.piece_id=X,l.width=Math.ceil(F+2*e.piece_margin)/e.piece_logical_scale,l.height=Math.ceil(U+2*e.piece_margin)/e.piece_logical_scale,l.width_float=F,l.height_float=U,l.puzzle_width=[F],l.puzzle_height=[U],l.puzzle_left_min=q.x0,l.puzzle_top_min=q.y0,l.puzzle_left=[o.x0],l.puzzle_top=[o.y0],l.side_set=[w],l.placed=!1,D[n][i]=l,X+=1}}var k=document.createElement("canvas"),I=k.getContext("2d");k.width=(N+2*e.piece_margin)/e.piece_logical_scale,k.height=(B+2*e.piece_margin)/e.piece_logical_scale;var P=h.naturalWidth/h.width,rt=P*h.width<=h.naturalWidth?P*h.width:h.naturalWidth,nt=P*h.height<=h.naturalHeight?P*h.height:h.naturalHeight;I.drawImage(h,0,0,rt,nt,e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale,h.width/e.piece_logical_scale,h.height/e.piece_logical_scale),I.save(),I.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),r.jigsaw_use_3d_effect&&_({canvas:k,draw_settings:z,stroke_width:z.stroke_width,cut_multiplier:z.cut_multiplier,shape_string:H,scale:1/e.piece_logical_scale,clear_stroke:"undefined"==typeof e.piece_margin_style,game_instance:e}),It({piece_grid:D,big_canvas:k,grid_is_new:!0,callback:function(e){I.restore(),b.callback(e)}})}function It(t){function u(){for(var t=0;_>t;t++){var e=s[c][r];if(1==n||!e.placed){var m=!1;0==n&&e.sprite&&(m=!0,D(e)),e.shape_string=Q(e.side_set,[-e.puzzle_left_min,-e.puzzle_top_min]),xt(e,p),F({canvas:e.canvas,logical_parent:e}),0==m&&i.piece_sprite_container.removeChild(e.sprite),1==n&&(e.zIndex=l)}if(l+=1,r+=1,r==o&&(r=0,c+=1),c==h)break}l!=h*o?(i.refresh_piece_styling=!0,timeout=d.inner.setTimeout(u,20)):(ut=void 0,void function(){for(var r={},l=0;h>l;l++)for(var c=0;o>c;c++){var e=s[l][c];0==n&&e.placed||(e.parentNode==i.piece_container||null==e.parentNode)&&(r[e.zIndex]=e)}for(var u=a(i.piece_sprite_container.children),t=0,d=u.length;d>t;t++)i.piece_sprite_container.removeChild(u[t]);for(var t in r)i.piece_sprite_container.addChild(r[t].sprite);i.piece_sprite_container.is_cached=!1,f(s)}())}var s=t.piece_grid,p=t.big_canvas,n=t.grid_is_new,f=t.callback,h=e.tile_x,o=e.tile_y,_=20,l=0,c=0,r=0;"undefined"!=typeof ut&&clearTimeout(ut),ut=void 0,u()}function vt(){for(var t=i.piece_sprite_container.children,e=0,r=t.length;r>e;e++){var n=t[e].logical_parent;n.zIndex=e}i.piece_sprite_container.is_cached=!1}function Q(r,e,t){function n(r){var n="",i="";return r.forEach(function(a){a.p.forEach(function(s){if(n+=" "+s.type+" ",""==i){var o=r[r.length-1].p,l=o[o.length-1],a=l.points;switch(l.type){case"L":i="M "+(a[1][0]*t+e[0]).toFixed(4)+","+(a[1][1]*t+e[1]).toFixed(4)+" ";break;case"C":i="M "+(a[2][0]*t+e[0]).toFixed(4)+","+(a[2][1]*t+e[1]).toFixed(4)+" "}}s.points.forEach(function(i){n+=(i[0]*t+e[0]).toFixed(4)+","+(i[1]*t+e[1]).toFixed(4)+" "})})}),i+n+"z"}var t="undefined"!=typeof t?t:1,e="undefined"==typeof e?[0,0]:e;e[0]*=t,e[1]*=t;var a=r,i=[];return a.forEach(function(e){i.push(n(e))}),"".concat.apply(i)}function dt(n,i,a){var r="undefined"!=typeof i?i:e.piece_margin_style;if("undefined"!=typeof r){var t=n.getContext("2d");t.lineJoin="round",t.lineCap="round",t.lineWidth=e.piece_margin/e.jigsaw_scale_low_power_sizer*w.border_scale,"clear"==i?(t.strokeStyle="rgba(0,0,0,1)",t.globalCompositeOperation="destination-out",t.stroke(),t.globalCompositeOperation="source-in"):(t.strokeStyle=r,t.stroke())}}function at(b,w){if(!w){var d=[];b.forEach(function(e){e.side_set.forEach(function(e){d.push(e)})});var T=[].concat.apply(d);return T}for(var x=[[-1,0],[0,-1],[1,0],[0,1]],c=[],l=[],i=-1;i<e.tile_x+2;i++){l[i]=[];for(var r=-1;r<e.tile_y+2;r++)l[i][r]=[0,0,0,0]}for(var i=-1;i<e.tile_x+1;i++){c[i]=[];for(var r=-1;r<e.tile_y+1;r++)c[i][r]=void 0}b.forEach(function(e){e.x.forEach(function(i,t){c[e.x[t]][e.y[t]]=e})});for(var v=[],i=0;i<e.tile_x;i++)for(var r=0;r<e.tile_y;r++)if(c[i][r])for(var p=0;4>p;p++)if(!l[i][r][p]){for(var g=[],t=p,m=0,y=!1,a=i,n=r;;){var o=a+x[t][0],s=n+x[t][1];if(l[a][n][t]=1,l[o][s][(t+2)%4]=1,c[o][s]){if(3==m)break;m+=1,t=(t+3)%4,a=o,n=s}else{if(0==y){y=!0;var h=a,u=n;o>a&&(h+=1,2==t&&(u+=1)),s>n&&(u+=1,1==t&&(h+=1)),a>o&&2==t&&(u+=1),n>s&&1==t&&(h+=1);var f=h,_=u}else{var f=a,_=n;if(o>a&&(f+=1,2==t&&(_+=1)),s>n&&(_+=1,1==t&&(f+=1)),a>o&&2==t&&(_+=1),n>s&&1==t&&(f+=1),h==f&&u==_)break}g.push([a,n,t]),l[a][n][t]=1,l[o][s][(t+2)%4]=1,t=(t+1)%4,m=0}}g.length>0&&v.push(g)}var d=[];return v.forEach(function(t){var e=[];t.forEach(function(i){var s=i[0],l=i[1],h=i[2],a=c[s][l];e:for(var n=0,u=a.side_set.length;u>n;n++)for(var o=a.side_set[n],r=0,d=o.length;d>r;r++){var t=o[r];if(s==t.x&&l==t.y&&h==t.s)break e}e.push(t)}),d.push(e)}),d}function Pt(e){return{placed:e.placed,puzzle_left:e.puzzle_left,puzzle_top:e.puzzle_top,puzzle_left_min:e.puzzle_left_min,puzzle_top_min:e.puzzle_top_min,width:e.width,height:e.height,width_float:e.width_float,height_float:e.height_float,puzzle_width:e.puzzle_width,puzzle_height:e.puzzle_height,x:e.x,y:e.y,zIndex:e.zIndex,virtual_left:e.virtual_left,virtual_top:e.virtual_top,piece_id:e.piece_id,side_set:e.side_set}}function F(t){if(t instanceof HTMLCanvasElement||t instanceof HTMLImageElement)var r=t,e=t,n=i.piece_sprite_container,o=n.children.length;else var e="undefined"!=typeof t.logical_parent?t.logical_parent:t.canvas,r=t.canvas,n="undefined"!=typeof t.parent?t.parent:i.piece_sprite_container,o="undefined"!=typeof t.position?t.position:n.children.length;var a=t.invalidate,c=t.is_2d;"undefined"==typeof a&&(a=!1);var s=e.cached_sprite_data;if(e.sprite&&"undefined"==typeof t.position&&-1!=n.children.indexOf(e.sprite)&&(o-=1),(e.canvas||e==r)&&D(e),c&&r!=e?(r.texture=new PIXI.Texture.fromCanvas(r),e.texture=r.texture,delete r.texture):e.texture=new PIXI.Texture.fromCanvas(r),e.sprite=new PIXI.Sprite(e.texture),e.sprite.logical_parent=e,e.canvas=e.texture.baseTexture.source,"undefined"!=typeof s)for(var l in s)e.sprite[l]=s[l];return n.addChildAt(e.sprite,o),L(),"undefined"!=typeof n&&n==i.piece_sprite_container&&1==a&&(n.is_cached=!1),e}function D(e,r){if("undefined"==typeof r&&(r=!1),"undefined"!=typeof e&&e.texture){var t=e.sprite.parent;"undefined"!=typeof t&&e.sprite.parent.removeChild(e.sprite),e.texture.destroy(!0),e.texture=null,e.sprite=null,"undefined"!=typeof t&&t==i.piece_sprite_container&&1==r&&(t.is_cached=!1),L()}}function Lt(e){i.renderer.gl&&e.texture&&PIXI.updateWebGLTexture(e.texture.baseTexture,i.renderer.gl)}function li(e,t){return e.forEach(function(e){e.forEach(function(e){e.p.forEach(function(e){e.points.forEach(function(e){e.forEach(function(r,i){e[i]=e[i]*t})})})})}),e}function mt(){var e={};e.is_jigsaw_piece=!0,e.canvas=document.createElement("canvas");var c=null;Object.defineProperty(e,"parentNode",{get:function(){return c},set:function(e){c=e}});var t,r;Object.defineProperty(e,"left",{get:function(){return t},set:function(r){t=r,n=t+o/2,e!=s&&(i.refresh_piece_styling=!0,i.refresh_piece_styling=!0)}}),Object.defineProperty(e,"top",{get:function(){return r},set:function(t){r=t,a=r+l/2,e!=s&&(i.refresh_piece_styling=!0,i.refresh_piece_styling=!0)}});var n,a;Object.defineProperty(e,"virtual_left",{get:function(){return n},set:function(r){n=r,t=n-o/2,e!=s&&(i.refresh_piece_styling=!0)}}),Object.defineProperty(e,"virtual_top",{get:function(){return a},set:function(t){a=t,r=a-l/2,e!=s&&(i.refresh_piece_styling=!0)}});var o,l;return Object.defineProperty(e,"calc_width",{get:function(){return o},set:function(r){o=r,t=n-o/2,e!=s&&(i.refresh_piece_styling=!0)}}),Object.defineProperty(e,"calc_height",{get:function(){return l},set:function(t){l=t,r=a-l/2,e!=s&&(i.refresh_piece_styling=!0)}}),e}function kt(e){var t=[];Object.defineProperty(e,"children",{get:function(){return t},set:function(e){t=e}}),Object.defineProperty(e,"childNodes",{get:function(){return t},set:function(e){t=e}}),e.appendChild=function(t){t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,e.children.push(t),L(),Bt()},e.removeChild=function(t){e.children.splice(e.children.indexOf(t),1),L(),Bt()},Array.prototype.slice.call(["forEach"]).forEach(function(t){e.children[t]=function(i,r){return Array.prototype.slice.call(e.children)[t](i,r)}})}function xt(t,c,n){if("undefined"!=typeof t.element)var n=t,t=n.element,c=n.parent,y=n.stroke_style;var i=t.canvas;i.width=t.width,i.height=t.height,n||(n={});var p="undefined"==typeof n.render_stroke?!0:n.render_stroke,f="undefined"==typeof n.use_3d_effect?!1:n.use_3d_effect,o=n.margin||0,s=e.piece_logical_scale,a=e.piece_margin,r=i.getContext("2d");r.save(),m({x:a+o,y:a+o,scale:1/s,data:t.shape_string,strokeStyle:"rgba(63,63,63,1)",lineWidth:0,canvas:i}),r.clip(),t.dummy_canvas=document.createElement("canvas");var g=Q(t.side_set,[-t.puzzle_left_min+a+o,-t.puzzle_top_min+a+o],1/s);if(t.path=new Path2D(g),c instanceof HTMLImageElement){var l=(u.composite_image.width-2*e.piece_margin/e.piece_logical_scale)*e.piece_logical_scale/u.base_image.naturalWidth,h=i.width*s/l,d=i.height*s/l;h>r.width&&(h=r.width),d>r.height&&(d=r.height),r.drawImage(c,t.puzzle_left_min/l,t.puzzle_top_min/l,h,d,0,0,i.width,i.height)}else r.drawImage(c,(t.puzzle_left_min+a)/s,(t.puzzle_top_min+a)/s,i.width,i.height,0,0,i.width,i.height);r.restore(),f&&(r.save(),r.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),_({canvas:i,draw_settings:w,stroke_width:w.stroke_width,cut_multiplier:w.cut_multiplier,shape_string:t.shape_string,scale:1/e.piece_logical_scale,clear_stroke:!p,game_instance:e}),r.restore()),p&&(r.save(),dt(i,y),r.restore())}function ot(t){D(t),t.canvas=document.createElement("canvas"),xt({element:t,parent:u.base_image,use_3d_effect:r.jigsaw_use_3d_effect,render_stroke:"undefined"!=typeof e.piece_margin_style}),F({logical_parent:t,canvas:t.canvas,invalidate:!0})}var g=q.content_div,A=q.mr_jigtato,r=q.global_settings,M=q.level_id;g.innerHTML="";var J=A.game_data.jigsaw,ui=A.game_data.trophy_list,O=A.player_data,it=A.game_data.entry_list[M],Z=A.set_name,$=r.game_type,y={},w={},e=y.game_instance={},tt=J.difficulty_levels[O.selected_difficulty];e.difficulty_level=O.selected_difficulty,e.get_piece_count=function(){return e.tile_x*e.tile_y},e.intro_audio_count=0,!r.is_kiosk&&r.use_social_media_buttons&&K();var ft=["answer-correct-10865990.ogg","answer-correct-23303730.ogg","answer-correct-25513672.ogg","answer-correct-25513693.ogg","answer-correct-37240671.ogg","answer-correct-37240686.ogg","answer-correct-37241588.ogg","answer-correct-37241627.ogg"],ni=["global-pick up.ogg","global-put down.ogg","answer-give up.ogg","fireworks-1.ogg","fireworks-2.ogg","fireworks-3.ogg","fireworks-4.ogg"].concat(ft);lt({parent:r,dir:r.audio_dir+"/",audio_list:ni,type:"is_sound_effect"}),r.ambient_music.last_on_state=r.ambient_music_on,r.ambient_music_on=!1,r.ambient_music.load_ambient_music(A.game_data.ambient_music,A.game_data.ambient_music_start),Qt();var L=(performance.now(),y.screen_refresh=function(){e.do_screen_refresh=!0}),Bt=y.category_refresh=function(){e.do_screen_refresh=!0,e.do_category_refresh=!0};if(e.force_screen_refresh=0,hi(),void function(){var i,t={},r=void 0,n=void 0;Object.defineProperty(t,"scalemin",{value:1,enumerable:!1,writable:!0}),Object.defineProperty(t,"scalemax",{value:4,enumerable:!1,writable:!0}),Object.defineProperty(t,"scale",{enumerable:!0,get:function(){return i},set:function(e){i=e,L()}}),Object.defineProperty(t,"offset_x",{enumerable:!0,get:function(){return r},set:function(e){if("undefined"!=typeof d){if(e>0)e=0;else{var n=parseFloat(window.getComputedStyle(d).width),t=(1-i)*n;t>e&&(e=t)}e=Math.round(1e4*e)/1e4,r=e,L()}}}),Object.defineProperty(t,"offset_y",{enumerable:!0,get:function(){return n},set:function(e){if("undefined"!=typeof d){if(e>0)e=0;else{var r=parseFloat(window.getComputedStyle(d).height),t=(1-i)*r;t>e&&(e=t)}e=Math.round(1e4*e)/1e4,n=e,L()}}}),Object.defineProperty(e,"zoom",{enumerable:!0,get:function(){return t},set:function(e){t.scale=e.scale,t.offset_x=e.offset_x,t.offset_y=e.offset_y}})}(),g.style.overflow="hidden",n(g),y.menu_item_list=[A.menu.generic.about,A.menu.generic.ogle_trophies,{text:"Restart",action:function(r,e,t){var i=smoke.confirm('<span style="color: #cc0000; font-weight: bold">Warning:</span> this will reset the puzzle piece positions and generate new puzzle pieces. Continue?',function(i){return 0==i?void e():void t.init.current_game.help_menu_obj.close({callback:function(){Jt({callback:function(){d.inner.setTimeout(ri,1e3)}})}})});c(i)}},{text:"Back to Main Menu",action:function(i,n,e){{var t=e.init;t.current_game}e.close(),r.IS_WEBVIEW?window.history.back():t.mr_jigtato.history_control.load_page({page:"select_jigsaw"})}},{text:"Rearrange Jigsaw Pieces",action:function(){st(h.current_category.piece_container),H(),y.help_menu_obj.close()}},A.menu.jigsaw.toggle_categories,A.menu.jigsaw.open_misc_config_menu,A.menu.jigsaw.show_mini_hint_image,{text:"undefined"==typeof A.game_data.play_intro_audio_text?"Play Puzzle Intro Audio":A.game_data.play_intro_audio_text,action:function(i,t){e.intro_audio_count+=1,A.play_intro_audio({level_id:q.level_id,count:e.intro_audio_count,parent:d.inner}),t()}},A.menu.jigsaw.open_visual_settings_menu,A.menu.generic.open_audio_settings_menu],!r.is_kiosk&&r.use_social_media_buttons){var Tt=y.social_sharing_button_container=document.createElement("div");Tt.className="jt-play-social_sharing_button_container",g.appendChild(Tt),N({parent:Tt,button_class:"jt-social_button_small"})}var wt=y.trophy_ribbon=ti({parent:g}),p=y.game_title=document.createElement("div");p.className="jt-play-title",p.hidden_top_value="-155%",n(p);var X=y.bottom_bar=document.createElement("div");X.className="jt-play-bottom_bar jt-play-main_image_border_width",n(X),g.appendChild(p),p.hide_title=function(e){var e=e||{};"undefined"==typeof e.callback&&(e.callback=function(){}),"undefined"==typeof e.duration&&(e.duration=500),r.jigsaw_minimal_ui&&(e.duration=0),h.style.display="",0==e.duration?(p.inner.style.top=p.hidden_top_value,h.style.top=0,p.inner.style.display="none",e.callback()):(TweenMax.to(h,e.duration/1e3,{parseTransform:!0,ease:Linear.ease,css:{top:0}}),TweenMax.to(p.inner,e.duration/1e3,{parseTransform:!0,ease:Linear.ease,css:{top:p.hidden_top_value,display:"none"}}),d.inner.setTimeout(e.callback,e.duration))},p.show_title=function(e){var e=e||{};"undefined"==typeof e.callback&&(e.callback=function(){}),"undefined"==typeof e.duration&&(e.duration=500),r.jigsaw_minimal_ui&&(e.duration=0),p.inner.style.display="",0==e.duration?(h.style.top=p.hidden_top_value,p.inner.style.top=0,h.style.display="none",e.callback()):(TweenMax.to(p.inner,e.duration/1e3,{parseTransform:!0,ease:Linear.ease,css:{top:0}}),TweenMax.to(h,e.duration/1e3,{parseTransform:!0,ease:Linear.ease,css:{top:p.hidden_top_value,display:"none"}}),d.inner.setTimeout(e.callback,e.duration))},p.autoshow_title=function(e){p[r.use_categories?"hide_title":"show_title"](e)},p.show_title_animation=function(t){function n(){setTimeout(function(){g.appendChild(e)},0);var s=e.childNodes[0],n=new SplitText(s,{type:"chars, words"}).chars,u=Math.floor(n.length/2),a=new TimelineLite,o=function(){(null==i||null==i.parentNode)&&TweenLite.killTweensOf(r)},c=!0;if(c)for(var t=0;t<n.length;t++){for(var h=n[t].children,l=0;l<h.length;l++)h[l].style.opacity=0;a.from(n[t],1.8,{onUpdate:o,x:40*(t-u),opacity:0,ease:Power2.easeOut},.05*t*18/n.length)}return a.fromTo(s,3+1*c,{onUpdate:o,z:250,y:74,visibility:"visible"},{z:-200,ease:SlowMo.ease.config(.1,.9)},0),a.to(s,1.5,{onUpdate:o,rotationX:-720,autoAlpha:0,scale:.3,ease:Power2.easeInOut},"-=1.5"),a}"undefined"==typeof t.callback&&(t.callback=function(){});var e=p.inner.cloneNode(!0);e.className="jt-select_screen-title-center-inner",e.style.display="",e.style.top="",p.autoshow_title({duration:0});var r=new TimelineMax;r.eventCallback("onComplete",function(){e.parentNode&&(g.removeChild(e),t.callback())}),setTimeout(function(){r.add(n())},0),TweenLite.set(e,{perspective:700,visibility:"visible"})};var h=y.category_deck=document.createElement("div");h.className="jt-jigsaw-category_deck",h.item_under_mouse=null,p.appendChild(h),h.edit_button=document.createElement("img"),h.edit_button.className="jt-op_button jt-op_button-edit"+(r.is_phone_or_tablet?" hoverable jt-op_button-edit-colored":""),h.edit_button.src=r["/"]+"images/gui/gui-item_edit.png",h.appendChild(h.edit_button),h.add_button=document.createElement("img"),h.add_button.className="jt-op_button jt-op_button-add"+(r.is_phone_or_tablet?" hoverable jt-op_button-add-colored":""),h.add_button.src=r["/"]+"images/gui/gui-item_expand_or_add.png",h.appendChild(h.add_button),h.basket_button=document.createElement("img"),h.basket_button.className="jt-op_button jt-op_button-basket"+(r.is_phone_or_tablet?" hoverable jt-op_button-basket-colored":""),h.basket_button.piece_list=[],h.basket_button.is_selected=!1,h.basket_button.src=r["/"]+"images/gui/gui-basket.png",h.appendChild(h.basket_button),h.remove_button=document.createElement("img"),h.remove_button.className="jt-op_button jt-op_button-remove"+(r.is_phone_or_tablet?" hoverable jt-op_button-remove-colored":""),h.remove_button.src=r["/"]+"images/gui/gui-item_remove.png",h.appendChild(h.remove_button),h.container=document.createElement("div"),h.container.className="jt-jigsaw-category_deck-container",h.appendChild(h.container),h.add_category=function(s){var t=document.createElement("div");t.className="jt-jigsaw-category_deck-category jt-play-main_image_border_width jt-button_generic hoverable",h.container.appendChild(t),t.inner=document.createElement("div"),t.appendChild(t.inner),h.set_category_name(t,s);var i=t.piece_container=document.createElement("div");i.className="jt-jigsaw-piece_container",kt(i);J.difficulty_levels[e.difficulty_level];i.piece_matrix=[];for(var n=0,o=e.area.length;o>n;n++){var l=e.area[n];i.piece_matrix[n]=[];for(var a=0;a<l.piece_row_max;a++)i.piece_matrix[n][a]=[]}return"undefined"==typeof h.current_category&&(h.select_category(t),h.original_category=t),t.addEventListener(r.events.POINT,function(e){h.select_category(e.currentTarget),H()}),t.is_category_deck_item=!0,t},h.set_category_name=function(e,t){var i=p.style.display;p.style.display="block",e.inner.innerHTML=t,e.style.padding=0,e.style.border="none",R(e.inner,{unit_type:"px",transform_scale:g.content_scale}),e.style.padding="",e.style.border="",p.style.display=i},h.remove_category=function(e){var t=e.piece_container,i=t.children;if(h.original_category&&e!=h.original_category){var r=h.original_category.piece_container;i.forEach(function(e){r.appendChild(e)})}else i.forEach(function(t){e.piece_container.removeChild(t)});t.parentNode&&t.parentNode.removeChild(t),h.original_category&&(e!=h.original_category?st(h.original_category.piece_container,i):delete h.original_category),1==h.container.children.length&&delete h.current_category,h.container.removeChild(e)},h.select_category=function(e){"undefined"!=typeof e&&(h.current_category=e,i.piece_container=e.piece_container,L(),h.refresh(),h.container.children.forEach(function(t){if(t==e)var i="add";else var i="remove";t.classList[i]("jt-button_generic-lit")}),i.piece_sprite_container.is_cached=!1)},h.refresh=function(){var t=I;if("undefined"!=typeof t)for(var r=0,a=t.length;a>r;r++){var n=t[r],e=n.sprite;if("undefined"!=typeof e&&null!=e)if(n.parentNode!=h.current_category.piece_container&&n.parentNode!=u){if("undefined"==typeof e.parent)continue;i.piece_sprite_container.removeChild(e)}else{if("undefined"!=typeof e.parent)continue;i.piece_sprite_container.addChild(e)}}},h.edit_button.addEventListener(r.events.POINT,function(){var e=h.current_category;k.stop(),smoke.prompt('Please enter a new name for category "'+e.inner.innerHTML+'".',function(t){return""===t?void smoke.alert("You can't set a blank name!",function(){k.resume()}):(k.resume(),void(t!==!1&&(h.set_category_name(e,t),H())))})}),h.add_button.addEventListener(r.events.POINT,Rt);var V=h.basket_button;V.addEventListener(r.events.POINT,function(t){var e=t.currentTarget,n=0==e.piece_list.length;e.classList[e.is_selected?"remove":"add"]("jt-op_button-basket"+(r.is_phone_or_tablet?"-colored":"")+"-selected"),e.is_selected&&!n&&Rt({error:function(){e.piece_list=[]},complete:function(){e.piece_list.forEach(function(t){e.remove_piece(t,{modify_array:!1})})},success:function(t){e.piece_list.forEach(function(e){t.piece_container.appendChild(e)}),e.piece_list.forEach(function(e){"undefined"!=typeof e.sprite.parent&&i.piece_sprite_container.removeChild(e.sprite)}),st(t.piece_container),e.piece_list=[],H()}}),e.is_selected=!e.is_selected}),V.toggle_piece=function(e,t){-1!=V.piece_list.indexOf(e)?V.remove_piece(e,t):V.add_piece(e,t)},V.remove_piece=function(t,e){"undefined"==typeof e&&(e={});var r="undefined"==typeof e.modify_array?!0:e.modify_array;if(r){var i=V.piece_list.indexOf(t);-1!=i&&V.piece_list.splice(i,1)}ot(t)},V.add_piece=function(e,t){"undefined"==typeof t&&(t={});var i="undefined"==typeof t.modify_array?!0:t.modify_array;D(e),e.canvas=document.createElement("canvas"),xt({element:e,parent:u.base_image,use_3d_effect:r.jigsaw_use_3d_effect,render_stroke:!0,stroke_style:"#e0b270"}),F({logical_parent:e,canvas:e.canvas,invalidate:!0}),i&&V.piece_list.push(e)},h.remove_button.addEventListener(r.events.POINT,function(){function t(t){k.resume(),0!=t&&(h.remove_category(e),h.select_category(h.original_category),H())}k.stop();var e=h.current_category;return e==h.original_category?void smoke.alert("You can't remove the initial category!",function(){k.resume()}):void(0==e.piece_container.children.length?t(!0):smoke.confirm('Are you sure you want to remove the category "'+e.inner.innerHTML+'"? Its pieces will be added to the first category.',t,{ok:"Proceed"}))});var k=y.timer_obj=rt({parent:p});y.timer_obj.style.display=r.show_timer?"":"none",n(k),y.refresh_gui_display=function(){var e=y.trophy_ribbon;e.style.display=!r.jigsaw_minimal_ui&&r.show_trophy_ribbon?"":"none",r.jigsaw_minimal_ui?(d.style.borderWidth=0,p.classList.add("minimal_ui"),p.classList.add("jt-play-title-minimal_ui"),p.inner.classList.add("jt-play-title-inner-minimal_ui"),g.classList.add("jt-play-action_area-minimal_ui"),y.menu_button_obj.classList.add("jt-play-menu_button-minimal_ui"),y.timer_obj.classList.add("jt-play-timer-minimal_ui"),y.menu_button_obj.setAttribute("current_text","M"),g.appendChild(y.timer_obj),g.appendChild(y.menu_button_obj),g.appendChild(p),X.parentNode==g&&g.removeChild(X)):(d.style.borderWidth="",p.classList.remove("jt-play-title-minimal_ui"),p.inner.classList.remove("jt-play-title-inner-minimal_ui"),d.classList.remove("jt-play-action_area-minimal_ui"),y.menu_button_obj.classList.remove("jt-play-menu_button-minimal_ui"),y.timer_obj.classList.remove("jt-play-timer-minimal_ui"),g.insertBefore(p,d),g.insertBefore(X,d.nextSibling),p.insertBefore(y.timer_obj,p.childNodes[0]),p.appendChild(y.menu_button_obj)),Ot()};var At=y.help_menu_obj=S({gs:r,parent:g,current_game:y,menu_item_list:y.menu_item_list,column_size:3,show_hint_image_options:!0,init:q}),Yt=y.menu_button_obj=z({parent:p,target:At,current_game:y,menu_class:"jt-play-menu_button",back_button_page:"select_jigsaw",init:q});it.use_image_title?C({image_src:r.get_set_directory(Z)+"/puzzle/"+M+"-title.png",fix_ie_bug:!0,color:"#edd9a7",callback:function(e){p.inner=e,p.inner.className="jt-play-title-inner",p.inner.style.position="relative",p.inner.style.width=p.inner.width+"px",p.inner.style.height=p.inner.height+"px",p.inner.style.left=0,p.appendChild(p.inner)}}):(p.inner=document.createElement("div"),p.inner.className="jt-play-title-inner",p.appendChild(p.inner),p.inner.text=document.createElement("p"),p.inner.text.innerHTML=it.name,p.inner.appendChild(p.inner.text),R(p.inner.text,{unit_type:"px",transform_scale:g.content_scale}));var d=document.createElement("div");d.className="jt-play-action_area",d.style.overflow="hidden",g.appendChild(d),r.is_phone_or_tablet||d.addEventListener("mousedown",function(e){e.preventDefault()}),d.inner=document.createElement("div"),d.inner.style.position="absolute",d.inner.style.width="100%",d.inner.style.height="100%",d.inner.style.transformOrigin="0 0",d.appendChild(d.inner),e.zoom={scale:1,offset_x:0,offset_y:0};var ht=new PIXI.Stage,yt=new PIXI.DisplayObjectContainer,Nt=new PIXI.DisplayObjectContainer,i=g.draw_area=document.createElement("canvas");i.className="jt-draw_area",i.controls_locked=!1,r.is_webgl=function(){var e=document.createElement("canvas"),t=e.getContext("webgl");return null!=t?(r.canvas_context="webgl",!0):(r.canvas_context="2d",!1)}();var $t=new PIXI[1==r.is_webgl?"WebGLRenderer":"CanvasRenderer"](1,1,{transparent:!0,clearBeforeRender:!1,view:i});i.renderer=$t,i.stage=yt,i.piece_sprite_container=Nt,i.real_stage=ht,ht.addChild(yt),yt.addChild(Nt),i.load_opacity_transition=.5,i.style.pointerEvents="none",i.bg=document.createElement("canvas"),i.bg.image=new Image,i.bg.image.src=A.background_image_url,i.reposition_and_resize=function(){var t=B(g),n=o(g),e=g.content_scale,a=parseFloat(getComputedStyle(d).top),l=r.jigsaw_minimal_ui?0:o(X);i.style.left=Math.round((window.innerWidth-t*e)/2)+"px",i.style.top=Math.round((window.innerHeight-n*e)/2+a*e)+"px",i.style.width=t*e+"px",i.style.height=(n-a-l)*e+"px",i.fireworks&&i.fireworks.update_size();var s=window.getComputedStyle(d);i.cached_width=Math.round(parseFloat(s.width)),i.cached_height=Math.round(parseFloat(s.height))},i.reposition_and_resize(),void function(){switch(e.jigsaw_scale_low_power_sizer=e.difficulty_level>=r.jigsaw_reduce_texture_size?2:1,e.difficulty_level){case 0:w.cut_multiplier=1,e.piece_logical_scale=1*e.jigsaw_scale_low_power_sizer,w.shadow_white_opacity=.5,w.shadow_black_opacity=.8,w.border_scale=1,w.stroke_shadow_blur=16,e.zoom.scalemax=2;break;case 1:w.cut_multiplier=1.1,e.piece_logical_scale=.75*e.jigsaw_scale_low_power_sizer,w.shadow_white_opacity=.6,w.shadow_black_opacity=.8,w.border_scale=1,w.stroke_shadow_blur=15,e.zoom.scalemax=2.666;break;case 2:w.cut_multiplier=1.5,e.piece_logical_scale=.5*e.jigsaw_scale_low_power_sizer,w.shadow_white_opacity=.6,w.shadow_black_opacity=.8,w.border_scale=.8,w.stroke_shadow_blur=12,e.zoom.scalemax=4;break;case 3:w.cut_multiplier=1.75,e.piece_logical_scale=.5*e.jigsaw_scale_low_power_sizer,w.shadow_white_opacity=.7,w.shadow_black_opacity=.8,w.border_scale=.5,w.stroke_shadow_blur=8,e.zoom.scalemax=6}w.stroke_width=e.piece_logical_scale/e.jigsaw_scale_low_power_sizer}();var u=y.main_image=document.createElement("div");u.className="jt-play-main_image jt-jigsaw-main_image",n(u),kt(u),u.classList.add("jt-jigsaw-main_image-active");var T=u.base_image=document.createElement("img"),x=document.createElement("div");x.className="jt-jigsaw-piece_deck";var j,I,s=null;T.crossOrigin="Anonymous",r.get_image(T,Z,M,"default"),T.addEventListener("load",function(){null!=d&&d.inner.setTimeout(jt,30)});var f=new Image;f.src=r.get_set_directory(A.set_name)+"/gui/gui-loading.png",f.logical_parent=i,i.loading_animation=f,f.defer_start=function(e){d.inner.setTimeout(function(){f&&!f.game_initialized&&(f.start(),nt(void 0,!0))},e)},f.start=function(){1!=!!f.game_initialized&&(f.stage.alpha=1,f.display=!0,ht.addChild(f.stage),L())},f.stop=function(){f.stage&&(f.stage.alpha=1),f.game_initialized=!0,f.display&&(f.display=!1,ht.removeChild(f.stage)),L()},f.addEventListener("load",function(){if(null!=d&&d.isAttached()){var e=f.width/2,t=f.height,a=(i.width-e)/2,s=(i.height-t)/2;f.stage=new PIXI.DisplayObjectContainer;var r=document.createElement("canvas");r.width=e,r.height=t;var o=r.getContext("2d");o.drawImage(f,e,0,e,t,0,0,e,t),f.outer={},F({logical_parent:f.outer,parent:f.stage,canvas:r}),f.outer.sprite.x=a+e/2,f.outer.sprite.y=s+t/2,f.outer.sprite.width=e,f.outer.sprite.height=t,f.outer.sprite.pivot.x=e/2,f.outer.sprite.pivot.y=t/2;var n=document.createElement("canvas");n.width=e,n.height=t;var o=n.getContext("2d");o.drawImage(f,0,0),f.inner={},F({logical_parent:f.inner,parent:f.stage,canvas:n}),f.inner.sprite.x=a,f.inner.sprite.y=s,f.inner.sprite.width=e,f.inner.sprite.height=t,f.start(),nt(void 0,!0)}}),y.refresh_gui_display(),nt(void 0,!0);var gt=y.set_base_image_size=function(){var t=ai();T.width=t.width,T.height=t.height,2==r.jigsaw_arrange_pieces_on_entire_area&&T.naturalHeight<=T.naturalWidth&&(e.jigsaw_arrange_pieces_on_entire_area=!0),void function(){var r=Math.round(T.naturalWidth/T.naturalHeight*1e3)/1e3;switch(e.tile_x=tt.tile_x,e.tile_y=tt.tile_y,r){case.8:e.tile_x=e.tile_y,e.tile_y*=1.25;break;case 1:e.tile_x=e.tile_y;break;case 1.25:e.tile_x=1.25*e.tile_y;break;case 1.333:var t=e.tile_x;e.tile_x=e.tile_y,e.tile_y=t;break;case 1.364:var t=e.tile_x;e.tile_x=e.tile_y,e.tile_y=t;break;case 1.4:var t=e.tile_x;e.tile_x=e.tile_y,e.tile_y=t;break;case 1.433:var t=e.tile_x;e.tile_x=e.tile_y,e.tile_y=t;break;case 1.5:var t=e.tile_y;e.tile_x=e.tile_y,e.tile_y=.75*t}var i=e.tile_x*e.tile_y/tt.piece_column_max/2;e.area=[{top:0,height_ratio:1,piece_row_max:i,piece_column_max:tt.piece_column_max},{top:0,height_ratio:1,piece_row_max:i,piece_column_max:tt.piece_column_max}]}(),Ot(),u.left=(parseFloat(window.getComputedStyle(g).width)-T.width)/2,u.width=T.width,u.height=T.height;var i=u.composite_image;i.set_size()},St=y.size_pieces=function(e){e.forEach(function(e){e.calc_width=e.width_float*r.jigsaw_piece_scale_to_actual,e.calc_height=e.height_float*r.jigsaw_piece_scale_to_actual}),i.piece_sprite_container.is_cached=!1};g.cleanup=function(){if(r.IS_CORDOVA&&r.audio_container[A.last_intro_audio]&&(r.audio_container[A.last_intro_audio].src="",delete r.audio_container[A.last_intro_audio],A.last_intro_audio=""),i.fireworks&&i.fireworks.destroy(),ci(),null!=i.parentNode&&document.body.removeChild(i),k.destroy(),document.removeEventListener(r.events.POINT_MOVE,Dt),r.is_phone_or_tablet?g.removeEventListener("touchend",Y):(document.removeEventListener("mouseup",Y),window.addEventListener("blur",pt),window.removeEventListener("mouseout",Ft)),g.innerHTML="","undefined"!=typeof r.ambient_music.last_on_state&&(1==r.ambient_music.last_on_state&&(r.ambient_music_on=!0),delete r.ambient_music.last_on_state),"undefined"!=typeof j)for(var t=0;t<e.tile_x+1;t++){j[t]=[];for(var n=0;n<e.tile_y+1;n++)j[t][n]=void 0}i.piece_container&&(i.piece_container.children.forEach(function(e){I.splice(I.indexOf(e),1);var t=e.piece_matrix;t&&delete t[e.area][e.row][e.column],e.piece_matrix=null,e.width=0,D(e),e=null}),i.piece_container.children=[],delete i.piece_container.piece_matrix,delete i.piece_container),D(u.base_image),D(i.bg),f.inner&&D(f.inner),f.outer&&D(f.outer),D(u.composite_image),i.stage.removeChild(i.piece_sprite_container),i.real_stage.removeChild(i.stage),i.real_stage.interactionManager.removeEvents(),i.renderer.destroy&&i.renderer.destroy(),u.composite_image&&(delete u.composite_image.set_size,delete u.composite_image),delete g.draw_area,delete f.logical_parent;for(var a in i)delete i[a];A=null,r=null,M=null,J=null,ui=null,O=null,it=null,Z=null,$=null,y=null,w=null,e=null,tt=null,L=null,wt=null,p=null,h=null,V=null,k=null,At=null,Yt=null,d=null,i=null,u=null,T=null,x=null,s=null,j=null,I=null,f=null,gt=null,St=null,H=null,Mt=null,delete g.cleanup},x.drag_active=!1,x.drag_start=function(e){x.drag_active=!0,x.touch_id=e.identifier,x.drag_update(e,!0)},x.drag_update=function(s,o){if(0!=x.drag_active){var t=l(s,d),i=t[0]/g.content_scale,r=t[1]/g.content_scale,c=e.zoom.scale,n=e.zoom.offset_x,a=e.zoom.offset_y;o||(n+=i-x.drag_initial_x,a+=r-x.drag_initial_y),e.zoom.offset_x=n,e.zoom.offset_y=a,x.drag_initial_x=i,x.drag_initial_y=r,x.drag_initial_scale=c}},x.drag_end=function(){x.touch_id=null,x.drag_active=!1};var ut=void 0,H=y.save_puzzle_state=function(){var t={};t.game_instance={jigsaw_initial_show_hint_image:e.jigsaw_initial_show_hint_image,jigsaw_show_hint_image:e.jigsaw_show_hint_image,jigsaw_show_hint_rect:e.jigsaw_show_hint_rect,jigsaw_arrange_pieces_on_entire_area:e.jigsaw_arrange_pieces_on_entire_area,action_area_height:parseFloat(window.getComputedStyle(d.inner).height),base_image_width_to_naturalWidth:T.width/T.naturalWidth},t.counter=y.timer_obj.counter,t.zoom=e.zoom,t.piece_list=[],I.forEach(function(e){var e=Pt(e);delete e.width,delete e.height,t.piece_list.push(e)}),t.category_deck={};var r=t.category_deck.container=[];h.container.childNodes.forEach(function(t){var e={};e.innerHTML=t.childNodes[0].innerHTML,r.push(e);var i=e.pieces=[];t.piece_container.children.forEach(function(e){i.push({piece_id:e.piece_id})})}),t.category_deck.current_category_name=h.current_category.childNodes[0].innerHTML;var i=JSON.parse(localStorage["puzzle_states.$keys"]);i[$+"."+M+"."+O.selected_difficulty]=!0,localStorage["puzzle_states.$keys"]=JSON.stringify(i),localStorage["puzzle_states."+$+"."+M+"."+O.selected_difficulty]=JSON.stringify(t)},Mt=y.load_puzzle_state=function(s){function o(){var e={};I.forEach(function(t){e[t.piece_id]=t});var i=t.category_deck.current_category_name,r=t.category_deck.container;r.forEach(function(t){var r=h.add_category(t.innerHTML),n=t.pieces,a=r.piece_container;n.forEach(function(t){var i=e[t.piece_id];a.appendChild(i)}),t.innerHTML==i&&h.select_category(r),St(r.piece_container.children)}),Xt()&&ct(),s.callback()}var t=JSON.parse(localStorage["puzzle_states."+$+"."+M+"."+O.selected_difficulty]);e.jigsaw_initial_show_hint_image=t.game_instance.jigsaw_initial_show_hint_image,e.jigsaw_show_hint_image=r.jigsaw_show_hint_image,e.jigsaw_show_hint_rect=r.jigsaw_show_hint_rect,e.jigsaw_arrange_pieces_on_entire_area=t.game_instance.jigsaw_arrange_pieces_on_entire_area;var a=t.game_instance.action_area_height,i=t.game_instance.base_image_width_to_naturalWidth;if("undefined"==typeof i&&(i=1),"undefined"!=typeof a)var l=parseFloat(window.getComputedStyle(d.inner).height)/a;y.timer_obj.counter=t.counter,gt();var c=T.width/T.naturalWidth/i;e.zoom=t.zoom,j=[];for(var n=0;n<e.tile_x;n++)j[n]=[];I=t.piece_list,y.redraw_main_image_and_pieces({piece_rescale:c,top_rescale:l,callback:o})};y.redraw_main_image_and_pieces=function(p){function S(){f.restore();var t=o.getContext("2d");t.save(),m({x:e.piece_margin,y:e.piece_margin,scale:1/e.piece_logical_scale,data:v,strokeStyle:"rgba(63,63,63,1)",lineWidth:0,canvas:o}),t.clip(),t.drawImage(h,-e.piece_margin/e.piece_logical_scale,-e.piece_margin/e.piece_logical_scale),t.restore(),t.save(),t.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),dt(o),t.restore(),F({parent:i.stage,canvas:o,position:1,is_2d:!0}),o.sprite.x=u.left-e.piece_margin,o.sprite.y=u.top-e.piece_margin,"undefined"!=typeof E&&E()}"undefined"==typeof p&&(p={});var s=p.piece_rescale,A=p.top_rescale||1,E=p.callback;e.pieces_in_position_count=0;for(var b=[],g=[],d=0;d<I.length;d++){var t=I[d];if("undefined"!=typeof s&&(t.width_float=Math.round(t.width_float*s*1e3/1e3),t.height_float=Math.round(t.height_float*s*1e3/1e3),t.puzzle_left_min=Math.round(t.puzzle_left_min*s*1e3/1e3),t.puzzle_top_min=Math.round(t.puzzle_top_min*s*1e3/1e3),t.width=Math.ceil(t.width_float/e.piece_logical_scale),t.height=Math.ceil(t.height_float/e.piece_logical_scale),t.puzzle_width.forEach(function(i,e){t.puzzle_width[e]=Math.round(t.puzzle_width[e]*s*1e3/1e3),t.puzzle_height[e]=Math.round(t.puzzle_height[e]*s*1e3/1e3),t.puzzle_left[e]=Math.round(t.puzzle_left[e]*s*1e3/1e3),t.puzzle_top[e]=Math.round(t.puzzle_top[e]*s*1e3/1e3)}),t.side_set=li(t.side_set,s)),t.width=Math.ceil((t.width_float+2*e.piece_margin)/e.piece_logical_scale),t.height=Math.ceil((t.height_float+2*e.piece_margin)/e.piece_logical_scale),t.placed){e.pieces_in_position_count+=t.x.length,t.shape_string=Q(t.side_set,[-t.puzzle_left_min,-t.puzzle_top_min]),b.push(t);for(var l=0,x=t.x.length;x>l;l++)j[t.x[l]][t.y[l]]=t}else{if(g.push(t),I[d].canvas)var n=I[d];else var n=mt();n.x=a(t.x),n.y=a(t.y),n.zIndex=a(t.zIndex),n.piece_id=t.piece_id,n.width_float=t.width_float,n.height_float=t.height_float,n.width=t.width,n.height=t.height,n.virtual_left=t.virtual_left,n.virtual_top=t.virtual_top*A,n.puzzle_width=a(t.puzzle_width),n.puzzle_height=a(t.puzzle_height),n.puzzle_left_min=t.puzzle_left_min,n.puzzle_top_min=t.puzzle_top_min,n.puzzle_left=a(t.puzzle_left),n.puzzle_top=a(t.puzzle_top),n.side_set=a(t.side_set),n.placed=!1,I[d]=n;for(var l=0,x=n.x.length;x>l;l++)j[n.x[l]][n.y[l]]=n}}L();var M=at(b,r.jigsaw_combine_pieces),y=[];g.forEach(function(e){e.side_set.forEach(function(e){y.push(e)})});{var v=Q(M,[0,0]),R=v+" "+Q(y,[0,0]),c=T,o=u.composite_image;c.naturalWidth/c.width}o.set_size();var h=document.createElement("canvas");h.width=o.width,h.height=o.height;var f=h.getContext("2d"),k=c.naturalWidth,C=c.naturalHeight;f.drawImage(c,0,0,k,C,e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale,c.width/e.piece_logical_scale,c.height/e.piece_logical_scale),f.save(),f.translate(e.piece_margin/e.piece_logical_scale,e.piece_margin/e.piece_logical_scale),r.jigsaw_use_3d_effect&&_({canvas:h,draw_settings:w,stroke_width:w.stroke_width,cut_multiplier:w.cut_multiplier,shape_string:R,scale:1/e.piece_logical_scale,clear_stroke:"undefined"==typeof e.piece_margin_style,game_instance:e}),It({piece_grid:j,big_canvas:h,grid_is_new:!1,callback:S})}}function _(e){function t(t){{var i=t.game_instance,r=t.canvas,h=t.draw_settings,s=t.stroke_width/i.jigsaw_scale_low_power_sizer,p=t.cut_multiplier,d=t.shape_string,f=t.scale,c=t.outline_style||"transparent";t.clear_stroke}if(t.outline_width)var u=t.outline_width;else if(i.piece_margin_style&&0!=i.piece_margin)var u=i.piece_margin>=5?10:6;else var u=10;var u=8;u/=i.jigsaw_scale_low_power_sizer;var o=r.getContext("2d"),a=document.createElement("canvas");a.width=r.width,a.height=r.height;var e=a.getContext("2d");m({x:0,y:0,scale:f,data:d,strokeStyle:"rgba(255,255,255,1)",lineJoin:"round",lineCap:"round",lineWidth:2/i.jigsaw_scale_low_power_sizer,canvas:a}),e.shadowBlur=h.stroke_shadow_blur/i.jigsaw_scale_low_power_sizer,e.shadowColor="rgba(0,0,0,"+h.shadow_black_opacity+")",e.shadowOffsetX=3*-s,e.shadowOffsetY=3*-s,e.stroke(),e.shadowColor="rgba(255,255,255,"+h.shadow_white_opacity+")",e.shadowOffsetX=3*s,e.shadowOffsetY=3*s,e.stroke();var n=document.createElement("canvas");n.width=r.width,n.height=r.height;var l=n.getContext("2d");l.drawImage(a,0,0),l.drawImage(n,0,0),l.drawImage(n,0,0),l.drawImage(n,0,0),o.globalCompositeOperation="source-atop",o.drawImage(n,0,0),t.clear_stroke&&(e.clearRect(0,0,r.width,r.height),e.lineWidth=u*s*p*i.jigsaw_scale_low_power_sizer*.5,e.shadowBlur=0,"transparent"!=c&&(e.strokeStyle=c),e.shadowColor="rgba(0,0,0,0)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.stroke(),o.globalCompositeOperation="transparent"==c?"destination-out":"source-atop",o.drawImage(a,0,0)),o.globalCompositeOperation="source-over"}t(e)}function _t(i){function a(){var t=e.canvas;t.style.position="absolute",t.style.pointerEvents="none",t.style.zIndex=1e4,document.body.appendChild(t),s(),r()}function r(){"undefined"!=typeof e.proton&&(e.requestAnimationFrameID=requestAnimationFrame(r),e.proton.update())}function s(){var i=e.canvas,r=e.proton=new Proton,t=e.emitter=new Proton.Emitter;t.rate=new Proton.Rate(new Proton.Span(2,2),1),t.addInitialize(new Proton.Mass(1)),t.addInitialize(new Proton.Radius(1,2)),t.addInitialize(new Proton.P(new Proton.LineZone(10,i.height,i.width,i.height))),t.addInitialize(new Proton.Life(.8,1.75)),t.addInitialize(new Proton.V(new Proton.Span(.8,1.65),new Proton.Span(0,0,!0),"polar")),t.addBehavior(new Proton.Gravity(.1)),t.addBehavior(new Proton.Color("#ff0000","random")),t.emit(),r.addEmitter(t);var a=e.renderer=new Proton.Renderer("canvas",r,i);a.onProtonUpdate=function(){var r=e.canvas.getContext("2d"),t=e.canvas_temp.getContext("2d");e.canvas_temp.width=e.canvas_temp.width,t.globalAlpha=.9,t.drawImage(e.canvas,0,0,i.width,i.height),e.canvas.width=e.canvas.width,r.drawImage(e.canvas_temp,0,0,i.width,i.height)},a.start(),t.addEventListener(Proton.PARTICLE_DEAD,function(e){var t=Math.randInt(1,4);n.playAudio(n.audio_dir+"/fireworks-"+t+".ogg",{audio_type:"sound_effect",blocking:!1}),Math.random()<.7?o(e.particle):l(e.particle)})}function o(i){var r=e.proton,t=new Proton.Emitter;t.rate=new Proton.Rate(new Proton.Span(62,75),1),t.addInitialize(new Proton.Mass(1)),t.addInitialize(new Proton.Radius(1,2)),t.addInitialize(new Proton.Life(.9,2.5)),t.addInitialize(new Proton.V(new Proton.Span(.4,.8),new Proton.Span(0,360),"polar")),t.addBehavior(new Proton.RandomDrift(1,1,.005)),t.addBehavior(new Proton.Alpha(1,0)),t.addBehavior(new Proton.Gravity(.3));var n=Math.random()>.3?Proton.MathUtils.randomColor():"random";t.addBehavior(new Proton.Color(n)),t.p.x=i.p.x,t.p.y=i.p.y,t.emit("once",!0),r.addEmitter(t)}function l(i){var r=e.proton,t=new Proton.Emitter;t.rate=new Proton.Rate(new Proton.Span(50,60),1),t.addInitialize(new Proton.Mass(1)),t.addInitialize(new Proton.Radius(4,8)),t.addInitialize(new Proton.Life(1,2)),t.addInitialize(new Proton.V([.2,.4],new Proton.Span(0,360),"polar")),t.addBehavior(new Proton.Alpha(1,0)),t.addBehavior(new Proton.Scale(1,.1)),t.addBehavior(new Proton.Gravity(.09));var n=Proton.MathUtils.randomColor();t.addBehavior(new Proton.Color(n)),t.p.x=i.p.x,t.p.y=i.p.y,t.emit("once",!0),r.addEmitter(t)}var n=i.gs,t=i.draw_area,e=this;return e.destroy=function(){null!=e.canvas.parentNode&&e.canvas.parentNode.removeChild(e.canvas),e.proton.destroy(),cancelAnimationFrame(e.requestAnimationFrameID)},e.update_size=function(){if("undefined"==typeof e.canvas||e.canvas.width_full!=t.width||e.canvas.height_full!=t.height){"undefined"!=typeof e.canvas&&e.destroy();var i=e.canvas=document.createElement("canvas");i.width_full=t.width,i.height_full=t.height,i.width=t.width/5,i.height=t.height/5;var r=e.canvas_temp=document.createElement("canvas");r.width=t.width/5,r.height=t.height/5,a()}var i=e.canvas;i.style.width=t.style.width,i.style.height=t.style.height,i.style.left=t.style.left,i.style.top=t.style.top},e.update_size(),this}function mt(r){function s(){e.is_active||(e.title_index=(e.title_index+1)%e.title_list.length,e.innerHTML=e.title_list[e.title_index]),e.setTimeout(s,4e3)}var n=r.select_screen,a=(r.content_div,r.mr_jigtato),i=r.gs,o=n.header,e=document.createElement("div");return e.className="jt-select_screen-header-show_hint_image jt-select_screen-header-size-2 jt-button hoverable",e.title_list=["Tell a friend!","Earn extra puzzle packs!","Get 10 gems per friend!"],e.title_index=e.title_list.length-1,s(),e.addEventListener(i.events.POINT,function(){e.toggle()}),e.toggle=function(){e.is_active?e.deactivate():e.activate()},e.activate=function(){h({gs:i,error:function(){smoke.alert("You must log in to Google Play to use this feature!")},success:function(){e.is_active=!0,o.querySelectorAll(".jt-button").forEach(function(t){t!=e&&t!=n.difficulty_level_button&&(t.style.display="none")}),e.classList.remove("jt-select_screen-header-size-2"),e.classList.add("jt-select_screen-header-size-4"),e.innerHTMLoriginal=e.innerHTML,e.innerHTML="Pick a puzzle to create the challenge with!",i.log_user_action("Tell a friend: initialized.")}})},e.deactivate=function(){e.is_active=!1,o.querySelectorAll(".jt-button").forEach(function(t){t!=e&&t!=n.difficulty_level_button&&(t.style.display="")}),e.classList.add("jt-select_screen-header-size-2"),e.classList.remove("jt-select_screen-header-size-4"),e.innerHTML=e.innerHTMLoriginal},e.select_puzzle=function(v){function _(){function a(a){return i.log_user_action("Tell-a-friend: email entered: "+a),a===!1?void e.deactivate():void h({gs:i,error:function(){e.deactivate(),smoke.alert("You must log in to Google Play to use this feature!")},success:function(){t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(i.DEBUG?"-beta":"")+".php?action=social_challenge_a_friend&user_id="+i.account.user_id+"&internal_access_token="+i.account.internal_access_token+"&puzzle_name="+r+"&selected_difficulty="+n+"&best_time="+l+"&email_address_list="+a,error:function(t){i.errormessage(t,e.deactivate)},request_method:"POST",async:!0,success:function(){e.deactivate();var t=smoke.alert("Your challenge has been sent! If your friend downloads the game and enter your unique code for the first time (specified in the email), they will receive access to the puzzle you shared, and both of you will receive 10 gems each!");t.dialog.text.style.textAlign="left",t.dialog.text.style.textIndent="1em",t.dialog.buttons.ok.innerHTML="Excellent!"}})}})}if(i.log_user_action("Tell-a-friend: email prompt screen."),window.plugins&&window.plugins.ContactPickerPlugin)return void window.plugins.ContactPickerPlugin.pickContact({error:function(t){i.errormessage(t),e.deactivate()},success:function(t){return"object"!=typeof t||"string"!=typeof t.email?void e.deactivate():void setTimeout(function(){a(t.email)},0)}});smoke.prompt("Type in your friend's email(s) to send them your challenge!",a,{ok:"Send!"})}var r=v.level_id,u=a.player_data,n=u.selected_difficulty,s=i.jigsaw_show_hint_image,o=u.jigsaw.best_times[+s];if("undefined"==typeof o[r]){s=!s;var o=u.jigsaw.best_times[+s]}if("undefined"==typeof o[r])return void smoke.alert("You didn't finish this puzzle!");if("undefined"==typeof o[r][n]){var n=0;for(var p in o[r])p>n&&(n=p)}var f=a.game_data.jigsaw.difficulty_levels[n].name.capitalize(),l=o[r][n],d=(l-l%60)/60,m=l%60,g=(d>0?d+" minutes, ":"")+m+" seconds",y=a.game_data.entry_list[r].name,c=smoke.alert('Your best time on "'+y.capitalize().replace(/_/g," ")+'" in '+f+" mode is "+g+", with the hint image "+(1==s?"ON":"OFF")+".",_);c.dialog.text.style.textAlign="left",c.dialog.text.style.textIndent="1em",c.dialog.buttons.ok.innerHTML="Continue..."},e}function y(e){function i(){t.challenge_code_request_asked=!0;var i=smoke.confirm('If you received a CHALLENGE CODE from a friend, enter one to gain 10 "gems".'+e.extra_text,function(r){if(r===!1)return void e.callback();var i=smoke.prompt("",function(i){A({gs:t,challenge_code:i,error:function(){y(e)},success:e.callback})});i.dialog.text.parentNode.removeChild(i.dialog.text)}),r=(i.dialog,i.dialog.text);r.style.textAlign="left",r.style.textIndent="1em",i.buttons.ok.innerHTML="Enter It",i.buttons.cancel.innerHTML="No Challenge Code",n(i.buttons)}var t=e.gs;"undefined"==typeof e.callback&&(e.callback=function(){}),"undefined"==typeof e.extra_text&&(e.extra_text=""),h({gs:t,error:e.callback,success:function(){if("undefined"!=typeof t.android.INSTALL_REFERRER||"undefined"!=typeof t.account.email_address){var r="";"undefined"!=typeof t.android.INSTALL_REFERRER&&(r=function(){var e="";return t.android.INSTALL_REFERRER.split(";").findIndex(function(i){var t=i.split("=");if(1!=t.length&&"S.referrer"==t[0]){var t=decodeURIComponent(t[1]).split("=");if(1!=t.length)return e=t[1],!0}}),e}());var r=t.android.INSTALL_REFERRER;A({gs:t,challenge_code:r,error:i,success:e.callback})}else i()}})}function A(e){var i=e.gs,r="undefined"!=typeof e.challenge_code?e.challenge_code:"",n=(e.error,function(t){if(i.challenge_code_processed=!0,"undefined"==typeof t||"undefined"==typeof t.gem_amount)return void e.success();smoke.alert("CHALLENGE code provided by your friend, "+t.challenger_name+", "+auto_accept+'accepted. You have received 10 gems and access to the "'+t.puzzle_name.capitalize()+'" puzzle!',e.success),"undefined"!=typeof t.gem_amount&&(i.account.gem_amount=t.gem_amount)});t({file:"http://www.flyingsoftgames.com/mr_jigtato/check-in_new"+(i.DEBUG?"-beta":"")+".php?action=social_accept_challenge&challenge_code="+r+"&accepter_user_id="+i.account.user_id+"&internal_access_token="+i.account.internal_access_token,error:function(t){return""==r?void n():void i.errormessage(t,e.error)},request_method:"POST",async:!0,success:n})}var L="safari",k="com.flyingsoft.safari.jigsaw",s=!0,d=!0;!function(s,r){var i,a,t,e,n;s.Kiip||(e={version:"1.0g",request:r,busy:!1,requestQueue:[{events:[{id:"session_start",start:(new Date).toISOString()}]}],currentUnit:r,unitQueue:[],localWebIDKey:"kpwd",userData:null,app_key:null,frameTimeout:5e3,postData:function(e){return this.busy||!this.device_id?void this.requestQueue.push(e):(this.busy=!0,e=new t.Options(e),this.request||(window.XDomainRequest?(this.request=new window.XDomainRequest,this.request.onload=this._handleXDomainLoad,this.request.onerror=this._handleFailure,this.request.ontimeout=this._handleFailure):(this.request=new window.XMLHttpRequest,this.request.onreadystatechange=this._handleReadyStateChange)),this.request.open("POST",t.getOrigin()+t.API+"r="+t.now(),!0),this.request.setRequestHeader&&(this.request.setRequestHeader("Accept","application/json"),this.request.setRequestHeader("Content-Type","application/json"),this.request.setRequestHeader("X-Requested-With","XMLHttpRequest")),this.request._type=e.moment_id?"moment":"analytics",void this.request.send(JSON.stringify(e)))},_handleXDomainLoad:function(){e._handleSuccess(),e.busy=!1,e.nextMoment()},_handleReadyStateChange:function(){e.readyStateChange()},readyStateChange:function(){4===this.request.readyState&&("moment"===this.request._type&&(this.request.status>=200&&this.request.status<300||0===this.request.status?this._handleSuccess():this._handleFailure()),this.busy=!1,this.request._type=r,this.nextMoment())},_handleFailure:function(){e.instance.callback(null)},_handleSuccess:function(){var e;try{e=JSON.parse(this.request.responseText)}catch(t){e=null}e&&e.view?this.createUnit(e.view.modal):this._handleFailure()},_handleMessages:function(t){var r,i;r=t&&t.data?t.data:"",i=r.split("|"),e.parseFrameCommand(i[0],i[1])},_handleDeviceIDFail:function(){e.parseFrameCommand("webid","blocked;web-noid")},_handleUnitFail:function(){e.parseFrameCommand("destroy"),e.instance.callback(null)},parseFrameCommand:function(t,i){var e=this.currentUnit;clearTimeout(this._iframeTimeout),"webid"===t&&(this.busy=!1,this.validateWebID(i),this.nextMoment()),"ready"===t&&e&&this.instance.callback(e),"destroy"===t&&e&&e.destroy(),e=r},validateWebID:function(e){e&&e.match(/^blocked;/)&&(e=e.split(";")[1],e=this.getLocalWebID(e)),this.device_id=e,this.webIDFrame.parentNode.removeChild(this.webIDFrame),this.webIDFrame=r},getLocalWebID:function(i){var e,t=window.localStorage&&window.localStorage.getItem?window.localStorage:null;if(t&&(e=t.getItem(this.localWebIDKey)),e||(e=this.getCookie(this.localWebIDKey)),e||(e=i),t)try{t.setItem(this.localWebIDKey,e)}catch(r){}return this.setCookie(this.localWebIDKey,e,1/0,"/",window.location.hostname,!1),e},createUnit:function(e){return this.currentUnit?void this.unitQueue.push(e):void(this.currentUnit=new a(e.body_url))},nextUnit:function(){var e=this.unitQueue.shift();this.currentUnit=r,e&&this.createUnit(e)},nextMoment:function(){this.requestQueue.length&&!this.busy&&setTimeout(function(){this.postData(this.requestQueue.shift())}.bind(this),0)},getDeviceID:function(){var i;if(!(this.busy||this.device_id||t.isBadIE)){if(!window.document.body)return void window.document.addEventListener("DOMContentLoaded",this.getDeviceID.bind(this),!1);window.addEventListener("message",e._handleMessages,!1),this.busy=!0,i=t.getOrigin()+"/webid/",i+="?"+encodeURIComponent(t.protocol+"://"+window.location.hostname+(window.location.port?":"+window.location.port:"")),this.webIDFrame=document.createElement("iframe"),this.webIDFrame.setAttribute("frameborder","0"),this.webIDFrame.setAttribute("src",i),this.webIDFrame.style.position="absolute",this.webIDFrame.style.width=0,this.webIDFrame.style.height=0,document.body.appendChild(this.webIDFrame),this._iframeTimeout=setTimeout(this._handleDeviceIDFail,this.frameTimeout)}},getCookie:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setCookie:function(i,a,e,r,n,s){if(!i||/^(?:expires|max\-age|path|domain|secure)$/i.test(i))return!1;var t="";if(e)switch(e.constructor){case Number:t=1/0===e?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+e;break;case String:t="; expires="+e;break;case Date:t="; expires="+e.toUTCString()}return document.cookie=encodeURIComponent(i)+"="+encodeURIComponent(a)+t+(n?"; domain="+n:"")+(r?"; path="+r:"")+(s?"; secure":""),!0}},t={isBadIE:!window.document.addEventListener,protocol:"file:"===window.location.protocol?"http":window.location.protocol.replace(":",""),origin:"://api.kiip.me",getOrigin:function(){return this.protocol+this.origin},API:"/2.0/web/moment/?",Options:function(r){var i={};return e.testMode&&(i.test=!0),e.web_user_id&&(i.web_user_id=e.web_user_id),"[object Object]"===t.typeOf(r)&&t.merge(i,r),i.app_key=e.app_key,i.user_data=e.userData,i.protocol=t.protocol,i.sdk_version="1.0",i.device_id=e.device_id,i},toQueryString:function(i){var e,r,t,n=[];for(t in i)e=i[t],r=t+"="+encodeURIComponent(e),e&&n.push(r);return n.join("&")},merge:function(r,i){var e;for(e in i)"[object Function]"!==t.typeOf(i[e])&&i[e]&&(r[e]=i[e]);return r},now:function(){return+new Date},typeOf:function(e){return Object.prototype.toString.call(e)},uniqueID:function(){return n||(n=t.now()),(n++).toString(36)}},i=function(i,r){if(e.instance&&i===e.app_key)return e.instance;if(e.instance)throw new Error("Kiip Error: Only one Kiip instance is allowed per page");if(!i)throw new Error("Kiip Error: You must supply an app key");(!window.JSON||t.isBadIE)&&(e.disabled=!0),e.app_key=i,"[object Function]"===t.typeOf(r)&&(this.callback=r),e.instance=this},i.prototype.setEmail=function(t){return e.email=t,this},i.prototype.setUserId=function(i){return("[object String]"===t.typeOf(i)||"[object Number]"===t.typeOf(i))&&(e.web_user_id=i+""),this},i.prototype.setContainer=function(i){return e.container="[object String]"===t.typeOf(i)?document.getElementById(i):i,this},i.prototype.setUserData=function(i){return"[object Object]"!==t.typeOf(i)?this:(e.userData||(e.userData={}),t.merge(e.userData,i),this)},i.prototype.setTestMode=function(){return e.testMode=!0,this},i.prototype.postMoment=function(t){return!t||e.disabled?(this.callback(null),this):(e.postData({moment_id:t}),this)},i.prototype.callback=function(e){e&&e.show&&e.show()},i.prototype.unload=function(){return e.email=r,e.container=r,e.currentUnit&&e.currentUnit.destroy(),e.request&&e.request.abort(),window.removeEventListener?window.removeEventListener("message",e._handleMessages,!1):window.detachEvent("onmessage",e._handleMessages),e.instance=null,r},i.version=e.version,a=function(r){var i,a,n;this.id=t.uniqueID(),r+="&domain="+encodeURIComponent(t.protocol+"://"+window.location.hostname+(window.location.port?":"+window.location.port:"")),r+="&frame_id="+this.id,r+="&overlay="+(e.container?"false":"true"),i=document.createElement("iframe"),i.setAttribute("frameborder","0"),i.setAttribute("src",r),i.style.zIndex="2147483647",i.style.width="100%",i.style.height="100%",i.style.minWidth="320px",i.style.minHeight="330px",e.container?(i.style.position="relative",e.container.appendChild(i)):(i.style.position="fixed",i.style.top="-999999px",i.style.left="-999999px",document.body.appendChild(i)),this.setID=function(e){return i.id=e,this},this.show=function(r){return n?this:(n=!0,i.style.top="0px",i.style.left="0px","[object Function]"===t.typeOf(r)&&(a=r),i.contentWindow.postMessage("show",t.getOrigin()),e.email&&i.contentWindow.postMessage("email="+e.email,t.getOrigin()),this)},this.destroy=function(){return n?(n=!1,i.parentNode.removeChild(i),a&&a(),e.nextUnit(),this):this},e._iframeTimeout=setTimeout(e._handleUnitFail,e.frameTimeout)},e.getDeviceID(),window.Kiip=i)}(window);var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(t){if(null==t)return"";var a,r,n,c,h,o,s,l="",i=0;for(t=e.compress(t);i<2*t.length;)i%2==0?(a=t.charCodeAt(i/2)>>8,r=255&t.charCodeAt(i/2),n=i/2+1<t.length?t.charCodeAt(i/2+1)>>8:0/0):(a=255&t.charCodeAt((i-1)/2),(i+1)/2<t.length?(r=t.charCodeAt((i+1)/2)>>8,n=255&t.charCodeAt((i+1)/2)):r=n=0/0),i+=3,c=a>>2,h=(3&a)<<4|r>>4,o=(15&r)<<2|n>>6,s=63&n,isNaN(r)?o=s=64:isNaN(n)&&(s=64),l=l+e._keyStr.charAt(c)+e._keyStr.charAt(h)+e._keyStr.charAt(o)+e._keyStr.charAt(s);return l},decompressFromBase64:function(t){if(null==t)return"";var i,o,l,c,p,u,n,a,s="",d=0,r=0,h=e._f;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");r<t.length;)p=e._keyStr.indexOf(t.charAt(r++)),u=e._keyStr.indexOf(t.charAt(r++)),n=e._keyStr.indexOf(t.charAt(r++)),a=e._keyStr.indexOf(t.charAt(r++)),o=p<<2|u>>4,l=(15&u)<<4|n>>2,c=(3&n)<<6|a,d%2==0?(i=o<<8,64!=n&&(s+=h(i|l)),64!=a&&(i=c<<8)):(s+=h(i|o),64!=n&&(i=l<<8),64!=a&&(s+=h(i|c))),d+=3;return e.decompress(s)},compressToUTF16:function(a){if(null==a)return"";var s,t,i,r="",o=0,n=e._f;for(a=e.compress(a),s=0;s<a.length;s++)switch(t=a.charCodeAt(s),o++){case 0:r+=n((t>>1)+32),i=(1&t)<<14;break;case 1:r+=n(i+(t>>2)+32),i=(3&t)<<13;break;case 2:r+=n(i+(t>>3)+32),i=(7&t)<<12;break;case 3:r+=n(i+(t>>4)+32),i=(15&t)<<11;break;case 4:r+=n(i+(t>>5)+32),i=(31&t)<<10;break;case 5:r+=n(i+(t>>6)+32),i=(63&t)<<9;break;case 6:r+=n(i+(t>>7)+32),i=(127&t)<<8;break;case 7:r+=n(i+(t>>8)+32),i=(255&t)<<7;break;case 8:r+=n(i+(t>>9)+32),i=(511&t)<<6;break;case 9:r+=n(i+(t>>10)+32),i=(1023&t)<<5;break;case 10:r+=n(i+(t>>11)+32),i=(2047&t)<<4;break;case 11:r+=n(i+(t>>12)+32),i=(4095&t)<<3;break;case 12:r+=n(i+(t>>13)+32),i=(8191&t)<<2;break;case 13:r+=n(i+(t>>14)+32),i=(16383&t)<<1;break;case 14:r+=n(i+(t>>15)+32,(32767&t)+32),o=0}return r+n(i+32)},decompressFromUTF16:function(a){if(null==a)return"";for(var i,t,r="",o=0,s=0,n=e._f;s<a.length;){switch(t=a.charCodeAt(s)-32,o++){case 0:i=t<<1;break;case 1:r+=n(i|t>>14),i=(16383&t)<<2;break;case 2:r+=n(i|t>>13),i=(8191&t)<<3;break;case 3:r+=n(i|t>>12),i=(4095&t)<<4;break;case 4:r+=n(i|t>>11),i=(2047&t)<<5;break;case 5:r+=n(i|t>>10),i=(1023&t)<<6;break;case 6:r+=n(i|t>>9),i=(511&t)<<7;break;case 7:r+=n(i|t>>8),i=(255&t)<<8;break;case 8:r+=n(i|t>>7),i=(127&t)<<9;break;case 9:r+=n(i|t>>6),i=(63&t)<<10;break;case 10:r+=n(i|t>>5),i=(31&t)<<11;break;case 11:r+=n(i|t>>4),i=(15&t)<<12;break;case 12:r+=n(i|t>>3),i=(7&t)<<13;break;case 13:r+=n(i|t>>2),i=(3&t)<<14;break;case 14:r+=n(i|t>>1),i=(1&t)<<15;break;case 15:r+=n(i|t),o=0}s++}return e.decompress(r)},compress:function(_){if(null==_)return"";var r,n,f,u={},d={},h="",p="",a="",l=2,m=3,s=2,o="",t=0,i=0,c=e._f;for(f=0;f<_.length;f+=1)if(h=_.charAt(f),Object.prototype.hasOwnProperty.call(u,h)||(u[h]=m++,d[h]=!0),p=a+h,Object.prototype.hasOwnProperty.call(u,p))a=p;else{if(Object.prototype.hasOwnProperty.call(d,a)){if(a.charCodeAt(0)<256){for(r=0;s>r;r++)t<<=1,15==i?(i=0,o+=c(t),t=0):i++;for(n=a.charCodeAt(0),r=0;8>r;r++)t=t<<1|1&n,15==i?(i=0,o+=c(t),t=0):i++,n>>=1}else{for(n=1,r=0;s>r;r++)t=t<<1|n,15==i?(i=0,o+=c(t),t=0):i++,n=0;for(n=a.charCodeAt(0),r=0;16>r;r++)t=t<<1|1&n,15==i?(i=0,o+=c(t),t=0):i++,n>>=1}l--,0==l&&(l=Math.pow(2,s),s++),delete d[a]}else for(n=u[a],r=0;s>r;r++)t=t<<1|1&n,15==i?(i=0,o+=c(t),t=0):i++,n>>=1;l--,0==l&&(l=Math.pow(2,s),s++),u[p]=m++,a=String(h)}if(""!==a){if(Object.prototype.hasOwnProperty.call(d,a)){if(a.charCodeAt(0)<256){for(r=0;s>r;r++)t<<=1,15==i?(i=0,o+=c(t),t=0):i++;for(n=a.charCodeAt(0),r=0;8>r;r++)t=t<<1|1&n,15==i?(i=0,o+=c(t),t=0):i++,n>>=1}else{for(n=1,r=0;s>r;r++)t=t<<1|n,15==i?(i=0,o+=c(t),t=0):i++,n=0;for(n=a.charCodeAt(0),r=0;16>r;r++)t=t<<1|1&n,15==i?(i=0,o+=c(t),t=0):i++,n>>=1}l--,0==l&&(l=Math.pow(2,s),s++),delete d[a]}else for(n=u[a],r=0;s>r;r++)t=t<<1|1&n,15==i?(i=0,o+=c(t),t=0):i++,n>>=1;l--,0==l&&(l=Math.pow(2,s),s++)}for(n=2,r=0;s>r;r++)t=t<<1|1&n,15==i?(i=0,o+=c(t),t=0):i++,n>>=1;for(;;){if(t<<=1,15==i){o+=c(t);break}i++}return o},decompress:function(_){if(null==_)return"";if(""==_)return null;var g,d,h,r,a,n,i,s,o=[],l=4,c=4,p=3,u="",m="",f=e._f,t={string:_,val:_.charCodeAt(0),position:32768,index:1};for(d=0;3>d;d+=1)o[d]=d;for(r=0,n=Math.pow(2,2),i=1;i!=n;)a=t.val&t.position,t.position>>=1,0==t.position&&(t.position=32768,t.val=t.string.charCodeAt(t.index++)),r|=(a>0?1:0)*i,i<<=1;switch(g=r){case 0:for(r=0,n=Math.pow(2,8),i=1;i!=n;)a=t.val&t.position,t.position>>=1,0==t.position&&(t.position=32768,t.val=t.string.charCodeAt(t.index++)),r|=(a>0?1:0)*i,i<<=1;s=f(r);break;case 1:for(r=0,n=Math.pow(2,16),i=1;i!=n;)a=t.val&t.position,t.position>>=1,0==t.position&&(t.position=32768,t.val=t.string.charCodeAt(t.index++)),r|=(a>0?1:0)*i,i<<=1;s=f(r);break;case 2:return""}for(o[3]=s,h=m=s;;){if(t.index>t.string.length)return"";for(r=0,n=Math.pow(2,p),i=1;i!=n;)a=t.val&t.position,t.position>>=1,0==t.position&&(t.position=32768,t.val=t.string.charCodeAt(t.index++)),r|=(a>0?1:0)*i,i<<=1;switch(s=r){case 0:for(r=0,n=Math.pow(2,8),i=1;i!=n;)a=t.val&t.position,t.position>>=1,0==t.position&&(t.position=32768,t.val=t.string.charCodeAt(t.index++)),r|=(a>0?1:0)*i,i<<=1;o[c++]=f(r),s=c-1,l--;break;case 1:for(r=0,n=Math.pow(2,16),i=1;i!=n;)a=t.val&t.position,t.position>>=1,0==t.position&&(t.position=32768,t.val=t.string.charCodeAt(t.index++)),r|=(a>0?1:0)*i,i<<=1;o[c++]=f(r),s=c-1,l--;break;case 2:return m}if(0==l&&(l=Math.pow(2,p),p++),o[s])u=o[s];else{if(s!==c)return null;u=h+h.charAt(0)}m+=u,o[c++]=h+u.charAt(0),l--,h=u,0==l&&(l=Math.pow(2,p),p++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=e),!function(n,a,i,e,u,g,s,o,l){function y(a){var l,s=a.length,i=this,r=0,o=i.i=i.j=0,n=i.S=[];for(s||(a=[s++]);e>r;)n[r]=r++;for(r=0;e>r;r++)n[r]=n[o=t&o+a[r%s]+(l=n[r])],n[o]=l;(i.g=function(l){for(var s,o=0,n=i.i,a=i.j,r=i.S;l--;)s=r[n=t&n+1],o=o*e+r[t&(r[n]=r[a=t&a+s])+(r[a]=s)];return i.i=n,i.j=a,o})(e)}function h(e,i){var r,t=[],n=typeof e;if(i&&"object"==n)for(r in e)try{t.push(h(e[r],i-1))}catch(a){}return t.length?t:"string"==n?e:e+"\x00"}function c(a,i){for(var s,n=a+"",e=0;e<n.length;)i[t&e]=t&(s^=19*i[t&e])+n.charCodeAt(e++);return r(i)}function _(t){try{return n.crypto.getRandomValues(t=new Uint8Array(e)),r(t)}catch(i){return[+new Date,n,(t=n.navigator)&&t.plugins,n.screen,r(a)]}}function r(e){return String.fromCharCode.apply(0,e)}var f=i.pow(e,u),d=i.pow(2,g),m=2*d,t=e-1,p=i["seed"+l]=function(n,t,p){var o=[];t=1==t?{entropy:!0}:t||{};var g=c(h(t.entropy?[n,r(a)]:null==n?_():n,3),o),s=new y(o);return c(r(s.S),a),(t.pass||p||function(e,t,r){return r?(i[l]=e,t):e})(function(){for(var t=s.g(u),r=f,i=0;d>t;)t=(t+i)*e,r*=e,i=s.g(1);for(;t>=m;)t/=2,r/=2,i>>>=1;return(t+i)/r},g,"global"in t?t.global:this==i)};c(i[l](),a),s&&s.exports?s.exports=p:o&&o.amd&&o(function(){return p})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random"),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozancelAnimationFrame||window.webkitCancelAnimationFrame,!function(){var i=this,e=e||{};e.WEBGL_RENDERER=0,e.CANVAS_RENDERER=1,e.VERSION="v1.6.1",e.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},e.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},e._UID=0,"undefined"!=typeof Float32Array?(e.Float32Array=Float32Array,e.Uint16Array=Uint16Array):(e.Float32Array=Array,e.Uint16Array=Array),e.INTERACTION_FREQUENCY=30,e.AUTO_PREVENT_DEFAULT=!0,e.RAD_TO_DEG=180/Math.PI,e.DEG_TO_RAD=Math.PI/180,e.RETINA_PREFIX="@2x",e.dontSayHello=!0,e.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0},e.sayHello=function(t){if(!e.dontSayHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var i=["%c %c %c Pixi.js "+e.VERSION+" - "+t+"  %c  %c  http://www.pixijs.com/  %c %c %c%c ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,i)}else window.console&&console.log("Pixi.js "+e.VERSION+" - http://www.pixijs.com/");e.dontSayHello=!0}},e.Point=function(e,t){this.x=e||0,this.y=t||0},e.Point.prototype.clone=function(){return new e.Point(this.x,this.y)},e.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},e.Point.prototype.constructor=e.Point,e.Rectangle=function(e,t,i,r){this.x=e||0,this.y=t||0,this.width=i||0,this.height=r||0},e.Rectangle.prototype.clone=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Rectangle.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(e>=i&&e<=i+this.width){var r=this.y;if(t>=r&&t<=r+this.height)return!0}return!1},e.Rectangle.prototype.constructor=e.Rectangle,e.EmptyRectangle=new e.Rectangle(0,0,0,0),e.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),"number"==typeof t[0]){for(var r=[],i=0,n=t.length;n>i;i+=2)r.push(new e.Point(t[i],t[i+1]));t=r}this.points=t},e.Polygon.prototype.clone=function(){for(var i=[],t=0;t<this.points.length;t++)i.push(this.points[t].clone());return new e.Polygon(i)},e.Polygon.prototype.contains=function(o,t){for(var i=!1,e=0,r=this.points.length-1;e<this.points.length;r=e++){var a=this.points[e].x,n=this.points[e].y,l=this.points[r].x,s=this.points[r].y,c=n>t!=s>t&&(l-a)*(t-n)/(s-n)+a>o;c&&(i=!i)}return i},e.Polygon.prototype.constructor=e.Polygon,e.Circle=function(e,t,i){this.x=e||0,this.y=t||0,this.radius=i||0},e.Circle.prototype.clone=function(){return new e.Circle(this.x,this.y,this.radius)},e.Circle.prototype.contains=function(i,r){if(this.radius<=0)return!1;var e=this.x-i,t=this.y-r,n=this.radius*this.radius;return e*=e,t*=t,n>=e+t},e.Circle.prototype.getBounds=function(){return new e.Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},e.Circle.prototype.constructor=e.Circle,e.Ellipse=function(e,t,i,r){this.x=e||0,this.y=t||0,this.width=i||0,this.height=r||0},e.Ellipse.prototype.clone=function(){return new e.Ellipse(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.contains=function(i,r){if(this.width<=0||this.height<=0)return!1;var e=(i-this.x)/this.width,t=(r-this.y)/this.height;return e*=e,t*=t,1>=e+t},e.Ellipse.prototype.getBounds=function(){return new e.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},e.Ellipse.prototype.constructor=e.Ellipse,e.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},e.Matrix.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},e.Matrix.prototype.toArray=function(i){this.array||(this.array=new e.Float32Array(9));var t=this.array;return i?(t[0]=this.a,t[1]=this.c,t[2]=0,t[3]=this.b,t[4]=this.d,t[5]=0,t[6]=this.tx,t[7]=this.ty,t[8]=1):(t[0]=this.a,t[1]=this.b,t[2]=this.tx,t[3]=this.c,t[4]=this.d,t[5]=this.ty,t[6]=0,t[7]=0,t[8]=1),t},e.Matrix.prototype.apply=function(i,t){return t=t||new e.Point,t.x=this.a*i.x+this.b*i.y+this.tx,t.y=this.c*i.x+this.d*i.y+this.ty,t},e.Matrix.prototype.applyInverse=function(r,i){i=i||new e.Point;var t=1/(this.a*this.d+this.b*-this.c);return i.x=this.d*t*r.x-this.b*t*r.y+(this.ty*this.b-this.tx*this.d)*t,i.y=this.a*t*r.y-this.c*t*r.x+(this.tx*this.c-this.ty*this.a)*t,i},e.Matrix.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},e.Matrix.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},e.Matrix.prototype.rotate=function(i){var e=Math.cos(i),t=Math.sin(i),r=this.a,n=this.c,a=this.tx;return this.a=r*e-this.b*t,this.b=r*t+this.b*e,this.c=n*e-this.d*t,this.d=n*t+this.d*e,this.tx=a*e-this.ty*t,this.ty=a*t+this.ty*e,this},e.identityMatrix=new e.Matrix,e.determineMatrixArrayType=function(){return"undefined"!=typeof Float32Array?Float32Array:Array},e.Matrix2=e.determineMatrixArrayType(),e.DisplayObject=function(){this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new e.Matrix,this.color=[],this.dynamic=!0,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new e.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},e.DisplayObject.prototype.constructor=e.DisplayObject,e.DisplayObject.prototype.setInteractive=function(e){this.interactive=e},Object.defineProperty(e.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(e){this._interactive=e,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}}),Object.defineProperty(e.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask&&(this._mask.isMask=!1),this._mask=e,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(e){if(e){for(var r=[],t=0;t<e.length;t++)for(var n=e[t].passes,i=0;i<n.length;i++)r.push(n[i]);this._filterBlock={target:this,filterPasses:r}}this._filters=e}}),Object.defineProperty(e.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap!==e&&(e?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=e)}}),e.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var e=this.parent.worldTransform,t=this.worldTransform,p=this.pivot.x,d=this.pivot.y,n=this._cr*this.scale.x,a=-this._sr*this.scale.y,s=this._sr*this.scale.x,c=this._cr*this.scale.y,u=this.position.x-n*p-d*a,h=this.position.y-c*d-p*s,l=e.a,r=e.b,i=e.c,o=e.d;t.a=l*n+r*s,t.b=l*a+r*c,t.tx=l*u+r*h+e.tx,t.c=i*n+o*s,t.d=i*a+o*c,t.ty=i*u+o*h+e.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},e.DisplayObject.prototype.getBounds=function(t){return t=t,e.EmptyRectangle},e.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(e.identityMatrix)},e.DisplayObject.prototype.setStageReference=function(e){this.stage=e,this._interactive&&(this.stage.dirty=!0)},e.DisplayObject.prototype.generateTexture=function(r,n,a){var t=this.getLocalBounds(),i=new e.RenderTexture(0|t.width,0|t.height,a,n,r);return i.render(this,new e.Point(-t.x,-t.y)),i},e.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},e.DisplayObject.prototype.toGlobal=function(e){return this.updateTransform(),this.worldTransform.apply(e)},e.DisplayObject.prototype.toLocal=function(e,t){return t&&(e=t.toGlobal(e)),this.updateTransform(),this.worldTransform.applyInverse(e)},e.DisplayObject.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha,t.gl?e.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):e.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},e.getAncestorRenderer=function(t){for(;;){if(null==t||"object"!=typeof t)return void 0;if(t.renderer instanceof e.WebGLRenderer||t.renderer instanceof e.CanvasRenderer)return t.renderer;t=t.parent}},e.DisplayObject.prototype._generateCachedSprite=function(r){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var n=new e.RenderTexture(0|t.width,0|t.height,e.getAncestorRenderer(this),void 0,r);this._cachedSprite=new e.Sprite(n),this._cachedSprite.worldTransform=this.worldTransform}var i=this._filters;this._filters=null,this._cachedSprite.filters=i,this._cachedSprite.texture.render(this,new e.Point(-t.x,-t.y)),this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._filters=i,this._cacheAsBitmap=!0},e.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},e.DisplayObject.prototype._renderWebGL=function(e){e=e},e.DisplayObject.prototype._renderCanvas=function(e){e=e},Object.defineProperty(e.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e}}),Object.defineProperty(e.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e}}),e.DisplayObjectContainer=function(){e.DisplayObject.call(this),this.children=[]},e.DisplayObjectContainer.prototype=Object.create(e.DisplayObject.prototype),e.DisplayObjectContainer.prototype.constructor=e.DisplayObjectContainer,Object.defineProperty(e.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/(t/this.scale.x):1,this._width=e}}),Object.defineProperty(e.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/(t/this.scale.y):1,this._height=e}}),e.DisplayObjectContainer.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},e.DisplayObjectContainer.prototype.addChildAt=function(e,t){if(t>=0&&t<=this.children.length)return e.parent&&e.parent.removeChild(e),e.parent=this,this.children.splice(t,0,e),this.stage&&e.setStageReference(this.stage),e;throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length)},e.DisplayObjectContainer.prototype.swapChildren=function(e,t){if(e!==t){var i=this.children.indexOf(e),r=this.children.indexOf(t);if(0>i||0>r)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=t,this.children[r]=e}},e.DisplayObjectContainer.prototype.getChildAt=function(e){if(e>=0&&e<this.children.length)return this.children[e];throw new Error("getChildAt: Supplied index "+e+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller")},e.DisplayObjectContainer.prototype.removeChild=function(e){return this.removeChildAt(this.children.indexOf(e))},e.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},e.DisplayObjectContainer.prototype.removeChildren=function(o,r){var n=o||0,a="number"==typeof r?r:this.children.length,e=a-n;if(e>0&&a>=e){for(var t=this.children.splice(n,e),i=0;i<t.length;i++){var s=t[i];this.stage&&s.removeStageReference(),s.parent=void 0}return t}if(0===e&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},e.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(e.DisplayObject.prototype.updateTransform.call(this),!this._cacheAsBitmap))for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateTransform()},e.DisplayObjectContainer.prototype.getBounds=function(h){if(0===this.children.length)return e.EmptyRectangle;if(h){var d=this.worldTransform;this.worldTransform=h,this.updateTransform(),this.worldTransform=d}for(var t,c,l,r=1/0,n=1/0,s=-1/0,a=-1/0,u=!1,o=0,p=this.children.length;p>o;o++){var f=this.children[o];f.visible&&(u=!0,t=this.children[o].getBounds(h),r=r<t.x?r:t.x,n=n<t.y?n:t.y,c=t.width+t.x,l=t.height+t.y,s=s>c?s:c,a=a>l?a:l)}if(!u)return e.EmptyRectangle;var i=this._bounds;return i.x=r,i.y=n,i.width=s-r,i.height=a-n,i},e.DisplayObjectContainer.prototype.getLocalBounds=function(){var i=this.worldTransform;this.worldTransform=e.identityMatrix;for(var t=0,r=this.children.length;r>t;t++)this.children[t].updateTransform();var n=this.getBounds();return this.worldTransform=i,n},e.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0);for(var e=0,i=this.children.length;i>e;e++){var r=this.children[e];r.setStageReference(t)}},e.DisplayObjectContainer.prototype.removeStageReference=function(){for(var e=0,t=this.children.length;t>e;e++){var i=this.children[e];i.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},e.DisplayObjectContainer.prototype._renderWebGL=function(e){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(e);var t,i;if(this._mask||this._filters){for(this._filters&&(e.spriteBatch.flush(),e.filterManager.pushFilter(this._filterBlock)),this._mask&&(e.spriteBatch.stop(),e.maskManager.pushMask(this.mask,e),e.spriteBatch.start()),t=0,i=this.children.length;i>t;t++)this.children[t]._renderWebGL(e);e.spriteBatch.stop(),this._mask&&e.maskManager.popMask(this._mask,e),this._filters&&e.filterManager.popFilter(),e.spriteBatch.start()}else for(t=0,i=this.children.length;i>t;t++)this.children[t]._renderWebGL(e)}},e.DisplayObjectContainer.prototype._renderCanvas=function(e){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(e);this._mask&&e.maskManager.pushMask(this._mask,e);for(var t=0,i=this.children.length;i>t;t++){var r=this.children[t];r._renderCanvas(e)}this._mask&&e.maskManager.popMask(e)}},e.Sprite=function(t){e.DisplayObjectContainer.call(this),this.anchor=new e.Point,this.texture=t,this._width=0,this._height=0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL,t.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Sprite.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Sprite.prototype.constructor=e.Sprite,Object.defineProperty(e.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width,this._width=e}}),Object.defineProperty(e.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height,this._height=e}}),e.Sprite.prototype.setTexture=function(e){this.texture=e,this.cachedTint=16777215},e.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},e.Sprite.prototype.getBounds=function(S){var E=this.texture.frame.width,C=this.texture.frame.height,p=E*(1-this.anchor.x),w=E*-this.anchor.x,T=C*(1-this.anchor.y),s=C*-this.anchor.y,a=S||this.worldTransform,l=a.a,c=a.c,h=a.b,u=a.d,d=a.tx,o=a.ty,f=l*w+h*s+d,_=u*s+c*w+o,m=l*p+h*s+d,g=u*s+c*p+o,y=l*p+h*T+d,v=u*T+c*p+o,x=l*w+h*T+d,b=u*T+c*w+o,i=-1/0,r=-1/0,t=1/0,e=1/0;t=t>f?f:t,t=t>m?m:t,t=t>y?y:t,t=t>x?x:t,e=e>_?_:e,e=e>g?g:e,e=e>v?v:e,e=e>b?b:e,i=f>i?f:i,i=m>i?m:i,i=y>i?y:i,i=x>i?x:i,r=_>r?_:r,r=g>r?g:r,r=v>r?v:r,r=b>r?b:r;var n=this._bounds;return n.x=t,n.width=i-t,n.y=e,n.height=r-e,this._currentBounds=n,n},e.Sprite.prototype._renderWebGL=function(e){if(this.visible&&!(this.alpha<=0)){var t,r;if(this._mask||this._filters){var i=e.spriteBatch;for(this._filters&&(i.flush(),e.filterManager.pushFilter(this._filterBlock)),this._mask&&(i.stop(),e.maskManager.pushMask(this.mask,e),i.start()),i.render(this),t=0,r=this.children.length;r>t;t++)this.children[t]._renderWebGL(e);i.stop(),this._mask&&e.maskManager.popMask(this._mask,e),this._filters&&e.filterManager.popFilter(),i.start()}else for(e.spriteBatch.render(this),t=0,r=this.children.length;r>t;t++)this.children[t]._renderWebGL(e)}},e.Sprite.prototype._renderCanvas=function(t){if(!(this.visible===!1||0===this.alpha||this.texture.crop.width<=0||this.texture.crop.height<=0)){if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid){var i=this.texture.baseTexture.resolution/t.resolution;t.context.globalAlpha=this.worldAlpha,t.roundPixels?t.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,0|this.worldTransform.tx,0|this.worldTransform.ty):t.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,this.worldTransform.tx*t.resolution,this.worldTransform.ty*t.resolution),t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=t.scaleMode===e.scaleModes.LINEAR);var n=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,a=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=e.CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,n/i,a/i,this.texture.crop.width/i,this.texture.crop.height/i)):t.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,n/i,a/i,this.texture.crop.width/i,this.texture.crop.height/i)}for(var r=0,s=this.children.length;s>r;r++)this.children[r]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},e.Sprite.fromFrame=function(t){var i=e.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new e.Sprite(i)},e.Sprite.fromImage=function(t,i,r){var n=e.Texture.fromImage(t,i,r);return new e.Sprite(n)},e.SpriteBatch=function(t){e.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},e.SpriteBatch.prototype=Object.create(e.DisplayObjectContainer.prototype),e.SpriteBatch.constructor=e.SpriteBatch,e.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new e.WebGLFastSpriteBatch(t),this.ready=!0},e.SpriteBatch.prototype.updateTransform=function(){e.DisplayObject.prototype.updateTransform.call(this)},e.SpriteBatch.prototype._renderWebGL=function(e){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(e.gl),e.spriteBatch.stop(),e.shaderManager.setShader(e.shaderManager.fastShader),this.fastSpriteBatch.begin(this,e),this.fastSpriteBatch.render(this),e.spriteBatch.start())},e.SpriteBatch.prototype._renderCanvas=function(c){if(this.visible&&!(this.alpha<=0)&&this.children.length){var n=c.context;n.globalAlpha=this.worldAlpha,e.DisplayObject.prototype.updateTransform.call(this);for(var a=this.worldTransform,s=!0,o=0;o<this.children.length;o++){var t=this.children[o];if(t.visible){var l=t.texture,i=l.frame;if(n.globalAlpha=this.worldAlpha*t.alpha,t.rotation%(2*Math.PI)===0)s&&(n.setTransform(a.a,a.c,a.b,a.d,a.tx,a.ty),s=!1),n.drawImage(l.baseTexture.source,i.x,i.y,i.width,i.height,t.anchor.x*-i.width*t.scale.x+t.position.x+.5|0,t.anchor.y*-i.height*t.scale.y+t.position.y+.5|0,i.width*t.scale.x,i.height*t.scale.y);else{s||(s=!0),e.DisplayObject.prototype.updateTransform.call(t);var r=t.worldTransform;c.roundPixels?n.setTransform(r.a,r.c,r.b,r.d,0|r.tx,0|r.ty):n.setTransform(r.a,r.c,r.b,r.d,r.tx,r.ty),n.drawImage(l.baseTexture.source,i.x,i.y,i.width,i.height,t.anchor.x*-i.width+.5|0,t.anchor.y*-i.height+.5|0,i.width,i.height)}}}}},e.MovieClip=function(t){e.Sprite.call(this,t[0]),this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},e.MovieClip.prototype=Object.create(e.Sprite.prototype),e.MovieClip.prototype.constructor=e.MovieClip,Object.defineProperty(e.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),e.MovieClip.prototype.stop=function(){this.playing=!1},e.MovieClip.prototype.play=function(){this.playing=!0},e.MovieClip.prototype.gotoAndStop=function(e){this.playing=!1,this.currentFrame=e;var t=this.currentFrame+.5|0;this.setTexture(this.textures[t%this.textures.length])},e.MovieClip.prototype.gotoAndPlay=function(e){this.currentFrame=e,this.playing=!0},e.MovieClip.prototype.updateTransform=function(){if(e.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=this.currentFrame+.5|0;this.currentFrame=this.currentFrame%this.textures.length,this.loop||t<this.textures.length?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},e.MovieClip.fromFrames=function(i){for(var r=[],t=0;t<i.length;t++)r.push(new e.Texture.fromFrame(i[t]));return new e.MovieClip(r)},e.MovieClip.fromImages=function(i){for(var r=[],t=0;t<i.length;t++)r.push(new e.Texture.fromImage(i[t]));return new e.MovieClip(r)},e.FilterBlock=function(){this.visible=!0,this.renderable=!0},e.Text=function(t,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=1,e.Sprite.call(this,e.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(i)},e.Text.prototype=Object.create(e.Sprite.prototype),e.Text.prototype.constructor=e.Text,Object.defineProperty(e.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width,this._width=e}}),Object.defineProperty(e.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height,this._height=e}}),e.Text.prototype.setStyle=function(e){e=e||{},e.font=e.font||"bold 20pt Arial",e.fill=e.fill||"black",e.align=e.align||"left",e.stroke=e.stroke||"black",e.strokeThickness=e.strokeThickness||0,e.wordWrap=e.wordWrap||!1,e.wordWrapWidth=e.wordWrapWidth||100,e.dropShadow=e.dropShadow||!1,e.dropShadowAngle=e.dropShadowAngle||Math.PI/6,e.dropShadowDistance=e.dropShadowDistance||4,e.dropShadowColor=e.dropShadowColor||"black",this.style=e,this.dirty=!0},e.Text.prototype.setText=function(e){this.text=e.toString()||" ",this.dirty=!0},e.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution,this.context.font=this.style.font;var c=this.text;this.style.wordWrap&&(c=this.wordWrap(this.text));for(var i=c.split(/(?:\r\n|\r|\n)/),n=[],r=0,e=0;e<i.length;e++){var h=this.context.measureText(i[e]).width;n[e]=h,r=Math.max(r,h)}var o=r+this.style.strokeThickness;this.style.dropShadow&&(o+=this.style.dropShadowDistance),this.canvas.width=(o+this.context.lineWidth)*this.resolution;var s=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,l=s*i.length;this.style.dropShadow&&(l+=this.style.dropShadowDistance),this.canvas.height=l*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top";var t,a;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var u=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,d=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(e=0;e<i.length;e++)t=this.style.strokeThickness/2,a=this.style.strokeThickness/2+e*s,"right"===this.style.align?t+=r-n[e]:"center"===this.style.align&&(t+=(r-n[e])/2),this.style.fill&&this.context.fillText(i[e],t+u,a+d)}for(this.context.fillStyle=this.style.fill,e=0;e<i.length;e++)t=this.style.strokeThickness/2,a=this.style.strokeThickness/2+e*s,"right"===this.style.align?t+=r-n[e]:"center"===this.style.align&&(t+=(r-n[e])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(i[e],t,a),this.style.fill&&this.context.fillText(i[e],t,a);this.updateTexture()},e.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height},e.Text.prototype._renderWebGL=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1,e.updateWebGLTexture(this.texture.baseTexture,t.gl)),e.Sprite.prototype._renderWebGL.call(this,t)},e.Text.prototype._renderCanvas=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1),e.Sprite.prototype._renderCanvas.call(this,t)},e.Text.prototype.determineFontHeight=function(r){var i=e.Text.heightCache[r];if(!i){var n=document.getElementsByTagName("body")[0],t=document.createElement("div"),a=document.createTextNode("M");t.appendChild(a),t.setAttribute("style",r+";position:absolute;top:0;left:0"),n.appendChild(t),i=t.offsetHeight,e.Text.heightCache[r]=i,n.removeChild(t)}return i},e.Text.prototype.wordWrap=function(l){for(var t="",n=l.split("\n"),i=0;i<n.length;i++){for(var a=this.style.wordWrapWidth,r=n[i].split(" "),e=0;e<r.length;e++){var s=this.context.measureText(r[e]).width,o=s+this.context.measureText(" ").width;0===e||o>a?(e>0&&(t+="\n"),t+=r[e],a=this.style.wordWrapWidth-s):(a-=o,t+=" "+r[e])}i<n.length-1&&(t+="\n")}return t},e.Text.prototype.destroy=function(e){this.context=null,this.canvas=null,this.texture.destroy(void 0===e?!0:e)},e.Text.heightCache={},e.BitmapText=function(t,i){e.DisplayObjectContainer.call(this),this._pool=[],this.setText(t),this.setStyle(i),this.updateText(),this.dirty=!1},e.BitmapText.prototype=Object.create(e.DisplayObjectContainer.prototype),e.BitmapText.prototype.constructor=e.BitmapText,e.BitmapText.prototype.setText=function(e){this.text=e||" ",this.dirty=!0},e.BitmapText.prototype.setStyle=function(t){t=t||{},t.align=t.align||"left",this.style=t;var i=t.font.split(" ");this.fontName=i[i.length-1],this.fontSize=i.length>=2?parseInt(i[i.length-2],10):e.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=t.tint},e.BitmapText.prototype.updateText=function(){for(var c=e.BitmapText.fonts[this.fontName],i=new e.Point,o=null,n=[],a=0,h=[],u=0,l=this.fontSize/c.size,t=0;t<this.text.length;t++){var d=this.text.charCodeAt(t);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(t)))h.push(i.x),a=Math.max(a,i.x),u++,i.x=0,i.y+=c.lineHeight,o=null;else{var s=c.chars[d];s&&(o&&s[o]&&(i.x+=s.kerning[o]),n.push({texture:s.texture,line:u,charCode:d,position:new e.Point(i.x+s.xOffset,i.y+s.yOffset)}),i.x+=s.xAdvance,o=d)}}h.push(i.x),a=Math.max(a,i.x);var _=[];for(t=0;u>=t;t++){var p=0;"right"===this.style.align?p=a-h[t]:"center"===this.style.align&&(p=(a-h[t])/2),_.push(p)}var g=this.children.length,f=n.length,y=this.tint||16777215;for(t=0;f>t;t++){var r=g>t?this.children[t]:this._pool.pop();r?r.setTexture(n[t].texture):r=new e.Sprite(n[t].texture),r.position.x=(n[t].position.x+_[n[t].line])*l,r.position.y=n[t].position.y*l,r.scale.x=r.scale.y=l,r.tint=y,r.parent||this.addChild(r)}for(;this.children.length>f;){var m=this.getChildAt(this.children.length-1);this._pool.push(m),this.removeChild(m)}this.textWidth=a*l,this.textHeight=(i.y+c.lineHeight)*l},e.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.BitmapText.fonts={},e.InteractionData=function(){this.global=new e.Point,this.target=null,this.originalEvent=null},e.InteractionData.prototype.getLocalPosition=function(u,r){var i=u.worldTransform,n=this.global,a=i.a,s=i.b,c=i.tx,l=i.c,o=i.d,h=i.ty,t=1/(a*o+s*-l);return r=r||new e.Point,r.x=o*t*n.x+-s*t*n.y+(h*s-c*o)*t,r.y=a*t*n.y+-l*t*n.x+(-h*a+c*l)*t,r},e.InteractionData.prototype.constructor=e.InteractionData,e.InteractionManager=function(t){this.stage=t,this.mouse=new e.InteractionData,this.touchs={},this.tempPoint=new e.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1,this.resolution=1},e.InteractionManager.prototype.constructor=e.InteractionManager,e.InteractionManager.prototype.collectInteractiveSprite=function(n,i){for(var r=n.children,a=r.length,t=a-1;t>=0;t--){var e=r[t];e._interactive?(i.interactiveChildren=!0,this.interactiveItems.push(e),e.children.length>0&&this.collectInteractiveSprite(e,e)):(e.__iParent=null,e.children.length>0&&this.collectInteractiveSprite(e,i))}},e.InteractionManager.prototype.setTarget=function(e){this.target=e,this.resolution=e.resolution,null===this.interactionDOMElement&&this.setTargetDomElement(e.view)},e.InteractionManager.prototype.setTargetDomElement=function(e){this.removeEvents(),window.navigator.msPointerEnabled&&(e.style["-ms-content-zooming"]="none",e.style["-ms-touch-action"]="none"),this.interactionDOMElement=e,e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mousedown",this.onMouseDown,!0),e.addEventListener("mouseout",this.onMouseOut,!0),e.addEventListener("touchstart",this.onTouchStart,!0),e.addEventListener("touchend",this.onTouchEnd,!0),e.addEventListener("touchmove",this.onTouchMove,!0)},e.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null)},e.InteractionManager.prototype.update=function(){if(this.target){var a=Date.now(),n=a-this.last;if(n=n*e.INTERACTION_FREQUENCY/1e3,!(1>n)){this.last=a;var i=0;this.dirty&&this.rebuildInteractiveGraph();var o=this.interactiveItems.length,r="inherit",s=!1;for(i=0;o>i;i++){var t=this.interactiveItems[i];t.__hit=this.hitTest(t,this.mouse),this.mouse.target=t,t.__hit&&!s?(t.buttonMode&&(r=t.defaultCursor),t.interactiveChildren||(s=!0),t.__isOver||(t.mouseover&&t.mouseover(this.mouse),t.__isOver=!0)):t.__isOver&&(t.mouseout&&t.mouseout(this.mouse),t.__isOver=!1)}this.currentCursorStyle!==r&&(this.currentCursorStyle=r,this.interactionDOMElement.style.cursor=r)}}},e.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=!1;for(var t=this.interactiveItems.length,e=0;t>e;e++)this.interactiveItems[e].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)},e.InteractionManager.prototype.onMouseMove=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t||window.event;var e=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width)/this.resolution,this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height)/this.resolution;for(var n=this.interactiveItems.length,i=0;n>i;i++){var r=this.interactiveItems[i];r.mousemove&&r.mousemove(this.mouse)}},e.InteractionManager.prototype.onMouseDown=function(s){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=s||window.event,e.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var o=this.interactiveItems.length,a=this.mouse.originalEvent,i=2===a.button||3===a.which,r=i?"rightdown":"mousedown",l=i?"rightclick":"click",c=i?"__rightIsDown":"__mouseIsDown",h=i?"__isRightDown":"__isDown",n=0;o>n;n++){var t=this.interactiveItems[n];if((t[r]||t[l])&&(t[c]=!0,t.__hit=this.hitTest(t,this.mouse),t.__hit&&(t[r]&&t[r](this.mouse),t[h]=!0,!t.interactiveChildren)))break}},e.InteractionManager.prototype.onMouseOut=function(i){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=i||window.event;var r=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var t=0;r>t;t++){var e=this.interactiveItems[t];e.__isOver&&(this.mouse.target=e,e.mouseout&&e.mouseout(this.mouse),e.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},e.InteractionManager.prototype.onMouseUp=function(h){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=h||window.event;for(var c=this.interactiveItems.length,l=!1,o=this.mouse.originalEvent,t=2===o.button||3===o.which,n=t?"rightup":"mouseup",s=t?"rightclick":"click",a=t?"rightupoutside":"mouseupoutside",r=t?"__isRightDown":"__isDown",i=0;c>i;i++){var e=this.interactiveItems[i];(e[s]||e[n]||e[a])&&(e.__hit=this.hitTest(e,this.mouse),e.__hit&&!l?(e[n]&&e[n](this.mouse),e[r]&&e[s]&&e[s](this.mouse),e.interactiveChildren||(l=!0)):e[r]&&e[a]&&e[a](this.mouse),e[r]=!1)}},e.InteractionManager.prototype.hitTest=function(t,r){var a=r.global;if(!t.worldVisible)return!1;var x=t instanceof e.Sprite,n=t.worldTransform,h=n.a,d=n.b,_=n.tx,l=n.c,c=n.d,f=n.ty,i=1/(h*c+d*-l),s=c*i*a.x+-d*i*a.y+(f*d-_*c)*i,u=h*i*a.y+-l*i*a.x+(-f*h+_*l)*i;if(r.target=t,t.hitArea&&t.hitArea.contains)return t.hitArea.contains(s,u)?(r.target=t,!0):!1;if(x){var o,m=t.texture.frame.width,g=t.texture.frame.height,y=-m*t.anchor.x;if(s>y&&y+m>s&&(o=-g*t.anchor.y,u>o&&o+g>u))return r.target=t,!0}for(var v=t.children.length,p=0;v>p;p++){var b=t.children[p],w=this.hitTest(b,r);if(w)return r.target=t,!0}return!1},e.InteractionManager.prototype.onTouchMove=function(r){this.dirty&&this.rebuildInteractiveGraph();var e,t=this.interactionDOMElement.getBoundingClientRect(),o=r.changedTouches,n=0;for(n=0;n<o.length;n++){var i=o[n];e=this.touchs[i.identifier],e.originalEvent=r||window.event,e.global.x=(i.clientX-t.left)*(this.target.width/t.width)/this.resolution,e.global.y=(i.clientY-t.top)*(this.target.height/t.height)/this.resolution,!navigator.isCocoonJS||t.left||t.top||r.target.style.width||r.target.style.height||(e.global.x=i.clientX,e.global.y=i.clientY);for(var s=0;s<this.interactiveItems.length;s++){var a=this.interactiveItems[s];a.touchmove&&a.__touchData&&a.__touchData[i.identifier]&&a.touchmove(e)}}},e.InteractionManager.prototype.onTouchStart=function(a){this.dirty&&this.rebuildInteractiveGraph();var r=this.interactionDOMElement.getBoundingClientRect();e.AUTO_PREVENT_DEFAULT&&a.preventDefault();for(var l=a.changedTouches,s=0;s<l.length;s++){var n=l[s],i=this.pool.pop();i||(i=new e.InteractionData),i.originalEvent=a||window.event,this.touchs[n.identifier]=i,i.global.x=(n.clientX-r.left)*(this.target.width/r.width)/this.resolution,i.global.y=(n.clientY-r.top)*(this.target.height/r.height)/this.resolution,!navigator.isCocoonJS||r.left||r.top||a.target.style.width||a.target.style.height||(i.global.x=n.clientX,i.global.y=n.clientY);for(var c=this.interactiveItems.length,o=0;c>o;o++){var t=this.interactiveItems[o];if((t.touchstart||t.tap)&&(t.__hit=this.hitTest(t,i),t.__hit&&(t.touchstart&&t.touchstart(i),t.__isDown=!0,t.__touchData=t.__touchData||{},t.__touchData[n.identifier]=i,!t.interactiveChildren)))break}}},e.InteractionManager.prototype.onTouchEnd=function(n){this.dirty&&this.rebuildInteractiveGraph();for(var r=this.interactionDOMElement.getBoundingClientRect(),o=n.changedTouches,a=0;a<o.length;a++){var t=o[a],i=this.touchs[t.identifier],l=!1;i.global.x=(t.clientX-r.left)*(this.target.width/r.width)/this.resolution,i.global.y=(t.clientY-r.top)*(this.target.height/r.height)/this.resolution,!navigator.isCocoonJS||r.left||r.top||n.target.style.width||n.target.style.height||(i.global.x=t.clientX,i.global.y=t.clientY);for(var c=this.interactiveItems.length,s=0;c>s;s++){var e=this.interactiveItems[s];e.__touchData&&e.__touchData[t.identifier]&&(e.__hit=this.hitTest(e,e.__touchData[t.identifier]),i.originalEvent=n||window.event,(e.touchend||e.tap)&&(e.__hit&&!l?(e.touchend&&e.touchend(i),e.__isDown&&e.tap&&e.tap(i),e.interactiveChildren||(l=!0)):e.__isDown&&e.touchendoutside&&e.touchendoutside(i),e.__isDown=!1),e.__touchData[t.identifier]=null)}this.pool.push(i),this.touchs[t.identifier]=null}},e.Stage=function(t){e.DisplayObjectContainer.call(this),this.worldTransform=new e.Matrix,this.interactive=!0,this.interactionManager=new e.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new e.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(t)},e.Stage.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Stage.prototype.constructor=e.Stage,e.Stage.prototype.setInteractionDelegate=function(e){this.interactionManager.setTargetDomElement(e)},e.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var e=0,t=this.children.length;t>e;e++)this.children[e].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},e.Stage.prototype.setBackgroundColor=function(i){this.backgroundColor=i||0,this.backgroundColorSplit=e.hex2rgb(this.backgroundColor);var t=this.backgroundColor.toString(16);t="000000".substr(0,6-t.length)+t,this.backgroundColorString="#"+t},e.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},e.hex2rgb=function(e){return[(e>>16&255)/255,(e>>8&255)/255,(255&e)/255]},e.rgb2hex=function(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){return function(n){function t(){for(var e=arguments.length,a=new Array(e);e--;)a[e]=arguments[e];a=r.concat(a),i.apply(this instanceof t?this:n,a)}var i=this,e=arguments.length-1,r=[];if(e>0)for(r.length=e;e--;)r[e]=arguments[e+1];if("function"!=typeof i)throw new TypeError;return t.prototype=function a(e){return e&&(a.prototype=e),this instanceof a?void 0:new a}(i.prototype),t}}()),e.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(i){}},e.canUseNewCanvasBlendModes=function(){if("undefined"==typeof document)return!1;var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),0===e.getImageData(0,0,1,1).data[0]},e.getNextPowerOfTwo=function(e){if(e>0&&0===(e&e-1))return e;for(var t=1;e>t;)t<<=1;return t},e.EventTarget=function(){var e={};this.addEventListener=this.on=function(t,i){void 0===e[t]&&(e[t]=[]),-1===e[t].indexOf(i)&&e[t].unshift(i)},this.dispatchEvent=this.emit=function(t){if(e[t.type]&&e[t.type].length)for(var i=e[t.type].length-1;i>=0;i--)e[t.type][i](t)},this.removeEventListener=this.off=function(t,r){if(void 0!==e[t]){var i=e[t].indexOf(r);-1!==i&&e[t].splice(i,1)}},this.removeAllEventListeners=function(i){var t=e[i];t&&(t.length=0)}},e.autoDetectRenderer=function(){function i(e,i){function t(){return e.apply(this,i)}return t.prototype=e.prototype,new t}var t=Array.prototype.slice.call(arguments);"undefined"==typeof t[0]&&(t[0]=800),"undefined"==typeof t[1]&&(t[1]=600);var r=function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}();return i(e[(r?"WebGL":"Canvas")+"Renderer"],t)},e.autoDetectRecommendedRenderer=function(t,i,r){t||(t=800),i||(i=600);var n=function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}(),a=/Android/i.test(navigator.userAgent);return n&&!a?new e.WebGLRenderer(t,i,r):new e.CanvasRenderer(t,i,r)},e.PolyK={},e.PolyK.Triangulate=function(r){var u=!0,a=r.length>>1;if(3>a)return[];for(var o=[],i=[],t=0;a>t;t++)i.push(t);t=0;for(var n=a;n>3;){var h=i[(t+0)%n],c=i[(t+1)%n],l=i[(t+2)%n],f=r[2*h],_=r[2*h+1],v=r[2*c],m=r[2*c+1],g=r[2*l],y=r[2*l+1],d=!1;if(e.PolyK._convex(f,_,v,m,g,y,u)){d=!0;for(var p=0;n>p;p++){var s=i[p];if(s!==h&&s!==c&&s!==l&&e.PolyK._PointInTriangle(r[2*s],r[2*s+1],f,_,v,m,g,y)){d=!1;break}}}if(d)o.push(h,c,l),i.splice((t+1)%n,1),n--,t=0;else if(t++>3*n){if(!u)return window.console.log("PIXI Warning: shape too complex to fill"),[];for(o=[],i=[],t=0;a>t;t++)i.push(t);t=0,n=a,u=!1}}return o.push(i[0],i[1],i[2]),o},e.PolyK._PointInTriangle=function(b,m,a,s,x,v,y,g){var t=y-a,i=g-s,r=x-a,e=v-s,d=b-a,p=m-s,f=t*t+i*i,n=t*r+i*e,u=t*d+i*p,o=r*r+e*e,_=r*d+e*p,h=1/(f*o-n*n),c=(o*u-n*_)*h,l=(f*_-n*u)*h;return c>=0&&l>=0&&1>c+l},e.PolyK._convex=function(i,r,e,t,n,a,s){return(r-t)*(n-e)+(e-i)*(a-t)>=0===s},e.initDefaultShaders=function(){},e.CompileVertexShader=function(t,i){return e._CompileShader(t,i,t.VERTEX_SHADER)},e.CompileFragmentShader=function(t,i){return e._CompileShader(t,i,t.FRAGMENT_SHADER)},e._CompileShader=function(e,i,r){var n=i.join("\n"),t=e.createShader(r);return e.shaderSource(t,n),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)?t:(window.console.log(e.getShaderInfoLog(t)),null)},e.compileProgram=function(t,r,n){var a=e.CompileFragmentShader(t,n),s=e.CompileVertexShader(t,r),i=t.createProgram();return t.attachShader(i,s),t.attachShader(i,a),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),i},e.PixiShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.attributes=[],this.init()},e.PixiShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc||e.PixiShader.defaultVertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.dimensions=t.getUniformLocation(i,"dimensions"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var r in this.uniforms)this.uniforms[r].uniformLocation=t.getUniformLocation(i,r);this.initUniforms(),this.program=i},e.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,i=this.gl;for(var r in this.uniforms){t=this.uniforms[r];var e=t.type;"sampler2D"===e?(t._init=!1,null!==t.value&&this.initSampler2D(t)):"mat2"===e||"mat3"===e||"mat4"===e?(t.glMatrix=!0,t.glValueLength=1,"mat2"===e?t.glFunc=i.uniformMatrix2fv:"mat3"===e?t.glFunc=i.uniformMatrix3fv:"mat4"===e&&(t.glFunc=i.uniformMatrix4fv)):(t.glFunc=i["uniform"+e],t.glValueLength="2f"===e||"2i"===e?2:"3f"===e||"3i"===e?3:"4f"===e||"4i"===e?4:1)}},e.PixiShader.prototype.initSampler2D=function(i){if(i.value&&i.value.baseTexture&&i.value.baseTexture.hasLoaded){var e=this.gl;if(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,i.value.baseTexture._glTextures[e.id]),i.textureData){var t=i.textureData,o=t.magFilter?t.magFilter:e.LINEAR,s=t.minFilter?t.minFilter:e.LINEAR,a=t.wrapS?t.wrapS:e.CLAMP_TO_EDGE,n=t.wrapT?t.wrapT:e.CLAMP_TO_EDGE,r=t.luminance?e.LUMINANCE:e.RGBA;if(t.repeat&&(a=e.REPEAT,n=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!t.flipY),t.width){var l=t.width?t.width:512,c=t.height?t.height:2,h=t.border?t.border:0;e.texImage2D(e.TEXTURE_2D,0,r,l,c,h,r,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,r,e.RGBA,e.UNSIGNED_BYTE,i.value.baseTexture.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n)}e.uniform1i(i.uniformLocation,this.textureCount),i._init=!0,this.textureCount++}},e.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var t,i=this.gl;for(var r in this.uniforms)t=this.uniforms[r],1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(i,t.uniformLocation,t.transpose,t.value):t.glFunc.call(i,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),i.bindTexture(i.TEXTURE_2D,t.value.baseTexture._glTextures[i.id]||e.createWebGLTexture(t.value.baseTexture,i)),i.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},e.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"],e.PixiFastShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},e.PixiFastShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.dimensions=t.getUniformLocation(i,"dimensions"),this.uMatrix=t.getUniformLocation(i,"uMatrix"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(i,"aPositionCoord"),this.aScale=t.getAttribLocation(i,"aScale"),this.aRotation=t.getAttribLocation(i,"aRotation"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=i},e.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.StripShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},e.StripShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.colorAttribute=t.getAttribLocation(i,"aColor"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},e.PrimitiveShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},e.PrimitiveShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.tintColor=t.getUniformLocation(i,"tint"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(i,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.ComplexPrimitiveShader=function(t){this._UID=e._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},e.ComplexPrimitiveShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.tintColor=t.getUniformLocation(i,"tint"),this.color=t.getUniformLocation(i,"color"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},e.WebGLGraphics=function(){},e.WebGLGraphics.renderGraphics=function(n,i){var a,t=i.gl,l=i.projection,c=i.offset,r=i.shaderManager.primitiveShader;n.dirty&&e.WebGLGraphics.updateGraphics(n,t);for(var o=n._webGL[t.id],s=0;s<o.data.length;s++)1===o.data[s].mode?(a=o.data[s],i.stencilManager.pushStencil(n,a,i),t.drawElements(t.TRIANGLE_FAN,4,t.UNSIGNED_SHORT,2*(a.indices.length-4)),i.stencilManager.popStencil(n,a,i)):(a=o.data[s],i.shaderManager.setShader(r),r=i.shaderManager.primitiveShader,t.uniformMatrix3fv(r.translationMatrix,!1,n.worldTransform.toArray(!0)),t.uniform2f(r.projectionVector,l.x,-l.y),t.uniform2f(r.offsetVector,-c.x,-c.y),t.uniform3fv(r.tintColor,e.hex2rgb(n.tint)),t.uniform1f(r.alpha,n.worldAlpha),t.bindBuffer(t.ARRAY_BUFFER,a.buffer),t.vertexAttribPointer(r.aVertexPosition,2,t.FLOAT,!1,24,0),t.vertexAttribPointer(r.colorAttribute,4,t.FLOAT,!1,24,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a.indexBuffer),t.drawElements(t.TRIANGLE_STRIP,a.indices.length,t.UNSIGNED_SHORT,0))},e.WebGLGraphics.updateGraphics=function(a,s){var i=a._webGL[s.id];i||(i=a._webGL[s.id]={lastIndex:0,data:[],gl:s}),a.dirty=!1;var n;if(a.clearDirty){for(a.clearDirty=!1,n=0;n<i.data.length;n++){var o=i.data[n];o.reset(),e.WebGLGraphics.graphicsDataPool.push(o)}i.data=[],i.lastIndex=0}var r;for(n=i.lastIndex;n<a.graphicsData.length;n++){var t=a.graphicsData[n];t.type===e.Graphics.POLY?(t.fill&&t.points.length>6&&(t.points.length>10?(r=e.WebGLGraphics.switchMode(i,1),e.WebGLGraphics.buildComplexPoly(t,r)):(r=e.WebGLGraphics.switchMode(i,0),e.WebGLGraphics.buildPoly(t,r))),t.lineWidth>0&&(r=e.WebGLGraphics.switchMode(i,0),e.WebGLGraphics.buildLine(t,r))):(r=e.WebGLGraphics.switchMode(i,0),t.type===e.Graphics.RECT?e.WebGLGraphics.buildRectangle(t,r):t.type===e.Graphics.CIRC||t.type===e.Graphics.ELIP?e.WebGLGraphics.buildCircle(t,r):t.type===e.Graphics.RREC&&e.WebGLGraphics.buildRoundedRectangle(t,r)),i.lastIndex++}for(n=0;n<i.data.length;n++)r=i.data[n],r.dirty&&r.upload()},e.WebGLGraphics.switchMode=function(i,r){var t;return i.data.length?(t=i.data[i.data.length-1],(t.mode!==r||1===r)&&(t=e.WebGLGraphics.graphicsDataPool.pop()||new e.WebGLGraphicsData(i.gl),t.mode=r,i.data.push(t))):(t=e.WebGLGraphics.graphicsDataPool.pop()||new e.WebGLGraphicsData(i.gl),t.mode=r,i.data.push(t)),t.dirty=!0,t},e.WebGLGraphics.buildRectangle=function(t,p){var c=t.points,r=c[0],n=c[1],l=c[2],u=c[3];if(t.fill){var f=e.hex2rgb(t.fillColor),a=t.fillAlpha,h=f[0]*a,o=f[1]*a,d=f[2]*a,i=p.points,_=p.indices,s=i.length/6;i.push(r,n),i.push(h,o,d,a),i.push(r+l,n),i.push(h,o,d,a),i.push(r,n+u),i.push(h,o,d,a),i.push(r+l,n+u),i.push(h,o,d,a),_.push(s,s,s+1,s+2,s+3,s+3)}if(t.lineWidth){var m=t.points;t.points=[r,n,r+l,n,r+l,n+u,r,n+u,r,n],e.WebGLGraphics.buildLine(t,p),t.points=m}},e.WebGLGraphics.buildRoundedRectangle=function(s,f){var h=s.points,i=h[0],r=h[1],l=h[2],o=h[3],a=h[4],t=[];if(t.push(i,r+a),t=t.concat(e.WebGLGraphics.quadraticBezierCurve(i,r+o-a,i,r+o,i+a,r+o)),t=t.concat(e.WebGLGraphics.quadraticBezierCurve(i+l-a,r+o,i+l,r+o,i+l,r+o-a)),t=t.concat(e.WebGLGraphics.quadraticBezierCurve(i+l,r+a,i+l,r,i+l-a,r)),t=t.concat(e.WebGLGraphics.quadraticBezierCurve(i+a,r,i,r,i,r+a)),s.fill){var _=e.hex2rgb(s.fillColor),p=s.fillAlpha,v=_[0]*p,y=_[1]*p,g=_[2]*p,m=f.points,d=f.indices,u=m.length/6,c=e.PolyK.Triangulate(t),n=0;for(n=0;n<c.length;n+=3)d.push(c[n]+u),d.push(c[n]+u),d.push(c[n+1]+u),d.push(c[n+2]+u),d.push(c[n+2]+u);for(n=0;n<t.length;n++)m.push(t[n],t[++n],v,y,g,p)}if(s.lineWidth){var x=s.points;s.points=t,e.WebGLGraphics.buildLine(s,f),s.points=x}},e.WebGLGraphics.quadraticBezierCurve=function(m,p,s,r,_,f){function t(e,t,i){var r=t-e;return e+r*i}for(var o,n,c,h,u,d,l=20,a=[],e=0,i=0;l>=i;i++)e=i/l,o=t(m,s,e),n=t(p,r,e),c=t(s,_,e),h=t(r,f,e),u=t(o,c,e),d=t(n,h,e),a.push(u,d);return a},e.WebGLGraphics.buildCircle=function(i,h){var n=i.points,u=n[0],c=n[1],y=n[2],g=n[3],l=40,s=2*Math.PI/l,t=0;if(i.fill){var d=e.hex2rgb(i.fillColor),r=i.fillAlpha,m=d[0]*r,f=d[1]*r,_=d[2]*r,p=h.points,o=h.indices,a=p.length/6;for(o.push(a),t=0;l+1>t;t++)p.push(u,c,m,f,_,r),p.push(u+Math.sin(s*t)*y,c+Math.cos(s*t)*g,m,f,_,r),o.push(a++,a++);o.push(a-1)}if(i.lineWidth){var v=i.points;for(i.points=[],t=0;l+1>t;t++)i.points.push(u+Math.sin(s*t)*y,c+Math.cos(s*t)*g);e.WebGLGraphics.buildLine(i,h),i.points=v}},e.WebGLGraphics.buildLine=function(w,U){var o=0,t=w.points;if(0!==t.length){if(w.lineWidth%2)for(o=0;o<t.length;o++)t[o]+=.5;var A=new e.Point(t[0],t[1]),x=new e.Point(t[t.length-2],t[t.length-1]);if(A.x===x.x&&A.y===x.y){t=t.slice(),t.pop(),t.pop(),x=new e.Point(t[t.length-2],t[t.length-1]);var N=x.x+.5*(A.x-x.x),B=x.y+.5*(A.y-x.y);t.unshift(N,B),t.push(N,B)}var E,b,_,p,a,n,M,S,r,i,g,f,v,y,z,P,k,R,O,L,C,G,l,s=U.points,I=U.indices,T=t.length/2,F=t.length,j=s.length/6,m=w.lineWidth/2,D=e.hex2rgb(w.lineColor),c=w.lineAlpha,u=D[0]*c,h=D[1]*c,d=D[2]*c;for(_=t[0],p=t[1],a=t[2],n=t[3],r=-(p-n),i=_-a,l=Math.sqrt(r*r+i*i),r/=l,i/=l,r*=m,i*=m,s.push(_-r,p-i,u,h,d,c),s.push(_+r,p+i,u,h,d,c),o=1;T-1>o;o++)_=t[2*(o-1)],p=t[2*(o-1)+1],a=t[2*o],n=t[2*o+1],M=t[2*(o+1)],S=t[2*(o+1)+1],r=-(p-n),i=_-a,l=Math.sqrt(r*r+i*i),r/=l,i/=l,r*=m,i*=m,g=-(n-S),f=a-M,l=Math.sqrt(g*g+f*f),g/=l,f/=l,g*=m,f*=m,z=-i+p-(-i+n),P=-r+a-(-r+_),k=(-r+_)*(-i+n)-(-r+a)*(-i+p),R=-f+S-(-f+n),O=-g+a-(-g+M),L=(-g+M)*(-f+n)-(-g+a)*(-f+S),C=z*O-R*P,Math.abs(C)<.1?(C+=10.1,s.push(a-r,n-i,u,h,d,c),s.push(a+r,n+i,u,h,d,c)):(E=(P*L-O*k)/C,b=(R*k-z*L)/C,G=(E-a)*(E-a)+(b-n)+(b-n),G>19600?(v=r-g,y=i-f,l=Math.sqrt(v*v+y*y),v/=l,y/=l,v*=m,y*=m,s.push(a-v,n-y),s.push(u,h,d,c),s.push(a+v,n+y),s.push(u,h,d,c),s.push(a-v,n-y),s.push(u,h,d,c),F++):(s.push(E,b),s.push(u,h,d,c),s.push(a-(E-a),n-(b-n)),s.push(u,h,d,c)));for(_=t[2*(T-2)],p=t[2*(T-2)+1],a=t[2*(T-1)],n=t[2*(T-1)+1],r=-(p-n),i=_-a,l=Math.sqrt(r*r+i*i),r/=l,i/=l,r*=m,i*=m,s.push(a-r,n-i),s.push(u,h,d,c),s.push(a+r,n+i),s.push(u,h,d,c),I.push(j),o=0;F>o;o++)I.push(j++);I.push(j-1)}},e.WebGLGraphics.buildComplexPoly=function(h,c){var i=h.points.slice();if(!(i.length<6)){var u=c.indices;c.points=i,c.alpha=h.fillAlpha,c.color=e.hex2rgb(h.fillColor);for(var n,a,r=1/0,s=-1/0,o=1/0,l=-1/0,t=0;t<i.length;t+=2)n=i[t],a=i[t+1],r=r>n?n:r,s=n>s?n:s,o=o>a?a:o,l=a>l?a:l;i.push(r,o,s,o,s,l,r,l);var d=i.length/2;for(t=0;d>t;t++)u.push(t)}},e.WebGLGraphics.buildPoly=function(l,c){var r=l.points;if(!(r.length<6)){var h=c.points,a=c.indices,f=r.length/2,o=e.hex2rgb(l.fillColor),s=l.fillAlpha,u=o[0]*s,d=o[1]*s,p=o[2]*s,i=e.PolyK.Triangulate(r),n=h.length/6,t=0;for(t=0;t<i.length;t+=3)a.push(i[t]+n),a.push(i[t]+n),a.push(i[t+1]+n),a.push(i[t+2]+n),a.push(i[t+2]+n);for(t=0;f>t;t++)h.push(r[2*t],r[2*t+1],u,d,p,s)}},e.WebGLGraphics.graphicsDataPool=[],e.WebGLGraphicsData=function(e){this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.lastIndex=0,this.buffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},e.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[],this.lastIndex=0},e.WebGLGraphicsData.prototype.upload=function(){var e=this.gl;this.glPoints=new Float32Array(this.points),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.glPoints,e.STATIC_DRAW),this.glIndicies=new Uint16Array(this.indices),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.glIndicies,e.STATIC_DRAW),this.dirty=!1},e.glContexts=[],e.WebGLRenderer=function(n,a,i){if(i)for(var r in e.defaultRenderOptions)"undefined"==typeof i[r]&&(i[r]=e.defaultRenderOptions[r]);else i=e.defaultRenderOptions;this.type=e.WEBGL_RENDERER,this.resolution=i.resolution,this.transparent=i.transparent,this.preserveDrawingBuffer=i.preserveDrawingBuffer,this.clearBeforeRender=i.clearBeforeRender,this.width=n||800,this.height=a||600,this.view=i.view||document.createElement("canvas"),this.contextLost=this.handleContextLost.bind(this),this.contextRestoredLost=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLost,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredLost,!1),this.contextOptions={alpha:this.transparent,antialias:i.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer};var t=null;if(["experimental-webgl","webgl"].forEach(function(e){try{t=t||this.view.getContext(e,this.contextOptions)}catch(i){}},this),!t)throw new Error("This browser does not support webGL. Try using the canvas renderer"+this);this.gl=t,this.glContextId=t.id=e.WebGLRenderer.glContextId++,e.glContexts[this.glContextId]=t,e.blendModesWebGL||(e.blendModesWebGL=[],e.blendModesWebGL[e.blendModes.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.ADD]=[t.SRC_ALPHA,t.DST_ALPHA],e.blendModesWebGL[e.blendModes.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SCREEN]=[t.SRC_ALPHA,t.ONE],e.blendModesWebGL[e.blendModes.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA]),this.projection=new e.Point,this.offset=new e.Point(0,0),this.resize(n,a),this.contextLost=!1,this.shaderManager=new e.WebGLShaderManager(t),this.spriteBatch=new e.WebGLSpriteBatch(t),this.maskManager=new e.WebGLMaskManager(t),this.filterManager=new e.WebGLFilterManager(t,this.transparent),this.stencilManager=new e.WebGLStencilManager(t),this.blendModeManager=new e.WebGLBlendModeManager(t),this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,this.renderSession.renderer=this,this.renderSession.resolution=this.resolution,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,this.transparent)},e.WebGLRenderer.prototype.constructor=e.WebGLRenderer,e.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(t.interactive&&t.interactionManager.removeEvents(),this.__stage=t),e.WebGLRenderer.updateTextures(),t.updateTransform(),t._interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)));var i=this.gl;i.viewport(0,0,this.width,this.height),i.bindFramebuffer(i.FRAMEBUFFER,null),this.clearBeforeRender&&(this.transparent?i.clearColor(0,0,0,0):i.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],1),i.clear(i.COLOR_BUFFER_BIT)),this.renderDisplayObject(t,this.projection),t.interactive?t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)):t._interactiveEventsAdded&&(t._interactiveEventsAdded=!1,t.interactionManager.setTarget(this))}},e.WebGLRenderer.prototype.renderDisplayObject=function(t,i,r){this.renderSession.blendModeManager.setBlendMode(e.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.currentBlendMode=9999,this.renderSession.projection=i,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,r),t._renderWebGL(this.renderSession),this.spriteBatch.end()},e.WebGLRenderer.updateTextures=function(){var t=0;for(t=0;t<e.Texture.frameUpdates.length;t++)e.WebGLRenderer.updateTextureFrame(e.Texture.frameUpdates[t]);for(t=0;t<e.texturesToDestroy.length;t++)e.WebGLRenderer.destroyTexture(e.texturesToDestroy[t]);e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,e.Texture.frameUpdates.length=0},e.WebGLRenderer.destroyTexture=function(i){for(var t=i._glTextures.length-1;t>=0;t--){var r=i._glTextures[t],n=e.glContexts[t];n&&r&&n.deleteTexture(r)}i._glTextures.length=0},e.WebGLRenderer.updateTextureFrame=function(e){e._updateWebGLuvs()},e.WebGLRenderer.prototype.resize=function(e,t){this.width=e*this.resolution,this.height=t*this.resolution,this.view.width=this.width,this.view.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=-this.height/2/this.resolution},e.createWebGLTexture=function(i,t){return i.hasLoaded&&(i._glTextures[t.id]=t.createTexture(),t.bindTexture(t.TEXTURE_2D,i._glTextures[t.id]),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultipliedAlpha),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i.scaleMode===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i.scaleMode===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),i._powerOf2?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),t.bindTexture(t.TEXTURE_2D,null),i._dirty[t.id]=!1),i._glTextures[t.id]},e.updateWebGLTexture=function(i,t){i._glTextures[t.id]&&(t.bindTexture(t.TEXTURE_2D,i._glTextures[t.id]),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultipliedAlpha),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i.scaleMode===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i.scaleMode===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),i._powerOf2?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),i._dirty[t.id]=!1)},e.WebGLRenderer.prototype.handleContextLost=function(e){e.preventDefault(),this.contextLost=!0},e.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.contextOptions)}catch(n){try{this.gl=this.view.getContext("webgl",this.contextOptions)}catch(a){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}e.glContexts[this.glContextId]=null;var t=this.gl;this.glContextId=t.id=e.WebGLRenderer.glContextId++,e.glContexts[this.glContextId]=t,this.shaderManager.setContext(t),this.spriteBatch.setContext(t),this.maskManager.setContext(t),this.filterManager.setContext(t),this.renderSession.gl=this.gl,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,this.transparent),this.gl.viewport(0,0,this.width,this.height);for(var i in e.TextureCache){var r=e.TextureCache[i].baseTexture;r._glTextures=[]}"object"==typeof this.contextLost&&this.view.removeEventListener("webglcontextlost",this.contextLost),this.contextLost=!1},e.WebGLRenderer.prototype.destroy=function(){"object"==typeof this.contextLost&&this.view.removeEventListener("webglcontextlost",this.contextLost),this.view.removeEventListener("webglcontextrestored",this.contextRestoredLost),e.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null,this.view=null,this.__stage=null,this.contextRestoredLost=null,this.stencilManager=null,this.blendModeManager=null,this.contextOptions=null},e.WebGLRenderer.glContextId=0,e.WebGLBlendModeManager=function(e){this.gl=e,this.currentBlendMode=99999},e.WebGLBlendModeManager.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var i=e.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(i[0],i[1]),!0},e.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},e.WebGLMaskManager=function(e){this.setContext(e)},e.WebGLMaskManager.prototype.setContext=function(e){this.gl=e},e.WebGLMaskManager.prototype.pushMask=function(t,i){var r=i.gl;t.dirty&&e.WebGLGraphics.updateGraphics(t,r),t._webGL[r.id].data.length&&i.stencilManager.pushStencil(t,t._webGL[r.id].data[0],i)},e.WebGLMaskManager.prototype.popMask=function(e,t){var i=this.gl;t.stencilManager.popStencil(e,e._webGL[i.id].data[0],t)},e.WebGLMaskManager.prototype.destroy=function(){this.gl=null},e.WebGLStencilManager=function(e){this.stencilStack=[],this.setContext(e),this.reverse=!0,this.count=0},e.WebGLStencilManager.prototype.setContext=function(e){this.gl=e},e.WebGLStencilManager.prototype.pushStencil=function(r,i,n){var e=this.gl;this.bindGraphics(r,i,n),0===this.stencilStack.length&&(e.enable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(i);var t=this.count;e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.ALWAYS,0,255),e.stencilOp(e.KEEP,e.KEEP,e.INVERT),1===i.mode?(e.drawElements(e.TRIANGLE_FAN,i.indices.length-4,e.UNSIGNED_SHORT,0),this.reverse?(e.stencilFunc(e.EQUAL,255-t,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)):(e.stencilFunc(e.EQUAL,t,255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_SHORT,2*(i.indices.length-4)),this.reverse?e.stencilFunc(e.EQUAL,255-(t+1),255):e.stencilFunc(e.EQUAL,t+1,255),this.reverse=!this.reverse):(this.reverse?(e.stencilFunc(e.EQUAL,t,255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)):(e.stencilFunc(e.EQUAL,255-t,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)),e.drawElements(e.TRIANGLE_STRIP,i.indices.length,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,t+1,255):e.stencilFunc(e.EQUAL,255-(t+1),255)),e.colorMask(!0,!0,!0,!0),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),this.count++},e.WebGLStencilManager.prototype.bindGraphics=function(r,n,a){this._currentGraphics=r;var i,t=this.gl,s=a.projection,o=a.offset;1===n.mode?(i=a.shaderManager.complexPrimitiveShader,a.shaderManager.setShader(i),t.uniformMatrix3fv(i.translationMatrix,!1,r.worldTransform.toArray(!0)),t.uniform2f(i.projectionVector,s.x,-s.y),t.uniform2f(i.offsetVector,-o.x,-o.y),t.uniform3fv(i.tintColor,e.hex2rgb(r.tint)),t.uniform3fv(i.color,n.color),t.uniform1f(i.alpha,r.worldAlpha*n.alpha),t.bindBuffer(t.ARRAY_BUFFER,n.buffer),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,8,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.indexBuffer)):(i=a.shaderManager.primitiveShader,a.shaderManager.setShader(i),t.uniformMatrix3fv(i.translationMatrix,!1,r.worldTransform.toArray(!0)),t.uniform2f(i.projectionVector,s.x,-s.y),t.uniform2f(i.offsetVector,-o.x,-o.y),t.uniform3fv(i.tintColor,e.hex2rgb(r.tint)),t.uniform1f(i.alpha,r.worldAlpha),t.bindBuffer(t.ARRAY_BUFFER,n.buffer),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,24,0),t.vertexAttribPointer(i.colorAttribute,4,t.FLOAT,!1,24,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.indexBuffer))},e.WebGLStencilManager.prototype.popStencil=function(r,i,n){var e=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)e.disable(e.STENCIL_TEST);else{var t=this.count;this.bindGraphics(r,i,n),e.colorMask(!1,!1,!1,!1),1===i.mode?(this.reverse=!this.reverse,this.reverse?(e.stencilFunc(e.EQUAL,255-(t+1),255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)):(e.stencilFunc(e.EQUAL,t+1,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_SHORT,2*(i.indices.length-4)),e.stencilFunc(e.ALWAYS,0,255),e.stencilOp(e.KEEP,e.KEEP,e.INVERT),e.drawElements(e.TRIANGLE_FAN,i.indices.length-4,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,t,255):e.stencilFunc(e.EQUAL,255-t,255)):(this.reverse?(e.stencilFunc(e.EQUAL,t+1,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR)):(e.stencilFunc(e.EQUAL,255-(t+1),255),e.stencilOp(e.KEEP,e.KEEP,e.INCR)),e.drawElements(e.TRIANGLE_STRIP,i.indices.length,e.UNSIGNED_SHORT,0),this.reverse?e.stencilFunc(e.EQUAL,t,255):e.stencilFunc(e.EQUAL,255-t,255)),e.colorMask(!0,!0,!0,!0),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}},e.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null,this.gl=null},e.WebGLShaderManager=function(t){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)},e.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new e.PrimitiveShader(t),this.complexPrimitiveShader=new e.ComplexPrimitiveShader(t),this.defaultShader=new e.PixiShader(t),this.fastShader=new e.PixiFastShader(t),this.stripShader=new e.StripShader(t),this.setShader(this.defaultShader)},e.WebGLShaderManager.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var r=t[e];this.tempAttribState[r]=!0}var i=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?i.enableVertexAttribArray(e):i.disableVertexAttribArray(e))},e.WebGLShaderManager.prototype.setShader=function(e){return this._currentId===e._UID?!1:(this._currentId=e._UID,this.currentShader=e,this.gl.useProgram(e.program),this.setAttribs(e.attributes),!0)},e.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},e.WebGLSpriteBatch=function(r){this.vertSize=6,this.size=2e3;var n=4*this.size*this.vertSize,i=6*this.size;this.vertices=new Float32Array(n),this.indices=new Uint16Array(i),this.lastIndexCount=0;for(var e=0,t=0;i>e;e+=6,t+=4)this.indices[e+0]=t+0,this.indices[e+1]=t+1,this.indices[e+2]=t+2,this.indices[e+3]=t+0,this.indices[e+4]=t+2,this.indices[e+5]=t+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.setContext(r),this.dirty=!0,this.textures=[],this.blendModes=[]},e.WebGLSpriteBatch.prototype.setContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLSpriteBatch.prototype.begin=function(e){this.renderSession=e,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},e.WebGLSpriteBatch.prototype.end=function(){this.flush()},e.WebGLSpriteBatch.prototype.render=function(n){var i=n.texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=i.baseTexture);var r=i._uvs;if(r){var o,a,l,s,u=n.worldAlpha,p=n.tint,e=this.vertices,x=n.anchor.x,b=n.anchor.y;if(i.trim){var d=i.trim;a=d.x-x*d.width,o=a+i.crop.width,s=d.y-b*d.height,l=s+i.crop.height}else o=i.frame.width*(1-x),a=i.frame.width*-x,l=i.frame.height*(1-b),s=i.frame.height*-b;var t=4*this.currentBatchSize*this.vertSize,f=i.baseTexture.resolution,c=n.worldTransform,m=c.a/f,g=c.c/f,y=c.b/f,v=c.d/f,h=c.tx,_=c.ty;e[t++]=m*a+y*s+h,e[t++]=v*s+g*a+_,e[t++]=r.x0,e[t++]=r.y0,e[t++]=u,e[t++]=p,e[t++]=m*o+y*s+h,e[t++]=v*s+g*o+_,e[t++]=r.x1,e[t++]=r.y1,e[t++]=u,e[t++]=p,e[t++]=m*o+y*l+h,e[t++]=v*l+g*o+_,e[t++]=r.x2,e[t++]=r.y2,e[t++]=u,e[t++]=p,e[t++]=m*a+y*l+h,e[t++]=v*l+g*a+_,e[t++]=r.x3,e[t++]=r.y3,e[t++]=u,e[t++]=p,this.textures[this.currentBatchSize]=n.texture.baseTexture,this.blendModes[this.currentBatchSize]=n.blendMode,this.currentBatchSize++}},e.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var a=t.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=a.baseTexture),t._uvs||(t._uvs=new e.TextureUvs);var n=t._uvs;t.tilePosition.x%=a.baseTexture.width*t.tileScaleOffset.x,t.tilePosition.y%=a.baseTexture.height*t.tileScaleOffset.y;var f=t.tilePosition.x/(a.baseTexture.width*t.tileScaleOffset.x),v=t.tilePosition.y/(a.baseTexture.height*t.tileScaleOffset.y),S=t.width/a.baseTexture.width/(t.tileScale.x*t.tileScaleOffset.x),C=t.height/a.baseTexture.height/(t.tileScale.y*t.tileScaleOffset.y);n.x0=0-f,n.y0=0-v,n.x1=1*S-f,n.y1=0-v,n.x2=1*S-f,n.y2=1*C-v,n.x3=0-f,n.y3=1*C-v;var l=t.worldAlpha,c=t.tint,i=this.vertices,E=t.width,T=t.height,w=t.anchor.x,A=t.anchor.y,_=E*(1-w),m=E*-w,g=T*(1-A),y=T*-A,r=4*this.currentBatchSize*this.vertSize,x=a.baseTexture.resolution,s=t.worldTransform,p=s.a/x,d=s.c/x,u=s.b/x,o=s.d/x,b=s.tx,h=s.ty;i[r++]=p*m+u*y+b,i[r++]=o*y+d*m+h,i[r++]=n.x0,i[r++]=n.y0,i[r++]=l,i[r++]=c,i[r++]=p*_+u*y+b,i[r++]=o*y+d*_+h,i[r++]=n.x1,i[r++]=n.y1,i[r++]=l,i[r++]=c,i[r++]=p*_+u*g+b,i[r++]=o*g+d*_+h,i[r++]=n.x2,i[r++]=n.y2,i[r++]=l,i[r++]=c,i[r++]=p*m+u*g+b,i[r++]=o*g+d*m+h,i[r++]=n.x3,i[r++]=n.y3,i[r++]=l,i[r++]=c,this.textures[this.currentBatchSize]=a.baseTexture,this.blendModes[this.currentBatchSize]=t.blendMode,this.currentBatchSize++},e.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var e=this.gl;if(this.renderSession.shaderManager.setShader(this.renderSession.shaderManager.defaultShader),this.dirty){this.dirty=!1,e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var c=this.renderSession.projection;e.uniform2f(this.shader.projectionVector,c.x,c.y);var l=4*this.vertSize;e.vertexAttribPointer(this.shader.aVertexPosition,2,e.FLOAT,!1,l,0),e.vertexAttribPointer(this.shader.aTextureCoord,2,e.FLOAT,!1,l,8),e.vertexAttribPointer(this.shader.colorAttribute,2,e.FLOAT,!1,l,16)}if(this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var h=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);e.bufferSubData(e.ARRAY_BUFFER,0,h)}for(var n,a,i=0,s=0,r=null,o=this.renderSession.blendModeManager.currentBlendMode,t=0,u=this.currentBatchSize;u>t;t++)n=this.textures[t],a=this.blendModes[t],(r!==n||o!==a)&&(this.renderBatch(r,i,s),s=t,i=0,r=n,o=a,this.renderSession.blendModeManager.setBlendMode(o)),i++;this.renderBatch(r,i,s),this.currentBatchSize=0}},e.WebGLSpriteBatch.prototype.renderBatch=function(i,r,n){if(0!==r){var t=this.gl;t.bindTexture(t.TEXTURE_2D,i._glTextures[t.id]||e.createWebGLTexture(i,t)),i._dirty[t.id]&&e.updateWebGLTexture(this.currentBaseTexture,t),t.drawElements(t.TRIANGLES,6*r,t.UNSIGNED_SHORT,6*n*2),this.renderSession.drawCount++}},e.WebGLSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},e.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},e.WebGLFastSpriteBatch=function(r){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var n=4*this.size*this.vertSize,i=6*this.maxSize;this.vertices=new Float32Array(n),this.indices=new Uint16Array(i),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var e=0,t=0;i>e;e+=6,t+=4)this.indices[e+0]=t+0,this.indices[e+1]=t+1,this.indices[e+2]=t+2,this.indices[e+3]=t+0,this.indices[e+4]=t+2,this.indices[e+5]=t+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(r)},e.WebGLFastSpriteBatch.prototype.setContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW)},e.WebGLFastSpriteBatch.prototype.begin=function(e,t){this.renderSession=t,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=e.worldTransform.toArray(!0),this.start()},e.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.render=function(r){var t=r.children,e=t[0];if(e.texture._uvs){this.currentBaseTexture=e.texture.baseTexture,e.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(e.blendMode));for(var i=0,n=t.length;n>i;i++)this.renderSprite(t[i]);this.flush()}},e.WebGLFastSpriteBatch.prototype.renderSprite=function(e){if(e.visible&&(e.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=e.texture.baseTexture,e.texture._uvs))){var r,h,c,o,a,s,n,t,i=this.vertices;if(r=e.texture._uvs,h=e.texture.frame.width,c=e.texture.frame.height,e.texture.trim){var l=e.texture.trim;a=l.x-e.anchor.x*l.width,o=a+e.texture.crop.width,n=l.y-e.anchor.y*l.height,s=n+e.texture.crop.height}else o=e.texture.frame.width*(1-e.anchor.x),a=e.texture.frame.width*-e.anchor.x,s=e.texture.frame.height*(1-e.anchor.y),n=e.texture.frame.height*-e.anchor.y;t=4*this.currentBatchSize*this.vertSize,i[t++]=a,i[t++]=n,i[t++]=e.position.x,i[t++]=e.position.y,i[t++]=e.scale.x,i[t++]=e.scale.y,i[t++]=e.rotation,i[t++]=r.x0,i[t++]=r.y1,i[t++]=e.alpha,i[t++]=o,i[t++]=n,i[t++]=e.position.x,i[t++]=e.position.y,i[t++]=e.scale.x,i[t++]=e.scale.y,i[t++]=e.rotation,i[t++]=r.x1,i[t++]=r.y1,i[t++]=e.alpha,i[t++]=o,i[t++]=s,i[t++]=e.position.x,i[t++]=e.position.y,i[t++]=e.scale.x,i[t++]=e.scale.y,i[t++]=e.rotation,i[t++]=r.x2,i[t++]=r.y2,i[t++]=e.alpha,i[t++]=a,i[t++]=s,i[t++]=e.position.x,i[t++]=e.position.y,i[t++]=e.scale.x,i[t++]=e.scale.y,i[t++]=e.rotation,i[t++]=r.x3,i[t++]=r.y3,i[t++]=e.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},e.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(this.currentBaseTexture._glTextures[t.id]||e.createWebGLTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var i=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,i)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.start=function(){var e=this.gl;e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var i=this.renderSession.projection;e.uniform2f(this.shader.projectionVector,i.x,i.y),e.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var t=4*this.vertSize;e.vertexAttribPointer(this.shader.aVertexPosition,2,e.FLOAT,!1,t,0),e.vertexAttribPointer(this.shader.aPositionCoord,2,e.FLOAT,!1,t,8),e.vertexAttribPointer(this.shader.aScale,2,e.FLOAT,!1,t,16),e.vertexAttribPointer(this.shader.aRotation,1,e.FLOAT,!1,t,24),e.vertexAttribPointer(this.shader.aTextureCoord,2,e.FLOAT,!1,t,28),e.vertexAttribPointer(this.shader.colorAttribute,1,e.FLOAT,!1,t,36)},e.WebGLFilterManager=function(e,t){this.transparent=t,this.filterStack=[],this.offsetX=0,this.offsetY=0,this.setContext(e)},e.WebGLFilterManager.prototype.setContext=function(e){this.gl=e,this.texturePool=[],this.initShaderBuffers()},e.WebGLFilterManager.prototype.begin=function(e,i){this.renderSession=e,this.defaultShader=e.shaderManager.defaultShader;var t=this.renderSession.projection;this.width=2*t.x,this.height=2*-t.y,this.buffer=i},e.WebGLFilterManager.prototype.pushFilter=function(r){var i=this.gl,s=this.renderSession.projection,o=this.renderSession.offset;r._filterArea=r.target.filterArea||r.target.getBounds(),this.filterStack.push(r);var l=r.filterPasses[0];this.offsetX+=r._filterArea.x,this.offsetY+=r._filterArea.y;var n=this.texturePool.pop();n?n.resize(this.width,this.height):n=new e.FilterTexture(this.gl,this.width,this.height),i.bindTexture(i.TEXTURE_2D,n.texture);var t=r._filterArea,a=l.padding;t.x-=a,t.y-=a,t.width+=2*a,t.height+=2*a,t.x<0&&(t.x=0),t.width>this.width&&(t.width=this.width),t.y<0&&(t.y=0),t.height>this.height&&(t.height=this.height),i.bindFramebuffer(i.FRAMEBUFFER,n.frameBuffer),i.viewport(0,0,t.width,t.height),s.x=t.width/2,s.y=-t.height/2,o.x=-t.x,o.y=-t.y,this.renderSession.shaderManager.setShader(this.defaultShader),i.uniform2f(this.defaultShader.projectionVector,t.width/2,-t.height/2),i.uniform2f(this.defaultShader.offsetVector,-t.x,-t.y),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),r._glFilterTexture=n},e.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,r=this.filterStack.pop(),i=r._filterArea,h=r._glFilterTexture,g=this.renderSession.projection,f=this.renderSession.offset;if(r.filterPasses.length>1){t.viewport(0,0,i.width,i.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=i.height,this.vertexArray[2]=i.width,this.vertexArray[3]=i.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=i.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var o=h,n=this.texturePool.pop();n||(n=new e.FilterTexture(this.gl,this.width,this.height)),n.resize(this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,n.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var p=0;p<r.filterPasses.length-1;p++){var v=r.filterPasses[p];t.bindFramebuffer(t.FRAMEBUFFER,n.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,o.texture),this.applyFilterPass(v,i,i.width,i.height);var x=o;o=n,n=x}t.enable(t.BLEND),h=o,this.texturePool.push(n)}var y=r.filterPasses[r.filterPasses.length-1];this.offsetX-=i.x,this.offsetY-=i.y;var s=this.width,a=this.height,c=0,d=0,_=this.buffer;if(0===this.filterStack.length)t.colorMask(!0,!0,!0,!0);else{var m=this.filterStack[this.filterStack.length-1];i=m._filterArea,s=i.width,a=i.height,c=i.x,d=i.y,_=m._glFilterTexture.frameBuffer}g.x=s/2,g.y=-a/2,f.x=c,f.y=d,i=r._filterArea;var u=i.x-c,l=i.y-d;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=u,this.vertexArray[1]=l+i.height,this.vertexArray[2]=u+i.width,this.vertexArray[3]=l+i.height,this.vertexArray[4]=u,this.vertexArray[5]=l,this.vertexArray[6]=u+i.width,this.vertexArray[7]=l,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,s,a),t.bindFramebuffer(t.FRAMEBUFFER,_),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,h.texture),this.applyFilterPass(y,i,s,a),this.renderSession.shaderManager.setShader(this.defaultShader),t.uniform2f(this.defaultShader.projectionVector,s/2,-a/2),t.uniform2f(this.defaultShader.offsetVector,-c,-d),this.texturePool.push(h),r._glFilterTexture=null},e.WebGLFilterManager.prototype.applyFilterPass=function(r,s,n,a){var t=this.gl,i=r.shaders[t.id];i||(i=new e.PixiShader(t),i.fragmentSrc=r.fragmentSrc,i.uniforms=r.uniforms,i.init(),r.shaders[t.id]=i),this.renderSession.shaderManager.setShader(i),t.uniform2f(i.projectionVector,n/2,-a/2),t.uniform2f(i.offsetVector,0,0),r.uniforms.dimensions&&(r.uniforms.dimensions.value[0]=this.width,r.uniforms.dimensions.value[1]=this.height,r.uniforms.dimensions.value[2]=this.vertexArray[0],r.uniforms.dimensions.value[3]=this.vertexArray[5]),i.syncUniforms(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.vertexAttribPointer(i.aTextureCoord,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.vertexAttribPointer(i.colorAttribute,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),this.renderSession.drawCount++},e.WebGLFilterManager.prototype.initShaderBuffers=function(){var e=this.gl;this.vertexBuffer=e.createBuffer(),this.uvBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW),this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvArray,e.STATIC_DRAW),this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),e.STATIC_DRAW)},e.WebGLFilterManager.prototype.destroy=function(){var e=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null,e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.uvBuffer),e.deleteBuffer(this.colorBuffer),e.deleteBuffer(this.indexBuffer)},e.FilterTexture=function(t,r,n,i){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),i=i||e.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(r,n)},e.FilterTexture.prototype.clear=function(){var e=this.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},e.FilterTexture.prototype.resize=function(t,i){if(this.width!==t||this.height!==i){this.width=t,this.height=i;var e=this.gl;e.bindTexture(e.TEXTURE_2D,this.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindRenderbuffer(e.RENDERBUFFER,this.renderBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t,i)}},e.FilterTexture.prototype.destroy=function(){var e=this.gl;e.deleteFramebuffer(this.frameBuffer),e.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},e.CanvasMaskManager=function(){},e.CanvasMaskManager.prototype.pushMask=function(r,a){var n=a.context;n.save();var s=r.alpha,t=r.worldTransform,i=a.resolution;n.setTransform(t.a*i,t.c*i,t.b*i,t.d*i,t.tx*i,t.ty*i),e.CanvasGraphics.renderGraphicsMask(r,n),n.clip(),r.worldAlpha=s},e.CanvasMaskManager.prototype.popMask=function(e){e.context.restore()},e.CanvasTinter=function(){},e.CanvasTinter.getTintedTexture=function(s,i){var t=s.texture;i=e.CanvasTinter.roundColor(i);var r="#"+("00000"+(0|i).toString(16)).substr(-6);if(t.tintCache=t.tintCache||{},t.tintCache[r])return t.tintCache[r];var n=e.CanvasTinter.canvas||document.createElement("canvas");if(e.CanvasTinter.tintMethod(t,i,n),e.CanvasTinter.convertTintToImage){var a=new Image;a.src=n.toDataURL(),t.tintCache[r]=a}else t.tintCache[r]=n,e.CanvasTinter.canvas=null;return n},e.CanvasTinter.tintWithMultiply=function(i,n,r){var t=r.getContext("2d"),e=i.crop;r.width=e.width,r.height=e.height,t.fillStyle="#"+("00000"+(0|n).toString(16)).substr(-6),t.fillRect(0,0,e.width,e.height),t.globalCompositeOperation="multiply",t.drawImage(i.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height),t.globalCompositeOperation="destination-atop",t.drawImage(i.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.CanvasTinter.tintWithOverlay=function(r,n,i){var t=i.getContext("2d"),e=r.crop;i.width=e.width,i.height=e.height,t.globalCompositeOperation="copy",t.fillStyle="#"+("00000"+(0|n).toString(16)).substr(-6),t.fillRect(0,0,e.width,e.height),t.globalCompositeOperation="destination-atop",t.drawImage(r.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.CanvasTinter.tintWithPerPixel=function(o,u,a){var r=a.getContext("2d"),t=o.crop;a.width=t.width,a.height=t.height,r.globalCompositeOperation="copy",r.drawImage(o.baseTexture.source,t.x,t.y,t.width,t.height,0,0,t.width,t.height);for(var s=e.hex2rgb(u),d=s[0],h=s[1],c=s[2],l=r.getImageData(0,0,t.width,t.height),n=l.data,i=0;i<n.length;i+=4)n[i+0]*=d,n[i+1]*=h,n[i+2]*=c;r.putImageData(l,0,0)},e.CanvasTinter.roundColor=function(r){var i=e.CanvasTinter.cacheStepsPerColorChannel,t=e.hex2rgb(r);return t[0]=Math.min(255,t[0]/i*i),t[1]=Math.min(255,t[1]/i*i),t[2]=Math.min(255,t[2]/i*i),e.rgb2hex(t)},e.CanvasTinter.cacheStepsPerColorChannel=8,e.CanvasTinter.convertTintToImage=!1,e.CanvasTinter.canUseMultiply=e.canUseNewCanvasBlendModes(),e.CanvasTinter.tintMethod=e.CanvasTinter.canUseMultiply?e.CanvasTinter.tintWithMultiply:e.CanvasTinter.tintWithPerPixel,e.CanvasRenderer=function(r,n,t){if(t)for(var i in e.defaultRenderOptions)"undefined"==typeof t[i]&&(t[i]=e.defaultRenderOptions[i]);else t=e.defaultRenderOptions;this.type=e.CANVAS_RENDERER,this.resolution=t.resolution,this.clearBeforeRender=t.clearBeforeRender,this.transparent=t.transparent,e.blendModesCanvas||(e.blendModesCanvas=[],e.canUseNewCanvasBlendModes()?(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="multiply",e.blendModesCanvas[e.blendModes.SCREEN]="screen",e.blendModesCanvas[e.blendModes.OVERLAY]="overlay",e.blendModesCanvas[e.blendModes.DARKEN]="darken",e.blendModesCanvas[e.blendModes.LIGHTEN]="lighten",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="color-dodge",e.blendModesCanvas[e.blendModes.COLOR_BURN]="color-burn",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="hard-light",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="soft-light",e.blendModesCanvas[e.blendModes.DIFFERENCE]="difference",e.blendModesCanvas[e.blendModes.EXCLUSION]="exclusion",e.blendModesCanvas[e.blendModes.HUE]="hue",e.blendModesCanvas[e.blendModes.SATURATION]="saturation",e.blendModesCanvas[e.blendModes.COLOR]="color",e.blendModesCanvas[e.blendModes.LUMINOSITY]="luminosity"):(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="source-over",e.blendModesCanvas[e.blendModes.SCREEN]="source-over",e.blendModesCanvas[e.blendModes.OVERLAY]="source-over",e.blendModesCanvas[e.blendModes.DARKEN]="source-over",e.blendModesCanvas[e.blendModes.LIGHTEN]="source-over",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="source-over",e.blendModesCanvas[e.blendModes.COLOR_BURN]="source-over",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.DIFFERENCE]="source-over",e.blendModesCanvas[e.blendModes.EXCLUSION]="source-over",e.blendModesCanvas[e.blendModes.HUE]="source-over",e.blendModesCanvas[e.blendModes.SATURATION]="source-over",e.blendModesCanvas[e.blendModes.COLOR]="source-over",e.blendModesCanvas[e.blendModes.LUMINOSITY]="source-over")),this.width=r||800,this.height=n||600,this.width*=this.resolution,this.height*=this.resolution,this.view=t.view||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width*this.resolution,this.view.height=this.height*this.resolution,this.count=0,this.maskManager=new e.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1},this.resize(r,n),"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="msImageSmoothingEnabled")},e.CanvasRenderer.prototype.constructor=e.CanvasRenderer,e.CanvasRenderer.prototype.render=function(t){e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent||(this.context.fillStyle=t.backgroundColorString),this.context[this.transparent?"clearRect":"fillRect"](0,0,this.width,this.height)),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),e.Texture.frameUpdates.length>0&&(e.Texture.frameUpdates.length=0)},e.CanvasRenderer.prototype.resize=function(e,t){this.width=e*this.resolution,this.height=t*this.resolution,this.view.width=this.width,this.view.height=this.height},e.CanvasRenderer.prototype.renderDisplayObject=function(e,t){this.renderSession.context=t||this.context,this.renderSession.resolution=this.resolution,e._renderCanvas(this.renderSession)},e.CanvasRenderer.prototype.renderStripFlat=function(s){var t=this.context,e=s.verticies,a=e.length/2;this.count++,t.beginPath();for(var r=1;a-2>r;r++){var i=2*r,n=e[i],o=e[i+2],l=e[i+4],c=e[i+1],h=e[i+3],u=e[i+5];t.moveTo(n,c),t.lineTo(o,h),t.lineTo(l,u)}t.fillStyle="#FF0000",t.fill(),t.closePath()},e.CanvasRenderer.prototype.renderStrip=function(l){var o=this.context,f=l.verticies,m=l.uvs,v=f.length/2;this.count++;for(var y=1;v-2>y;y++){var e=2*y,p=f[e],d=f[e+2],c=f[e+4],_=f[e+1],h=f[e+3],u=f[e+5],t=m[e]*l.texture.width,s=m[e+2]*l.texture.width,a=m[e+4]*l.texture.width,n=m[e+1]*l.texture.height,r=m[e+3]*l.texture.height,i=m[e+5]*l.texture.height;o.save(),o.beginPath(),o.moveTo(p,_),o.lineTo(d,h),o.lineTo(c,u),o.closePath(),o.clip();var g=t*r+n*a+s*i-r*a-n*s-t*i,x=p*r+n*c+d*i-r*c-n*d-p*i,b=t*d+p*a+s*c-d*a-p*s-t*c,w=t*r*c+n*d*a+p*s*i-p*r*a-n*s*c-t*d*i,T=_*r+n*u+h*i-r*u-n*h-_*i,E=t*h+_*a+s*u-h*a-_*s-t*u,C=t*r*u+n*h*a+_*s*i-_*r*a-n*s*u-t*h*i;o.transform(x/g,T/g,b/g,E/g,w/g,C/g),o.drawImage(l.texture.baseTexture.source,0,0),o.restore()}},e.CanvasBuffer=function(e,t){this.width=e,this.height=t,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=e,this.canvas.height=t},e.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.CanvasBuffer.prototype.resize=function(e,t){this.width=this.canvas.width=e,this.height=this.canvas.height=t},e.CanvasGraphics=function(){},e.CanvasGraphics.renderGraphics=function(b,t){for(var o=b.worldAlpha,p="",T=0;T<b.graphicsData.length;T++){var i=b.graphicsData[T],r=i.points;if(t.strokeStyle=p="#"+("00000"+(0|i.lineColor).toString(16)).substr(-6),t.lineWidth=i.lineWidth,i.type===e.Graphics.POLY){t.beginPath(),t.moveTo(r[0],r[1]);for(var g=1;g<r.length/2;g++)t.lineTo(r[2*g],r[2*g+1]);r[0]===r[r.length-2]&&r[1]===r[r.length-1]&&t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.stroke())}else if(i.type===e.Graphics.RECT)(i.fillColor||0===i.fillColor)&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fillRect(r[0],r[1],r[2],r[3])),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.strokeRect(r[0],r[1],r[2],r[3]));else if(i.type===e.Graphics.CIRC)t.beginPath(),t.arc(r[0],r[1],r[2],0,2*Math.PI),t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.stroke());else if(i.type===e.Graphics.ELIP){var _=i.points,v=2*_[2],m=2*_[3],u=_[0]-v/2,f=_[1]-m/2;t.beginPath();var S=.5522848,y=v/2*S,x=m/2*S,E=u+v,w=f+m,d=u+v/2,c=f+m/2;t.moveTo(u,c),t.bezierCurveTo(u,c-x,d-y,f,d,f),t.bezierCurveTo(d+y,f,E,c-x,E,c),t.bezierCurveTo(E,c+x,d+y,w,d,w),t.bezierCurveTo(d-y,w,u,c+x,u,c),t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.stroke())}else if(i.type===e.Graphics.RREC){var a=r[0],n=r[1],h=r[2],l=r[3],s=r[4],C=Math.min(h,l)/2|0;s=s>C?C:s,t.beginPath(),t.moveTo(a,n+s),t.lineTo(a,n+l-s),t.quadraticCurveTo(a,n+l,a+s,n+l),t.lineTo(a+h-s,n+l),t.quadraticCurveTo(a+h,n+l,a+h,n+l-s),t.lineTo(a+h,n+s),t.quadraticCurveTo(a+h,n,a+h-s,n),t.lineTo(a+s,n),t.quadraticCurveTo(a,n,a,n+s),t.closePath(),(i.fillColor||0===i.fillColor)&&(t.globalAlpha=i.fillAlpha*o,t.fillStyle=p="#"+("00000"+(0|i.fillColor).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*o,t.stroke())}}},e.CanvasGraphics.renderGraphicsMask=function(E,t){var b=E.graphicsData.length;if(0!==b){b>1&&(b=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var x=0;1>x;x++){var l=E.graphicsData[x],i=l.points;if(l.type===e.Graphics.POLY){t.beginPath(),t.moveTo(i[0],i[1]);for(var f=1;f<i.length/2;f++)t.lineTo(i[2*f],i[2*f+1]);i[0]===i[i.length-2]&&i[1]===i[i.length-1]&&t.closePath()}else if(l.type===e.Graphics.RECT)t.beginPath(),t.rect(i[0],i[1],i[2],i[3]),t.closePath();else if(l.type===e.Graphics.CIRC)t.beginPath(),t.arc(i[0],i[1],i[2],0,2*Math.PI),t.closePath();else if(l.type===e.Graphics.ELIP){var p=l.points,g=2*p[2],_=2*p[3],h=p[0]-g/2,d=p[1]-_/2;t.beginPath();var T=.5522848,m=g/2*T,y=_/2*T,w=h+g,v=d+_,u=h+g/2,o=d+_/2;t.moveTo(h,o),t.bezierCurveTo(h,o-y,u-m,d,u,d),t.bezierCurveTo(u+m,d,w,o-y,w,o),t.bezierCurveTo(w,o+y,u+m,v,u,v),t.bezierCurveTo(u-m,v,h,o+y,h,o),t.closePath()}else if(l.type===e.Graphics.RREC){var n=i[0],r=i[1],c=i[2],s=i[3],a=i[4],C=Math.min(c,s)/2|0;a=a>C?C:a,t.beginPath(),t.moveTo(n,r+a),t.lineTo(n,r+s-a),t.quadraticCurveTo(n,r+s,n+a,r+s),t.lineTo(n+c-a,r+s),t.quadraticCurveTo(n+c,r+s,n+c,r+s-a),t.lineTo(n+c,r+a),t.quadraticCurveTo(n+c,r,n+c-a,r),t.lineTo(n+a,r),t.quadraticCurveTo(n,r,n,r+a),t.closePath()}}}},e.Graphics=function(){e.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.tint=16777215,this.blendMode=e.blendModes.NORMAL,this.currentPath={points:[]},this._webGL=[],this.isMask=!1,this.bounds=null,this.boundsPadding=10,this.dirty=!0},e.Graphics.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Graphics.prototype.constructor=e.Graphics,Object.defineProperty(e.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap=e,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),e.Graphics.prototype.lineStyle=function(t,i,r){return this.currentPath.points.length||this.graphicsData.pop(),this.lineWidth=t||0,this.lineColor=i||0,this.lineAlpha=arguments.length<3?1:r,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.moveTo=function(t,i){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.currentPath.points.push(t,i),this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.lineTo=function(e,t){return this.currentPath.points.push(e,t),this.dirty=!0,this},e.Graphics.prototype.quadraticCurveTo=function(i,s,u,h){0===this.currentPath.points.length&&this.moveTo(0,0);var n,a,c=20,t=this.currentPath.points;0===t.length&&this.moveTo(0,0);for(var o=t[t.length-2],l=t[t.length-1],e=0,r=1;c>=r;r++)e=r/c,n=o+(i-o)*e,a=l+(s-l)*e,t.push(n+(i+(u-i)*e-n)*e,a+(s+(h-s)*e-a)*e);return this.dirty=!0,this},e.Graphics.prototype.bezierCurveTo=function(m,c,_,d,u,h){0===this.currentPath.points.length&&this.moveTo(0,0);for(var t,n,a,r,s,l=20,i=this.currentPath.points,p=i[i.length-2],f=i[i.length-1],e=0,o=1;l>=o;o++)e=o/l,t=1-e,n=t*t,a=n*t,r=e*e,s=r*e,i.push(a*p+3*n*e*m+3*t*r*_+s*u,a*f+3*n*e*c+3*t*r*d+s*h);return this.dirty=!0,this},e.Graphics.prototype.arcTo=function(a,o,b,x,c){0===this.currentPath.points.length&&this.moveTo(a,o);var n=this.currentPath.points,v=n[n.length-2],y=n[n.length-1],t=y-o,e=v-a,r=x-o,i=b-a,u=Math.abs(t*i-e*r);if(1e-8>u||0===c)n.push(a,o);else{var p=t*t+e*e,m=r*r+i*i,_=t*r+e*i,s=c*Math.sqrt(p)/u,l=c*Math.sqrt(m)/u,f=s*_/p,g=l*_/m,d=s*i+l*e,h=s*r+l*t,w=e*(l+f),T=t*(l+f),E=i*(s+g),C=r*(s+g),S=Math.atan2(T-h,w-d),A=Math.atan2(C-h,E-d);this.arc(d+a,h+o,c,S,A,e*r>i*t)}return this.dirty=!0,this},e.Graphics.prototype.arc=function(g,u,n,e,i,s){var c=g+Math.cos(e)*n,_=u+Math.sin(e)*n,t=this.currentPath.points;if((0!==t.length&&t[t.length-2]!==c||t[t.length-1]!==_)&&(this.moveTo(c,_),t=this.currentPath.points),e===i)return this;!s&&e>=i?i+=2*Math.PI:s&&i>=e&&(e+=2*Math.PI);var o=s?-1*(e-i):i-e,h=Math.abs(o)/(2*Math.PI)*40;if(0===o)return this;for(var r=o/(2*h),b=2*r,p=Math.cos(r),f=Math.sin(r),l=h-1,x=l%1/l,a=0;l>=a;a++){var v=a+x*a,m=r+e+b*v,d=Math.cos(m),y=-Math.sin(m);t.push((p*d+f*y)*n+g,(p*-y+f*d)*n+u)}return this.dirty=!0,this},e.Graphics.prototype.drawPath=function(t){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath),this.currentPath.points=this.currentPath.points.concat(t),this.dirty=!0,this},e.Graphics.prototype.beginFill=function(e,t){return this.filling=!0,this.fillColor=e||0,this.fillAlpha=arguments.length<2?1:t,this},e.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.Graphics.prototype.drawRect=function(t,i,r,n){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,r,n],type:e.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawRoundedRect=function(t,i,r,n,a){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,r,n,a],type:e.Graphics.RREC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawCircle=function(i,r,t){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[i,r,t,t],type:e.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawEllipse=function(t,i,r,n){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,r,n],type:e.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this.bounds=null,this},e.Graphics.prototype.generateTexture=function(t,a){t=t||2;var i=this.getBounds(),r=new e.CanvasBuffer(i.width*t,i.height*t),n=e.Texture.fromCanvas(r.canvas,a);return n.baseTexture.resolution=t,r.context.scale(t,t),r.context.translate(-i.x,-i.y),e.CanvasGraphics.renderGraphics(this,r.context),n},e.Graphics.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return this.dirty&&(this._generateCachedSprite(),e.updateWebGLTexture(this._cachedSprite.texture.baseTexture,t.gl),this.dirty=!1),this._cachedSprite.alpha=this.alpha,void e.Sprite.prototype._renderWebGL.call(this._cachedSprite,t);if(t.spriteBatch.stop(),t.blendModeManager.setBlendMode(this.blendMode),this._mask&&t.maskManager.pushMask(this._mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode){t.spriteBatch.currentBlendMode=this.blendMode;var r=e.blendModesWebGL[t.spriteBatch.currentBlendMode];t.spriteBatch.gl.blendFunc(r[0],r[1])}if(e.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var i=0,n=this.children.length;n>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this.mask,t),t.drawCount++,t.spriteBatch.start()}},e.Graphics.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){var n=t.context,i=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,n.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t.context);var r=t.resolution;n.setTransform(i.a*r,i.c*r,i.b*r,i.d*r,i.tx*r,i.ty*r),e.CanvasGraphics.renderGraphics(this,n);for(var a=0,s=this.children.length;s>a;a++)this.children[a]._renderCanvas(t);this._mask&&t.maskManager.popMask(t.context)}},e.Graphics.prototype.getBounds=function(E){this.bounds||this.updateBounds();var b=this.bounds.x,u=this.bounds.width+this.bounds.x,x=this.bounds.y,v=this.bounds.height+this.bounds.y,n=E||this.worldTransform,y=n.a,o=n.c,f=n.b,l=n.d,c=n.tx,h=n.ty,w=y*u+f*v+c,T=l*v+o*u+h,d=y*b+f*v+c,p=l*v+o*b+h,s=y*b+f*x+c,_=l*x+o*b+h,m=y*u+f*x+c,g=l*x+o*u+h,r=w,i=T,t=w,e=T;t=t>d?d:t,t=t>s?s:t,t=t>m?m:t,e=e>p?p:e,e=e>_?_:e,e=e>g?g:e,r=d>r?d:r,r=s>r?s:r,r=m>r?m:r,i=p>i?p:i,i=_>i?_:i,i=g>i?g:i;var a=this._bounds;return a.x=t,a.width=r-t,a.y=e,a.height=i-e,a},e.Graphics.prototype.updateBounds=function(){for(var n,i,t,h,c,s=1/0,o=-1/0,a=1/0,l=-1/0,p=0;p<this.graphicsData.length;p++){var f=this.graphicsData[p],_=f.type,r=f.lineWidth;if(n=f.points,_===e.Graphics.RECT)i=n[0]-r/2,t=n[1]-r/2,h=n[2]+r,c=n[3]+r,s=s>i?i:s,o=i+h>o?i+h:o,a=a>t?t:a,l=t+c>l?t+c:l;else if(_===e.Graphics.CIRC||_===e.Graphics.ELIP)i=n[0],t=n[1],h=n[2]+r/2,c=n[3]+r/2,s=s>i-h?i-h:s,o=i+h>o?i+h:o,a=a>t-c?t-c:a,l=t+c>l?t+c:l;else for(var u=0;u<n.length;u+=2)i=n[u],t=n[u+1],s=s>i-r?i-r:s,o=i+r>o?i+r:o,a=a>t-r?t-r:a,l=t+r>l?t+r:l}var d=this.boundsPadding;this.bounds=new e.Rectangle(s-d,a-d,o-s+2*d,l-a+2*d)},e.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var i=new e.CanvasBuffer(t.width,t.height),r=e.Texture.fromCanvas(i.canvas);this._cachedSprite=new e.Sprite(r),this._cachedSprite.buffer=i,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._cachedSprite.buffer.context.translate(-t.x,-t.y),e.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},e.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},e.Graphics.POLY=0,e.Graphics.RECT=1,e.Graphics.CIRC=2,e.Graphics.ELIP=3,e.Graphics.RREC=4,e.Strip=function(t){e.DisplayObjectContainer.call(this),this.texture=t,this.uvs=new e.Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new e.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new e.Float32Array([1,1,1,1]),this.indices=new e.Uint16Array([0,1,2,3]),this.dirty=!0,this.padding=0},e.Strip.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Strip.prototype.constructor=e.Strip,e.Strip.prototype._renderWebGL=function(e){!this.visible||this.alpha<=0||(e.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(e),e.shaderManager.setShader(e.shaderManager.stripShader),this._renderStrip(e),e.spriteBatch.start())},e.Strip.prototype._initWebGL=function(t){var e=t.gl;this._vertexBuffer=e.createBuffer(),this._indexBuffer=e.createBuffer(),this._uvBuffer=e.createBuffer(),this._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.verticies,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)},e.Strip.prototype._renderStrip=function(r){var t=r.gl,n=r.projection,a=r.offset,i=r.shaderManager.stripShader;t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.uniformMatrix3fv(i.translationMatrix,!1,this.worldTransform.toArray(!0)),t.uniform2f(i.projectionVector,n.x,-n.y),t.uniform2f(i.offsetVector,-a.x,-a.y),t.uniform1f(i.alpha,1),this.dirty?(this.dirty=!1,t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.verticies,t.STATIC_DRAW),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.STATIC_DRAW),t.vertexAttribPointer(i.aTextureCoord,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture.baseTexture._glTextures[t.id]||e.createWebGLTexture(this.texture.baseTexture,t)),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)):(t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.verticies),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer),t.vertexAttribPointer(i.aTextureCoord,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture.baseTexture._glTextures[t.id]||e.createWebGLTexture(this.texture.baseTexture,t)),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),t.drawElements(t.TRIANGLE_STRIP,this.indices.length,t.UNSIGNED_SHORT,0)},e.Strip.prototype._renderCanvas=function(C){var r=C.context,i=this.worldTransform;C.roundPixels?r.setTransform(i.a,i.c,i.b,i.d,0|i.tx,0|i.ty):r.setTransform(i.a,i.c,i.b,i.d,i.tx,i.ty);var y=this,v=y.verticies,w=y.uvs,S=v.length/2;this.count++;for(var E=0;S-2>E;E++){var t=2*E,l=v[t],c=v[t+2],h=v[t+4],u=v[t+1],s=v[t+3],p=v[t+5];if(0===this.padding){var x=(l+c+h)/3,T=(u+s+p)/3,n=l-x,a=u-T,e=Math.sqrt(n*n+a*a);l=x+n/e*(e+3),u=T+a/e*(e+3),n=c-x,a=s-T,e=Math.sqrt(n*n+a*a),c=x+n/e*(e+3),s=T+a/e*(e+3),n=h-x,a=p-T,e=Math.sqrt(n*n+a*a),h=x+n/e*(e+3),p=T+a/e*(e+3)}var g=w[t]*y.texture.width,m=w[t+2]*y.texture.width,_=w[t+4]*y.texture.width,f=w[t+1]*y.texture.height,d=w[t+3]*y.texture.height,o=w[t+5]*y.texture.height;r.save(),r.beginPath(),r.moveTo(l,u),r.lineTo(c,s),r.lineTo(h,p),r.closePath(),r.clip();var b=g*d+f*_+m*o-d*_-f*m-g*o,A=l*d+f*h+c*o-d*h-f*c-l*o,M=g*c+l*_+m*h-c*_-l*m-g*h,k=g*d*h+f*c*_+l*m*o-l*d*_-f*m*h-g*c*o,R=u*d+f*p+s*o-d*p-f*s-u*o,L=g*s+u*_+m*p-s*_-u*m-g*p,P=g*d*p+f*s*_+u*m*o-u*d*_-f*m*p-g*s*o;r.transform(A/b,R/b,M/b,L/b,k/b,P/b),r.drawImage(y.texture.baseTexture.source,0,0),r.restore()}},e.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.Rope=function(i,t){e.Strip.call(this,i),this.points=t,this.verticies=new e.Float32Array(4*t.length),this.uvs=new e.Float32Array(4*t.length),this.colors=new e.Float32Array(2*t.length),this.indices=new e.Uint16Array(2*t.length),this.refresh()},e.Rope.prototype=Object.create(e.Strip.prototype),e.Rope.prototype.constructor=e.Rope,e.Rope.prototype.refresh=function(){var n=this.points;if(!(n.length<1)){var t=this.uvs,c=n[0],a=this.indices,s=this.colors;this.count-=.2,t[0]=0,t[1]=0,t[2]=0,t[3]=1,s[0]=1,s[1]=1,a[0]=0,a[1]=1;for(var o,e,r,l=n.length,i=1;l>i;i++)o=n[i],e=4*i,r=i/(l-1),i%2?(t[e]=r,t[e+1]=0,t[e+2]=r,t[e+3]=1):(t[e]=r,t[e+1]=0,t[e+2]=r,t[e+3]=1),e=2*i,s[e]=1,s[e+1]=1,e=2*i,a[e]=e,a[e+1]=e+1,c=o}},e.Rope.prototype.updateTransform=function(){var n=this.points;if(!(n.length<1)){var l,o=n[0],t={x:0,y:0};this.count-=.2;for(var r,a,u,c,h,s=this.verticies,d=n.length,i=0;d>i;i++)r=n[i],a=4*i,l=i<n.length-1?n[i+1]:r,t.y=-(l.x-o.x),t.x=l.y-o.y,u=10*(1-i/(d-1)),u>1&&(u=1),c=Math.sqrt(t.x*t.x+t.y*t.y),h=this.texture.height/2,t.x/=c,t.y/=c,t.x*=h,t.y*=h,s[a]=r.x+t.x,s[a+1]=r.y+t.y,s[a+2]=r.x-t.x,s[a+3]=r.y-t.y,o=r;e.DisplayObjectContainer.prototype.updateTransform.call(this)}},e.Rope.prototype.setTexture=function(e){this.texture=e},e.TilingSprite=function(t,i,r){e.Sprite.call(this,t),this._width=i||100,this._height=r||100,this.tileScale=new e.Point(1,1),this.tileScaleOffset=new e.Point(1,1),this.tilePosition=new e.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL},e.TilingSprite.prototype=Object.create(e.Sprite.prototype),e.TilingSprite.prototype.constructor=e.TilingSprite,Object.defineProperty(e.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}}),Object.defineProperty(e.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}}),e.TilingSprite.prototype.setTexture=function(e){this.texture!==e&&(this.texture=e,this.refreshTexture=!0,this.cachedTint=16777215)},e.TilingSprite.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha){var i,r;for(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(e.updateWebGLTexture(this.tilingTexture.baseTexture,t.gl),this.tilingTexture.needsUpdate=!1)):t.spriteBatch.renderTilingSprite(this),i=0,r=this.children.length;r>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this._mask,t),t.spriteBatch.start()}},e.TilingSprite.prototype._renderCanvas=function(i){if(this.visible!==!1&&0!==this.alpha){var t=i.context;this._mask&&i.maskManager.pushMask(this._mask,t),t.globalAlpha=this.worldAlpha;var o,l,n=this.worldTransform,a=i.resolution;if(t.setTransform(n.a*a,n.c*a,n.b*a,n.d*a,n.tx*a,n.ty*a),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=t.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==i.currentBlendMode&&(i.currentBlendMode=this.blendMode,t.globalCompositeOperation=e.blendModesCanvas[i.currentBlendMode]);var r=this.tilePosition,s=this.tileScale;for(r.x%=this.tilingTexture.baseTexture.width,r.y%=this.tilingTexture.baseTexture.height,t.scale(s.x,s.y),t.translate(r.x,r.y),t.fillStyle=this.__tilePattern,t.fillRect(-r.x+this.anchor.x*-this._width,-r.y+this.anchor.y*-this._height,this._width/s.x,this._height/s.y),t.scale(1/s.x,1/s.y),t.translate(-r.x,-r.y),this._mask&&i.maskManager.popMask(i.context),o=0,l=this.children.length;l>o;o++)this.children[o]._renderCanvas(i)}},e.TilingSprite.prototype.getBounds=function(){var C=this._width,E=this._height,p=C*(1-this.anchor.x),b=C*-this.anchor.x,w=E*(1-this.anchor.y),T=E*-this.anchor.y,a=this.worldTransform,o=a.a,l=a.c,c=a.b,h=a.d,u=a.tx,d=a.ty,s=o*b+c*T+u,f=h*T+l*b+d,_=o*p+c*T+u,m=h*T+l*p+d,g=o*p+c*w+u,y=h*w+l*p+d,v=o*b+c*w+u,x=h*w+l*b+d,i=-1/0,r=-1/0,t=1/0,e=1/0;t=t>s?s:t,t=t>_?_:t,t=t>g?g:t,t=t>v?v:t,e=e>f?f:e,e=e>m?m:e,e=e>y?y:e,e=e>x?x:e,i=s>i?s:i,i=_>i?_:i,i=g>i?g:i,i=v>i?v:i,r=f>r?f:r,r=m>r?m:r,r=y>r?y:r,r=x>r?x:r;var n=this._bounds;return n.x=t,n.width=i-t,n.y=e,n.height=r-e,this._currentBounds=n,n},e.TilingSprite.prototype.onTextureUpdate=function(){},e.TilingSprite.prototype.generateTilingTexture=function(o){if(this.texture.baseTexture.hasLoaded){var r,n,i=this.texture,t=i.frame,l=t.width!==i.baseTexture.width||t.height!==i.baseTexture.height,s=!1;if(o?(r=e.getNextPowerOfTwo(t.width),n=e.getNextPowerOfTwo(t.height),(t.width!==r||t.height!==n)&&(s=!0)):l&&(r=t.width,n=t.height,s=!0),s){var a;this.tilingTexture&&this.tilingTexture.isTiling?(a=this.tilingTexture.canvasBuffer,a.resize(r,n),this.tilingTexture.baseTexture.width=r,this.tilingTexture.baseTexture.height=n,this.tilingTexture.needsUpdate=!0):(a=new e.CanvasBuffer(r,n),this.tilingTexture=e.Texture.fromCanvas(a.canvas),this.tilingTexture.canvasBuffer=a,this.tilingTexture.isTiling=!0),a.context.drawImage(i.baseTexture.source,i.crop.x,i.crop.y,i.crop.width,i.crop.height,0,0,r,n),this.tileScaleOffset.x=t.width/r,this.tileScaleOffset.y=t.height/n}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=i;this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}};var t={};t.BoneData=function(e,t){this.name=e,this.parent=t},t.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},t.SlotData=function(e,t){this.name=e,this.boneData=t},t.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},t.Bone=function(e,t){this.data=e,this.parent=t,this.setToSetupPose()},t.Bone.yDown=!1,t.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(a,s){var e=this.parent;null!=e?(this.worldX=this.x*e.m00+this.y*e.m01+e.worldX,this.worldY=this.x*e.m10+this.y*e.m11+e.worldY,this.worldScaleX=e.worldScaleX*this.scaleX,this.worldScaleY=e.worldScaleY*this.scaleY,this.worldRotation=e.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var i=this.worldRotation*Math.PI/180,r=Math.cos(i),n=Math.sin(i);this.m00=r*this.worldScaleX,this.m10=n*this.worldScaleX,this.m01=-n*this.worldScaleY,this.m11=r*this.worldScaleY,a&&(this.m00=-this.m00,this.m01=-this.m01),s&&(this.m10=-this.m10,this.m11=-this.m11),t.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var e=this.data;this.x=e.x,this.y=e.y,this.rotation=e.rotation,this.scaleX=e.scaleX,this.scaleY=e.scaleY}},t.Slot=function(e,t,i){this.data=e,this.skeleton=t,this.bone=i,this.setToSetupPose()},t.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(e){this.attachment=e,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(e){this._attachmentTime=this.skeleton.time-e},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var e=this.data;this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a;for(var i=this.skeleton.data.slots,t=0,r=i.length;r>t;t++)if(i[t]==e){this.setAttachment(e.attachmentName?this.skeleton.getAttachmentBySlotIndex(t,e.attachmentName):null);break}}},t.Skin=function(e){this.name=e,this.attachments={}},t.Skin.prototype={addAttachment:function(e,t,i){this.attachments[e+":"+t]=i},getAttachment:function(e,t){return this.attachments[e+":"+t]},_attachAll:function(s,o){for(var e in o.attachments){var i=e.indexOf(":"),r=parseInt(e.substring(0,i),10),n=e.substring(i+1),t=s.slots[r];if(t.attachment&&t.attachment.name==n){var a=this.getAttachment(r,n);a&&t.setAttachment(a)}}}},t.Animation=function(e,t,i){this.name=e,this.timelines=t,this.duration=i},t.Animation.prototype={apply:function(r,t,n){n&&this.duration&&(t%=this.duration);for(var i=this.timelines,e=0,a=i.length;a>e;e++)i[e].apply(r,t,1)},mix:function(r,t,n,a){n&&this.duration&&(t%=this.duration);for(var i=this.timelines,e=0,s=i.length;s>e;e++)i[e].apply(r,t,a)}},t.binarySearch=function(n,a,t){var i=0,e=Math.floor(n.length/t)-2;if(!e)return t;for(var r=e>>>1;;){if(n[(r+1)*t]<=a?i=r+1:e=r,i==e)return(i+1)*t;r=i+e>>>1}},t.linearSearch=function(t,r,i){for(var e=0,n=t.length-i;n>=e;e+=i)if(t[e]>r)return e;return-1},t.Curves=function(e){this.curves=[],this.curves.length=6*(e-1)},t.Curves.prototype={setLinear:function(e){this.curves[6*e]=0},setStepped:function(e){this.curves[6*e]=-1},setCurve:function(g,o,n,u,f){var i=.1,a=i*i,s=a*i,_=3*i,m=3*a,h=6*a,r=6*s,d=2*-o+u,p=2*-n+f,l=3*(o-u)+1,c=3*(n-f)+1,t=6*g,e=this.curves;e[t]=o*_+d*m+l*s,e[t+1]=n*_+p*m+c*s,e[t+2]=d*h+l*r,e[t+3]=p*h+c*r,e[t+4]=l*r,e[t+5]=c*r},getCurvePercent:function(f,e){e=0>e?0:e>1?1:e;var t=6*f,i=this.curves,r=i[t];if(!r)return e;if(-1==r)return 0;for(var s=i[t+1],h=i[t+2],o=i[t+3],p=i[t+4],d=i[t+5],n=r,a=s,c=8;;){if(n>=e){var l=n-r,u=a-s;return u+(a-u)*(e-l)/(n-l)}if(!c)break;c--,r+=h,s+=o,h+=p,o+=d,n+=r,a+=s}return a+(1-a)*(e-n)/(1-n)}},t.RotateTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=2*e},t.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(e,t,i){e*=2,this.frames[e]=t,this.frames[e+1]=i},apply:function(h,a,o){var e,i=this.frames;if(!(a<i[0])){var r=h.bones[this.boneIndex];if(a>=i[i.length-2]){for(e=r.data.rotation+i[i.length-1]-r.rotation;e>180;)e-=360;for(;-180>e;)e+=360;return void(r.rotation+=e*o)}var n=t.binarySearch(i,a,2),l=i[n-1],c=i[n],s=1-(a-c)/(i[n-2]-c);for(s=this.curves.getCurvePercent(n/2-1,s),e=i[n+1]-l;e>180;)e-=360;for(;-180>e;)e+=360;for(e=r.data.rotation+(l+e*s)-r.rotation;e>180;)e-=360;for(;-180>e;)e+=360;r.rotation+=e*o}}},t.TranslateTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=3*e},t.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,t,i,r){e*=3,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=r},apply:function(h,n,a){var e=this.frames;if(!(n<e[0])){var i=h.bones[this.boneIndex];if(n>=e[e.length-3])return i.x+=(i.data.x+e[e.length-2]-i.x)*a,void(i.y+=(i.data.y+e[e.length-1]-i.y)*a);var r=t.binarySearch(e,n,3),o=e[r-2],l=e[r-1],c=e[r],s=1-(n-c)/(e[r+-3]-c);s=this.curves.getCurvePercent(r/3-1,s),i.x+=(i.data.x+o+(e[r+1]-o)*s-i.x)*a,i.y+=(i.data.y+l+(e[r+2]-l)*s-i.y)*a}}},t.ScaleTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=3*e},t.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,t,i,r){e*=3,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=r},apply:function(h,n,a){var e=this.frames;if(!(n<e[0])){var i=h.bones[this.boneIndex];if(n>=e[e.length-3])return i.scaleX+=(i.data.scaleX-1+e[e.length-2]-i.scaleX)*a,void(i.scaleY+=(i.data.scaleY-1+e[e.length-1]-i.scaleY)*a);var r=t.binarySearch(e,n,3),o=e[r-2],l=e[r-1],c=e[r],s=1-(n-c)/(e[r+-3]-c);s=this.curves.getCurvePercent(r/3-1,s),i.scaleX+=(i.data.scaleX-1+o+(e[r+1]-o)*s-i.scaleX)*a,i.scaleY+=(i.data.scaleY-1+l+(e[r+2]-l)*s-i.scaleY)*a}}},t.ColorTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=5*e},t.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(e,t,i,r,n,a){e*=5,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=r,this.frames[e+3]=n,this.frames[e+4]=a},apply:function(g,o,a){var e=this.frames;if(!(o<e[0])){var i=g.slots[this.slotIndex];if(o>=e[e.length-5]){var s=e.length-1;return i.r=e[s-3],i.g=e[s-2],i.b=e[s-1],void(i.a=e[s])}var r=t.binarySearch(e,o,5),p=e[r-4],l=e[r-3],h=e[r-2],u=e[r-1],d=e[r],n=1-(o-d)/(e[r-5]-d);n=this.curves.getCurvePercent(r/5-1,n);var f=p+(e[r+1]-p)*n,_=l+(e[r+2]-l)*n,m=h+(e[r+3]-h)*n,c=u+(e[r+4]-u)*n;1>a?(i.r+=(f-i.r)*a,i.g+=(_-i.g)*a,i.b+=(m-i.b)*a,i.a+=(c-i.a)*a):(i.r=f,i.g=_,i.b=m,i.a=c)}}},t.AttachmentTimeline=function(e){this.curves=new t.Curves(e),this.frames=[],this.frames.length=e,this.attachmentNames=[],this.attachmentNames.length=e},t.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(e,t,i){this.frames[e]=t,this.attachmentNames[e]=i},apply:function(r,i){var e=this.frames;if(!(i<e[0])){var n;n=i>=e[e.length-1]?e.length-1:t.binarySearch(e,i,1)-1;var a=this.attachmentNames[n];r.slots[this.slotIndex].setAttachment(a?r.getAttachmentBySlotIndex(this.slotIndex,a):null)}}},t.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},t.SkeletonData.prototype={defaultSkin:null,findBone:function(i){for(var t=this.bones,e=0,r=t.length;r>e;e++)if(t[e].name==i)return t[e];return null},findBoneIndex:function(i){for(var t=this.bones,e=0,r=t.length;r>e;e++)if(t[e].name==i)return e;return-1},findSlot:function(i){for(var t=this.slots,e=0,r=t.length;r>e;e++)if(t[e].name==i)return slot[e];return null},findSlotIndex:function(i){for(var t=this.slots,e=0,r=t.length;r>e;e++)if(t[e].name==i)return e;return-1},findSkin:function(i){for(var t=this.skins,e=0,r=t.length;r>e;e++)if(t[e].name==i)return t[e];return null},findAnimation:function(i){for(var t=this.animations,e=0,r=t.length;r>e;e++)if(t[e].name==i)return t[e];return null}},t.Skeleton=function(e){this.data=e,this.bones=[];for(var i=0,r=e.bones.length;r>i;i++){var n=e.bones[i],o=n.parent?this.bones[e.bones.indexOf(n.parent)]:null;this.bones.push(new t.Bone(n,o))}for(this.slots=[],this.drawOrder=[],i=0,r=e.slots.length;r>i;i++){var a=e.slots[i],l=this.bones[e.bones.indexOf(a.boneData)],s=new t.Slot(a,this,l);this.slots.push(s),this.drawOrder.push(s)}},t.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var i=this.flipX,r=this.flipY,t=this.bones,e=0,n=t.length;n>e;e++)t[e].updateWorldTransform(i,r)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,i=t.length;i>e;e++)t[e].setToSetupPose()},setSlotsToSetupPose:function(){for(var t=this.slots,e=0,i=t.length;i>e;e++)t[e].setToSetupPose(e)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(i){for(var t=this.bones,e=0,r=t.length;r>e;e++)if(t[e].data.name==i)return t[e];return null},findBoneIndex:function(i){for(var t=this.bones,e=0,r=t.length;r>e;e++)if(t[e].data.name==i)return e;return-1},findSlot:function(i){for(var t=this.slots,e=0,r=t.length;r>e;e++)if(t[e].data.name==i)return t[e];return null},findSlotIndex:function(i){for(var t=this.slots,e=0,r=t.length;r>e;e++)if(t[e].data.name==i)return e;return-1},setSkinByName:function(e){var t=this.data.findSkin(e);if(!t)throw"Skin not found: "+e;this.setSkin(t)},setSkin:function(e){this.skin&&e&&e._attachAll(this,this.skin),this.skin=e},getAttachmentBySlotName:function(e,t){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(e),t)},getAttachmentBySlotIndex:function(e,t){if(this.skin){var i=this.skin.getAttachment(e,t);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(e,t):null},setAttachment:function(t,i){for(var n=this.slots,e=0,s=n.size;s>e;e++){var a=n[e];if(a.data.name==t){var r=null;if(i&&(r=this.getAttachment(e,i),null==r))throw"Attachment not found: "+i+", for slot: "+t;return void a.setAttachment(r)}}throw"Slot not found: "+t},update:function(e){time+=e}},t.AttachmentType={region:0},t.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},t.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,i,r,n,a){var e=this.uvs;a?(e[2]=t,e[3]=n,e[4]=t,e[5]=i,e[6]=r,e[7]=i,e[0]=r,e[1]=n):(e[0]=t,e[1]=n,e[2]=t,e[3]=i,e[4]=r,e[5]=i,e[6]=r,e[7]=n)},updateOffset:function(){var o=this.width/this.regionOriginalWidth*this.scaleX,c=this.height/this.regionOriginalHeight*this.scaleY,r=-this.width/2*this.scaleX+this.regionOffsetX*o,n=-this.height/2*this.scaleY+this.regionOffsetY*c,l=r+this.regionWidth*o,a=n+this.regionHeight*c,s=this.rotation*Math.PI/180,t=Math.cos(s),i=Math.sin(s),g=r*t+this.x,h=r*i,u=n*t+this.y,d=n*i,p=l*t+this.x,f=l*i,_=a*t+this.y,m=a*i,e=this.offset;e[0]=g-d,e[1]=u+h,e[2]=g-m,e[3]=_+h,e[4]=p-m,e[5]=_+f,e[6]=p-d,e[7]=u+f},computeVertices:function(r,n,i,t){r+=i.worldX,n+=i.worldY;var a=i.m00,s=i.m01,o=i.m10,l=i.m11,e=this.offset;t[0]=e[0]*a+e[1]*s+r,t[1]=e[0]*o+e[1]*l+n,t[2]=e[2]*a+e[3]*s+r,t[3]=e[2]*o+e[3]*l+n,t[4]=e[4]*a+e[5]*s+r,t[5]=e[4]*o+e[5]*l+n,t[6]=e[6]*a+e[7]*s+r,t[7]=e[6]*o+e[7]*l+n}},t.AnimationStateData=function(e){this.skeletonData=e,this.animationToMixTime={}},t.AnimationStateData.prototype={defaultMix:0,setMixByName:function(e,t,n){var i=this.skeletonData.findAnimation(e);if(!i)throw"Animation not found: "+e;var r=this.skeletonData.findAnimation(t);if(!r)throw"Animation not found: "+t;this.setMix(i,r,n)},setMix:function(e,t,i){this.animationToMixTime[e.name+":"+t.name]=i},getMix:function(t,i){var e=this.animationToMixTime[t.name+":"+i.name];return e?e:this.defaultMix}},t.AnimationState=function(e){this.data=e,this.queue=[]},t.AnimationState.prototype={animationSpeed:1,current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(e){if(this.currentTime+=e*this.animationSpeed,this.previousTime+=e,this.mixTime+=e,this.queue.length>0){var t=this.queue[0];this.currentTime>=t.delay&&(this._setAnimation(t.animation,t.loop),this.queue.shift())}},apply:function(e){if(this.current)if(this.previous){this.previous.apply(e,this.previousTime,this.previousLoop);var t=this.mixTime/this.mixDuration;t>=1&&(t=1,this.previous=null),this.current.mix(e,this.currentTime,this.currentLoop,t)}else this.current.apply(e,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(e,t){this.previous=null,e&&this.current&&(this.mixDuration=this.data.getMix(this.current,e),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=e,this.currentLoop=t,this.currentTime=0},setAnimationByName:function(e,i){var t=this.data.skeletonData.findAnimation(e);if(!t)throw"Animation not found: "+e;this.setAnimation(t,i)},setAnimation:function(e,t){this.queue.length=0,this._setAnimation(e,t)},addAnimationByName:function(e,i,r){var t=this.data.skeletonData.findAnimation(e);if(!t)throw"Animation not found: "+e;this.addAnimation(t,i,r)},addAnimation:function(r,n,e){var t={};if(t.animation=r,t.loop=n,!e||0>=e){var i=this.queue.length?this.queue[this.queue.length-1].animation:this.current;e=null!=i?i.duration-this.data.getMix(i,r)+(e||0):0}t.delay=e,this.queue.push(t)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},t.SkeletonJson=function(e){this.attachmentLoader=e},t.SkeletonJson.prototype={scale:1,readSkeletonData:function(c){for(var e,r=new t.SkeletonData,x=c.bones,n=0,m=x.length;m>n;n++){var i=x[n],g=null;if(i.parent&&(g=r.findBone(i.parent),!g))throw"Parent bone not found: "+i.parent;e=new t.BoneData(i.name,g),e.length=(i.length||0)*this.scale,e.x=(i.x||0)*this.scale,e.y=(i.y||0)*this.scale,e.rotation=i.rotation||0,e.scaleX=i.scaleX||1,e.scaleY=i.scaleY||1,r.bones.push(e)}var w=c.slots;for(n=0,m=w.length;m>n;n++){var l=w[n];if(e=r.findBone(l.bone),!e)throw"Slot bone not found: "+l.bone;var a=new t.SlotData(l.name,e),s=l.color;s&&(a.r=t.SkeletonJson.toColor(s,0),a.g=t.SkeletonJson.toColor(s,1),a.b=t.SkeletonJson.toColor(s,2),a.a=t.SkeletonJson.toColor(s,3)),a.attachmentName=l.attachment,r.slots.push(a)}var p=c.skins;for(var f in p)if(p.hasOwnProperty(f)){var _=p[f],o=new t.Skin(f);for(var u in _)if(_.hasOwnProperty(u)){var T=r.findSlotIndex(u),v=_[u];for(var h in v)if(v.hasOwnProperty(h)){var b=this.readAttachment(o,h,v[h]);null!=b&&o.addAttachment(T,h,b)}}r.skins.push(o),"default"==o.name&&(r.defaultSkin=o)}var y=c.animations;for(var d in y)y.hasOwnProperty(d)&&this.readAnimation(d,y[d],r);return r},readAttachment:function(a,r,i){r=i.name||r;var n=t.AttachmentType[i.type||"region"];if(n==t.AttachmentType.region){var e=new t.RegionAttachment;return e.x=(i.x||0)*this.scale,e.y=(i.y||0)*this.scale,e.scaleX=i.scaleX||1,e.scaleY=i.scaleY||1,e.rotation=i.rotation||0,e.width=(i.width||32)*this.scale,e.height=(i.height||32)*this.scale,e.updateOffset(),e.rendererObject={},e.rendererObject.name=r,e.rendererObject.scale={},e.rendererObject.scale.x=e.scaleX,e.rendererObject.scale.y=e.scaleY,e.rendererObject.rotation=-e.rotation*Math.PI/180,e}throw"Unknown attachment type: "+n},readAnimation:function(T,x,g){var a,e,s,i,n,r,l,c=[],o=0,p=x.bones;for(var h in p)if(p.hasOwnProperty(h)){var v=g.findBoneIndex(h);if(-1==v)throw"Bone not found: "+h;var f=p[h];for(s in f)if(f.hasOwnProperty(s))if(n=f[s],"rotate"==s){for(e=new t.RotateTimeline(n.length),e.boneIndex=v,a=0,r=0,l=n.length;l>r;r++)i=n[r],e.setFrame(a,i.time,i.angle),t.SkeletonJson.readCurve(e,a,i),a++;c.push(e),o=Math.max(o,e.frames[2*e.getFrameCount()-2])}else{if("translate"!=s&&"scale"!=s)throw"Invalid timeline type for a bone: "+s+" ("+h+")";var _=1;for("scale"==s?e=new t.ScaleTimeline(n.length):(e=new t.TranslateTimeline(n.length),_=this.scale),e.boneIndex=v,a=0,r=0,l=n.length;l>r;r++){i=n[r];var E=(i.x||0)*_,w=(i.y||0)*_;e.setFrame(a,i.time,E,w),t.SkeletonJson.readCurve(e,a,i),a++}c.push(e),o=Math.max(o,e.frames[3*e.getFrameCount()-3])}}var m=x.slots;for(var u in m)if(m.hasOwnProperty(u)){var y=m[u],b=g.findSlotIndex(u);for(s in y)if(y.hasOwnProperty(s))if(n=y[s],"color"==s){for(e=new t.ColorTimeline(n.length),e.slotIndex=b,a=0,r=0,l=n.length;l>r;r++){i=n[r];var d=i.color,C=t.SkeletonJson.toColor(d,0),S=t.SkeletonJson.toColor(d,1),A=t.SkeletonJson.toColor(d,2),M=t.SkeletonJson.toColor(d,3);e.setFrame(a,i.time,C,S,A,M),t.SkeletonJson.readCurve(e,a,i),a++}c.push(e),o=Math.max(o,e.frames[5*e.getFrameCount()-5])}else{if("attachment"!=s)throw"Invalid timeline type for a slot: "+s+" ("+u+")";for(e=new t.AttachmentTimeline(n.length),e.slotIndex=b,a=0,r=0,l=n.length;l>r;r++)i=n[r],e.setFrame(a++,i.time,i.name);c.push(e),o=Math.max(o,e.frames[e.getFrameCount()-1])}}g.animations.push(new t.Animation(T,c,o))}},t.SkeletonJson.readCurve=function(t,i,r){var e=r.curve;e&&("stepped"==e?t.curves.setStepped(i):e instanceof Array&&t.curves.setCurve(i,e[0],e[1],e[2],e[3]))},t.SkeletonJson.toColor=function(e,t){if(8!=e.length)throw"Color hexidecimal length must be 8, recieved: "+e;return parseInt(e.substr(2*t,2),16)/255},t.Atlas=function(d,u){this.textureLoader=u,this.pages=[],this.regions=[];var n=new t.AtlasReader(d),e=[];e.length=4;for(var r=null;;){var a=n.readLine();if(null==a)break;if(a=n.trim(a),a.length)if(r){var i=new t.AtlasRegion;i.name=a,i.page=r,i.rotate="true"==n.readValue(),n.readTuple(e);var s=parseInt(e[0],10),o=parseInt(e[1],10);n.readTuple(e);var h=parseInt(e[0],10),c=parseInt(e[1],10);i.u=s/r.width,i.v=o/r.height,i.rotate?(i.u2=(s+c)/r.width,i.v2=(o+h)/r.height):(i.u2=(s+h)/r.width,i.v2=(o+c)/r.height),i.x=s,i.y=o,i.width=Math.abs(h),i.height=Math.abs(c),4==n.readTuple(e)&&(i.splits=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)],4==n.readTuple(e)&&(i.pads=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)],n.readTuple(e))),i.originalWidth=parseInt(e[0],10),i.originalHeight=parseInt(e[1],10),n.readTuple(e),i.offsetX=parseInt(e[0],10),i.offsetY=parseInt(e[1],10),i.index=parseInt(n.readValue(),10),this.regions.push(i)}else{r=new t.AtlasPage,r.name=a,r.format=t.Atlas.Format[n.readValue()],n.readTuple(e),r.minFilter=t.Atlas.TextureFilter[e[0]],r.magFilter=t.Atlas.TextureFilter[e[1]];var l=n.readValue();r.uWrap=t.Atlas.TextureWrap.clampToEdge,r.vWrap=t.Atlas.TextureWrap.clampToEdge,"x"==l?r.uWrap=t.Atlas.TextureWrap.repeat:"y"==l?r.vWrap=t.Atlas.TextureWrap.repeat:"xy"==l&&(r.uWrap=r.vWrap=t.Atlas.TextureWrap.repeat),u.load(r,a),this.pages.push(r)}else r=null}},t.Atlas.prototype={findRegion:function(i){for(var t=this.regions,e=0,r=t.length;r>e;e++)if(t[e].name==i)return t[e];return null},dispose:function(){for(var t=this.pages,e=0,i=t.length;i>e;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var r=this.regions,i=0,n=r.length;n>i;i++){var e=r[i];e.page==t&&(e.u=e.x/t.width,e.v=e.y/t.height,e.rotate?(e.u2=(e.x+e.height)/t.width,e.v2=(e.y+e.width)/t.height):(e.u2=(e.x+e.width)/t.width,e.v2=(e.y+e.height)/t.height))}}},t.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},t.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},t.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},t.AtlasPage=function(){},t.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},t.AtlasRegion=function(){},t.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},t.AtlasReader=function(e){this.lines=e.split(/\r\n|\r|\n/)},t.AtlasReader.prototype={index:0,trim:function(e){return e.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var e=this.readLine(),t=e.indexOf(":");if(-1==t)throw"Invalid line: "+e;return this.trim(e.substring(t+1))},readTuple:function(n){var e=this.readLine(),a=e.indexOf(":");if(-1==a)throw"Invalid line: "+e;for(var t=0,i=a+1;3>t;t++){var r=e.indexOf(",",i);if(-1==r){if(!t)throw"Invalid line: "+e;break}n[t]=this.trim(e.substr(i,r-i)),i=r+1}return n[t]=this.trim(e.substring(i)),t+1}},t.AtlasAttachmentLoader=function(e){this.atlas=e},t.AtlasAttachmentLoader.prototype={newAttachment:function(a,r,n){switch(r){case t.AttachmentType.region:var e=this.atlas.findRegion(n);if(!e)throw"Region not found in atlas: "+n+" ("+r+")";var i=new t.RegionAttachment(n);return i.rendererObject=e,i.setUVs(e.u,e.v,e.u2,e.v2,e.rotate),i.regionOffsetX=e.offsetX,i.regionOffsetY=e.offsetY,i.regionWidth=e.width,i.regionHeight=e.height,i.regionOriginalWidth=e.originalWidth,i.regionOriginalHeight=e.originalHeight,i}throw"Unknown attachment type: "+r}},t.Bone.yDown=!0,e.AnimCache={},e.Spine=function(s){if(e.DisplayObjectContainer.call(this),this.spineData=e.AnimCache[s],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+s);this.skeleton=new t.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new t.AnimationStateData(this.spineData),this.state=new t.AnimationState(this.stateData),this.slotContainers=[];for(var r=0,l=this.skeleton.drawOrder.length;l>r;r++){var i=this.skeleton.drawOrder[r],n=i.attachment,a=new e.DisplayObjectContainer;if(this.slotContainers.push(a),this.addChild(a),n instanceof t.RegionAttachment){var c=n.rendererObject.name,o=this.createSprite(i,n.rendererObject);i.currentSprite=o,i.currentSpriteName=c,a.addChild(o)}}},e.Spine.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Spine.prototype.constructor=e.Spine,e.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var c=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.state.update(c),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var l=this.skeleton.drawOrder,s=0,h=l.length;h>s;s++){var i=l[s],r=i.attachment,n=this.slotContainers[s];if(r instanceof t.RegionAttachment){if(r.rendererObject&&(!i.currentSpriteName||i.currentSpriteName!=r.name)){var o=r.rendererObject.name;if(void 0!==i.currentSprite&&(i.currentSprite.visible=!1),i.sprites=i.sprites||{},void 0!==i.sprites[o])i.sprites[o].visible=!0;else{var u=this.createSprite(i,r.rendererObject);n.addChild(u)}i.currentSprite=i.sprites[o],i.currentSpriteName=o}n.visible=!0;var a=i.bone;n.position.x=a.worldX+r.x*a.m00+r.y*a.m01,n.position.y=a.worldY+r.x*a.m10+r.y*a.m11,n.scale.x=a.worldScaleX,n.scale.y=a.worldScaleY,n.rotation=-(i.bone.worldRotation*Math.PI/180),n.alpha=i.a,i.currentSprite.tint=e.rgb2hex([i.r,i.g,i.b])}else n.visible=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.Spine.prototype.createSprite=function(r,t){var n=e.TextureCache[t.name]?t.name:t.name+".png",i=new e.Sprite(e.Texture.fromFrame(n));return i.scale=t.scale,i.rotation=t.rotation,i.anchor.x=i.anchor.y=.5,r.sprites=r.sprites||{},r.sprites[t.name]=i,i},e.BaseTextureCache={},e.texturesToUpdate=[],e.texturesToDestroy=[],e.BaseTextureCacheIdGenerator=0,e.BaseTexture=function(i,r){if(e.EventTarget.call(this),this.resolution=1,this.width=100,this.height=100,this.scaleMode=r||e.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=i,this.id=e.BaseTextureCacheIdGenerator++,this.premultipliedAlpha=!0,this._glTextures=[],this._dirty=[],i){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source[this.source instanceof HTMLImageElement?"naturalWidth":"width"],this.height=this.source[this.source instanceof HTMLImageElement?"naturalHeight":"height"],e.texturesToUpdate.push(this);else{var t=this;this.source.onload=function(){t.hasLoaded=!0,t.width=t.source[t.source instanceof HTMLImageElement?"naturalWidth":"width"],t.height=t.source[t.source instanceof HTMLImageElement?"naturalHeight":"height"];for(var e=0;e<t._glTextures.length;e++)t._dirty[e]=!0;t.dispatchEvent({type:"loaded",content:t})},this.source.onerror=function(){t.dispatchEvent({type:"error",content:t})}}this.imageUrl=null,this._powerOf2=!1}},e.BaseTexture.prototype.constructor=e.BaseTexture,e.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete e.BaseTextureCache[this.imageUrl],delete e.TextureCache[this.imageUrl],this.imageUrl=null,this.source.src=""):this.source&&this.source._pixiId&&delete e.BaseTextureCache[this.source._pixiId],this.source=null,e.texturesToDestroy.push(this)},e.BaseTexture.prototype.updateSourceImage=function(e){this.hasLoaded=!1,this.source.src=null,this.source.src=e},e.BaseTexture.fromImage=function(t,r,a){var i=e.BaseTextureCache[t];if(void 0===r&&-1===t.indexOf("data:")&&(r=!0),!i){var n=new Image;r&&(n.crossOrigin=""),n.src=t,i=new e.BaseTexture(n,a),i.imageUrl=t,e.BaseTextureCache[t]=i,-1!==t.indexOf(e.RETINA_PREFIX+".")&&(i.resolution=2)}return i},e.BaseTexture.fromCanvas=function(t,r){t._pixiId||(t._pixiId="canvas_"+e.TextureCacheIdGenerator++);var i=e.BaseTextureCache[t._pixiId];return i||(i=new e.BaseTexture(t,r),e.BaseTextureCache[t._pixiId]=i),i},e.TextureCache={},e.FrameCache={},e.TextureCacheIdGenerator=0,e.Texture=function(t,i){e.EventTarget.call(this),this.noFrame=!1,i||(this.noFrame=!0,i=new e.Rectangle(0,0,1,1)),t instanceof e.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=i,this.trim=null,this.valid=!1,this._uvs=null,this.width=0,this.height=0,this.crop=new e.Rectangle(0,0,1,1),t.hasLoaded?(this.noFrame&&(i=new e.Rectangle(0,0,t.width,t.height)),this.setFrame(i)):t.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))},e.Texture.prototype.constructor=e.Texture,e.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new e.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame),this.dispatchEvent({type:"update",content:this})},e.Texture.prototype.destroy=function(e){e&&this.baseTexture.destroy(),this.valid=!1},e.Texture.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,!this.trim&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&e.Texture.frameUpdates.push(this)},e.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new e.TextureUvs);var t=this.crop,i=this.baseTexture.width,r=this.baseTexture.height;this._uvs.x0=t.x/i,this._uvs.y0=t.y/r,this._uvs.x1=(t.x+t.width)/i,this._uvs.y1=t.y/r,this._uvs.x2=(t.x+t.width)/i,this._uvs.y2=(t.y+t.height)/r,this._uvs.x3=t.x/i,this._uvs.y3=(t.y+t.height)/r},e.Texture.fromImage=function(i,r,n){var t=e.TextureCache[i];return t||(t=new e.Texture(e.BaseTexture.fromImage(i,r,n)),e.TextureCache[i]=t),t},e.Texture.fromFrame=function(t){var i=e.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return i},e.Texture.fromCanvas=function(t,i){var r=e.BaseTexture.fromCanvas(t,i);return new e.Texture(r)},e.Texture.addTextureToCache=function(t,i){e.TextureCache[i]=t},e.Texture.removeTextureFromCache=function(t){var i=e.TextureCache[t];return delete e.TextureCache[t],delete e.BaseTextureCache[t],i},e.Texture.frameUpdates=[],e.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},e.RenderTexture=function(i,r,n,a,s){if(e.EventTarget.call(this),this.width=i||100,this.height=r||100,this.resolution=s||1,this.frame=new e.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new e.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new e.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=a||e.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,this.renderer=n||e.defaultRenderer,this.renderer.type===e.WEBGL_RENDERER){var t=this.renderer.gl;this.textureBuffer=new e.FilterTexture(t,this.width*this.resolution,this.height*this.resolution,this.baseTexture.scaleMode),this.baseTexture._glTextures[t.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new e.Point(.5*this.width,.5*-this.height)}else this.render=this.renderCanvas,this.textureBuffer=new e.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype=Object.create(e.Texture.prototype),e.RenderTexture.prototype.constructor=e.RenderTexture,e.RenderTexture.prototype.resize=function(t,i,r){(t!==this.width||i!==this.height)&&(this.valid=t>0&&i>0,this.width=this.frame.width=this.crop.width=t,this.height=this.frame.height=this.crop.height=i,r&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===e.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution))},e.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===e.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},e.RenderTexture.prototype.renderWebGL=function(t,r,s){if(this.valid){var i=this.renderer.gl;i.colorMask(!0,!0,!0,!0),i.viewport(0,0,this.width*this.resolution,this.height*this.resolution),i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer),s&&this.textureBuffer.clear();var a=t.children,o=t.worldTransform;t.worldTransform=e.RenderTexture.tempMatrix,t.worldAlpha=1,t.worldTransform.d=-1,t.worldTransform.ty=-2*this.projection.y,r&&(t.worldTransform.tx=r.x,t.worldTransform.ty-=r.y);for(var n=0,l=a.length;l>n;n++)a[n].updateTransform();e.WebGLRenderer.updateTextures(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer),t.worldTransform=o,this.renderer.spriteBatch.dirty=!0}},e.RenderTexture.prototype.renderCanvas=function(t,i,s){if(this.valid){var n=t.children,o=t.worldTransform;t.worldTransform=e.RenderTexture.tempMatrix,i?(t.worldTransform.tx=i.x,t.worldTransform.ty=i.y):(t.worldTransform.tx=0,t.worldTransform.ty=0);for(var r=0,l=n.length;l>r;r++)n[r].updateTransform();s&&this.textureBuffer.clear();var a=this.textureBuffer.context,c=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,a),this.renderer.resolution=c,a.setTransform(1,0,0,1,0,0),t.worldTransform=o}},e.RenderTexture.prototype.getImage=function(){var e=new Image;return e.src=this.getBase64(),e},e.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},e.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===e.WEBGL_RENDERER){var i=this.renderer.gl,n=this.textureBuffer.width,a=this.textureBuffer.height,r=new Uint8Array(4*n*a);i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer),i.readPixels(0,0,n,a,i.RGBA,i.UNSIGNED_BYTE,r),i.bindFramebuffer(i.FRAMEBUFFER,null);for(var l=new e.CanvasBuffer(n,a),c=l.context.getImageData(0,0,n,a),s=c.data,t=0;t<r.length;t+=4){var o=r[t+3];s[t]=r[t]*o,s[t+1]=r[t+1]*o,s[t+2]=r[t+2]*o,s[t+3]=o}return l.context.putImageData(c,0,0),l.canvas}return this.textureBuffer.canvas},e.RenderTexture.tempMatrix=new e.Matrix,e.AssetLoader=function(t,i){e.EventTarget.call(this),this.assetURLs=t,this.crossorigin=i,this.loadersByType={jpg:e.ImageLoader,jpeg:e.ImageLoader,png:e.ImageLoader,gif:e.ImageLoader,webp:e.ImageLoader,json:e.JsonLoader,atlas:e.AtlasLoader,anim:e.SpineLoader,xml:e.BitmapFontLoader,fnt:e.BitmapFontLoader}},e.AssetLoader.prototype.constructor=e.AssetLoader,e.AssetLoader.prototype._getDataType=function(i){var e="data:",a=i.slice(0,e.length).toLowerCase();if(a===e){var r=i.slice(e.length),n=r.indexOf(",");if(-1===n)return null;var t=r.slice(0,n).split(";")[0];return t&&"text/plain"!==t.toLowerCase()?t.split("/").pop().toLowerCase():"txt"}return null},e.AssetLoader.prototype.load=function(){function a(e){s.onAssetLoaded(e.content)}var s=this;this.loadCount=this.assetURLs.length;for(var t=0;t<this.assetURLs.length;t++){var i=this.assetURLs[t],e=this._getDataType(i);e||(e=i.split("?").shift().split(".").pop().toLowerCase());var r=this.loadersByType[e];if(!r)throw new Error(e+" is an unsupported file type");var n=new r(i,this.crossorigin);n.addEventListener("loaded",a),n.load()}},e.AssetLoader.prototype.onAssetLoaded=function(e){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this,loader:e}),this.onProgress&&this.onProgress(e),this.loadCount||(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},e.JsonLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.loaded=!1},e.JsonLoader.prototype.constructor=e.JsonLoader,e.JsonLoader.prototype.load=function(){window.XDomainRequest&&this.crossorigin?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=this.onError.bind(this),this.ajaxRequest.ontimeout=this.onError.bind(this),this.ajaxRequest.onprogress=function(){}):this.ajaxRequest=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onload=this.onJSONLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},e.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var l=this.baseUrl+this.json.meta.image,a=new e.ImageLoader(l,this.crossorigin),n=this.json.frames;this.texture=a.texture.baseTexture,a.addEventListener("loaded",this.onLoaded.bind(this));for(var r in n){var i=n[r].frame;if(i&&(e.TextureCache[r]=new e.Texture(this.texture,{x:i.x,y:i.y,width:i.w,height:i.h}),e.TextureCache[r].crop=new e.Rectangle(i.x,i.y,i.w,i.h),n[r].trimmed)){var s=n[r].sourceSize,o=n[r].spriteSourceSize;e.TextureCache[r].trim=new e.Rectangle(o.x,o.y,s.w,s.h)}}a.load()}else if(this.json.bones){var c=new t.SkeletonJson,h=c.readSkeletonData(this.json);e.AnimCache[this.url]=h,this.onLoaded()}else this.onLoaded()},e.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.AtlasLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.crossorigin=i,this.loaded=!1},e.AtlasLoader.constructor=e.AtlasLoader,e.AtlasLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var n=this.ajaxRequest.responseText.split(/\r?\n/),a=-3,c=0,i=null,u=!1,t=0,r=0,d=this.onLoaded.bind(this);for(t=0;t<n.length;t++)if(n[t]=n[t].replace(/^\s+|\s+$/g,""),""===n[t]&&(u=t+1),n[t].length>0){if(u===t)this.atlas.meta.image.push(n[t]),c=this.atlas.meta.image.length-1,this.atlas.frames.push({}),a=-3;else if(a>0)if(a%7===1)null!=i&&(this.atlas.frames[c][i.name]=i),i={name:n[t],frame:{}};else{var s=n[t].split(" ");if(a%7===3)i.frame.x=Number(s[1].replace(",","")),i.frame.y=Number(s[2]);else if(a%7===4)i.frame.w=Number(s[1].replace(",","")),i.frame.h=Number(s[2]);else if(a%7===5){var h={x:0,y:0,w:Number(s[1].replace(",","")),h:Number(s[2])};h.w>i.frame.w||h.h>i.frame.h?(i.trimmed=!0,i.realSize=h):i.trimmed=!1}}a++}if(null!=i&&(this.atlas.frames[c][i.name]=i),this.atlas.meta.image.length>0){for(this.images=[],r=0;r<this.atlas.meta.image.length;r++){var p=this.baseUrl+this.atlas.meta.image[r],l=this.atlas.frames[r];this.images.push(new e.ImageLoader(p,this.crossorigin));for(t in l){var o=l[t].frame;o&&(e.TextureCache[t]=new e.Texture(this.images[r].texture.baseTexture,{x:o.x,y:o.y,width:o.w,height:o.h}),l[t].trimmed&&(e.TextureCache[t].realSize=l[t].realSize,e.TextureCache[t].trim.x=0,e.TextureCache[t].trim.y=0))}}for(this.currentImageId=0,r=0;r<this.images.length;r++)this.images[r].addEventListener("loaded",d);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},e.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))},e.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.SpriteSheetLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},e.SpriteSheetLoader.prototype.constructor=e.SpriteSheetLoader,e.SpriteSheetLoader.prototype.load=function(){var t=this,i=new e.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(e){t.json=e.content.json,t.onLoaded()}),i.load()},e.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader=function(t,i){e.EventTarget.call(this),this.texture=e.Texture.fromImage(t,i),this.frames=[]},e.ImageLoader.prototype.constructor=e.ImageLoader,e.ImageLoader.prototype.load=function(){this.texture.baseTexture.hasLoaded?this.onLoaded():this.texture.baseTexture.addEventListener("loaded",this.onLoaded.bind(this))},e.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader.prototype.loadFramedSpriteSheet=function(t,i,a){this.frames=[];for(var l=Math.floor(this.texture.width/t),c=Math.floor(this.texture.height/i),s=0,r=0;c>r;r++)for(var n=0;l>n;n++,s++){var o=new e.Texture(this.texture.baseTexture,{x:n*t,y:r*i,width:t,height:i});this.frames.push(o),a&&(e.TextureCache[a+"-"+s]=o)}this.load()},e.BitmapFontLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null},e.BitmapFontLoader.prototype.constructor=e.BitmapFontLoader,e.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onXMLLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},e.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var r=this.ajaxRequest.responseXML;if(!r||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){var h=new DOMParser;r=h.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var c=document.createElement("div");c.innerHTML=this.ajaxRequest.responseText,r=c}var u=this.baseUrl+r.getElementsByTagName("page")[0].getAttribute("file"),s=new e.ImageLoader(u,this.crossorigin);this.texture=s.texture.baseTexture;var n={},o=r.getElementsByTagName("info")[0],p=r.getElementsByTagName("common")[0];n.font=o.getAttribute("face"),n.size=parseInt(o.getAttribute("size"),10),n.lineHeight=parseInt(p.getAttribute("lineHeight"),10),n.chars={};for(var i=r.getElementsByTagName("char"),t=0;t<i.length;t++){var l=parseInt(i[t].getAttribute("id"),10),d=new e.Rectangle(parseInt(i[t].getAttribute("x"),10),parseInt(i[t].getAttribute("y"),10),parseInt(i[t].getAttribute("width"),10),parseInt(i[t].getAttribute("height"),10));n.chars[l]={xOffset:parseInt(i[t].getAttribute("xoffset"),10),yOffset:parseInt(i[t].getAttribute("yoffset"),10),xAdvance:parseInt(i[t].getAttribute("xadvance"),10),kerning:{},texture:e.TextureCache[l]=new e.Texture(this.texture,d)}}var a=r.getElementsByTagName("kerning");for(t=0;t<a.length;t++){var f=parseInt(a[t].getAttribute("first"),10),_=parseInt(a[t].getAttribute("second"),10),m=parseInt(a[t].getAttribute("amount"),10);n.chars[_].kerning[f]=m}e.BitmapText.fonts[n.font]=n,s.addEventListener("loaded",this.onLoaded.bind(this)),s.load()}},e.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.SpineLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.loaded=!1},e.SpineLoader.prototype.constructor=e.SpineLoader,e.SpineLoader.prototype.load=function(){var t=this,i=new e.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(e){t.json=e.content.json,t.onLoaded()}),i.load()},e.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.AbstractFilter=function(e,t){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=t||{},this.fragmentSrc=e||[]},e.AlphaMaskFilter=function(t){e.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:t},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mask.value.x=t.width,this.uniforms.mask.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},e.AlphaMaskFilter.prototype=Object.create(e.AbstractFilter.prototype),e.AlphaMaskFilter.prototype.constructor=e.AlphaMaskFilter,e.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(e){this.uniforms.mask.value=e}}),e.ColorMatrixFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},e.ColorMatrixFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorMatrixFilter.prototype.constructor=e.ColorMatrixFilter,Object.defineProperty(e.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(e){this.uniforms.matrix.value=e}}),e.GrayFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},e.GrayFilter.prototype=Object.create(e.AbstractFilter.prototype),e.GrayFilter.prototype.constructor=e.GrayFilter,Object.defineProperty(e.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(e){this.uniforms.gray.value=e}}),e.DisplacementFilter=function(t){e.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=t.width,this.uniforms.mapDimensions.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},e.DisplacementFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DisplacementFilter.prototype.constructor=e.DisplacementFilter,e.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(e){this.uniforms.displacementMap.value=e}}),Object.defineProperty(e.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(e){this.uniforms.scale.value=e}}),Object.defineProperty(e.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(e){this.uniforms.offset.value=e}}),e.PixelateFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]},e.PixelateFilter.prototype=Object.create(e.AbstractFilter.prototype),e.PixelateFilter.prototype.constructor=e.PixelateFilter,Object.defineProperty(e.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(e){this.dirty=!0,this.uniforms.pixelSize.value=e}}),e.BlurXFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurXFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurXFilter.prototype.constructor=e.BlurXFilter,Object.defineProperty(e.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.dirty=!0,this.uniforms.blur.value=1/7e3*e}}),e.BlurYFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurYFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurYFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}}),e.BlurFilter=function(){this.blurXFilter=new e.BlurXFilter,this.blurYFilter=new e.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},Object.defineProperty(e.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e}}),Object.defineProperty(e.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e}}),Object.defineProperty(e.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e}}),e.InvertFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},e.InvertFilter.prototype=Object.create(e.AbstractFilter.prototype),e.InvertFilter.prototype.constructor=e.InvertFilter,Object.defineProperty(e.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(e){this.uniforms.invert.value=e}}),e.SepiaFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},e.SepiaFilter.prototype=Object.create(e.AbstractFilter.prototype),e.SepiaFilter.prototype.constructor=e.SepiaFilter,Object.defineProperty(e.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(e){this.uniforms.sepia.value=e}}),e.TwistFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},e.TwistFilter.prototype=Object.create(e.AbstractFilter.prototype),e.TwistFilter.prototype.constructor=e.TwistFilter,Object.defineProperty(e.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(e){this.dirty=!0,this.uniforms.offset.value=e}}),Object.defineProperty(e.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(e){this.dirty=!0,this.uniforms.radius.value=e}}),Object.defineProperty(e.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(e){this.dirty=!0,this.uniforms.angle.value=e}}),e.ColorStepFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},e.ColorStepFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorStepFilter.prototype.constructor=e.ColorStepFilter,Object.defineProperty(e.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(e){this.uniforms.step.value=e}}),e.DotScreenFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},e.DotScreenFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DotScreenFilter.prototype.constructor=e.DotScreenFilter,Object.defineProperty(e.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(e){this.dirty=!0,this.uniforms.scale.value=e}}),Object.defineProperty(e.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(e){this.dirty=!0,this.uniforms.angle.value=e}}),e.CrossHatchFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]},e.CrossHatchFilter.prototype=Object.create(e.AbstractFilter.prototype),e.CrossHatchFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}}),e.RGBSplitFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},e.RGBSplitFilter.prototype=Object.create(e.AbstractFilter.prototype),e.RGBSplitFilter.prototype.constructor=e.RGBSplitFilter,Object.defineProperty(e.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.PIXI=e):"undefined"!=typeof define&&define.amd?define(e):i.PIXI=e}.call(this),!function(z,S){function e(t,i){this.proParticleCount=e.Util.initValue(t,e.POOL_MAX),this.integrationType=e.Util.initValue(i,e.EULER),this.emitters=[],this.renderers=[],this.time=0,this.oldTime=0,e.pool=new e.ParticlePool(this.proParticleCount),e.integrator=new e.NumericalIntegration(this.integrationType)}function U(){this.initialize()}function st(e){this.type=e.type,this.particle=e.particle,this.emitter=e.emitter}function L(){this.mats=[],this.size=0;for(var t=0;20>t;t++)this.mats.push(e.Mat3.create([0,0,0,0,0,0,0,0,0]))}function j(t){this.id="particle_"+j.ID++,this.reset(!0),e.Util.setPrototypeByObject(this,t)}function Y(i,r){this.proParticleCount=e.Util.initValue(i,0),this.releaseTime=e.Util.initValue(r,-1),this.poolList=[],this.timeoutID=0;for(var t=0;t<this.proParticleCount;t++)this.add();this.releaseTime>0&&(this.timeoutID=setTimeout(this.release,this.releaseTime/1e3))}function X(t,i,r){this.isArray=!1,e.Util.isArray(t)?(this.isArray=!0,this.a=t):(this.a=e.Util.initValue(t,1),this.b=e.Util.initValue(i,this.a),this.center=e.Util.initValue(r,!1))}function N(t){this.colorArr=e.Util.isArray(t)?t:[t]}function V(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r,this.bottom=this.y+this.height,this.right=this.x+this.width}function F(t,i){this.id="Behavior_"+F.id++,this.life=e.Util.initValue(t,1/0),this.easing=e.ease.setEasingByName(i),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.name="Behavior"}function W(t,i){this.numPan=e.Util.initValue(t,1),this.timePan=e.Util.initValue(i,1),this.numPan=e.Util.setSpanValue(this.numPan),this.timePan=e.Util.setSpanValue(this.timePan),this.startTime=0,this.nextTime=0,this.init()}function O(){}function D(t,i,r){D._super_.call(this),this.lifePan=e.Util.setSpanValue(t,i,r)}function C(t){C._super_.call(this),this.zone=e.Util.initValue(t,new e.PointZone)}function b(t,i,r){b._super_.call(this),this.rPan=e.Util.setSpanValue(t),this.thaPan=e.Util.setSpanValue(i),this.type=e.Util.initValue(r,"vector")}function B(t,i,r){B._super_.call(this),this.massPan=e.Util.setSpanValue(t,i,r)}function M(t,i,r){M._super_.call(this),this.radius=e.Util.setSpanValue(t,i,r)}function A(t,i,r){A._super_.call(this),this.image=this.setSpanValue(t),this.w=e.Util.initValue(i,20),this.h=e.Util.initValue(r,this.w)}function f(t,i,r,n){f._super_.call(this,r,n),this.force=this.normalizeForce(new e.Vector2D(t,i)),this.name="Force"}function g(t,i,r,n,a){g._super_.call(this,n,a),this.targetPosition=e.Util.initValue(t,new e.Vector2D),this.radius=e.Util.initValue(r,1e3),this.force=e.Util.initValue(this.normalizeValue(i),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new e.Vector2D,this.lengthSq=0,this.name="Attraction"}function y(e,t,i,r,n){y._super_.call(this,r,n),this.reset(e,t,i),this.time=0,this.name="RandomDrift"}function P(e,t,i,r,n){P._super_.call(this,e,t,i,r,n),this.force*=-1,this.name="Repulsion"}function E(e,t,i){E._super_.call(this,0,e,t,i),this.name="Gravity"}function T(e,t,i,r,n){T._super_.call(this,r,n),this.reset(e,t,i),this.name="Collision"}function v(e,t,i,r){v._super_.call(this,i,r),this.reset(e,t),this.name="CrossZone"}function _(e,t,i,r){_._super_.call(this,i,r),this.reset(e,t),this.name="Alpha"}function d(e,t,i,r){d._super_.call(this,i,r),this.reset(e,t),this.name="Scale"}function p(e,t,i,r,n){p._super_.call(this,r,n),this.reset(e,t,i),this.name="Rotate"}function u(e,t,i,r){u._super_.call(this,i,r),this.reset(e,t),this.name="Color"}function x(t,i,r,n){x._super_.call(this,r,n),this.distanceVec=new e.Vector2D,this.centerPoint=e.Util.initValue(t,new e.Vector2D),this.force=e.Util.initValue(this.normalizeValue(i),100),this.name="GravityWell"}function i(t){this.initializes=[],this.particles=[],this.behaviors=[],this.emitTime=0,this.emitTotalTimes=-1,this.damping=.006,this.bindEmitter=!0,this.rate=new e.Rate(1,.1),i._super_.call(this,t),this.id="emitter_"+i.ID++}function w(e){this.selfBehaviors=[],w._super_.call(this,e)}function c(t,i,r){this.mouseTarget=e.Util.initValue(t,z),this.ease=e.Util.initValue(i,.7),this._allowEmitting=!1,this.initEventHandler(),c._super_.call(this,r)}function Q(t,i,r){this.element=r,this.type=e.Util.initValue(t,"canvas"),this.proton=i,this.renderer=this.getRenderer()}function H(e,t,i){this.proton=e,this.element=t,this.stroke=i}function s(e,t){s._super_.call(this,e,t),this.stroke=null}function l(e,t,i){l._super_.call(this,e,t),this.stroke=i}function n(e,t){n._super_.call(this,e,t),this.stroke=null,this.context=this.element.getContext("2d"),this.bufferCache={}}function r(t,i,e){r._super_.call(this,t,i),this.context=this.element.getContext("2d"),this.imageData=null,this.rectangle=null,this.rectangle=e,this.createImageData(e)}function t(e,i){t._super_.call(this,e,i),this.gl=this.element.getContext("experimental-webgl",{antialias:!0,stencil:!1,depth:!1}),this.gl||alert("Sorry your browser do not suppest WebGL!"),this.initVar(),this.setMaxRadius(),this.initShaders(),this.initBuffers(),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND)}function q(){this.vector=new e.Vector2D(0,0),this.random=0,this.crossType="dead",this.alert=!0}function o(t,r,i,n,a){o._super_.call(this),i-t>=0?(this.x1=t,this.y1=r,this.x2=i,this.y2=n):(this.x1=i,this.y1=n,this.x2=t,this.y2=r),this.dx=this.x2-this.x1,this.dy=this.y2-this.y1,this.minx=Math.min(this.x1,this.x2),this.miny=Math.min(this.y1,this.y2),this.maxx=Math.max(this.x1,this.x2),this.maxy=Math.max(this.y1,this.y2),this.dot=this.x2*this.y1-this.x1*this.y2,this.xxyy=this.dx*this.dx+this.dy*this.dy,this.gradient=this.getGradient(),this.length=this.getLength(),this.direction=e.Util.initValue(a,">")}function m(e,t,i){m._super_.call(this),this.x=e,this.y=t,this.radius=i,this.angle=0,this.center={x:this.x,y:this.y}}function k(e,t){k._super_.call(this),this.x=e,this.y=t}function R(e,t,i,r){R._super_.call(this),this.x=e,this.y=t,this.width=i,this.height=r}function h(e,t,i,r){h._super_.call(this),this.reset(e,t,i,r)}e.POOL_MAX=1e3,e.TIME_STEP=60,e.MEASURE=100,e.EULER="euler",e.RK2="runge-kutta2",e.RK4="runge-kutta4",e.VERLET="verlet",e.PARTICLE_CREATED="partilcleCreated",e.PARTICLE_UPDATE="partilcleUpdate",e.PARTICLE_SLEEP="particleSleep",e.PARTICLE_DEAD="partilcleDead",e.PROTON_UPDATE="protonUpdate",e.PROTON_UPDATE_AFTER="protonUpdateAfter",e.EMITTER_ADDED="emitterAdded",e.EMITTER_REMOVED="emitterRemoved",e.amendChangeTabsBug=!0,e.TextureBuffer={},e.TextureCanvasBuffer={},e.prototype={addRender:function(e){e.proton=this,this.renderers.push(e.proton)},addEmitter:function(t){this.emitters.push(t),t.parent=this,this.dispatchEvent(new e.Event({type:e.EMITTER_ADDED,emitter:t}))},removeEmitter:function(t){var i=this.emitters.indexOf(t);this.emitters.splice(i,1),t.parent=null,this.dispatchEvent(new e.Event({type:e.EMITTER_REMOVED,emitter:t}))},update:function(){this.dispatchEvent(new e.Event({type:e.PROTON_UPDATE})),this.oldTime||(this.oldTime=(new Date).getTime());var i=(new Date).getTime();if(this.elapsed=(i-this.oldTime)/1e3,e.amendChangeTabsBug&&this.amendChangeTabsBug(),this.oldTime=i,this.elapsed>0)for(var t=0;t<this.emitters.length;t++)this.emitters[t]&&this.emitters[t].update(this.elapsed);this.dispatchEvent(new e.Event({type:e.PROTON_UPDATE_AFTER}))},amendChangeTabsBug:function(){this.elapsed>.5&&(this.oldTime=(new Date).getTime(),this.elapsed=0)},getCount:function(){for(var t=0,i=this.emitters.length,e=0;i>e;e++)t+=this.emitters[e].particles.length;return t},destroy:function(){for(var i=this.emitters.length,t=0;i>t;t++)this.emitters[t]&&(this.emitters[t].destroy(),delete this.emitters[t]);this.emitters=[],this.time=0,this.oldTime=0,e.pool.release()}},z.Proton=e;var a=U.prototype;U.initialize=function(e){e.addEventListener=a.addEventListener,e.removeEventListener=a.removeEventListener,e.removeAllEventListeners=a.removeAllEventListeners,e.hasEventListener=a.hasEventListener,e.dispatchEvent=a.dispatchEvent},a._listeners=null,a.initialize=function(){},a.addEventListener=function(t,i){var e=this._listeners;e?this.removeEventListener(t,i):e=this._listeners={};var r=e[t];return r||(r=e[t]=[]),r.push(i),i},a.removeEventListener=function(r,a){var i=this._listeners;if(i){var e=i[r];if(e)for(var t=0,n=e.length;n>t;t++)if(e[t]==a){1==n?delete i[r]:e.splice(t,1);break}}},a.removeAllEventListeners=function(e){e?this._listeners&&delete this._listeners[e]:this._listeners=null},a.dispatchEvent=function(i){var t=!1,n=this._listeners;if(i&&n){var e=n[i.type];if(!e)return t;e=e.slice();for(var r=0,a=e.length;a>r;r++){var s=e[r];t=t||s(i)}}return!!t},a.hasEventListener=function(t){var e=this._listeners;return!(!e||!e[t])},e.EventDispatcher=U,e.EventDispatcher.initialize(e.prototype),e.Event=st;var J=J||{initValue:function(e,t){var e=null!=e&&e!=S?e:t;return e},isArray:function(e){return"object"==typeof e&&e.hasOwnProperty("length")},destroyArray:function(e){e.length=0},destroyObject:function(e){for(var t in e)delete e[t]},getVector2D:function(t,i){if("object"==typeof t)return t;var r=new e.Vector2D(t,i);return r},judgeVector2D:function(e){var t="";return(e.hasOwnProperty("x")||e.hasOwnProperty("y")||e.hasOwnProperty("p")||e.hasOwnProperty("position"))&&(t+="p"),(e.hasOwnProperty("vx")||e.hasOwnProperty("vx")||e.hasOwnProperty("v")||e.hasOwnProperty("velocity"))&&(t+="v"),(e.hasOwnProperty("ax")||e.hasOwnProperty("ax")||e.hasOwnProperty("a")||e.hasOwnProperty("accelerate"))&&(t+="a"),t},setVector2DByObject:function(t,e){e.hasOwnProperty("x")&&(t.p.x=e.x),e.hasOwnProperty("y")&&(t.p.y=e.y),e.hasOwnProperty("vx")&&(t.v.x=e.vx),e.hasOwnProperty("vy")&&(t.v.y=e.vy),e.hasOwnProperty("ax")&&(t.a.x=e.ax),e.hasOwnProperty("ay")&&(t.a.y=e.ay),e.hasOwnProperty("p")&&particle.p.copy(e.p),e.hasOwnProperty("v")&&particle.v.copy(e.v),e.hasOwnProperty("a")&&particle.a.copy(e.a),e.hasOwnProperty("position")&&particle.p.copy(e.position),e.hasOwnProperty("velocity")&&particle.v.copy(e.velocity),e.hasOwnProperty("accelerate")&&particle.a.copy(e.accelerate)},addPrototypeByObject:function(i,r,n){for(var t in r)n?n.indexOf(t)<0&&(i[t]=e.Util.getSpanValue(r[t])):i[t]=e.Util.getSpanValue(r[t]);return i},setPrototypeByObject:function(i,r,n){for(var t in r)i.hasOwnProperty(t)&&(n?n.indexOf(t)<0&&(i[t]=e.Util.getSpanValue(r[t])):i[t]=e.Util.getSpanValue(r[t]));return i},setSpanValue:function(t,i,r){return t instanceof e.Span?t:i?r?new e.Span(t,i,r):new e.Span(t,i):new e.Span(t)},getSpanValue:function(t){return t instanceof e.Span?t.getValue():t},inherits:function(e,t){if(e._super_=t,Object.create)e.prototype=Object.create(t.prototype,{constructor:{value:t}});else{var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},getImageData:function(t,i,e){t.drawImage(i,e.x,e.y);var r=t.getImageData(e.x,e.y,e.width,e.height);return t.clearRect(e.x,e.y,e.width,e.height),r},getImage:function(e,t,i,r){"string"==typeof e?this.loadAndSetImage(e,t,i,r):"object"==typeof e?this.loadAndSetImage(e.src,t,i,r):e instanceof Image&&this.loadedImage(e.src,t,i,r,e)},loadedImage:function(i,t,n,r,a){if(t.target=a,t.transform.src=i,e.TextureBuffer[i]||(e.TextureBuffer[i]=t.target),n)if(e.TextureCanvasBuffer[i])t.transform.canvas=e.TextureCanvasBuffer[i];else{var s=e.WebGLUtil.nhpot(t.target.width),o=e.WebGLUtil.nhpot(t.target.height);t.transform.canvas=e.DomUtil.createCanvas("canvas"+i,s,o);var l=t.transform.canvas.getContext("2d");l.drawImage(t.target,0,0,t.target.width,t.target.height),e.TextureCanvasBuffer[i]=t.transform.canvas}r&&r(t)},loadAndSetImage:function(t,i,r,n){if(e.TextureBuffer[t])this.loadedImage(t,i,r,n,e.TextureBuffer[t]);else{var s=this,a=new Image;a.onload=function(e){s.loadedImage(t,i,r,n,e.target)},a.src=t}},hexToRGB:function(e){var t="#"==e.charAt(0)?e.substring(1,7):e,i=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16);return{r:i,g:r,b:n}},rgbToHex:function(e){return"rgb("+e.r+", "+e.g+", "+e.b+")"}};e.Util=J;var G=G||{ipot:function(e){return 0==(e&e-1)},nhpot:function(e){--e;for(var t=1;32>t;t<<=1)e|=e>>t;return e+1},makeTranslation:function(e,t){return[1,0,0,0,1,0,e,t,1]},makeRotation:function(e){var t=Math.cos(e),i=Math.sin(e);return[t,-i,0,i,t,0,0,0,1]},makeScale:function(e,t){return[e,0,0,0,t,0,0,0,1]},matrixMultiply:function(e,t){var i=e[0],r=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=e[6],c=e[7],v=e[8],u=t[0],d=t[1],p=t[2],f=t[3],_=t[4],m=t[5],g=t[6],y=t[7],h=t[8];return[i*u+r*f+n*g,i*d+r*_+n*y,i*p+r*m+n*h,a*u+s*f+o*g,a*d+s*_+o*y,a*p+s*m+o*h,l*u+c*f+v*g,l*d+c*_+v*y,l*p+c*m+v*h]}};e.WebGLUtil=G;var K=K||{createCanvas:function(i,r,n,t){var e=document.createElement("canvas"),a=t?t:"absolute";return e.id=i,e.width=r,e.height=n,e.style.position=a,e.style.opacity=0,this.transformDom(e,-500,-500,0,0),e},transformDom:function(e,t,i,r,n){e.style.WebkitTransform="translate("+t+"px, "+i+"px) scale("+r+") rotate("+n+"deg)",e.style.MozTransform="translate("+t+"px, "+i+"px) scale("+r+") rotate("+n+"deg)",e.style.OTransform="translate("+t+"px, "+i+"px) scale("+r+") rotate("+n+"deg)",e.style.msTransform="translate("+t+"px, "+i+"px) scale("+r+") rotate("+n+"deg)",e.style.transform="translate("+t+"px, "+i+"px) scale("+r+") rotate("+n+"deg)"}};e.DomUtil=K,L.prototype.set=function(i,t){0==t?e.Mat3.set(i,this.mats[0]):e.Mat3.multiply(this.mats[t-1],i,this.mats[t]),this.size=Math.max(this.size,t+1)},L.prototype.push=function(t){0==this.size?e.Mat3.set(t,this.mats[0]):e.Mat3.multiply(this.mats[this.size-1],t,this.mats[this.size]),this.size++},L.prototype.pop=function(){this.size>0&&this.size--},L.prototype.top=function(){return this.mats[this.size-1]},e.MStack=L,j.ID=0,j.prototype={getDirection:function(){return Math.atan2(this.v.x,-this.v.y)*(180/Math.PI)},reset:function(t){return this.life=1/0,this.age=0,this.energy=1,this.dead=!1,this.sleep=!1,this.target=null,this.sprite=null,this.parent=null,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.easing=e.ease.setEasingByName(e.easeLinear),t?(this.transform={},this.p=new e.Vector2D,this.v=new e.Vector2D,this.a=new e.Vector2D,this.old={p:new e.Vector2D,v:new e.Vector2D,a:new e.Vector2D},this.behaviors=[]):(e.Util.destroyObject(this.transform),this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.removeAllBehaviors()),this.transform.rgb={r:255,g:255,b:255},this},update:function(t,i){if(!this.sleep){this.age+=t;var e,r=this.behaviors.length;for(e=0;r>e;e++)this.behaviors[e]&&this.behaviors[e].applyBehavior(this,t,i)}if(this.age>=this.life)this.destroy();else{var n=this.easing(this.age/this.life);this.energy=Math.max(1-n,0)}},addBehavior:function(e){this.behaviors.push(e),e.hasOwnProperty("parents")&&e.parents.push(this),e.initialize(this)},addBehaviors:function(t){var e,i=t.length;for(e=0;i>e;e++)this.addBehavior(t[e])},removeBehavior:function(e){var t=this.behaviors.indexOf(e);if(t>-1){var e=this.behaviors.splice(t,1);e.parents=null}},removeAllBehaviors:function(){e.Util.destroyArray(this.behaviors)},destroy:function(){this.removeAllBehaviors(),this.energy=0,this.dead=!0,this.parent=null}},e.Particle=j,Y.prototype={create:function(t){return t?new newTypeParticle:new e.Particle},getCount:function(){return this.poolList.length},add:function(){return this.poolList.push(this.create())},get:function(){return 0===this.poolList.length?this.create():this.poolList.pop().reset()},set:function(t){return this.poolList.length<e.POOL_MAX?this.poolList.push(t):void 0},release:function(){for(var e=0;e<this.poolList.length;e++)this.poolList[e].destroy&&this.poolList[e].destroy(),delete this.poolList[e];this.poolList=[]}},e.ParticlePool=Y;var Z={randomAToB:function(e,t,i){return i?Math.floor(Math.random()*(t-e))+e:e+Math.random()*(t-e)},randomFloating:function(e,t,i){return Z.randomAToB(e-t,e+t,i)},randomZone:function(){},degreeTransform:function(e){return e*Math.PI/180},toColor16:function(e){return"#"+e.toString(16)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}};e.MathUtils=Z;var $=function(t){this.type=e.Util.initValue(t,e.EULER)};$.prototype={integrate:function(e,t,i){this.eulerIntegrate(e,t,i)},eulerIntegrate:function(e,t,i){e.sleep||(e.old.p.copy(e.p),e.old.v.copy(e.v),e.a.multiplyScalar(1/e.mass),e.v.add(e.a.multiplyScalar(t)),e.p.add(e.old.v.multiplyScalar(t)),i&&e.v.multiplyScalar(i),e.a.clear())}},e.NumericalIntegration=$;var et=function(e,t){this.x=e||0,this.y=t||0};et.prototype={set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getGradient:function(){return 0!=this.x?Math.atan2(this.y,this.x):this.y>0?Math.PI/2:this.y<0?-Math.PI/2:void 0},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return t!==S?this.addVectors(e,t):(this.x+=e.x,this.y+=e.y,this)},addXY:function(e,t){return this.x+=e,this.y+=t,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScalar:function(e){return this.x+=e,this.y+=e,this},sub:function(e,t){return t!==S?this.subVectors(e,t):(this.x-=e.x,this.y-=e.y,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divideScalar:function(e){return 0!==e?(this.x/=e,this.y/=e):this.set(0,0),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},rotate:function(e){var t=this.x,i=this.y;return this.x=t*Math.cos(e)+i*Math.sin(e),this.y=-t*Math.sin(e)+i*Math.cos(e),this},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y},toArray:function(){return[this.x,this.y]},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new e.Vector2D(this.x,this.y)}},e.Vector2D=et;var tt=function(e,t){this.r=Math.abs(e)||0,this.tha=t||0};tt.prototype={set:function(e,t){return this.r=e,this.tha=t,this},setR:function(e){return this.r=e,this},setTha:function(e){return this.tha=e,this},copy:function(e){return this.r=e.r,this.tha=e.tha,this},toVector:function(){return new e.Vector2D(this.getX(),this.getY())},getX:function(){return this.r*Math.sin(this.tha)},getY:function(){return-this.r*Math.cos(this.tha)},normalize:function(){return this.r=1,this},equals:function(e){return e.r===this.r&&e.tha===this.tha},toArray:function(){return[this.r,this.tha]},clear:function(){return this.r=0,this.tha=0,this},clone:function(){return new e.Polar2D(this.r,this.tha)}},e.Polar2D=tt,X.prototype={getValue:function(t){return this.isArray?this.a[Math.floor(this.a.length*Math.random())]:this.center?e.MathUtils.randomFloating(this.a,this.b,t):e.MathUtils.randomAToB(this.a,this.b,t)}},e.Span=X,e.getSpan=function(t,i,r){return new e.Span(t,i,r)},e.Util.inherits(N,e.Span),N.prototype.getValue=function(){var t=this.colorArr[Math.floor(this.colorArr.length*Math.random())];return"random"==t||"Random"==t?e.MathUtils.randomColor():t},e.ColorSpan=N,V.prototype={contains:function(e,t){return e<=this.right&&e>=this.x&&t<=this.bottom&&t>=this.y?!0:!1}},e.Rectangle=V;var it=it||{create:function(e){var t=new Float32Array(9);return e&&this.set(e,t),t},set:function(i,t){for(var e=0;9>e;e++)t[e]=i[e];return t},multiply:function(t,i,e){var r=t[0],n=t[1],_=t[2],a=t[3],s=t[4],m=t[6],f=t[7],h=i[0],u=i[1],p=i[2],d=i[3],c=i[4],o=i[6],l=i[7];return e[0]=h*r+u*a,e[1]=h*n+u*s,e[2]=_*p,e[3]=d*r+c*a,e[4]=d*n+c*s,e[6]=o*r+l*a+m,e[7]=o*n+l*s+f,e},inverse:function(i,t){var e,r=i[0],n=i[1],a=i[3],s=i[4],o=i[6],l=i[7],c=s,h=-a,u=l*a-s*o,d=r*c+n*h;return e=1/d,t[0]=c*e,t[1]=-n*e,t[3]=h*e,t[4]=r*e,t[6]=u*e,t[7]=(-l*r+n*o)*e,t},multiplyVec2:function(e,i,t){var r=i[0],n=i[1];return t[0]=r*e[0]+n*e[3]+e[6],t[1]=r*e[1]+n*e[4]+e[7],t}};e.Mat3=it,F.id=0,F.prototype={reset:function(t,i){this.life=e.Util.initValue(t,1/0),this.easing=e.Util.initValue(i,e.ease.setEasingByName(e.easeLinear))},normalizeForce:function(t){return t.multiplyScalar(e.MEASURE)},normalizeValue:function(t){return t*e.MEASURE},initialize:function(){},applyBehavior:function(e,t){if(this.age+=t,this.age>=this.life||this.dead)this.energy=0,this.dead=!0,this.destroy();else{var i=this.easing(e.age/e.life);this.energy=Math.max(1-i,0)}},destroy:function(){var e,t=this.parents.length;for(e=0;t>e;e++)this.parents[e].removeBehavior(this);this.parents=[]}},e.Behavior=F,W.prototype={init:function(){this.startTime=0,this.nextTime=this.timePan.getValue()},getValue:function(e){return this.startTime+=e,this.startTime>=this.nextTime?(this.startTime=0,this.nextTime=this.timePan.getValue(),1==this.numPan.b?this.numPan.getValue(!1)>.5?1:0:this.numPan.getValue(!0)):0}},e.Rate=W,O.prototype.reset=function(){},O.prototype.init=function(t,e){this.initialize(e?e:t)},O.prototype.initialize=function(){},e.Initialize=O;var at={initialize:function(r,n,i){var t,a=i.length;for(t=0;a>t;t++)i[t]instanceof e.Initialize?i[t].init(r,n):e.InitializeUtil.init(r,n,i[t]);e.InitializeUtil.bindEmitter(r,n)},init:function(r,t,i){e.Util.setPrototypeByObject(t,i),e.Util.setVector2DByObject(t,i)},bindEmitter:function(t,i){t.bindEmitter&&(i.p.add(t.p),i.v.add(t.v),i.a.add(t.a),i.v.rotate(e.MathUtils.degreeTransform(t.rotation)))}};e.InitializeUtil=at,e.Util.inherits(D,e.Initialize),D.prototype.initialize=function(e){e.life=1/0==this.lifePan.a?1/0:this.lifePan.getValue()},e.Life=D,e.Util.inherits(C,e.Initialize),C.prototype.reset=function(t){this.zone=e.Util.initValue(t,new e.PointZone)},C.prototype.initialize=function(e){this.zone.getPosition(),e.p.x=this.zone.vector.x,e.p.y=this.zone.vector.y},e.Position=C,e.P=C,e.Util.inherits(b,e.Initialize),b.prototype.reset=function(t,i,r){this.rPan=e.Util.setSpanValue(t),this.thaPan=e.Util.setSpanValue(i),this.type=e.Util.initValue(r,"vector")},b.prototype.normalizeVelocity=function(t){return t*e.MEASURE},b.prototype.initialize=function(t){if("p"==this.type||"P"==this.type||"polar"==this.type){var i=new e.Polar2D(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*Math.PI/180);t.v.x=i.getX(),t.v.y=i.getY()}else t.v.x=this.normalizeVelocity(this.rPan.getValue()),t.v.y=this.normalizeVelocity(this.thaPan.getValue())},e.Velocity=b,e.V=b,e.Util.inherits(B,e.Initialize),B.prototype.initialize=function(e){e.mass=this.massPan.getValue()},e.Mass=B,e.Util.inherits(M,e.Initialize),M.prototype.reset=function(t,i,r){this.radius=e.Util.setSpanValue(t,i,r)},M.prototype.initialize=function(e){e.radius=this.radius.getValue(),e.transform.oldRadius=e.radius},e.Radius=M,e.Util.inherits(A,e.Initialize),A.prototype.initialize=function(t){var e=this.image.getValue();t.target="string"==typeof e?{width:this.w,height:this.h,src:e}:e},A.prototype.setSpanValue=function(t){return t instanceof e.ColorSpan?t:new e.ColorSpan(t)},e.ImageTarget=A,e.Util.inherits(f,e.Behavior),f.prototype.reset=function(i,r,t,n){this.force=this.normalizeForce(new e.Vector2D(i,r)),t&&f._super_.prototype.reset.call(this,t,n)},f.prototype.applyBehavior=function(e,t,i){f._super_.prototype.applyBehavior.call(this,e,t,i),e.a.add(this.force)},e.Force=f,e.F=f,e.Util.inherits(g,e.Behavior),g.prototype.reset=function(i,r,n,t,a){this.targetPosition=e.Util.initValue(i,new e.Vector2D),this.radius=e.Util.initValue(n,1e3),this.force=e.Util.initValue(this.normalizeValue(r),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new e.Vector2D,this.lengthSq=0,t&&g._super_.prototype.reset.call(this,t,a)},g.prototype.applyBehavior=function(e,t,i){g._super_.prototype.applyBehavior.call(this,e,t,i),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(e.p),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-6&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),e.a.add(this.attractionForce))},e.Attraction=g,e.Util.inherits(y,e.Behavior),y.prototype.reset=function(i,r,n,t,a){this.panFoce=new e.Vector2D(i,r),this.panFoce=this.normalizeForce(this.panFoce),this.delay=n,t&&y._super_.prototype.reset.call(this,t,a)},y.prototype.applyBehavior=function(t,i,r){y._super_.prototype.applyBehavior.call(this,t,i,r),this.time+=i,this.time>=this.delay&&(t.a.addXY(e.MathUtils.randomAToB(-this.panFoce.x,this.panFoce.x),e.MathUtils.randomAToB(-this.panFoce.y,this.panFoce.y)),this.time=0)},e.RandomDrift=y,e.Util.inherits(P,e.Attraction),P.prototype.reset=function(e,t,i,r,n){P._super_.prototype.reset.call(this,e,t,i,r,n),this.force*=-1},e.Repulsion=P,e.Util.inherits(E,e.Force),E.prototype.reset=function(e,t,i){E._super_.prototype.reset.call(this,0,e,t,i)},e.Gravity=E,e.G=E,e.Util.inherits(T,e.Behavior),T.prototype.reset=function(i,r,n,t,a){this.emitter=e.Util.initValue(i,null),this.mass=e.Util.initValue(r,!0),this.callback=e.Util.initValue(n,null),this.collisionPool=[],this.delta=new e.Vector2D,t&&T._super_.prototype.reset.call(this,t,a)},T.prototype.applyBehavior=function(t,h,a){for(var e,r,i,s,o,l=this.emitter?this.emitter.particles.slice(a):this.pool.slice(a),c=l.length,n=0;c>n;n++)e=l[n],e!==t&&(this.delta.copy(e.p),this.delta.sub(t.p),r=this.delta.lengthSq(),distance=t.radius+e.radius,distance*distance>=r&&(i=distance-Math.sqrt(r),i+=.5,totalMass=t.mass+e.mass,s=this.mass?e.mass/totalMass:.5,o=this.mass?t.mass/totalMass:.5,t.p.add(this.delta.clone().normalize().multiplyScalar(i*-s)),e.p.add(this.delta.normalize().multiplyScalar(i*o)),this.callback&&this.callback(t,e)))},e.Collision=T,e.Util.inherits(v,e.Behavior),v.prototype.reset=function(i,r,t,n){this.zone=i,this.zone.crossType=e.Util.initValue(r,"dead"),t&&v._super_.prototype.reset.call(this,t,n)},v.prototype.applyBehavior=function(e,t,i){v._super_.prototype.applyBehavior.call(this,e,t,i),this.zone.crossing(e)},e.CrossZone=v,e.Util.inherits(_,e.Behavior),_.prototype.reset=function(r,t,i,n){this.same=null==t||t==S?!0:!1,this.a=e.Util.setSpanValue(e.Util.initValue(r,1)),this.b=e.Util.setSpanValue(t),i&&_._super_.prototype.reset.call(this,i,n)},_.prototype.initialize=function(e){e.transform.alphaA=this.a.getValue(),e.transform.alphaB=this.same?e.transform.alphaA:this.b.getValue()},_.prototype.applyBehavior=function(e,t,i){_._super_.prototype.applyBehavior.call(this,e,t,i),e.alpha=e.transform.alphaB+(e.transform.alphaA-e.transform.alphaB)*this.energy,e.alpha<.001&&(e.alpha=0)},e.Alpha=_,e.Util.inherits(d,e.Behavior),d.prototype.reset=function(r,t,i,n){this.same=null==t||t==S?!0:!1,this.a=e.Util.setSpanValue(e.Util.initValue(r,1)),this.b=e.Util.setSpanValue(t),i&&d._super_.prototype.reset.call(this,i,n)},d.prototype.initialize=function(e){e.transform.scaleA=this.a.getValue(),e.transform.oldRadius=e.radius,e.transform.scaleB=this.same?e.transform.scaleA:this.b.getValue()},d.prototype.applyBehavior=function(e,t,i){d._super_.prototype.applyBehavior.call(this,e,t,i),e.scale=e.transform.scaleB+(e.transform.scaleA-e.transform.scaleB)*this.energy,e.scale<1e-4&&(e.scale=0),e.radius=e.transform.oldRadius*e.scale},e.Scale=d,e.Util.inherits(p,e.Behavior),p.prototype.reset=function(r,t,n,i,a){this.same=null==t||t==S?!0:!1,this.a=e.Util.setSpanValue(e.Util.initValue(r,"Velocity")),this.b=e.Util.setSpanValue(e.Util.initValue(t,0)),this.style=e.Util.initValue(n,"to"),i&&p._super_.prototype.reset.call(this,i,a)},p.prototype.initialize=function(e){e.rotation=this.a.getValue(),e.transform.rotationA=this.a.getValue(),this.same||(e.transform.rotationB=this.b.getValue())},p.prototype.applyBehavior=function(e,t,i){p._super_.prototype.applyBehavior.call(this,e,t,i),this.same?("V"==this.a.a||"Velocity"==this.a.a||"v"==this.a.a)&&(e.rotation=e.getDirection()):e.rotation+="to"==this.style||"TO"==this.style||"_"==this.style?e.transform.rotationB+(e.transform.rotationA-e.transform.rotationB)*this.energy:e.transform.rotationB},e.Rotate=p,e.Util.inherits(u,e.Behavior),u.prototype.reset=function(t,i,e,r){this.color1=this.setSpanValue(t),this.color2=this.setSpanValue(i),e&&u._super_.prototype.reset.call(this,e,r)},u.prototype.initialize=function(t){t.color=this.color1.getValue(),t.transform.beginRGB=e.Util.hexToRGB(t.color),this.color2&&(t.transform.endRGB=e.Util.hexToRGB(this.color2.getValue()))},u.prototype.applyBehavior=function(e,t,i){this.color2?(u._super_.prototype.applyBehavior.call(this,e,t,i),e.transform.rgb.r=e.transform.endRGB.r+(e.transform.beginRGB.r-e.transform.endRGB.r)*this.energy,e.transform.rgb.g=e.transform.endRGB.g+(e.transform.beginRGB.g-e.transform.endRGB.g)*this.energy,e.transform.rgb.b=e.transform.endRGB.b+(e.transform.beginRGB.b-e.transform.endRGB.b)*this.energy,e.transform.rgb.r=parseInt(e.transform.rgb.r,10),e.transform.rgb.g=parseInt(e.transform.rgb.g,10),e.transform.rgb.b=parseInt(e.transform.rgb.b,10)):(e.transform.rgb.r=e.transform.beginRGB.r,e.transform.rgb.g=e.transform.beginRGB.g,e.transform.rgb.b=e.transform.beginRGB.b)},u.prototype.setSpanValue=function(t){return t?t instanceof e.ColorSpan?t:new e.ColorSpan(t):null},e.Color=u,e.Util.inherits(x,e.Behavior),x.prototype.reset=function(i,r,t,n){this.distanceVec=new e.Vector2D,this.centerPoint=e.Util.initValue(i,new e.Vector2D),this.force=e.Util.initValue(this.normalizeValue(r),100),t&&x._super_.prototype.reset.call(this,t,n)},x.prototype.initialize=function(){},x.prototype.applyBehavior=function(e,r){this.distanceVec.set(this.centerPoint.x-e.p.x,this.centerPoint.y-e.p.y);var t=this.distanceVec.lengthSq();if(0!=t){var n=this.distanceVec.length(),i=this.force*r/(t*n);e.v.x+=i*this.distanceVec.x,e.v.y+=i*this.distanceVec.y}},e.GravityWell=x,i.ID=0,e.Util.inherits(i,e.Particle),e.EventDispatcher.initialize(i.prototype),i.prototype.emit=function(i,t){this.emitTime=0,this.emitTotalTimes=e.Util.initValue(i,1/0),1==t||"life"==t||"destroy"==t?this.life="once"==i?1:this.emitTotalTimes:isNaN(t)||(this.life=t),this.rate.init()},i.prototype.stopEmit=function(){this.emitTotalTimes=-1,this.emitTime=0},i.prototype.removeAllParticles=function(){for(var e=0;e<this.particles.length;e++)this.particles[e].dead=!0},i.prototype.createParticle=function(i,r){var t=e.pool.get();return this.setupParticle(t,i,r),this.dispatchEvent(new e.Event({type:e.PARTICLE_CREATED,particle:t})),t},i.prototype.addSelfInitialize=function(e){e.init?e.init(this):this.initAll()},i.prototype.addInitialize=function(){var e,t=arguments.length;for(e=0;t>e;e++)this.initializes.push(arguments[e])},i.prototype.removeInitialize=function(t){var e=this.initializes.indexOf(t);e>-1&&this.initializes.splice(e,1)},i.prototype.removeInitializers=function(){e.Util.destroyArray(this.initializes)},i.prototype.addBehavior=function(){var e,t=arguments.length;for(e=0;t>e;e++)this.behaviors.push(arguments[e]),arguments[e].hasOwnProperty("parents")&&arguments[e].parents.push(this)},i.prototype.removeBehavior=function(t){var e=this.behaviors.indexOf(t);e>-1&&this.behaviors.splice(e,1)},i.prototype.removeAllBehaviors=function(){e.Util.destroyArray(this.behaviors)},i.prototype.integrate=function(i){var n=1-this.damping;e.integrator.integrate(this,i,n);var t,a=this.particles.length;for(t=0;a>t;t++){var r=this.particles[t];r.update(i,t),e.integrator.integrate(r,i,n),this.dispatchEvent(new e.Event({type:e.PARTICLE_UPDATE,particle:r}))}},i.prototype.emitting=function(t){if("once"==this.emitTotalTimes){var e,i=this.rate.getValue(99999);for(e=0;i>e;e++)this.createParticle();this.emitTotalTimes="none"}else if(!isNaN(this.emitTotalTimes)&&(this.emitTime+=t,this.emitTime<this.emitTotalTimes)){var e,i=this.rate.getValue(t);for(e=0;i>e;e++)this.createParticle()}},i.prototype.update=function(r){this.age+=r,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(r),this.integrate(r);var i,t,n=this.particles.length;for(t=n-1;t>=0;t--)i=this.particles[t],i.dead&&(e.pool.set(i),this.particles.splice(t,1),this.dispatchEvent(new e.Event({type:e.PARTICLE_DEAD,particle:i})))},i.prototype.setupParticle=function(t,i,r){var n=this.initializes,a=this.behaviors;i&&(n=i instanceof Array?i:[i]),r&&(a=r instanceof Array?r:[r]),e.InitializeUtil.initialize(this,t,n),t.addBehaviors(a),t.parent=this,this.particles.push(t)},i.prototype.destroy=function(){this.dead=!0,this.emitTotalTimes=-1,0==this.particles.length&&(this.removeInitializers(),this.removeAllBehaviors(),this.parent&&this.parent.removeEmitter(this))},e.Emitter=i,e.Util.inherits(w,e.Emitter),w.prototype.addSelfBehavior=function(){var e,t=arguments.length;for(e=0;t>e;e++)this.selfBehaviors.push(arguments[e])},w.prototype.removeSelfBehavior=function(t){var e=this.selfBehaviors.indexOf(t);e>-1&&this.selfBehaviors.splice(e,1)},w.prototype.update=function(t){if(w._super_.prototype.update.call(this,t),!this.sleep){var e,i=this.selfBehaviors.length;for(e=0;i>e;e++)this.selfBehaviors[e].applyBehavior(this,t,e)}},e.BehaviorEmitter=w,e.Util.inherits(c,e.Emitter),c.prototype.initEventHandler=function(){var e=this;this.mousemoveHandler=function(t){e.mousemove.call(e,t)},this.mousedownHandler=function(t){e.mousedown.call(e,t)},this.mouseupHandler=function(t){e.mouseup.call(e,t)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},c.prototype.emit=function(){this._allowEmitting=!0},c.prototype.stopEmit=function(){this._allowEmitting=!1},c.prototype.mousemove=function(e){e.layerX||0==e.layerX?(this.p.x+=(e.layerX-this.p.x)*this.ease,this.p.y+=(e.layerY-this.p.y)*this.ease):(e.offsetX||0==e.offsetX)&&(this.p.x+=(e.offsetX-this.p.x)*this.ease,this.p.y+=(e.offsetY-this.p.y)*this.ease),this._allowEmitting&&c._super_.prototype.emit.call(this,"once")},c.prototype.destroy=function(){c._super_.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},e.FollowEmitter=c;var rt=rt||{easeLinear:function(e){return e},easeInQuad:function(e){return Math.pow(e,2)},easeOutQuad:function(e){return-(Math.pow(e-1,2)-1)},easeInOutQuad:function(e){return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2)},easeInCubic:function(e){return Math.pow(e,3)},easeOutCubic:function(e){return Math.pow(e-1,3)+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},easeInQuart:function(e){return Math.pow(e,4)},easeOutQuart:function(e){return-(Math.pow(e-1,4)-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeInSine:function(e){return-Math.cos(e*(Math.PI/2))+1},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:-Math.pow(2,-10*e)+1},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(-Math.pow(2,-10*--e)+2)},easeInCirc:function(e){return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?.5*e*e*(((t*=1.525)+1)*e-t):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},setEasingByName:function(t){switch(t){case"easeLinear":return e.ease.easeLinear;case"easeInQuad":return e.ease.easeInQuad;case"easeOutQuad":return e.ease.easeOutQuad;case"easeInOutQuad":return e.ease.easeInOutQuad;case"easeInCubic":return e.ease.easeInCubic;case"easeOutCubic":return e.ease.easeOutCubic;case"easeInOutCubic":return e.ease.easeInOutCubic;case"easeInQuart":return e.ease.easeInQuart;case"easeOutQuart":return e.ease.easeOutQuart;case"easeInOutQuart":return e.ease.easeInOutQuart;case"easeInSine":return e.ease.easeInSine;case"easeOutSine":return e.ease.easeOutSine;case"easeInOutSine":return e.ease.easeInOutSine;case"easeInExpo":return e.ease.easeInExpo;case"easeOutExpo":return e.ease.easeOutExpo;case"easeInOutExpo":return e.ease.easeInOutExpo;case"easeInCirc":return e.ease.easeInCirc;case"easeOutCirc":return e.ease.easeOutCirc;case"easeInOutCirc":return e.ease.easeInOutCirc;case"easeInBack":return e.ease.easeInBack;case"easeOutBack":return e.ease.easeOutBack;case"easeInOutBack":return e.ease.easeInOutBack;default:return e.ease.easeLinear}}};e.ease=rt,e.easeLinear="easeLinear",e.easeInQuad="easeInQuad",e.easeOutQuad="easeOutQuad",e.easeInOutQuad="easeInOutQuad",e.easeInCubic="easeInCubic",e.easeOutCubic="easeOutCubic",e.easeInOutCubic="easeInOutCubic",e.easeInQuart="easeInQuart",e.easeOutQuart="easeOutQuart",e.easeInOutQuart="easeInOutQuart",e.easeInSine="easeInSine",e.easeOutSine="easeOutSine",e.easeInOutSine="easeInOutSine",e.easeInExpo="easeInExpo",e.easeOutExpo="easeOutExpo",e.easeInOutExpo="easeInOutExpo",e.easeInCirc="easeInCirc",e.easeOutCirc="easeOutCirc",e.easeInOutCirc="easeInOutCirc",e.easeInBack="easeInBack",e.easeOutBack="easeOutBack",e.easeInOutBack="easeInOutBack",Q.prototype={start:function(){this.addEventHandler(),this.renderer.start()},stop:function(){this.renderer.stop()},resize:function(e,t){this.renderer.resize(e,t)},setStroke:function(e,t){this.renderer.hasOwnProperty("stroke")?this.renderer.setStroke(e,t):alert("Sorry this renderer do not suppest stroke method!")},createImageData:function(t){this.renderer instanceof e.PixelRender&&this.renderer.createImageData(t)},setMaxRadius:function(t){this.renderer instanceof e.WebGLRender&&this.renderer.setMaxRadius(t)},blendEquation:function(t){this.renderer instanceof e.WebGLRender&&this.renderer.blendEquation(t)},blendFunc:function(t,i){this.renderer instanceof e.WebGLRender&&this.renderer.blendFunc(t,i)},setType:function(e){this.type=e,this.renderer=this.getRenderer()},getRenderer:function(){switch(this.type){case"dom":return new e.DomRender(this.proton,this.element);case"canvas":return new e.CanvasRender(this.proton,this.element);case"webgl":return new e.WebGLRender(this.proton,this.element);case"easel":return new e.EaselRender(this.proton,this.element);case"easeljs":return new e.EaselRender(this.proton,this.element);case"pixel":return new e.PixelRender(this.proton,this.element);default:return new e.BaseRender(this.proton,this.element)}},render:function(e){this.renderer.render(e)},addEventHandler:function(){this.onProtonUpdate&&(this.renderer.onProtonUpdate=this.onProtonUpdate),this.onParticleCreated&&(this.renderer.onParticleCreated=this.onParticleCreated),this.onParticleUpdate&&(this.renderer.onParticleUpdate=this.onParticleUpdate),this.onParticleDead&&(this.renderer.onParticleDead=this.onParticleDead)}},e.Renderer=Q,H.prototype={start:function(){var t=this;this.proton.addEventListener(e.PROTON_UPDATE,function(){t.onProtonUpdate.call(t)}),this.proton.addEventListener(e.PROTON_UPDATE_AFTER,function(){t.onProtonUpdateAfter.call(t)}),this.proton.addEventListener(e.EMITTER_ADDED,function(e){t.onEmitterAdded.call(t,e.emitter)}),this.proton.addEventListener(e.EMITTER_REMOVED,function(e){t.onEmitterRemoved.call(t,e.emitter)});var i,r=this.proton.emitters.length;for(i=0;r>i;i++){var n=this.proton.emitters[i];this.addEmitterListener(n)}},resize:function(){},addEmitterListener:function(i){var t=this;i.addEventListener(e.PARTICLE_CREATED,function(e){t.onParticleCreated.call(t,e.particle)}),i.addEventListener(e.PARTICLE_UPDATE,function(e){t.onParticleUpdate.call(t,e.particle)}),i.addEventListener(e.PARTICLE_DEAD,function(e){t.onParticleDead.call(t,e.particle)})},stop:function(){var e,t=this.proton.emitters.length;for(this.proton.removeAllEventListeners(),e=0;t>e;e++){var i=this.proton.emitters[e];i.removeAllEventListeners()}},onEmitterAdded:function(e){this.addEmitterListener(e)},onEmitterRemoved:function(e){e.removeAllEventListeners()},onProtonUpdate:function(){},onProtonUpdateAfter:function(){},onParticleCreated:function(){},onParticleUpdate:function(){},onParticleDead:function(){}},e.BaseRender=H,e.Util.inherits(s,e.BaseRender),s.prototype.start=function(){s._super_.prototype.start.call(this)},s.prototype.setStroke=function(t,i){t=e.Util.initValue(t,"#000000"),i=e.Util.initValue(i,1),this.stroke={color:t,thinkness:i}},s.prototype.onProtonUpdate=function(){},s.prototype.onParticleCreated=function(t){if(t.target){var i=this;e.Util.getImage(t.target,t,!1,function(e){i.setImgInDIV.call(i,e)})}else t.transform.canvas=e.DomUtil.createCanvas(t.id+"_canvas",t.radius+1,t.radius+1,"absolute"),t.transform.bakOldRadius=t.radius,this.stroke?(t.transform.canvas.width=2*t.radius+2*this.stroke.thinkness,t.transform.canvas.height=2*t.radius+2*this.stroke.thinkness):(t.transform.canvas.width=2*t.radius+1,t.transform.canvas.height=2*t.radius+1),t.transform.context=t.transform.canvas.getContext("2d"),t.transform.context.fillStyle=t.color,t.transform.context.beginPath(),t.transform.context.arc(t.radius,t.radius,t.radius,0,2*Math.PI,!0),this.stroke&&(t.transform.context.strokeStyle=this.stroke.color,t.transform.context.lineWidth=this.stroke.thinkness,t.transform.context.stroke()),t.transform.context.closePath(),t.transform.context.fill(),this.element.appendChild(t.transform.canvas)},s.prototype.onParticleUpdate=function(t){t.target?t.target instanceof Image&&(t.transform.canvas.style.opacity=t.alpha,e.DomUtil.transformDom(t.transform.canvas,t.p.x-t.target.width/2,t.p.y-t.target.height/2,t.scale,t.rotation)):(t.transform.canvas.style.opacity=t.alpha,t.transform.oldRadius?e.DomUtil.transformDom(t.transform.canvas,t.p.x-t.transform.oldRadius,t.p.y-t.transform.oldRadius,t.scale,t.rotation):e.DomUtil.transformDom(t.transform.canvas,t.p.x-t.transform.bakOldRadius,t.p.y-t.transform.bakOldRadius,t.scale,t.rotation))},s.prototype.onParticleDead=function(e){e.transform.canvas&&this.element.removeChild(e.transform.canvas)},s.prototype.setImgInDIV=function(t){t.transform.canvas=e.DomUtil.createCanvas(t.id+"_canvas",t.target.width+1,t.target.height+1,"absolute",t.p.x-t.radius,t.p.y-t.radius),t.transform.context=t.transform.canvas.getContext("2d"),t.transform.context.drawImage(t.target,0,0,t.target.width,t.target.height),this.element.appendChild(t.transform.canvas)},e.DomRender=s,e.Util.inherits(l,e.BaseRender),l.prototype.resize=function(){},l.prototype.start=function(){l._super_.prototype.start.call(this)},l.prototype.onProtonUpdate=function(){},l.prototype.onParticleCreated=function(e){if(e.target)e.target=e.target.clone(),e.target.parent||(e.target.image&&(e.target.regX=e.target.image.width/2,e.target.regY=e.target.image.height/2),this.element.addChild(e.target));else{var t=new createjs.Graphics;this.stroke&&(1==this.stroke?t.beginStroke("#000000"):this.stroke instanceof String&&t.beginStroke(this.stroke)),t.beginFill(e.color).drawCircle(0,0,e.radius);var i=new createjs.Shape(t);e.target=i,this.element.addChild(e.target)}},l.prototype.onParticleUpdate=function(e){e.target&&(e.target.x=e.p.x,e.target.y=e.p.y,e.target.alpha=e.alpha,e.target.scaleX=e.target.scaleY=e.scale,e.target.rotation=e.rotation)},l.prototype.onParticleDead=function(e){e.target&&e.target.parent&&e.target.parent.removeChild(e.target)},e.EaselRender=l,e.Util.inherits(n,e.BaseRender),n.prototype.resize=function(e,t){this.element.width=e,this.element.height=t},n.prototype.start=function(){n._super_.prototype.start.call(this)},n.prototype.setStroke=function(t,i){t=e.Util.initValue(t,"#000000"),i=e.Util.initValue(i,1),this.stroke={color:t,thinkness:i}},n.prototype.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},n.prototype.onParticleCreated=function(t){t.target?e.Util.getImage(t.target,t,!1):t.color=t.color?t.color:"#ff0000"},n.prototype.onParticleUpdate=function(t){if(t.target){if(t.target instanceof Image){var r=t.target.width*t.scale|0,n=t.target.height*t.scale|0,a=t.p.x-r/2,s=t.p.y-n/2;if(t.color){t.transform.buffer||(t.transform.buffer=this.getBuffer(t.target));var i=t.transform.buffer.getContext("2d");i.clearRect(0,0,t.transform.buffer.width,t.transform.buffer.height),i.globalAlpha=t.alpha,i.drawImage(t.target,0,0),i.globalCompositeOperation="source-atop",i.fillStyle=e.Util.rgbToHex(t.transform.rgb),i.fillRect(0,0,t.transform.buffer.width,t.transform.buffer.height),i.globalCompositeOperation="source-over",i.globalAlpha=1,this.context.drawImage(t.transform.buffer,0,0,t.transform.buffer.width,t.transform.buffer.height,a,s,r,n)}else this.context.save(),this.context.globalAlpha=t.alpha,this.context.translate(t.p.x,t.p.y),this.context.rotate(e.MathUtils.degreeTransform(t.rotation)),this.context.translate(-t.p.x,-t.p.y),this.context.drawImage(t.target,0,0,t.target.width,t.target.height,a,s,r,n),this.context.globalAlpha=1,this.context.restore()}}else this.context.fillStyle=t.transform.rgb?"rgba("+t.transform.rgb.r+","+t.transform.rgb.g+","+t.transform.rgb.b+","+t.alpha+")":t.color,this.context.beginPath(),this.context.arc(t.p.x,t.p.y,t.radius,0,2*Math.PI,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()},n.prototype.onParticleDead=function(){},n.prototype.getBuffer=function(t){if(t instanceof Image){var i=t.width+"_"+t.height,e=this.bufferCache[i];return e||(e=document.createElement("canvas"),e.width=t.width,e.height=t.height,this.bufferCache[i]=e),e}},e.CanvasRender=n,e.Util.inherits(r,e.BaseRender),r.prototype.resize=function(e,t){this.element.width=e,this.element.height=t},r.prototype.createImageData=function(t){this.rectangle=t?t:new e.Rectangle(0,0,this.element.width,this.element.height),this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height),this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},r.prototype.start=function(){r._super_.prototype.start.call(this)},r.prototype.onProtonUpdate=function(){this.context.clearRect(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)},r.prototype.onProtonUpdateAfter=function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},r.prototype.onParticleCreated=function(){},r.prototype.onParticleUpdate=function(e){this.imageData&&this.setPixel(this.imageData,Math.floor(e.p.x-this.rectangle.x),Math.floor(e.p.y-this.rectangle.y),e)},r.prototype.setPixel=function(e,i,r,a){var n=a.transform.rgb;if(!(0>i||i>this.element.width||0>r||r>this.elementwidth)){var t=4*((r>>0)*e.width+(i>>0));e.data[t]=n.r,e.data[t+1]=n.g,e.data[t+2]=n.b,e.data[t+3]=255*a.alpha}},r.prototype.onParticleDead=function(){},e.PixelRender=r,e.Util.inherits(t,e.BaseRender),t.prototype.resize=function(e,t){this.umat[4]=-2,this.umat[7]=1,this.smat[0]=1/e,this.smat[4]=1/t,this.mstack.set(this.umat,0),this.mstack.set(this.smat,1),this.gl.viewport(0,0,e,t),this.element.width=e,this.element.height=t},t.prototype.setMaxRadius=function(e){this.circleCanvasURL=this.createCircle(e)},t.prototype.getVertexShader=function(){var e=["uniform vec2 viewport;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 tMat;","varying vec2 vTextureCoord;","varying float alpha;","void main() {","vec3 v = tMat * vec3(aVertexPosition, 1.0);","gl_Position = vec4(v.x, v.y, 0, 1);","vTextureCoord = aTextureCoord;","alpha = tMat[0][2];","}"].join("\n");return e},t.prototype.getFragmentShader=function(){var e=["precision mediump float;","varying vec2 vTextureCoord;","varying float alpha;","uniform sampler2D uSampler;","uniform vec4 color;","uniform bool useTexture;","uniform vec3 uColor;","void main() {","vec4 textureColor = texture2D(uSampler, vTextureCoord);","gl_FragColor = textureColor * vec4(uColor, 1.0);","gl_FragColor.w *= alpha;","}"].join("\n");return e},t.prototype.initVar=function(){this.mstack=new e.MStack,this.umat=e.Mat3.create([2,0,1,0,-2,0,-1,1,1]),this.smat=e.Mat3.create([.01,0,1,0,.01,0,0,0,1]),this.texturebuffers={}},t.prototype.start=function(){t._super_.prototype.start.call(this),this.resize(this.element.width,this.element.height)},t.prototype.blendEquation=function(e){this.gl.blendEquation(this.gl[e])},t.prototype.blendFunc=function(e,t){this.gl.blendFunc(this.gl[e],this.gl[t])},t.prototype.getShader=function(e,i,r){var t;return t=e.createShader(r?e.FRAGMENT_SHADER:e.VERTEX_SHADER),e.shaderSource(t,i),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)?t:(alert(e.getShaderInfoLog(t)),null)},t.prototype.initShaders=function(){var e=this.getShader(this.gl,this.getFragmentShader(),!0),t=this.getShader(this.gl,this.getVertexShader(),!1);this.sprogram=this.gl.createProgram(),this.gl.attachShader(this.sprogram,t),this.gl.attachShader(this.sprogram,e),this.gl.linkProgram(this.sprogram),this.gl.getProgramParameter(this.sprogram,this.gl.LINK_STATUS)||alert("Could not initialise shaders"),this.gl.useProgram(this.sprogram),this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition"),this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.sprogram.tca),this.gl.enableVertexAttribArray(this.sprogram.vpa),this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat"),this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler"),this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture"),this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor"),this.gl.uniform1i(this.sprogram.useTex,1)},t.prototype.initBuffers=function(){this.unitIBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer);var i=[0,3,1,0,2,3];this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),this.gl.STATIC_DRAW);for(var t=[],e=0;100>e;e++)t.push(e);for(idx=new Uint16Array(t),this.unitI33=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW),t=[],e=0;100>e;e++)t.push(e,e+1,e+2);idx=new Uint16Array(t),this.stripBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW)},t.prototype.createCircle=function(r){this.circleCanvasRadius=e.WebGLUtil.nhpot(e.Util.initValue(r,32));var i=e.DomUtil.createCanvas("circle_canvas",2*this.circleCanvasRadius,2*this.circleCanvasRadius),t=i.getContext("2d");return t.beginPath(),t.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,2*Math.PI,!0),t.closePath(),t.fillStyle="#FFF",t.fill(),i.toDataURL()},t.prototype.setImgInCanvas=function(t){var i=t.target.width,r=t.target.height,a=e.WebGLUtil.nhpot(t.target.width),s=e.WebGLUtil.nhpot(t.target.height),o=t.target.width/a,n=t.target.height/s;this.texturebuffers[t.transform.src]||(this.texturebuffers[t.transform.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]),t.transform.texture=this.texturebuffers[t.transform.src][0],t.transform.vcBuffer=this.texturebuffers[t.transform.src][1],t.transform.tcBuffer=this.texturebuffers[t.transform.src][2],this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.transform.tcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,o,0,0,n,n,n]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.transform.vcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,i,0,0,r,i,r]),this.gl.STATIC_DRAW);var l=t.transform.canvas.getContext("2d"),c=l.getImageData(0,0,a,s);this.gl.bindTexture(this.gl.TEXTURE_2D,t.transform.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,c),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D),t.transform.textureLoaded=!0,t.transform.textureWidth=i,t.transform.textureHeight=r},t.prototype.setStroke=function(){},t.prototype.onProtonUpdate=function(){},t.prototype.onParticleCreated=function(t){var i=this;t.transform.textureLoaded=!1,t.transform.tmat=e.Mat3.create(),t.transform.tmat[8]=1,t.transform.imat=e.Mat3.create(),t.transform.imat[8]=1,t.target?e.Util.getImage(t.target,t,!0,function(e){i.setImgInCanvas.call(i,e),e.transform.oldScale=1}):e.Util.getImage(this.circleCanvasURL,t,!0,function(e){i.setImgInCanvas.call(i,e),e.transform.oldScale=e.radius/i.circleCanvasRadius})},t.prototype.onParticleUpdate=function(e){e.transform.textureLoaded&&(this.updateMatrix(e),this.gl.uniform3f(this.sprogram.color,e.transform.rgb.r/255,e.transform.rgb.g/255,e.transform.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,!1,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.transform.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.transform.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,e.transform.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())},t.prototype.onParticleDead=function(){},t.prototype.updateMatrix=function(t){var n=e.WebGLUtil.makeTranslation(-t.transform.textureWidth/2,-t.transform.textureHeight/2),a=e.WebGLUtil.makeTranslation(t.p.x,t.p.y),s=t.rotation*(Math.PI/180),o=e.WebGLUtil.makeRotation(s),r=t.scale*t.transform.oldScale,l=e.WebGLUtil.makeScale(r,r),i=e.WebGLUtil.matrixMultiply(n,l);i=e.WebGLUtil.matrixMultiply(i,o),i=e.WebGLUtil.matrixMultiply(i,a),e.Mat3.inverse(i,t.transform.imat),i[2]=t.alpha,this.mstack.push(i)},e.WebGLRender=t,q.prototype={getPosition:function(){},crossing:function(){}},e.Zone=q,e.Util.inherits(o,e.Zone),o.prototype.getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient),this.vector},o.prototype.getDirection=function(t,i){var r=this.dy,e=-this.dx,n=this.dot,a=0==e?1:e;return(r*t+e*i+n)*a>0?!0:!1},o.prototype.getDistance=function(e,t){var i=this.dy,r=-this.dx,n=this.dot,a=i*e+r*t+n;return a/Math.sqrt(this.xxyy)},o.prototype.getSymmetric=function(e){var n=e.getGradient(),a=this.getGradient(),t=2*(a-n),i=e.x,r=e.y;return e.x=i*Math.cos(t)-r*Math.sin(t),e.y=i*Math.sin(t)+r*Math.cos(t),e},o.prototype.getGradient=function(){return Math.atan2(this.dy,this.dx)},o.prototype.getRange=function(e,t){var i=Math.abs(this.getGradient());i<=Math.PI/4?e.p.x<this.maxx&&e.p.x>this.minx&&t():e.p.y<this.maxy&&e.p.y>this.miny&&t()},o.prototype.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},o.prototype.crossing=function(e){var t=this;"dead"==this.crossType?">"==this.direction||"R"==this.direction||"right"==this.direction||"down"==this.direction?this.getRange(e,function(){t.getDirection(e.p.x,e.p.y)&&(e.dead=!0)}):this.getRange(e,function(){t.getDirection(e.p.x,e.p.y)||(e.dead=!0)}):"bound"==this.crossType?this.getRange(e,function(){t.getDistance(e.p.x,e.p.y)<=e.radius&&(0==t.dx?e.v.x*=-1:0==t.dy?e.v.y*=-1:t.getSymmetric(e.v))}):"cross"==this.crossType&&this.alert&&(alert("Sorry lineZone does not support cross method"),this.alert=!1)},e.LineZone=o,e.Util.inherits(m,e.Zone),m.prototype.getPosition=function(){return this.random=Math.random(),this.angle=2*Math.PI*Math.random(),this.vector.x=this.x+this.random*this.radius*Math.cos(this.angle),this.vector.y=this.y+this.random*this.radius*Math.sin(this.angle),this.vector},m.prototype.setCenter=function(e,t){this.center.x=e,this.center.y=t},m.prototype.crossing=function(e){var t=e.p.distanceTo(this.center);"dead"==this.crossType?t-e.radius>this.radius&&(e.dead=!0):"bound"==this.crossType?t+e.radius>=this.radius&&this.getSymmetric(e):"cross"==this.crossType&&this.alert&&(alert("Sorry CircleZone does not support cross method"),this.alert=!1)},m.prototype.getSymmetric=function(e){var n=e.v.getGradient(),a=this.getGradient(e),t=2*(a-n),i=e.v.x,r=e.v.y;e.v.x=i*Math.cos(t)-r*Math.sin(t),e.v.y=i*Math.sin(t)+r*Math.cos(t)},m.prototype.getGradient=function(e){return-Math.PI/2+Math.atan2(e.p.y-this.center.y,e.p.x-this.center.x)},e.CircleZone=m,e.Util.inherits(k,e.Zone),k.prototype.getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector},k.prototype.crossing=function(){this.alert&&(alert("Sorry PointZone does not support crossing method"),this.alert=!1)},e.PointZone=k,e.Util.inherits(R,e.Zone),R.prototype.getPosition=function(){return this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height,this.vector},R.prototype.crossing=function(e){"dead"==this.crossType?(e.p.x+e.radius<this.x?e.dead=!0:e.p.x-e.radius>this.x+this.width&&(e.dead=!0),e.p.y+e.radius<this.y?e.dead=!0:e.p.y-e.radius>this.y+this.height&&(e.dead=!0)):"bound"==this.crossType?(e.p.x-e.radius<this.x?(e.p.x=this.x+e.radius,e.v.x*=-1):e.p.x+e.radius>this.x+this.width&&(e.p.x=this.x+this.width-e.radius,e.v.x*=-1),e.p.y-e.radius<this.y?(e.p.y=this.y+e.radius,e.v.y*=-1):e.p.y+e.radius>this.y+this.height&&(e.p.y=this.y+this.height-e.radius,e.v.y*=-1)):"cross"==this.crossType&&(e.p.x+e.radius<this.x&&e.v.x<=0?e.p.x=this.x+this.width+e.radius:e.p.x-e.radius>this.x+this.width&&e.v.x>=0&&(e.p.x=this.x-e.radius),e.p.y+e.radius<this.y&&e.v.y<=0?e.p.y=this.y+this.height+e.radius:e.p.y-e.radius>this.y+this.height&&e.v.y>=0&&(e.p.y=this.y-e.radius))},e.RectZone=R,e.Util.inherits(h,e.Zone),h.prototype.reset=function(t,i,r,n){this.imageData=t,this.x=e.Util.initValue(i,0),this.y=e.Util.initValue(r,0),this.d=e.Util.initValue(n,2),this.vectors=[],this.setVectors()},h.prototype.setVectors=function(){var e,t,i=this.imageData.width,r=this.imageData.height;for(e=0;i>e;e+=this.d)for(t=0;r>t;t+=this.d){var n=4*((t>>0)*i+(e>>0));this.imageData.data[n+3]>0&&this.vectors.push({x:e+this.x,y:t+this.y})}return this.vector},h.prototype.getBound=function(e,t){var i=4*((t>>0)*this.imageData.width+(e>>0));return this.imageData.data[i+3]>0?!0:!1},h.prototype.getPosition=function(){return this.vector.copy(this.vectors[Math.floor(Math.random()*this.vectors.length)])},h.prototype.getColor=function(t,i){t-=this.x,i-=this.y;var e=4*((i>>0)*this.imageData.width+(t>>0));return{r:this.imageData.data[e],g:this.imageData.data[e+1],b:this.imageData.data[e+2],a:this.imageData.data[e+3]}},h.prototype.crossing=function(e){"dead"==this.crossType?e.dead=this.getBound(e.p.x-this.x,e.p.y-this.y)?!0:!1:"bound"==this.crossType&&(this.getBound(e.p.x-this.x,e.p.y-this.y)||e.v.negate())},e.ImageZone=h;var I=function(){if(z.console&&z.console.log){var e=arguments;if("string"==typeof arguments[0])if(0==arguments[0].indexOf("+")){var t=parseInt(arguments[0]);I.once<t&&(delete e[0],console.log(e),I.once++)}else console.log(e);else console.log(e)}};I.once=0,e.log=I;var nt=nt||{addEventListener:function(t,i){t.addEventListener(e.PROTON_UPDATE,function(){i()})},setStyle:function(i){var r=i||"#ff0000",t=e.Util.hexToRGB(r),n="rgba("+t.r+","+t.g+","+t.b+",0.5)";return n},drawZone:function(a,n,i,s){var t=n.getContext("2d"),r=this.setStyle();this.addEventListener(a,function(){s&&t.clearRect(0,0,n.width,n.height),i instanceof e.PointZone?(t.beginPath(),t.fillStyle=r,t.arc(i.x,i.y,10,0,2*Math.PI,!0),t.fill(),t.closePath()):i instanceof e.LineZone?(t.beginPath(),t.strokeStyle=r,t.moveTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.stroke(),t.closePath()):i instanceof e.RectZone?(t.beginPath(),t.strokeStyle=r,t.drawRect(i.x,i.y,i.width,i.height),t.stroke(),t.closePath()):i instanceof e.CircleZone&&(t.beginPath(),t.strokeStyle=r,t.arc(i.x,i.y,i.radius,0,2*Math.PI,!0),t.stroke(),t.closePath())})},drawEmitter:function(r,t,i,n){var e=t.getContext("2d"),a=this.setStyle();this.addEventListener(r,function(){n&&e.clearRect(0,0,t.width,t.height),e.beginPath(),e.fillStyle=a,e.arc(i.p.x,i.p.y,10,0,2*Math.PI,!0),e.fill(),e.closePath()})},test:{},setTest:function(e,t){this.test[e]=t},getTest:function(e){return this.test.hasOwnProperty(e)?this.test[e]:!1}};e.Debug=nt}(window),!function(){for(var i=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(r){var e=(new Date).getTime(),t=Math.max(0,16-(e-i)),n=window.setTimeout(function(){r(e+t)},t);return i=e+t,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var r="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;if((r._gsQueue||(r._gsQueue=[])).push(function(){"use strict";r._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(n,u,t){var c=function(t){var e,i=[],r=t.length;for(e=0;e!==r;i.push(t[e++]));return i},e=function(i,r,n){t.call(this,i,r,n),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=e.prototype.render},r=1e-10,s=t._internals,p=s.isSelector,l=s.isArray,i=e.prototype=t.to({},.1,{}),a=[];e.version="1.13.1",i.constructor=e,i.kill()._gc=!1,e.killTweensOf=e.killDelayedCallsTo=t.killTweensOf,e.getTweensOf=t.getTweensOf,e.lagSmoothing=t.lagSmoothing,e.ticker=t.ticker,e.render=t.render,i.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),t.prototype.invalidate.call(this)},i.updateTo=function(r,n){var i,s=this.ratio;n&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(i in r)this.vars[i]=r[i];if(this._initted)if(n)this._initted=!1;else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&t._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var o=this._time;this.render(0,!0,!1),this._initted=!1,this.render(o,!0,!1)}else if(this._time>0){this._initted=!1,this._init();for(var a,l=1/(1-s),e=this._firstPT;e;)a=e.s+e.c,e.c*=l,e.s=a-e.c,e=e._next}return this},i.render=function(t,c,o){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var u,h,n,_,e,d,p,m,v=this._dirty?this.totalDuration():this._totalDuration,g=this._time,f=this._totalTime,y=this._cycle,i=this._duration,l=this._rawPrevTime;if(t>=v?(this._totalTime=v,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=i,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(u=!0,h="onComplete"),0===i&&(this._initted||!this.vars.lazy||o)&&(this._startTime===this._timeline._duration&&(t=0),(0===t||0>l||l===r)&&l!==t&&(o=!0,l>r&&(h="onReverseComplete")),this._rawPrevTime=m=!c||t||l===t?t:r)):1e-7>t?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==f||0===i&&l>0&&l!==r)&&(h="onReverseComplete",u=this._reversed),0>t?(this._active=!1,0===i&&(this._initted||!this.vars.lazy||o)&&(l>=0&&(o=!0),this._rawPrevTime=m=!c||t||l===t?t:r)):this._initted||(o=!0)):(this._totalTime=this._time=t,0!==this._repeat&&(_=i+this._repeatDelay,this._cycle=this._totalTime/_>>0,0!==this._cycle&&this._cycle===this._totalTime/_&&this._cycle--,this._time=this._totalTime-this._cycle*_,this._yoyo&&0!==(1&this._cycle)&&(this._time=i-this._time),this._time>i?this._time=i:0>this._time&&(this._time=0)),this._easeType?(e=this._time/i,d=this._easeType,p=this._easePower,(1===d||3===d&&e>=.5)&&(e=1-e),3===d&&(e*=2),1===p?e*=e:2===p?e*=e*e:3===p?e*=e*e*e:4===p&&(e*=e*e*e*e),this.ratio=1===d?1-e:2===d?e:.5>this._time/i?e/2:1-e/2):this.ratio=this._ease.getRatio(this._time/i)),g===this._time&&!o&&y===this._cycle)return void(f!==this._totalTime&&this._onUpdate&&(c||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||a)));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!o&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=g,this._totalTime=f,this._rawPrevTime=l,this._cycle=y,s.lazyTweens.push(this),void(this._lazy=t);this._time&&!u?this.ratio=this._ease.getRatio(this._time/i):u&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==g&&t>=0&&(this._active=!0),0===f&&(2===this._initted&&t>0&&this._init(),this._startAt&&(t>=0?this._startAt.render(t,c,o):h||(h="_dummyGS")),this.vars.onStart&&(0!==this._totalTime||0===i)&&(c||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||a))),n=this._firstPT;n;)n.f?n.t[n.p](n.c*this.ratio+n.s):n.t[n.p]=n.c*this.ratio+n.s,n=n._next;this._onUpdate&&(0>t&&this._startAt&&this._startTime&&this._startAt.render(t,c,o),c||(this._totalTime!==f||u)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||a)),this._cycle!==y&&(c||this._gc||this.vars.onRepeat&&this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||a)),h&&(!this._gc||o)&&(0>t&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(t,c,o),u&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!c&&this.vars[h]&&this.vars[h].apply(this.vars[h+"Scope"]||this,this.vars[h+"Params"]||a),0===i&&this._rawPrevTime===r&&m!==r&&(this._rawPrevTime=0))},e.to=function(t,i,r){return new e(t,i,r)},e.from=function(i,r,t){return t.runBackwards=!0,t.immediateRender=0!=t.immediateRender,new e(i,r,t)},e.fromTo=function(r,n,i,t){return t.startAt=i,t.immediateRender=0!=t.immediateRender&&0!=i.immediateRender,new e(r,n,t)},e.staggerTo=e.allTo=function(i,m,r,u,d,y,g){u=u||0;var h,s,n,o,f=r.delay||0,_=[],v=function(){r.onComplete&&r.onComplete.apply(r.onCompleteScope||this,arguments),d.apply(g||this,y||a)};for(l(i)||("string"==typeof i&&(i=t.selector(i)||i),p(i)&&(i=c(i))),h=i.length,n=0;h>n;n++){s={};for(o in r)s[o]=r[o];s.delay=f,n===h-1&&d&&(s.onComplete=v),_[n]=new e(i[n],m,s),f+=u}return _},e.staggerFrom=e.allFrom=function(i,r,t,n,a,s,o){return t.runBackwards=!0,t.immediateRender=0!=t.immediateRender,e.staggerTo(i,r,t,n,a,s,o)},e.staggerFromTo=e.allFromTo=function(r,n,i,t,a,s,o,l){return t.startAt=i,t.immediateRender=0!=t.immediateRender&&0!=i.immediateRender,e.staggerTo(r,n,t,a,s,o,l)},e.delayedCall=function(n,t,i,r,a){return new e(t,0,{delay:n,onComplete:t,onCompleteParams:i,onCompleteScope:r,onReverseComplete:t,onReverseCompleteParams:i,onReverseCompleteScope:r,immediateRender:!1,useFrames:a,overwrite:0})},e.set=function(t,i){return new e(t,0,i)},e.isTweening=function(e){return t.getTweensOf(e,!0).length>0};var o=function(a,n){for(var i=[],r=0,e=a._first;e;)e instanceof t?i[r++]=e:(n&&(i[r++]=e),i=i.concat(o(e,n)),r=i.length),e=e._next;return i},d=e.getAllTweens=function(e){return o(n._rootTimeline,e).concat(o(n._rootFramesTimeline,e))};e.killAll=function(o,t,i,n){null==t&&(t=!0),null==i&&(i=!0);var a,e,r,s=d(0!=n),l=s.length,c=t&&i&&n;for(r=0;l>r;r++)e=s[r],(c||e instanceof u||(a=e.target===e.vars.onComplete)&&i||t&&!a)&&(o?e.totalTime(e._reversed?0:e.totalDuration()):e._enabled(!1,!1))},e.killChildTweensOf=function(i,u){if(null!=i){var n,a,o,r,d,h=s.tweenLookup;if("string"==typeof i&&(i=t.selector(i)||i),p(i)&&(i=c(i)),l(i))for(r=i.length;--r>-1;)e.killChildTweensOf(i[r],u);else{n=[];for(o in h)for(a=h[o].target.parentNode;a;)a===i&&(n=n.concat(h[o].tweens)),a=a.parentNode;for(d=n.length,r=0;d>r;r++)u&&n[r].totalTime(n[r].totalDuration()),n[r]._enabled(!1,!1)}}};var h=function(o,t,i,r){t=t!==!1,i=i!==!1,r=r!==!1;for(var n,e,a=d(r),l=t&&i&&r,s=a.length;--s>-1;)e=a[s],(l||e instanceof u||(n=e.target===e.vars.onComplete)&&i||t&&!n)&&e.paused(o)};return e.pauseAll=function(e,t,i){h(!0,e,t,i)},e.resumeAll=function(e,t,i){h(!1,e,t,i)},e.globalTimeScale=function(i){var e=n._rootTimeline,a=t.ticker.time;return arguments.length?(i=i||r,e._startTime=a-(a-e._startTime)*e._timeScale/i,e=n._rootFramesTimeline,a=t.ticker.frame,e._startTime=a-(a-e._startTime)*e._timeScale/i,e._timeScale=n._rootTimeline._timeScale=i,i):e._timeScale},i.progress=function(e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},i.totalProgress=function(e){return arguments.length?this.totalTime(this.totalDuration()*e,!1):this._totalTime/this.totalDuration()},i.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!==(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},i.duration=function(e){return arguments.length?n.prototype.duration.call(this,e):this._duration},i.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},i.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},i.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},i.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},e},!0),r._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(o,s,t){var i=function(r){s.call(this,r),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var t,i,e=this.vars;for(i in e)t=e[i],n(t)&&-1!==t.join("").indexOf("{self}")&&(e[i]=this._swapSelfInParams(t));n(e.tweens)&&this.add(e.tweens,0,e.align,e.stagger)},a=1e-10,l=t._internals,f=l.isSelector,n=l.isArray,p=l.lazyTweens,u=l.lazyRender,c=[],h=r._gsDefine.globals,d=function(t){var e,i={};for(e in t)i[e]=t[e];return i},_=function(e,t,i,r){e._timeline.pause(e._startTime),t&&t.apply(r||e._timeline,i||c)},m=function(t){var e,i=[],r=t.length;for(e=0;e!==r;i.push(t[e++]));return i},e=i.prototype=new s;return i.version="1.13.1",e.constructor=i,e.kill()._gc=!1,e.to=function(i,r,e,n){var a=e.repeat&&h.TweenMax||t;return r?this.add(new a(i,r,e),n):this.set(i,e,n)},e.from=function(i,r,e,n){return this.add((e.repeat&&h.TweenMax||t).from(i,r,e),n)},e.fromTo=function(i,r,a,e,n){var s=e.repeat&&h.TweenMax||t;return r?this.add(s.fromTo(i,r,a,e),n):this.set(i,e,n)},e.staggerTo=function(e,o,n,a,l,c,h,u){var r,s=new i({onComplete:c,onCompleteParams:h,onCompleteScope:u,smoothChildTiming:this.smoothChildTiming});for("string"==typeof e&&(e=t.selector(e)||e),f(e)&&(e=m(e)),a=a||0,r=0;e.length>r;r++)n.startAt&&(n.startAt=d(n.startAt)),s.to(e[r],o,d(n),r*a);return this.add(s,l)},e.staggerFrom=function(t,i,e,r,n,a,s,o){return e.immediateRender=0!=e.immediateRender,e.runBackwards=!0,this.staggerTo(t,i,e,r,n,a,s,o)},e.staggerFromTo=function(i,r,t,e,n,a,s,o,l){return e.startAt=t,e.immediateRender=0!=e.immediateRender&&0!=t.immediateRender,this.staggerTo(i,r,e,n,a,s,o,l)},e.call=function(e,i,r,n){return this.add(t.delayedCall(0,e,i,r),n)},e.set=function(r,i,e){return e=this._parseTimeOrLabel(e,0,!0),null==i.immediateRender&&(i.immediateRender=e===this._time&&!this._paused),this.add(new t(r,0,i),e)},i.exportRoot=function(n,s){n=n||{},null==n.smoothChildTiming&&(n.smoothChildTiming=!0);var e,o,r=new i(n),a=r._timeline;for(null==s&&(s=!0),a._remove(r,!0),r._startTime=0,r._rawPrevTime=r._time=r._totalTime=a._time,e=a._first;e;)o=e._next,s&&e instanceof t&&e.target===e.vars.onComplete||r.add(e,e._startTime-e._delay),e=o;return a.add(r,0),r},e.add=function(e,l,c,d){var h,p,u,r,a,f;if("number"!=typeof l&&(l=this._parseTimeOrLabel(l,0,!0,e)),!(e instanceof o)){if(e instanceof Array||e&&e.push&&n(e)){for(c=c||"normal",d=d||0,h=l,p=e.length,u=0;p>u;u++)n(r=e[u])&&(r=new i({tweens:r})),this.add(r,h),"string"!=typeof r&&"function"!=typeof r&&("sequence"===c?h=r._startTime+r.totalDuration()/r._timeScale:"start"===c&&(r._startTime-=r.delay())),h+=d;return this._uncache(!0)}if("string"==typeof e)return this.addLabel(e,l);if("function"!=typeof e)throw"Cannot add "+e+" into the timeline; it is not a tween, timeline, function, or string.";e=t.delayedCall(0,e)}if(s.prototype.add.call(this,e,l),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(a=this,f=a.rawTime()>e._startTime;a._timeline;)f&&a._timeline.smoothChildTiming?a.totalTime(a._totalTime,!0):a._gc&&a._enabled(!0,!1),a=a._timeline;return this},e.remove=function(e){if(e instanceof o)return this._remove(e,!1);if(e instanceof Array||e&&e.push&&n(e)){for(var t=e.length;--t>-1;)this.remove(e[t]);return this}return"string"==typeof e?this.removeLabel(e):this.kill(null,e)},e._remove=function(t,i){s.prototype._remove.call(this,t,i);var e=this._last;return e?this._time>e._startTime+e._totalDuration/e._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},e.append=function(e,t){return this.add(e,this._parseTimeOrLabel(null,t,!0,e))},e.insert=e.insertMultiple=function(e,t,i,r){return this.add(e,t||0,i,r)},e.appendMultiple=function(e,t,i,r){return this.add(e,this._parseTimeOrLabel(null,t,!0,e),i,r)},e.addLabel=function(e,t){return this._labels[e]=this._parseTimeOrLabel(t),this},e.addPause=function(e,t,i,r){return this.call(_,["{self}",t,i,r],this,e)},e.removeLabel=function(e){return delete this._labels[e],this},e.getLabelTime=function(e){return null!=this._labels[e]?this._labels[e]:-1},e._parseTimeOrLabel=function(e,r,a,t){var i;if(t instanceof o&&t.timeline===this)this.remove(t);else if(t&&(t instanceof Array||t.push&&n(t)))for(i=t.length;--i>-1;)t[i]instanceof o&&t[i].timeline===this&&this.remove(t[i]);if("string"==typeof r)return this._parseTimeOrLabel(r,a&&"number"==typeof e&&null==this._labels[r]?e-this.duration():0,a);if(r=r||0,"string"!=typeof e||!isNaN(e)&&null==this._labels[e])null==e&&(e=this.duration());else{if(i=e.indexOf("="),-1===i)return null==this._labels[e]?a?this._labels[e]=this.duration()+r:r:this._labels[e]+r;r=parseInt(e.charAt(i-1)+"1",10)*Number(e.substr(i+1)),e=i>1?this._parseTimeOrLabel(e.substr(0,i-1),0,a):this.duration()}return Number(e)+r},e.seek=function(e,t){return this.totalTime("number"==typeof e?e:this._parseTimeOrLabel(e),t!==!1)},e.stop=function(){return this.paused(!0)},e.gotoAndPlay=function(e,t){return this.play(e,t)},e.gotoAndStop=function(e,t){return this.pause(e,t)},e.render=function(t,i,s){this._gc&&this._enabled(!0,!1);var e,d,o,r,l,h=this._dirty?this.totalDuration():this._totalDuration,n=this._time,_=this._startTime,m=this._timeScale,f=this._paused;if(t>=h?(this._totalTime=this._time=h,this._reversed||this._hasPausedChild()||(d=!0,r="onComplete",0===this._duration&&(0===t||0>this._rawPrevTime||this._rawPrevTime===a)&&this._rawPrevTime!==t&&this._first&&(l=!0,this._rawPrevTime>a&&(r="onReverseComplete"))),this._rawPrevTime=this._duration||!i||t||this._rawPrevTime===t?t:a,t=h+1e-4):1e-7>t?(this._totalTime=this._time=0,(0!==n||0===this._duration&&this._rawPrevTime!==a&&(this._rawPrevTime>0||0>t&&this._rawPrevTime>=0))&&(r="onReverseComplete",d=this._reversed),0>t?(this._active=!1,this._rawPrevTime>=0&&this._first&&(l=!0),this._rawPrevTime=t):(this._rawPrevTime=this._duration||!i||t||this._rawPrevTime===t?t:a,t=0,this._initted||(l=!0))):this._totalTime=this._time=this._rawPrevTime=t,this._time!==n&&this._first||s||l){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==n&&t>0&&(this._active=!0),0===n&&this.vars.onStart&&0!==this._time&&(i||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||c)),this._time>=n)for(e=this._first;e&&(o=e._next,!this._paused||f);)(e._active||e._startTime<=this._time&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(t-e._startTime)*e._timeScale,i,s):e.render((t-e._startTime)*e._timeScale,i,s)),e=o;else for(e=this._last;e&&(o=e._prev,!this._paused||f);)(e._active||n>=e._startTime&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(t-e._startTime)*e._timeScale,i,s):e.render((t-e._startTime)*e._timeScale,i,s)),e=o;this._onUpdate&&(i||(p.length&&u(),this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||c))),r&&(this._gc||(_===this._startTime||m!==this._timeScale)&&(0===this._time||h>=this.totalDuration())&&(d&&(p.length&&u(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!i&&this.vars[r]&&this.vars[r].apply(this.vars[r+"Scope"]||this,this.vars[r+"Params"]||c)))}},e._hasPausedChild=function(){for(var e=this._first;e;){if(e._paused||e instanceof i&&e._hasPausedChild())return!0;e=e._next}return!1},e.getChildren=function(o,a,s,r){r=r||-9999999999;for(var i=[],e=this._first,n=0;e;)r>e._startTime||(e instanceof t?a!==!1&&(i[n++]=e):(s!==!1&&(i[n++]=e),o!==!1&&(i=i.concat(e.getChildren(!0,a,s)),n=i.length))),e=e._next;return i},e.getTweensOf=function(a,s){var e,i,r=this._gc,n=[],o=0;for(r&&this._enabled(!0,!0),e=t.getTweensOf(a),i=e.length;--i>-1;)(e[i].timeline===this||s&&this._contains(e[i]))&&(n[o++]=e[i]);return r&&this._enabled(!1,!0),n},e._contains=function(t){for(var e=t.timeline;e;){if(e===this)return!0;e=e.timeline}return!1},e.shiftChildren=function(n,a,t){t=t||0;for(var i,e=this._first,r=this._labels;e;)e._startTime>=t&&(e._startTime+=n),e=e._next;if(a)for(i in r)r[i]>=t&&(r[i]+=n);return this._uncache(!0)},e._kill=function(t,e){if(!t&&!e)return this._enabled(!1,!1);for(var i=e?this.getTweensOf(e):this.getChildren(!0,!0,!1),r=i.length,n=!1;--r>-1;)i[r]._kill(t,e)&&(n=!0);return n},e.clear=function(i){var e=this.getChildren(!1,!0,!0),t=e.length;for(this._time=this._totalTime=0;--t>-1;)e[t]._enabled(!1,!1);return i!==!1&&(this._labels={}),this._uncache(!0)},e.invalidate=function(){for(var e=this._first;e;)e.invalidate(),e=e._next;return this},e._enabled=function(t,i){if(t===this._gc)for(var e=this._first;e;)e._enabled(t,!0),e=e._next;return s.prototype._enabled.call(this,t,i)},e.duration=function(e){return arguments.length?(0!==this.duration()&&0!==e&&this.timeScale(this._duration/e),this):(this._dirty&&this.totalDuration(),this._duration)},e.totalDuration=function(n){if(!arguments.length){if(this._dirty){for(var a,i,t=0,e=this._last,r=999999999999;e;)a=e._prev,e._dirty&&e.totalDuration(),e._startTime>r&&this._sortChildren&&!e._paused?this.add(e,e._startTime-e._delay):r=e._startTime,0>e._startTime&&!e._paused&&(t-=e._startTime,this._timeline.smoothChildTiming&&(this._startTime+=e._startTime/this._timeScale),this.shiftChildren(-e._startTime,!1,-9999999999),r=0),i=e._startTime+e._totalDuration/e._timeScale,i>t&&(t=i),e=a;this._duration=this._totalDuration=t,this._dirty=!1}return this._totalDuration}return 0!==this.totalDuration()&&0!==n&&this.timeScale(this._totalDuration/n),this},e.usesFrames=function(){for(var e=this._timeline;e._timeline;)e=e._timeline;return e===o._rootFramesTimeline},e.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},i},!0),r._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(n,a,c){var r=function(e){n.call(this,e),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},i=1e-10,t=[],s=a._internals,o=s.lazyTweens,l=s.lazyRender,h=new c(null,null,1,0),e=r.prototype=new n;return e.constructor=r,e.kill()._gc=!1,r.version="1.13.1",e.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),n.prototype.invalidate.call(this)},e.addCallback=function(e,t,i,r){return this.add(a.delayedCall(0,e,i,r),t)},e.removeCallback=function(e,r){if(e)if(null==r)this._kill(null,e);else for(var t=this.getTweensOf(e,!1),i=t.length,n=this._parseTimeOrLabel(r);--i>-1;)t[i]._startTime===n&&t[i]._enabled(!1,!1);return this},e.tweenTo=function(o,i){i=i||{};var n,s,e,r={ease:h,overwrite:i.delay?2:1,useFrames:this.usesFrames(),immediateRender:!1};for(s in i)r[s]=i[s];return r.time=this._parseTimeOrLabel(o),n=Math.abs(Number(r.time)-this._time)/this._timeScale||.001,e=new a(this,n,r),r.onStart=function(){e.target.paused(!0),e.vars.time!==e.target.time()&&n===e.duration()&&e.duration(Math.abs(e.vars.time-e.target.time())/e.target._timeScale),i.onStart&&i.onStart.apply(i.onStartScope||e,i.onStartParams||t)},e},e.tweenFromTo=function(t,r,e){e=e||{},t=this._parseTimeOrLabel(t),e.startAt={onComplete:this.seek,onCompleteParams:[t],onCompleteScope:this},e.immediateRender=e.immediateRender!==!1;var i=this.tweenTo(r,e);return i.duration(Math.abs(i.vars.time-t)/this._timeScale||.001)},e.render=function(r,a,d){this._gc&&this._enabled(!0,!1);var e,y,_,h,u,m,v=this._dirty?this.totalDuration():this._totalDuration,n=this._duration,c=this._time,g=this._totalTime,w=this._startTime,b=this._timeScale,s=this._rawPrevTime,x=this._paused,f=this._cycle;if(r>=v?(this._locked||(this._totalTime=v,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(y=!0,h="onComplete",0===this._duration&&(0===r||0>s||s===i)&&s!==r&&this._first&&(u=!0,s>i&&(h="onReverseComplete"))),this._rawPrevTime=this._duration||!a||r||this._rawPrevTime===r?r:i,this._yoyo&&0!==(1&this._cycle)?this._time=r=0:(this._time=n,r=n+1e-4)):1e-7>r?(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==c||0===n&&s!==i&&(s>0||0>r&&s>=0)&&!this._locked)&&(h="onReverseComplete",y=this._reversed),0>r?(this._active=!1,s>=0&&this._first&&(u=!0),this._rawPrevTime=r):(this._rawPrevTime=n||!a||r||this._rawPrevTime===r?r:i,r=0,this._initted||(u=!0))):(0===n&&0>s&&(u=!0),this._time=this._rawPrevTime=r,this._locked||(this._totalTime=r,0!==this._repeat&&(m=n+this._repeatDelay,this._cycle=this._totalTime/m>>0,0!==this._cycle&&this._cycle===this._totalTime/m&&this._cycle--,this._time=this._totalTime-this._cycle*m,this._yoyo&&0!==(1&this._cycle)&&(this._time=n-this._time),this._time>n?(this._time=n,r=n+1e-4):0>this._time?this._time=r=0:r=this._time))),this._cycle!==f&&!this._locked){var p=this._yoyo&&0!==(1&f),T=p===(this._yoyo&&0!==(1&this._cycle)),E=this._totalTime,C=this._cycle,S=this._rawPrevTime,A=this._time;if(this._totalTime=f*n,f>this._cycle?p=!p:this._totalTime+=n,this._time=c,this._rawPrevTime=0===n?s-1e-4:s,this._cycle=f,this._locked=!0,c=p?0:n,this.render(c,a,0===n),a||this._gc||this.vars.onRepeat&&this.vars.onRepeat.apply(this.vars.onRepeatScope||this,this.vars.onRepeatParams||t),T&&(c=p?n+1e-4:-1e-4,this.render(c,!0,!1)),this._locked=!1,this._paused&&!x)return;this._time=A,this._totalTime=E,this._cycle=C,this._rawPrevTime=S}if(!(this._time!==c&&this._first||d||u))return void(g!==this._totalTime&&this._onUpdate&&(a||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||t)));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==g&&r>0&&(this._active=!0),0===g&&this.vars.onStart&&0!==this._totalTime&&(a||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||t)),this._time>=c)for(e=this._first;e&&(_=e._next,!this._paused||x);)(e._active||e._startTime<=this._time&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(r-e._startTime)*e._timeScale,a,d):e.render((r-e._startTime)*e._timeScale,a,d)),e=_;else for(e=this._last;e&&(_=e._prev,!this._paused||x);)(e._active||c>=e._startTime&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(r-e._startTime)*e._timeScale,a,d):e.render((r-e._startTime)*e._timeScale,a,d)),e=_;this._onUpdate&&(a||(o.length&&l(),this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||t))),h&&(this._locked||this._gc||(w===this._startTime||b!==this._timeScale)&&(0===this._time||v>=this.totalDuration())&&(y&&(o.length&&l(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!a&&this.vars[h]&&this.vars[h].apply(this.vars[h+"Scope"]||this,this.vars[h+"Params"]||t)))},e.getActive=function(t,i,r){null==t&&(t=!0),null==i&&(i=!0),null==r&&(r=!1);var e,n,a=[],s=this.getChildren(t,i,r),o=0,l=s.length;for(e=0;l>e;e++)n=s[e],n.isActive()&&(a[o++]=n);return a},e.getLabelAfter=function(t){t||0!==t&&(t=this._time);var e,i=this.getLabelsArray(),r=i.length;for(e=0;r>e;e++)if(i[e].time>t)return i[e].name;return null},e.getLabelBefore=function(e){null==e&&(e=this._time);for(var t=this.getLabelsArray(),i=t.length;--i>-1;)if(e>t[i].time)return t[i].name;return null},e.getLabelsArray=function(){var e,t=[],i=0;for(e in this._labels)t[i++]={time:this._labels[e],name:e};return t.sort(function(e,t){return e.time-t.time}),t},e.progress=function(e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},e.totalProgress=function(e){return arguments.length?this.totalTime(this.totalDuration()*e,!1):this._totalTime/this.totalDuration()},e.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(n.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},e.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!==(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},e.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},e.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},e.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},e.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.getLabelBefore(this._time+1e-8)},r},!0),function(){var u=180/Math.PI,e=[],t=[],i=[],s={},a=function(e,t,i,r){this.a=e,this.b=t,this.c=i,this.d=r,this.da=r-e,this.ca=i-e,this.ba=t-e},_=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",o=function(n,u,d,s){var r={a:n},e={},t={},i={c:s},l=(n+u)/2,h=(u+d)/2,c=(d+s)/2,o=(l+h)/2,a=(h+c)/2,p=(a-o)/8;return r.b=l+(n-l)/4,e.b=o+p,r.c=e.a=(r.b+e.b)/2,e.c=t.a=(o+a)/2,t.b=a-p,i.b=c+(s-c)/4,t.c=i.a=(t.b+i.b)/2,[r,e,t,i]},m=function(u,_,w,b,T){var c,h,n,v,r,d,p,g,x,s,f,m,y,E=u.length-1,l=0,a=u[0].a;for(c=0;E>c;c++)r=u[l],h=r.a,n=r.d,v=u[l+1].d,T?(f=e[c],m=t[c],y=.25*(m+f)*_/(b?.5:i[c]||.5),d=n-(n-h)*(b?.5*_:0!==f?y/f:0),p=n+(v-n)*(b?.5*_:0!==m?y/m:0),g=n-(d+((p-d)*(3*f/(f+m)+.5)/4||0))):(d=n-.5*(n-h)*_,p=n+.5*(v-n)*_,g=n-(d+p)/2),d+=g,p+=g,r.c=x=d,r.b=0!==c?a:a=r.a+.6*(r.c-r.a),r.da=n-h,r.ca=x-h,r.ba=a-h,w?(s=o(h,a,x,n),u.splice(l,1,s[0],s[1],s[2],s[3]),l+=4):l++,a=p;r=u[l],r.b=a,r.c=a+.4*(r.d-a),r.da=r.d-r.a,r.ca=r.c-r.a,r.ba=a-r.a,w&&(s=o(r.a,a,r.c,r.d),u.splice(l,1,s[0],s[1],s[2],s[3]))},h=function(r,n,p,u){var l,i,c,s,d,h,o=[];if(u)for(r=[u].concat(r),i=r.length;--i>-1;)"string"==typeof(h=r[i][n])&&"="===h.charAt(1)&&(r[i][n]=u[n]+Number(h.charAt(0)+h.substr(2)));if(l=r.length-2,0>l)return o[0]=new a(r[0][n],0,0,r[-1>l?0:1][n]),o;for(i=0;l>i;i++)c=r[i][n],s=r[i+1][n],o[i]=new a(c,0,0,s),p&&(d=r[i+2][n],e[i]=(e[i]||0)+(s-c)*(s-c),t[i]=(t[i]||0)+(d-s)*(d-s));return o[i]=new a(r[i][n],0,0,r[i+1][n]),o},c=function(a,g,w,b,d,u){var r,n,c,o,y,v,p,x,f={},l=[],T=u||a[0];d="string"==typeof d?","+d+",":_,null==g&&(g=1);for(n in a[0])l.push(n);if(a.length>1){for(x=a[a.length-1],p=!0,r=l.length;--r>-1;)if(n=l[r],Math.abs(T[n]-x[n])>.05){p=!1;break}p&&(a=a.concat(),u&&a.unshift(u),a.push(a[1]),u=a[a.length-3])}for(e.length=t.length=i.length=0,r=l.length;--r>-1;)n=l[r],s[n]=-1!==d.indexOf(","+n+","),f[n]=h(a,n,s[n],u);for(r=e.length;--r>-1;)e[r]=Math.sqrt(e[r]),t[r]=Math.sqrt(t[r]);if(!b){for(r=l.length;--r>-1;)if(s[n])for(c=f[l[r]],v=c.length-1,o=0;v>o;o++)y=c[o+1].da/t[o]+c[o].da/e[o],i[o]=(i[o]||0)+y*y;for(r=i.length;--r>-1;)i[r]=Math.sqrt(i[r])}for(r=l.length,o=w?4:1;--r>-1;)n=l[r],c=f[n],m(c,g,w,b,s[n]),p&&(c.splice(0,o),c.splice(c.length-o,o));return f},d=function(r,h,p){h=h||"soft";var s,u,d,g,t,f,e,c,n,i,o,m={},l="cubic"===h?3:2,y="soft"===h,_=[];if(y&&p&&(r=[p].concat(r)),null==r||l+1>r.length)throw"invalid Bezier data";for(n in r[0])_.push(n);for(f=_.length;--f>-1;){for(n=_[f],m[n]=t=[],i=0,c=r.length,e=0;c>e;e++)s=null==p?r[e][n]:"string"==typeof(o=r[e][n])&&"="===o.charAt(1)?p[n]+Number(o.charAt(0)+o.substr(2)):Number(o),y&&e>1&&c-1>e&&(t[i++]=(s+t[i-2])/2),t[i++]=s;for(c=i-l+1,i=0,e=0;c>e;e+=l)s=t[e],u=t[e+1],d=t[e+2],g=2===l?0:t[e+3],t[i++]=o=3===l?new a(s,u,d,g):new a(s,(2*u+s)/3,(2*u+d)/3,d);t.length=i}return m},p=function(p,d,s){for(var r,o,n,h,u,f,e,t,l,i,c,_=1/s,a=p.length;--a>-1;)for(i=p[a],n=i.a,h=i.d-n,u=i.c-n,f=i.b-n,r=o=0,t=1;s>=t;t++)e=_*t,l=1-e,r=o-(o=(e*e*h+3*l*(e*u+l*f))*e),c=a*s+t-1,d[c]=(d[c]||0)+r*r},f=function(u,i){i=i>>0||6;var c,e,l,t,n=[],o=[],r=0,s=0,d=i-1,h=[],a=[];for(c in u)p(u[c],n,i);for(l=n.length,e=0;l>e;e++)r+=Math.sqrt(n[e]),t=e%i,a[t]=r,t===d&&(s+=r,t=e/i>>0,h[t]=a,o[t]=s,r=0,a=[]);return{length:s,lengths:o,segments:h}},n=r._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.3",API:2,global:!0,init:function(r,t,p){this._target=r,t instanceof Array&&(t={values:t}),this._func={},this._round={},this._props=[],this._timeRes=null==t.timeResolution?6:parseInt(t.timeResolution,10);var e,u,n,a,l,o=t.values||[],s={},_=o[0],i=t.autoRotate||p.vars.orientToBezier;this._autoRotate=i?i instanceof Array?i:[["x","y","rotation",i===!0?0:Number(i)||0]]:null;for(e in _)this._props.push(e);for(n=this._props.length;--n>-1;)e=this._props[n],this._overwriteProps.push(e),u=this._func[e]="function"==typeof r[e],s[e]=u?r[e.indexOf("set")||"function"!=typeof r["get"+e.substr(3)]?e:"get"+e.substr(3)]():parseFloat(r[e]),l||s[e]!==o[0][e]&&(l=s);if(this._beziers="cubic"!==t.type&&"quadratic"!==t.type&&"soft"!==t.type?c(o,isNaN(t.curviness)?1:t.curviness,!1,"thruBasic"===t.type,t.correlate,l):d(o,t.type,s),this._segCount=this._beziers[e].length,this._timeRes){var h=f(this._beziers,this._timeRes);this._length=h.length,this._lengths=h.lengths,this._segments=h.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(i=this._autoRotate)for(this._initialRotations=[],i[0]instanceof Array||(this._autoRotate=i=[i]),n=i.length;--n>-1;){for(a=0;3>a;a++)e=i[n][a],this._func[e]="function"==typeof r[e]?r[e.indexOf("set")||"function"!=typeof r["get"+e.substr(3)]?e:"get"+e.substr(3)]:!1;e=i[n][2],this._initialRotations[n]=this._func[e]?this._func[e].call(this._target):this._target[e]}return this._startRatio=p.vars.runBackwards?1:0,!0},set:function(t){var l,v,e,s,i,r,o,_,d,a,h=this._segCount,x=this._func,g=this._target,T=t!==this._startRatio;if(this._timeRes){if(d=this._lengths,a=this._curSeg,t*=this._length,e=this._li,t>this._l2&&h-1>e){for(_=h-1;_>e&&t>=(this._l2=d[++e]););this._l1=d[e-1],this._li=e,this._curSeg=a=this._segments[e],this._s2=a[this._s1=this._si=0]}else if(this._l1>t&&e>0){for(;e>0&&(this._l1=d[--e])>=t;);0===e&&this._l1>t?this._l1=0:e++,this._l2=d[e],this._li=e,this._curSeg=a=this._segments[e],this._s1=a[(this._si=a.length-1)-1]||0,this._s2=a[this._si]}if(l=e,t-=this._l1,e=this._si,t>this._s2&&a.length-1>e){for(_=a.length-1;_>e&&t>=(this._s2=a[++e]););this._s1=a[e-1],this._si=e}else if(this._s1>t&&e>0){for(;e>0&&(this._s1=a[--e])>=t;);0===e&&this._s1>t?this._s1=0:e++,this._s2=a[e],this._si=e}r=(e+(t-this._s1)/(this._s2-this._s1))*this._prec}else l=0>t?0:t>=1?h-1:h*t>>0,r=(t-l*(1/h))*h;for(v=1-r,e=this._props.length;--e>-1;)s=this._props[e],i=this._beziers[s][l],o=(r*r*i.da+3*v*(r*i.ca+v*i.ba))*r+i.a,this._round[s]&&(o=Math.round(o)),x[s]?g[s](o):g[s]=o;if(this._autoRotate){var n,y,m,f,p,b,w,c=this._autoRotate;for(e=c.length;--e>-1;)s=c[e][2],b=c[e][3]||0,w=c[e][4]===!0?1:u,i=this._beziers[c[e][0]],n=this._beziers[c[e][1]],i&&n&&(i=i[l],n=n[l],y=i.a+(i.b-i.a)*r,f=i.b+(i.c-i.b)*r,y+=(f-y)*r,f+=(i.c+(i.d-i.c)*r-f)*r,m=n.a+(n.b-n.a)*r,p=n.b+(n.c-n.b)*r,m+=(p-m)*r,p+=(n.c+(n.d-n.c)*r-p)*r,o=T?Math.atan2(p-m,f-y)*w+b:this._initialRotations[e],x[s]?g[s](o):g[s]=o)}}}),l=n.prototype;n.bezierThrough=c,n.cubicToQuadratic=o,n._autoCSS=!0,n.quadraticToCubic=function(e,t,i){return new a(e,(2*t+e)/3,(2*t+i)/3,i)},n._cssRegister=function(){var t=r._gsDefine.globals.CSSPlugin;if(t){var e=t._internals,i=e._parseToProxy,a=e._setPluginRatio,s=e.CSSPropTween;e._registerComplexSpecialProp("bezier",{parser:function(f,l,m,c,o,h){l instanceof Array&&(l={values:l}),h=new n;var t,u,r,p=l.values,d=p.length-1,_=[],e={};if(0>d)return o;for(t=0;d>=t;t++)r=i(f,p[t],c,o,h,d!==t),_[t]=r.end;for(u in l)e[u]=l[u];return e.values=_,o=new s(f,"bezier",0,0,r.pt,2),o.data=r,o.plugin=h,o.setRatio=a,0===e.autoRotate&&(e.autoRotate=!0),!e.autoRotate||e.autoRotate instanceof Array||(t=e.autoRotate===!0?0:Number(e.autoRotate),e.autoRotate=null!=r.end.left?[["left","top","rotation",t,!1]]:null!=r.end.x?[["x","y","rotation",t,!1]]:!1),e.autoRotate&&(c._transform||c._enableTransforms(!1),r.autoRotate=c._target._gsTransform),h._onInitTween(r.proxy,e,c._tween),o}})}},l._roundProps=function(e,r){for(var t=this._overwriteProps,i=t.length;--i>-1;)(e[t[i]]||e.bezier||e.bezierThrough)&&(this._round[t[i]]=r)},l._kill=function(r){var e,t,i=this._props;for(e in this._beziers)if(e in r)for(delete this._beziers[e],delete this._func[e],t=i.length;--t>-1;)i[t]===e&&i.splice(t,1);return this._super._kill.call(this,r)}}(),r._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(R,O){var T,L,n,G,a=function(){R.call(this,"css"),this._overwriteProps.length=0,this.setRatio=a.prototype.setRatio},f={},e=a.prototype=new R("css");e.constructor=a,a.version="1.13.1",a.API=2,a.defaultTransformPerspective=0,a.defaultSkewType="compensated",e="px",a.suffixMap={top:e,right:e,bottom:e,left:e,width:e,height:e,fontSize:e,padding:e,margin:e,perspective:e,lineHeight:""};var W,gt,H,_t,ft,A,P=/(?:\d|\-\d|\.\d|\-\.\d)+/g,pt=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,B=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,z=/[^\d\-\.]/g,Q=/(?:\d|\-|\+|=|#|\.)*/g,K=/opacity *= *([^)]*)/i,Ct=/opacity:([^;]*)/i,Et=/alpha\(opacity *=.+?\)/i,ot=/^(rgb|hsl)/,lt=/([A-Z])/g,ut=/-([a-z])/gi,wt=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,tt=function(t,e){return e.toUpperCase()},vt=/(?:Left|Right|Width)/i,Rt=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,Tt=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,d=/,(?=[^\)]*(?:\(|$))/gi,h=Math.PI/180,b=180/Math.PI,D={},y=document,m=y.createElement("div"),F=y.createElement("img"),u=a._internals={_specialProps:f},g=navigator.userAgent,v=function(){var e,t=g.indexOf("Android"),i=y.createElement("div");return H=-1!==g.indexOf("Safari")&&-1===g.indexOf("Chrome")&&(-1===t||Number(g.substr(t+8,1))>3),ft=H&&6>Number(g.substr(g.indexOf("Version/")+8,1)),_t=-1!==g.indexOf("Firefox"),/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(g)&&(A=parseFloat(RegExp.$1)),i.innerHTML="<a style='top:1px;opacity:.55;'>a</a>",e=i.getElementsByTagName("a")[0],e?/^0.55/.test(e.style.opacity):!1}(),nt=function(e){return K.test("string"==typeof e?e:(e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100:1},ct=function(e){window.console&&console.log(e)},dt="",et="",k=function(e,i){i=i||m;var r,t,n=i.style;if(void 0!==n[e])return e;for(e=e.charAt(0).toUpperCase()+e.substr(1),r=["O","Moz","ms","Ms","Webkit"],t=5;--t>-1&&void 0===n[r[t]+e];);return t>=0?(et=3===t?"ms":r[t],dt="-"+et.toLowerCase()+"-",et+e):null},M=y.defaultView?y.defaultView.getComputedStyle:function(){},i=a.getStyle=function(i,t,r,a,n){var e;return v||"opacity"!==t?(!a&&i.style[t]?e=i.style[t]:(r=r||M(i))?e=r[t]||r.getPropertyValue(t)||r.getPropertyValue(t.replace(lt,"-$1").toLowerCase()):i.currentStyle&&(e=i.currentStyle[t]),null==n||e&&"none"!==e&&"auto"!==e&&"auto auto"!==e?e:n):nt(i)},p=u.convertToPixels=function(o,h,e,t,f){if("px"===t||!t)return e;if("auto"===t||!e)return 0;var s,r,c,l=vt.test(h),n=o,u=m.style,d=0>e;if(d&&(e=-e),"%"===t&&-1!==h.indexOf("border"))s=e/100*(l?o.clientWidth:o.clientHeight);else{if(u.cssText="border:0 solid red;position:"+i(o,"position")+";line-height:0;","%"!==t&&n.appendChild)u[l?"borderLeftWidth":"borderTopWidth"]=e+t;else{if(n=o.parentNode||y.body,r=n._gsCache,c=O.ticker.frame,r&&l&&r.time===c)return r.width*e/100;u[l?"width":"height"]=e+t}n.appendChild(m),s=parseFloat(m[l?"offsetWidth":"offsetHeight"]),n.removeChild(m),l&&"%"===t&&a.cacheWidths!==!1&&(r=n._gsCache=n._gsCache||{},r.time=c,r.width=100*(s/e)),0!==s||f||(s=p(o,h,e,t,!0))}return d?-s:s},st=u.calculateOffset=function(e,t,r){if("absolute"!==i(e,"position",r))return 0;var n="left"===t?"Left":"Top",a=i(e,"margin"+n,r);return e["offset"+n]-(p(e,t,parseFloat(a),a.replace(Q,""))||0)},C=function(n,t){var i,r,e={};if(t=t||M(n,null))if(i=t.length)for(;--i>-1;)e[t[i].replace(ut,tt)]=t.getPropertyValue(t[i]);else for(i in t)e[i]=t[i];else if(t=n.currentStyle||n.style)for(i in t)"string"==typeof i&&void 0===e[i]&&(e[i.replace(ut,tt)]=t[i]);return v||(e.opacity=nt(n)),r=E(n,t,!1),e.rotation=r.rotation,e.skewX=r.skewX,e.scaleX=r.scaleX,e.scaleY=r.scaleY,e.x=r.x,e.y=r.y,_&&(e.z=r.z,e.rotationX=r.rotationX,e.rotationY=r.rotationY,e.scaleZ=r.scaleZ),e.filters&&delete e.filters,e},Z=function(o,i,l,r,c){var t,e,n,a={},s=o.style;for(e in l)"cssText"!==e&&"length"!==e&&isNaN(e)&&(i[e]!==(t=l[e])||c&&c[e])&&-1===e.indexOf("Origin")&&("number"==typeof t||"string"==typeof t)&&(a[e]="auto"!==t||"left"!==e&&"top"!==e?""!==t&&"auto"!==t&&"none"!==t||"string"!=typeof i[e]||""===i[e].replace(z,"")?t:0:st(o,e),void 0!==s[e]&&(n=new X(s,e,s[e],n)));if(r)for(e in r)"className"!==e&&(a[e]=r[e]);return{difs:a,firstMPT:n}},Mt={width:["Left","Right"],height:["Top","Bottom"]},Ot=["marginLeft","marginRight","marginTop","marginBottom"],At=function(e,s,t){var r=parseFloat("width"===s?e.offsetWidth:e.offsetHeight),n=Mt[s],a=n.length;for(t=t||M(e,null);--a>-1;)r-=parseFloat(i(e,"padding"+n[a],t,!0))||0,r-=parseFloat(i(e,"border"+n[a]+"Width",t,!0))||0;return r},$=function(e,r){(null==e||""===e||"auto"===e||"auto auto"===e)&&(e="0 0");var n=e.split(" "),t=-1!==e.indexOf("left")?"0%":-1!==e.indexOf("right")?"100%":n[0],i=-1!==e.indexOf("top")?"0%":-1!==e.indexOf("bottom")?"100%":n[1];return null==i?i="0":"center"===i&&(i="50%"),("center"===t||isNaN(parseFloat(t))&&-1===(t+"").indexOf("="))&&(t="50%"),r&&(r.oxp=-1!==t.indexOf("%"),r.oyp=-1!==i.indexOf("%"),r.oxr="="===t.charAt(1),r.oyr="="===i.charAt(1),r.ox=parseFloat(t.replace(z,"")),r.oy=parseFloat(i.replace(z,""))),t+" "+i+(n.length>2?" "+n[2]:"")},rt=function(e,t){return"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(t)},c=function(e,t){return null==e?t:"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*Number(e.substr(2))+t:parseFloat(e)},S=function(i,n,l,s){var t,a,e,r,o=1e-6;return null==i?r=n:"number"==typeof i?r=i:(t=360,a=i.split("_"),e=Number(a[0].replace(z,""))*(-1===i.indexOf("rad")?1:b)-("="===i.charAt(1)?0:n),a.length&&(s&&(s[l]=n+e),-1!==i.indexOf("short")&&(e%=t,e!==e%(t/2)&&(e=0>e?e+t:e-t)),-1!==i.indexOf("_cw")&&0>e?e=(e+9999999999*t)%t-(0|e/t)*t:-1!==i.indexOf("ccw")&&e>0&&(e=(e-9999999999*t)%t-(0|e/t)*t)),r=n+e),o>r&&r>-o&&(r=0),r},w={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},J=function(e,t,i){return e=0>e?e+1:e>1?e-1:e,0|255*(1>6*e?t+6*(i-t)*e:.5>e?i:2>3*e?t+6*(i-t)*(2/3-e):t)+.5},q=function(e){var i,t,s,n,a,r;return e&&""!==e?"number"==typeof e?[e>>16,255&e>>8,255&e]:(","===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),w[e]?w[e]:"#"===e.charAt(0)?(4===e.length&&(i=e.charAt(1),t=e.charAt(2),s=e.charAt(3),e="#"+i+i+t+t+s+s),e=parseInt(e.substr(1),16),[e>>16,255&e>>8,255&e]):"hsl"===e.substr(0,3)?(e=e.match(P),n=Number(e[0])%360/360,a=Number(e[1])/100,r=Number(e[2])/100,t=.5>=r?r*(a+1):r+a-r*a,i=2*r-t,e.length>3&&(e[3]=Number(e[3])),e[0]=J(n+1/3,i,t),e[1]=J(n,i,t),e[2]=J(n-1/3,i,t),e):(e=e.match(P)||w.transparent,e[0]=Number(e[0]),e[1]=Number(e[1]),e[2]=Number(e[2]),e.length>3&&(e[3]=Number(e[3])),e)):w.black},x="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(e in w)x+="|"+e+"\\b";x=RegExp(x+")","gi");var ht=function(e,o,h,a){if(null==e)return function(e){return e};var r,s=o?(e.match(x)||[""])[0]:"",i=e.split(s).join("").match(B)||[],l=e.substr(0,e.indexOf(i[0])),c=")"===e.charAt(e.length-1)?")":"",n=-1!==e.indexOf(" ")?" ":",",t=i.length,u=t>0?i[0].replace(P,""):"";return t?r=o?function(o){var _,p,e,f;if("number"==typeof o)o+=u;else if(a&&d.test(o)){for(f=o.replace(d,"|").split("|"),e=0;f.length>e;e++)f[e]=r(f[e]);return f.join(",")}if(_=(o.match(x)||[s])[0],p=o.split(_).join("").match(B)||[],e=p.length,t>e--)for(;t>++e;)p[e]=h?p[0|(e-1)/2]:i[e];return l+p.join(n)+n+_+c+(-1!==o.indexOf("inset")?" inset":"")}:function(s){var o,p,e;if("number"==typeof s)s+=u;else if(a&&d.test(s)){for(p=s.replace(d,"|").split("|"),e=0;p.length>e;e++)p[e]=r(p[e]);return p.join(",")}if(o=s.match(B)||[],e=o.length,t>e--)for(;t>++e;)o[e]=h?o[0|(e-1)/2]:i[e];return l+o.join(n)+c}:function(e){return e}},Y=function(e){return e=e.split(","),function(n,a,c,s,o,l,i){var t,r=(a+"").split(" ");for(i={},t=0;4>t;t++)i[e[t]]=r[t]=r[t]||r[(t-1)/2>>0];return s.parse(n,i,o,l)}},X=(u._setPluginRatio=function(s){this.plugin.setRatio(s);for(var i,e,r,a,n=this.data,o=n.proxy,t=n.firstMPT,l=1e-6;t;)i=o[t.v],t.r?i=Math.round(i):l>i&&i>-l&&(i=0),t.t[t.p]=i,t=t._next;if(n.autoRotate&&(n.autoRotate.rotation=o.rotation),1===s)for(t=n.firstMPT;t;){if(e=t.t,e.type){if(1===e.type){for(a=e.xs0+e.s+e.xs1,r=1;e.l>r;r++)a+=e["xn"+r]+e["xs"+(r+1)];e.e=a}}else e.e=e.s+e.xs0;t=t._next}},function(t,i,r,e,n){this.t=t,this.p=i,this.v=r,this.r=n,e&&(e._prev=this,this._next=e)}),s=(u._parseToProxy=function(p,u,a,e,d,s){var o,t,i,r,h,n=e,l={},c={},f=a._transform,_=D;for(a._transform=null,D=u,e=h=a.parse(p,u,e,d),D=_,s&&(a._transform=f,n&&(n._prev=null,n._prev&&(n._prev._next=null)));e&&e!==n;){if(1>=e.type&&(t=e.p,c[t]=e.s+e.c,l[t]=e.s,s||(r=new X(e,"s",t,r,e.r),e.c=0),1===e.type))for(o=e.l;--o>0;)i="xn"+o,t=e.p+"_"+i,c[t]=e.data[i],l[t]=e[i],s||(r=new X(e,i,t,r,e.rxp[i]));e=e._next}return{proxy:l,end:c,firstMPT:r,pt:h}},u.CSSPropTween=function(i,a,e,r,t,u,h,c,l,o,n){this.t=i,this.p=a,this.s=e,this.c=r,this.n=h||a,i instanceof s||G.push(this.n),this.r=c,this.type=u||0,l&&(this.pr=l,T=!0),this.b=void 0===o?e:o,this.e=void 0===n?e+r:n,t&&(this._next=t,t._prev=this)}),j=a.parseComplex=function(k,C,u,_,M,T,e,A,S,b){u=u||T||"",e=new s(k,C,0,0,e,b?2:1,null,!1,A,u,_),_+="";var r,c,h,t,i,g,y,f,l,x,o,a,n=u.split(", ").join(",").split(" "),p=_.split(", ").join(",").split(" "),m=n.length,E=W!==!1;for((-1!==_.indexOf(",")||-1!==u.indexOf(","))&&(n=n.join(" ").replace(d,", ").split(" "),p=p.join(" ").replace(d,", ").split(" "),m=n.length),m!==p.length&&(n=(T||"").split(" "),m=n.length),e.plugin=S,e.setRatio=b,r=0;m>r;r++)if(t=n[r],i=p[r],f=parseFloat(t),f||0===f)e.appendXtra("",f,rt(i,f),i.replace(pt,""),E&&-1!==i.indexOf("px"),!0);else if(M&&("#"===t.charAt(0)||w[t]||ot.test(t)))a=","===i.charAt(i.length-1)?"),":")",t=q(t),i=q(i),l=t.length+i.length>6,l&&!v&&0===i[3]?(e["xs"+e.l]+=e.l?" transparent":"transparent",e.e=e.e.split(p[r]).join("transparent")):(v||(l=!1),e.appendXtra(l?"rgba(":"rgb(",t[0],i[0]-t[0],",",!0,!0).appendXtra("",t[1],i[1]-t[1],",",!0).appendXtra("",t[2],i[2]-t[2],l?",":a,!0),l&&(t=4>t.length?1:t[3],e.appendXtra("",t,(4>i.length?1:i[3])-t,a,!1)));else if(g=t.match(P)){if(y=i.match(pt),!y||y.length!==g.length)return e;for(h=0,c=0;g.length>c;c++)o=g[c],x=t.indexOf(o,h),e.appendXtra(t.substr(h,x-h),Number(o),rt(y[c],o),"",E&&"px"===t.substr(x+o.length,2),0===c),h=x+o.length;e["xs"+e.l]+=t.substr(h)}else e["xs"+e.l]+=e.l?" "+t:t;if(-1!==_.indexOf("=")&&e.data){for(a=e.xs0+e.data.s,r=1;e.l>r;r++)a+=e["xs"+r]+e.data["xn"+r];e.e=a+e["xs"+r]}return e.l||(e.type=-1,e.xs0=e.e),e.xfirst||e},o=9;for(e=s.prototype,e.l=e.pr=0;--o>0;)e["xn"+o]=0,e["xs"+o]="";e.xs0="",e._next=e._prev=e.xfirst=e.data=e.plugin=e.setRatio=e.rxp=null,e.appendXtra=function(a,i,r,o,n,l){var e=this,t=e.l;return e["xs"+t]+=l&&t?" "+a:a||"",r||0===t||e.plugin?(e.l++,e.type=e.setRatio?2:1,e["xs"+e.l]=o||"",t>0?(e.data["xn"+t]=i+r,e.rxp["xn"+t]=n,e["xn"+t]=i,e.plugin||(e.xfirst=new s(e,"xn"+t,i,r,e.xfirst||e,0,e.n,n,e.pr),e.xfirst.xs0=0),e):(e.data={s:i+r},e.rxp={},e.s=i,e.c=r,e.r=n,e)):(e["xs"+t]+=i+(o||""),e)};var mt=function(t,e){e=e||{},this.p=e.prefix?k(t)||t:t,f[t]=f[this.p]=this,this.format=e.formatter||ht(e.defaultValue,e.color,e.collapsible,e.multi),e.parser&&(this.parse=e.parser),this.clrs=e.color,this.multi=e.multi,this.keyword=e.keyword,this.dflt=e.defaultValue,this.pr=e.priority||0},t=u._registerComplexSpecialProp=function(a,e,i){"object"!=typeof e&&(e={parser:i});var t,s,r=a.split(","),n=e.defaultValue;for(i=i||[n],t=0;r.length>t;t++)e.prefix=0===t&&e.prefix,e.defaultValue=i[t]||n,s=new mt(r[t],e)},xt=function(e){if(!f[e]){var i=e.charAt(0).toUpperCase()+e.substr(1)+"Plugin";t(e,{parser:function(a,s,e,o,t,l,c){var n=(r.GreenSockGlobals||r).com.greensock.plugins[i];return n?(n._cssRegister(),f[e].parse(a,s,e,o,t,l,c)):(ct("Error: "+i+" js file not loaded."),t)}})}};e=mt.prototype,e.parseComplex=function(p,n,e,u,h,c){var i,r,t,o,l,s,a=this.keyword;if(this.multi&&(d.test(e)||d.test(n)?(r=n.replace(d,"|").split("|"),t=e.replace(d,"|").split("|")):a&&(r=[n],t=[e])),t){for(o=t.length>r.length?t.length:r.length,i=0;o>i;i++)n=r[i]=r[i]||this.dflt,e=t[i]=t[i]||this.dflt,a&&(l=n.indexOf(a),s=e.indexOf(a),l!==s&&(e=-1===s?t:r,e[i]+=" "+a));n=r.join(", "),e=t.join(", ")}return j(p,this.p,n,e,this.clrs,this.dflt,u,this.pr,h,c)},e.parse=function(e,t,s,o,r,a){return this.parseComplex(e.style,this.format(i(e,this.p,n,!1,this.dflt)),this.format(t),r,a)},a.registerSpecialProp=function(i,r,e){t(i,{parser:function(n,a,t,o,l,c){var i=new s(n,t,0,0,l,2,t,!1,e);return i.plugin=c,i.setRatio=r(n,a,o._tween,t),i},priority:e})};var yt="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),l=k("transform"),bt=dt+"transform",V=k("transformOrigin"),_=null!==k("perspective"),at=u.Transform=function(){this.skewY=0},E=u.getTransform=function(m,Q,P,J){if(m._gsTransform&&P&&!J)return m._gsTransform;var o,t,v,R,X,L,D,w,y,q,Y,z,N,e=P?m._gsTransform||new at:new at,nt=0>e.scaleX,M=2e-5,u=1e5,k=179.99,E=k*h,rt=_?parseFloat(i(m,V,Q,!1,"0 0 0").split(" ")[2])||e.zOrigin||0:0;if(l?o=i(m,bt,Q,!0):m.currentStyle&&(o=m.currentStyle.filter.match(Rt),o=o&&4===o.length?[o[0].substr(4),Number(o[2].substr(4)),Number(o[1].substr(4)),o[3].substr(4),e.x||0,e.y||0].join(","):""),o&&"none"!==o&&"matrix(1, 0, 0, 1, 0, 0)"!==o){for(t=(o||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],v=t.length;--v>-1;)R=Number(t[v]),t[v]=(X=R-(R|=0))?(0|X*u+(0>X?-.5:.5))/u+R:R;if(16===t.length){var C=t[8],p=t[9],c=t[10],tt=t[12],Z=t[13],S=t[14];if(e.zOrigin&&(S=-e.zOrigin,tt=C*S-t[12],Z=p*S-t[13],S=c*S+e.zOrigin-t[14]),!P||J||null==e.rotationX){var j,A,W,s,n,K,H,T=t[0],f=t[1],F=t[2],st=t[3],B=t[4],d=t[5],x=t[6],it=t[7],g=t[11],r=Math.atan2(x,c),$=-E>r||r>E;e.rotationX=r*b,r&&(s=Math.cos(-r),n=Math.sin(-r),j=B*s+C*n,A=d*s+p*n,W=x*s+c*n,C=B*-n+C*s,p=d*-n+p*s,c=x*-n+c*s,g=it*-n+g*s,B=j,d=A,x=W),r=Math.atan2(C,T),e.rotationY=r*b,r&&(K=-E>r||r>E,s=Math.cos(-r),n=Math.sin(-r),j=T*s-C*n,A=f*s-p*n,W=F*s-c*n,p=f*n+p*s,c=F*n+c*s,g=st*n+g*s,T=j,f=A,F=W),r=Math.atan2(f,d),e.rotation=r*b,r&&(H=-E>r||r>E,s=Math.cos(-r),n=Math.sin(-r),T=T*s+B*n,A=f*s+d*n,d=f*-n+d*s,x=F*-n+x*s,f=A),H&&$?e.rotation=e.rotationX=0:H&&K?e.rotation=e.rotationY=0:K&&$&&(e.rotationY=e.rotationX=0),e.scaleX=(0|Math.sqrt(T*T+f*f)*u+.5)/u,e.scaleY=(0|Math.sqrt(d*d+p*p)*u+.5)/u,e.scaleZ=(0|Math.sqrt(x*x+c*c)*u+.5)/u,e.skewX=0,e.perspective=g?1/(0>g?-g:g):0,e.x=tt,e.y=Z,e.z=S}}else if(!(_&&!J&&t.length&&e.x===t[4]&&e.y===t[5]&&(e.rotationX||e.rotationY)||void 0!==e.x&&"none"===i(m,"display",Q))){var et=t.length>=6,U=et?t[0]:1,I=t[1]||0,O=t[2]||0,G=et?t[3]:1;e.x=t[4]||0,e.y=t[5]||0,L=Math.sqrt(U*U+I*I),D=Math.sqrt(G*G+O*O),w=U||I?Math.atan2(I,U)*b:e.rotation||0,y=O||G?Math.atan2(O,G)*b+w:e.skewX||0,q=L-Math.abs(e.scaleX||0),Y=D-Math.abs(e.scaleY||0),Math.abs(y)>90&&270>Math.abs(y)&&(nt?(L*=-1,y+=0>=w?180:-180,w+=0>=w?180:-180):(D*=-1,y+=0>=y?180:-180)),z=(w-e.rotation)%180,N=(y-e.skewX)%180,(void 0===e.skewX||q>M||-M>q||Y>M||-M>Y||z>-k&&k>z&&!1|z*u||N>-k&&k>N&&!1|N*u)&&(e.scaleX=L,e.scaleY=D,e.rotation=w,e.skewX=y),_&&(e.rotationX=e.rotationY=e.z=0,e.perspective=parseFloat(a.defaultTransformPerspective)||0,e.scaleZ=1)}e.zOrigin=rt;for(v in e)M>e[v]&&e[v]>-M&&(e[v]=0)}else e={x:0,y:0,z:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,perspective:0,rotation:0,rotationX:0,rotationY:0,zOrigin:0};return P&&(m._gsTransform=e),e.xPercent=e.yPercent=0,e},St=function(C){var d,_,e=this.data,x=-e.rotation*h,E=x+e.skewX*h,a=1e5,s=(0|Math.cos(x)*e.scaleX*a)/a,n=(0|Math.sin(x)*e.scaleX*a)/a,r=(0|Math.sin(E)*-e.scaleY*a)/a,l=(0|Math.cos(E)*e.scaleY*a)/a,y=this.t.style,v=this.t.currentStyle;if(v){_=n,n=-r,r=-_,d=v.filter,y.filter="";var t,i,c=this.t.offsetWidth,u=this.t.offsetHeight,b="absolute"!==v.position,m="progid:DXImageTransform.Microsoft.Matrix(M11="+s+", M12="+n+", M21="+r+", M22="+l,w=e.x+c*e.xPercent/100,T=e.y+u*e.yPercent/100;if(null!=e.ox&&(t=(e.oxp?.01*c*e.ox:e.ox)-c/2,i=(e.oyp?.01*u*e.oy:e.oy)-u/2,w+=t-(t*s+i*n),T+=i-(t*r+i*l)),b?(t=c/2,i=u/2,m+=", Dx="+(t-(t*s+i*n)+w)+", Dy="+(i-(t*r+i*l)+T)+")"):m+=", sizingMethod='auto expand')",y.filter=-1!==d.indexOf("DXImageTransform.Microsoft.Matrix(")?d.replace(Tt,m):m+" "+d,(0===C||1===C)&&1===s&&0===n&&0===r&&1===l&&(b&&-1===m.indexOf("Dx=0, Dy=0")||K.test(d)&&100!==parseFloat(RegExp.$1)||-1===d.indexOf("gradient("&&d.indexOf("Alpha"))&&y.removeAttribute("filter")),!b){var g,f,S,M=8>A?1:-1;for(t=e.ieOffsetX||0,i=e.ieOffsetY||0,e.ieOffsetX=Math.round((c-((0>s?-s:s)*c+(0>n?-n:n)*u))/2+w),e.ieOffsetY=Math.round((u-((0>l?-l:l)*u+(0>r?-r:r)*c))/2+T),o=0;4>o;o++)f=Ot[o],g=v[f],_=-1!==g.indexOf("px")?parseFloat(g):p(this.t,f,parseFloat(g),g.replace(Q,""))||0,S=_!==e[f]?2>o?-e.ieOffsetX:-e.ieOffsetY:2>o?t-e.ieOffsetX:i-e.ieOffsetY,y[f]=(e[f]=Math.round(_-S*(0===o||2===o?1:M)))+"px"}}},U=u.set3DTransformRatio=function(R){var w,v,y,m,b,x,p,f,M,T,d,s,A,E,_,S,t,r,i,n,j,I,P,e=this.data,L=this.t.style,a=e.rotation*h,o=e.scaleX,c=e.scaleY,u=e.scaleZ,O=e.x,D=e.y,k=e.z,g=e.perspective;if(!(1!==R&&0!==R||"auto"!==e.force3D||e.rotationY||e.rotationX||1!==u||g||k))return void it.call(this,R);if(_t){var C=1e-4;C>o&&o>-C&&(o=u=2e-5),C>c&&c>-C&&(c=u=2e-5),!g||e.z||e.rotationX||e.rotationY||(g=0)}if(a||e.skewX)r=Math.cos(a),i=Math.sin(a),w=r,b=i,e.skewX&&(a-=e.skewX*h,r=Math.cos(a),i=Math.sin(a),"simple"===e.skewType&&(n=Math.tan(e.skewX*h),n=Math.sqrt(1+n*n),r*=n,i*=n)),v=-i,x=r;else{if(!(e.rotationY||e.rotationX||1!==u||g))return void(L[l]=(e.xPercent||e.yPercent?"translate("+e.xPercent+"%,"+e.yPercent+"%) translate3d(":"translate3d(")+O+"px,"+D+"px,"+k+"px)"+(1!==o||1!==c?" scale("+o+","+c+")":""));w=x=1,v=b=0}d=1,y=m=p=f=M=T=s=A=E=0,_=g?-1/g:0,S=e.zOrigin,t=1e5,a=e.rotationY*h,a&&(r=Math.cos(a),i=Math.sin(a),M=d*-i,A=_*-i,y=w*i,p=b*i,d*=r,_*=r,w*=r,b*=r),a=e.rotationX*h,a&&(r=Math.cos(a),i=Math.sin(a),n=v*r+y*i,j=x*r+p*i,I=T*r+d*i,P=E*r+_*i,y=v*-i+y*r,p=x*-i+p*r,d=T*-i+d*r,_=E*-i+_*r,v=n,x=j,T=I,E=P),1!==u&&(y*=u,p*=u,d*=u,_*=u),1!==c&&(v*=c,x*=c,T*=c,E*=c),1!==o&&(w*=o,b*=o,M*=o,A*=o),S&&(s-=S,m=y*s,f=p*s,s=d*s+S),m=(n=(m+=O)-(m|=0))?(0|n*t+(0>n?-.5:.5))/t+m:m,f=(n=(f+=D)-(f|=0))?(0|n*t+(0>n?-.5:.5))/t+f:f,s=(n=(s+=k)-(s|=0))?(0|n*t+(0>n?-.5:.5))/t+s:s,L[l]=(e.xPercent||e.yPercent?"translate("+e.xPercent+"%,"+e.yPercent+"%) matrix3d(":"matrix3d(")+[(0|w*t)/t,(0|b*t)/t,(0|M*t)/t,(0|A*t)/t,(0|v*t)/t,(0|x*t)/t,(0|T*t)/t,(0|E*t)/t,(0|y*t)/t,(0|p*t)/t,(0|d*t)/t,(0|_*t)/t,m,f,s,g?1+-s/g:1].join(",")+")"},it=u.set2DTransformRatio=function(s){var i,a,t,n,r,e=this.data,d=this.t,o=d.style,c=e.x,u=e.y;return e.rotationX||e.rotationY||e.z||e.force3D===!0||"auto"===e.force3D&&1!==s&&0!==s?(this.setRatio=U,void U.call(this,s)):void(e.rotation||e.skewX?(i=e.rotation*h,a=i-e.skewX*h,t=1e5,n=e.scaleX*t,r=e.scaleY*t,o[l]=(e.xPercent||e.yPercent?"translate("+e.xPercent+"%,"+e.yPercent+"%) matrix(":"matrix(")+(0|Math.cos(i)*n)/t+","+(0|Math.sin(i)*n)/t+","+(0|Math.sin(a)*-r)/t+","+(0|Math.cos(a)*r)/t+","+c+","+u+")"):o[l]=(e.xPercent||e.yPercent?"translate("+e.xPercent+"%,"+e.yPercent+"%) matrix(":"matrix(")+e.scaleX+",0,0,"+e.scaleY+","+c+","+u+")")};t("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent",{parser:function(w,R,u,x,r,k,M){if(x._transform)return r;var o,b,d,h,g,v,p,t=x._transform=E(w,n,!0,M.parseTransform),T=w.style,C=1e-6,A=yt.length,e=M,f={};if("string"==typeof e.transform&&l)d=m.style,d[l]=e.transform,d.display="block",d.position="absolute",y.body.appendChild(m),o=E(m,null,!1),y.body.removeChild(m);else if("object"==typeof e){if(o={scaleX:c(null!=e.scaleX?e.scaleX:e.scale,t.scaleX),scaleY:c(null!=e.scaleY?e.scaleY:e.scale,t.scaleY),scaleZ:c(e.scaleZ,t.scaleZ),x:c(e.x,t.x),y:c(e.y,t.y),z:c(e.z,t.z),xPercent:c(e.xPercent,t.xPercent),yPercent:c(e.yPercent,t.yPercent),perspective:c(e.transformPerspective,t.perspective)},p=e.directionalRotation,null!=p)if("object"==typeof p)for(d in p)e[d]=p[d];else e.rotation=p;"string"==typeof e.x&&-1!==e.x.indexOf("%")&&(o.x=0,o.xPercent=c(e.x,t.xPercent)),"string"==typeof e.y&&-1!==e.y.indexOf("%")&&(o.y=0,o.yPercent=c(e.y,t.yPercent)),o.rotation=S("rotation"in e?e.rotation:"shortRotation"in e?e.shortRotation+"_short":"rotationZ"in e?e.rotationZ:t.rotation,t.rotation,"rotation",f),_&&(o.rotationX=S("rotationX"in e?e.rotationX:"shortRotationX"in e?e.shortRotationX+"_short":t.rotationX||0,t.rotationX,"rotationX",f),o.rotationY=S("rotationY"in e?e.rotationY:"shortRotationY"in e?e.shortRotationY+"_short":t.rotationY||0,t.rotationY,"rotationY",f)),o.skewX=null==e.skewX?t.skewX:S(e.skewX,t.skewX),o.skewY=null==e.skewY?t.skewY:S(e.skewY,t.skewY),(b=o.skewY-t.skewY)&&(o.skewX+=b,o.rotation+=b)}for(_&&null!=e.force3D&&(t.force3D=e.force3D,v=!0),t.skewType=e.skewType||t.skewType||a.defaultSkewType,g=t.force3D||t.z||t.rotationX||t.rotationY||o.z||o.rotationX||o.rotationY||o.perspective,g||null==e.scale||(o.scaleZ=1);--A>-1;)u=yt[A],h=o[u]-t[u],(h>C||-C>h||null!=D[u])&&(v=!0,r=new s(t,u,t[u],h,r),u in f&&(r.e=f[u]),r.xs0=0,r.plugin=k,x._overwriteProps.push(r.n));return h=e.transformOrigin,(h||_&&g&&t.zOrigin)&&(l?(v=!0,u=V,h=(h||i(w,u,n,!1,"50% 50%"))+"",r=new s(T,u,0,0,r,-1,"transformOrigin"),r.b=T[u],r.plugin=k,_?(d=t.zOrigin,h=h.split(" "),t.zOrigin=(h.length>2&&(0===d||"0px"!==h[2])?parseFloat(h[2]):d)||0,r.xs0=r.e=h[0]+" "+(h[1]||"50%")+" 0px",r=new s(t,"zOrigin",0,0,r,-1,r.n),r.b=d,r.xs0=r.e=t.zOrigin):r.xs0=r.e=h):$(h+"",t)),v&&(x._transformType=g||3===this._transformType?3:2),r},prefix:!0}),t("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),t("borderRadius",{defaultValue:"0px",parser:function(l,m,T,C,v){m=this.format(m);var b,s,y,r,e,t,f,o,x,w,a,h,_,d,u,g,c=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],E=l.style;for(x=parseFloat(l.offsetWidth),w=parseFloat(l.offsetHeight),b=m.split(" "),s=0;c.length>s;s++)this.p.indexOf("border")&&(c[s]=k(c[s])),e=r=i(l,c[s],n,!1,"0px"),-1!==e.indexOf(" ")&&(r=e.split(" "),e=r[0],r=r[1]),t=y=b[s],f=parseFloat(e),h=e.substr((f+"").length),_="="===t.charAt(1),_?(o=parseInt(t.charAt(0)+"1",10),t=t.substr(2),o*=parseFloat(t),a=t.substr((o+"").length-(0>o?1:0))||""):(o=parseFloat(t),a=t.substr((o+"").length)),""===a&&(a=L[T]||h),a!==h&&(d=p(l,"borderLeft",f,h),u=p(l,"borderTop",f,h),"%"===a?(e=100*(d/x)+"%",r=100*(u/w)+"%"):"em"===a?(g=p(l,"borderLeft",1,"em"),e=d/g+"em",r=u/g+"em"):(e=d+"px",r=u+"px"),_&&(t=parseFloat(e)+o+a,y=parseFloat(r)+o+a)),v=j(E,c[s],e+" "+r,t+" "+y,!1,"0px",v);return v},prefix:!0,formatter:ht("0px 0px 0px 0px",!1,!0)}),t("backgroundPosition",{defaultValue:"0 0",parser:function(t,f,m,g,p,_){var s,d,r,l,u,o,c="background-position",a=n||M(t,null),e=this.format((a?A?a.getPropertyValue(c+"-x")+" "+a.getPropertyValue(c+"-y"):a.getPropertyValue(c):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),h=this.format(f);if(-1!==e.indexOf("%")!=(-1!==h.indexOf("%"))&&(o=i(t,"backgroundImage").replace(wt,""),o&&"none"!==o)){for(s=e.split(" "),d=h.split(" "),F.setAttribute("src",o),r=2;--r>-1;)e=s[r],l=-1!==e.indexOf("%"),l!==(-1!==d[r].indexOf("%"))&&(u=0===r?t.offsetWidth-F.width:t.offsetHeight-F.height,s[r]=l?parseFloat(e)/100*u+"px":100*(parseFloat(e)/u)+"%");e=s.join(" ")}return this.parseComplex(t.style,e,h,p,_)},formatter:$}),t("backgroundSize",{defaultValue:"0 0",formatter:$}),t("perspective",{defaultValue:"0px",prefix:!0}),t("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),t("transformStyle",{prefix:!0}),t("backfaceVisibility",{prefix:!0}),t("userSelect",{prefix:!0}),t("margin",{parser:Y("marginTop,marginRight,marginBottom,marginLeft")}),t("padding",{parser:Y("paddingTop,paddingRight,paddingBottom,paddingLeft")}),t("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(a,e,c,h,o,l){var s,t,r;return 9>A?(t=a.currentStyle,r=8>A?" ":",",s="rect("+t.clipTop+r+t.clipRight+r+t.clipBottom+r+t.clipLeft+")",e=this.format(e).split(",").join(r)):(s=this.format(i(a,this.p,n,!1,this.dflt)),e=this.format(e)),this.parseComplex(a.style,s,e,o,l)}}),t("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),t("autoRound,strictUnits",{parser:function(t,i,r,n,e){return e}}),t("border",{defaultValue:"0px solid #000",parser:function(e,t,s,o,r,a){return this.parseComplex(e.style,this.format(i(e,"borderTopWidth",n,!1,"0px")+" "+i(e,"borderTopStyle",n,!1,"solid")+" "+i(e,"borderTopColor",n,!1,"#000")),this.format(t),r,a)},color:!0,formatter:function(e){var t=e.split(" ");return t[0]+" "+(t[1]||"solid")+" "+(e.match(x)||["#000"])[0]}}),t("borderWidth",{parser:Y("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),t("float,cssFloat,styleFloat",{parser:function(i,r,n,o,a){var e=i.style,t="cssFloat"in e?"cssFloat":"styleFloat";return new s(e,t,0,0,a,-1,n,!1,0,e[t],r)}});var kt=function(a){var n,t=this.t,e=t.filter||i(this.data,"filter"),r=0|this.s+this.c*a;100===r&&(-1===e.indexOf("atrix(")&&-1===e.indexOf("radient(")&&-1===e.indexOf("oader(")?(t.removeAttribute("filter"),n=!i(this.data,"filter")):(t.filter=e.replace(Et,""),n=!0)),n||(this.xn1&&(t.filter=e=e||"alpha(opacity="+r+")"),-1===e.indexOf("pacity")?0===r&&this.xn1||(t.filter=e+" alpha(opacity="+r+")"):t.filter=e.replace(K,"opacity="+r))};t("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(a,t,c,h,e,u){var r=parseFloat(i(a,"opacity",n,!1,"1")),o=a.style,l="autoAlpha"===c;return"string"==typeof t&&"="===t.charAt(1)&&(t=("-"===t.charAt(0)?-1:1)*parseFloat(t.substr(2))+r),l&&1===r&&"hidden"===i(a,"visibility",n)&&0!==t&&(r=0),v?e=new s(o,"opacity",r,t-r,e):(e=new s(o,"opacity",100*r,100*(t-r),e),e.xn1=l?1:0,o.zoom=1,e.type=2,e.b="alpha(opacity="+e.s+")",e.e="alpha(opacity="+(e.s+e.c)+")",e.data=a,e.plugin=u,e.setRatio=kt),l&&(e=new s(o,"visibility",0,0,e,-1,null,!1,0,0!==r?"inherit":"hidden",0===t?"hidden":"inherit"),e.xs0="inherit",h._overwriteProps.push(e.n),h._overwriteProps.push(c)),e}});var N=function(t,e){e&&(t.removeProperty?("ms"===e.substr(0,2)&&(e="M"+e.substr(1)),t.removeProperty(e.replace(lt,"-$1").toLowerCase())):t.removeAttribute(e))},Lt=function(t){if(this.t._gsClassPT=this,1===t||0===t){this.t.setAttribute("class",0===t?this.b:this.e);for(var e=this.data,i=this.t.style;e;)e.v?i[e.p]=e.v:N(i,e.p),e=e._next;1===t&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};t("className",{parser:function(t,r,f,c,e,p,d){var a,u,h,l,i,o=t.getAttribute("class")||"",_=t.style.cssText;if(e=c._classNamePT=new s(t,f,0,0,e,2),e.setRatio=Lt,e.pr=-11,T=!0,e.b=o,u=C(t,n),h=t._gsClassPT){for(l={},i=h.data;i;)l[i.p]=1,i=i._next;h.setRatio(1)}return t._gsClassPT=e,e.e="="!==r.charAt(1)?r:o.replace(RegExp("\\s*\\b"+r.substr(2)+"\\b"),"")+("+"===r.charAt(0)?" "+r.substr(2):""),c._tween._duration&&(t.setAttribute("class",e.e),a=Z(t,u,C(t),d,l),t.setAttribute("class",o),e.data=a.firstMPT,t.style.cssText=_,e=e.xfirst=c.parse(t,a.difs,e,p)),e}});var Pt=function(a){if((1===a||0===a)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var t,e,i,r,n=this.t.style,s=f.transform.parse;if("all"===this.e)n.cssText="",r=!0;else for(t=this.e.split(","),i=t.length;--i>-1;)e=t[i],f[e]&&(f[e].parse===s?r=!0:e="transformOrigin"===e?V:f[e].p),N(n,e);r&&(N(n,l),this.t._gsTransform&&delete this.t._gsTransform)}};for(t("clearProps",{parser:function(t,i,r,n,e){return e=new s(t,r,0,0,e,2),e.setRatio=Pt,e.e=i,e.pr=-10,e.data=n._tween,T=!0,e}}),e="bezier,throwProps,physicsProps,physics2D".split(","),o=e.length;o--;)xt(e[o]);e=a.prototype,e._firstPT=null,e._onInitTween=function(r,h,y){if(!r.nodeType)return!1;this._target=r,this._tween=y,this._vars=h,W=h.autoRound,T=!1,L=h.suffixMap||a.suffixMap,n=M(r,""),G=this._overwriteProps;var c,t,e,u,m,g,p,d,f,o=r.style;if(gt&&""===o.zIndex&&(c=i(r,"zIndex",n),("auto"===c||""===c)&&this._addLazySet(o,"zIndex",0)),"string"==typeof h&&(u=o.cssText,c=C(r,n),o.cssText=u+";"+h,c=Z(r,c,C(r)).difs,!v&&Ct.test(h)&&(c.opacity=parseFloat(RegExp.$1)),h=c,o.cssText=u),this._firstPT=t=this.parse(r,h,null),this._transformType){for(f=3===this._transformType,l?H&&(gt=!0,""===o.zIndex&&(p=i(r,"zIndex",n),("auto"===p||""===p)&&this._addLazySet(o,"zIndex",0)),ft&&this._addLazySet(o,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(f?"visible":"hidden"))):o.zoom=1,e=t;e&&e._next;)e=e._next;d=new s(r,"transform",0,0,null,2),this._linkCSSP(d,null,e),d.setRatio=f&&_?U:l?it:St,d.data=this._transform||E(r,n,!0),G.pop()}if(T){for(;t;){for(g=t._next,e=u;e&&e.pr>t.pr;)e=e._next;(t._prev=e?e._prev:m)?t._prev._next=t:u=t,(t._next=e)?e._prev=t:m=t,t=g}this._firstPT=u}return!0},e.parse=function(h,d,o,m){var e,v,r,a,c,t,u,l,_,g,y=h.style;for(e in d)t=d[e],v=f[e],v?o=v.parse(h,t,e,this,o,m,d):(c=i(h,e,n)+"",_="string"==typeof t,"color"===e||"fill"===e||"stroke"===e||-1!==e.indexOf("Color")||_&&ot.test(t)?(_||(t=q(t),t=(t.length>3?"rgba(":"rgb(")+t.join(",")+")"),o=j(y,e,c,t,!0,"transparent",o,0,m)):!_||-1===t.indexOf(" ")&&-1===t.indexOf(",")?(r=parseFloat(c),u=r||0===r?c.substr((r+"").length):"",(""===c||"auto"===c)&&("width"===e||"height"===e?(r=At(h,e,n),u="px"):"left"===e||"top"===e?(r=st(h,e,n),u="px"):(r="opacity"!==e?0:1,u="")),g=_&&"="===t.charAt(1),g?(a=parseInt(t.charAt(0)+"1",10),t=t.substr(2),a*=parseFloat(t),l=t.replace(Q,"")):(a=parseFloat(t),l=_?t.substr((a+"").length)||"":""),""===l&&(l=e in L?L[e]:u),t=a||0===a?(g?a+r:a)+l:d[e],u!==l&&""!==l&&(a||0===a)&&r&&(r=p(h,e,r,u),"%"===l?(r/=p(h,e,100,"%")/100,d.strictUnits!==!0&&(c=r+"%")):"em"===l?r/=p(h,e,1,"em"):"px"!==l&&(a=p(h,e,a,l),l="px"),g&&(a||0===a)&&(t=a+r+l)),g&&(a+=r),!r&&0!==r||!a&&0!==a?void 0!==y[e]&&(t||"NaN"!=t+""&&null!=t)?(o=new s(y,e,a||r||0,0,o,-1,e,!1,0,c,t),o.xs0="none"!==t||"display"!==e&&-1===e.indexOf("Style")?t:c):ct("invalid "+e+" tween value: "+d[e]):(o=new s(y,e,r,a-r,o,0,e,W!==!1&&("px"===l||"zIndex"===e),0,c,t),o.xs0=l)):o=j(y,e,c,t,!0,null,o,0,m)),m&&o&&!o.plugin&&(o.plugin=m);return o},e.setRatio=function(r){var t,n,i,e=this._firstPT,a=1e-6;if(1!==r||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(r||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;e;){if(t=e.c*r+e.s,e.r?t=Math.round(t):a>t&&t>-a&&(t=0),e.type)if(1===e.type)if(i=e.l,2===i)e.t[e.p]=e.xs0+t+e.xs1+e.xn1+e.xs2;else if(3===i)e.t[e.p]=e.xs0+t+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3;else if(4===i)e.t[e.p]=e.xs0+t+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3+e.xn3+e.xs4;else if(5===i)e.t[e.p]=e.xs0+t+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3+e.xn3+e.xs4+e.xn4+e.xs5;else{for(n=e.xs0+t+e.xs1,i=1;e.l>i;i++)n+=e["xn"+i]+e["xs"+(i+1)];e.t[e.p]=n}else-1===e.type?e.t[e.p]=e.xs0:e.setRatio&&e.setRatio(r);else e.t[e.p]=t+e.xs0;e=e._next}else for(;e;)2!==e.type?e.t[e.p]=e.b:e.setRatio(r),e=e._next;else for(;e;)2!==e.type?e.t[e.p]=e.e:e.setRatio(r),e=e._next},e._enableTransforms=function(e){this._transformType=e||3===this._transformType?3:2,this._transform=this._transform||E(this._target,n,!0)};var It=function(){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};e._addLazySet=function(t,i,r){var e=this._firstPT=new s(t,i,0,0,this._firstPT,2);e.e=r,e.setRatio=It,e.data=this},e._linkCSSP=function(e,t,i,r){return e&&(t&&(t._prev=e),e._next&&(e._next._prev=e._prev),e._prev?e._prev._next=e._next:this._firstPT===e&&(this._firstPT=e._next,r=!0),i?i._next=e:r||null!==this._firstPT||(this._firstPT=e),e._next=t,e._prev=i),e},e._kill=function(i){var e,n,t,r=i;if(i.autoAlpha||i.alpha){r={};for(n in i)r[n]=i[n];r.opacity=1,r.autoAlpha&&(r.visibility=1)}return i.className&&(e=this._classNamePT)&&(t=e.xfirst,t&&t._prev?this._linkCSSP(t._prev,e._next,t._prev._prev):t===this._firstPT&&(this._firstPT=e._next),e._next&&this._linkCSSP(e._next,e._next._next,t._prev),this._classNamePT=null),R.prototype._kill.call(this,r)};var I=function(i,a,r){var s,t,e,n;if(i.slice)for(t=i.length;--t>-1;)I(i[t],a,r);else for(s=i.childNodes,t=s.length;--t>-1;)e=s[t],n=e.type,e.style&&(a.push(C(e)),r&&r.push(e)),1!==n&&9!==n&&11!==n||!e.childNodes.length||I(e,a,r)};return a.cascadeTo=function(r,s,o){var t,i,a,e=O.to(r,s,o),l=[e],c=[],h=[],n=[],u=O._internals.reservedProps;for(r=e._targets||e.target,I(r,c,n),e.render(s,!0),I(r,h),e.render(0,!0),e._enabled(!0),t=n.length;--t>-1;)if(i=Z(n[t],c[t],h[t]),i.firstMPT){i=i.difs;for(a in o)u[a]&&(i[a]=o[a]);l.push(O.to(n[t],s,i))}return l},R.activate([a]),a},!0),function(){var t=r._gsDefine.plugin({propName:"roundProps",priority:-1,API:2,init:function(t,i,e){return this._tween=e,!0}}),e=t.prototype;e._onInitAllProps=function(){for(var n,e,i,t=this._tween,a=t.vars.roundProps instanceof Array?t.vars.roundProps:t.vars.roundProps.split(","),r=a.length,s={},o=t._propLookup.roundProps;--r>-1;)s[a[r]]=1;for(r=a.length;--r>-1;)for(n=a[r],e=t._firstPT;e;)i=e._next,e.pg?e.t._roundProps(s,!0):e.n===n&&(this._add(e.t,n,e.s,e.c),i&&(i._prev=e._prev),e._prev?e._prev._next=i:t._firstPT===e&&(t._firstPT=i),e._next=e._prev=null,t._propLookup[n]=o),e=i;return!1},e._add=function(i,e,t,r){this._addTween(i,e,t,t+r,e,!0),this._overwriteProps.push(e)}}(),r._gsDefine.plugin({propName:"attr",API:2,version:"0.3.3",init:function(i,r){var e,n,t;if("function"!=typeof i.setAttribute)return!1;this._target=i,this._proxy={},this._start={},this._end={};for(e in r)this._start[e]=this._proxy[e]=n=i.getAttribute(e),t=this._addTween(this._proxy,e,parseFloat(n),r[e],e),this._end[e]=t?t.s+t.c:r[e],this._overwriteProps.push(e);return!0},set:function(e){this._super.setRatio.call(this,e);for(var t,i=this._overwriteProps,r=i.length,n=1===e?this._end:e?this._proxy:this._start;--r>-1;)t=i[r],this._target.setAttribute(t,n[t]+"")}}),r._gsDefine.plugin({propName:"directionalRotation",version:"0.2.1",API:2,init:function(a,n){"object"!=typeof n&&(n={rotation:n}),this.finals={};var t,r,s,l,e,o,i=n.useRadians===!0?2*Math.PI:360,c=1e-6;for(t in n)"useRadians"!==t&&(o=(n[t]+"").split("_"),r=o[0],s=parseFloat("function"!=typeof a[t]?a[t]:a[t.indexOf("set")||"function"!=typeof a["get"+t.substr(3)]?t:"get"+t.substr(3)]()),l=this.finals[t]="string"==typeof r&&"="===r.charAt(1)?s+parseInt(r.charAt(0)+"1",10)*Number(r.substr(2)):Number(r)||0,e=l-s,o.length&&(r=o.join("_"),-1!==r.indexOf("short")&&(e%=i,e!==e%(i/2)&&(e=0>e?e+i:e-i)),-1!==r.indexOf("_cw")&&0>e?e=(e+9999999999*i)%i-(0|e/i)*i:-1!==r.indexOf("ccw")&&e>0&&(e=(e-9999999999*i)%i-(0|e/i)*i)),(e>c||-c>e)&&(this._addTween(a,t,s,s+e,t),this._overwriteProps.push(t)));return!0},set:function(t){var e;if(1!==t)this._super.setRatio.call(this,t);else for(e=this._firstPT;e;)e.f?e.t[e.p](this.finals[e.p]):e.t[e.p]=this.finals[e.p],e=e._next}})._autoCSS=!0,r._gsDefine("easing.Back",["easing.Ease"],function(i){var l,a,h,f=r.GreenSockGlobals||r,g=f.com.greensock,c=2*Math.PI,_=Math.PI/2,n=g._class,e=function(r,a){var e=n("easing."+r,function(){},!0),t=e.prototype=new i;return t.constructor=e,t.getRatio=a,e},u=i.register||function(){},o=function(e,i,r,a){var t=n("easing."+e,{easeOut:new i,easeIn:new r,easeInOut:new a},!0);return u(t,e),t},d=function(t,i,e){this.t=t,this.v=i,e&&(this.next=e,e.prev=this,this.c=e.v-i,this.gap=e.t-t)},p=function(r,a){var e=n("easing."+r,function(e){this._p1=e||0===e?e:1.70158,this._p2=1.525*this._p1},!0),t=e.prototype=new i;return t.constructor=e,t.getRatio=a,t.config=function(t){return new e(t)},e},m=o("Back",p("BackOut",function(e){return(e-=1)*e*((this._p1+1)*e+this._p1)+1}),p("BackIn",function(e){return e*e*((this._p1+1)*e-this._p1)}),p("BackInOut",function(e){return 1>(e*=2)?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)})),s=n("easing.SlowMo",function(e,t,i){t=t||0===t?t:.7,null==e?e=.7:e>1&&(e=1),this._p=1!==e?t:0,this._p1=(1-e)/2,this._p2=e,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),t=s.prototype=new i;return t.constructor=s,t.getRatio=function(e){var t=e+(.5-e)*this._p;return this._p1>e?this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t:e>this._p3?this._calcEnd?1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e:this._calcEnd?1:t},s.ease=new s(.7,.7),t.config=s.config=function(e,t,i){return new s(e,t,i)},l=n("easing.SteppedEase",function(e){e=e||1,this._p1=1/e,this._p2=e+1},!0),t=l.prototype=new i,t.constructor=l,t.getRatio=function(e){return 0>e?e=0:e>=1&&(e=.999999999),(this._p2*e>>0)*this._p1},t.config=l.config=function(e){return new l(e)},a=n("easing.RoughEase",function(e){e=e||{};for(var t,r,n,a,u,o,c=e.taper||"none",p=[],m=0,h=0|(e.points||20),s=h,f=e.randomize!==!1,g=e.clamp===!0,_=e.template instanceof i?e.template:null,l="number"==typeof e.strength?.4*e.strength:.4;--s>-1;)t=f?Math.random():1/h*s,r=_?_.getRatio(t):t,"none"===c?n=l:"out"===c?(a=1-t,n=a*a*l):"in"===c?n=t*t*l:.5>t?(a=2*t,n=.5*a*a*l):(a=2*(1-t),n=.5*a*a*l),f?r+=Math.random()*n-.5*n:s%2?r+=.5*n:r-=.5*n,g&&(r>1?r=1:0>r&&(r=0)),p[m++]={x:t,y:r};for(p.sort(function(e,t){return e.x-t.x}),o=new d(1,1,null),s=h;--s>-1;)u=p[s],o=new d(u.x,u.y,o);this._prev=new d(0,0,0!==o.t?o:o.next)},!0),t=a.prototype=new i,t.constructor=a,t.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&e.t>=t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},t.config=function(e){return new a(e)},a.ease=new a,o("Bounce",e("BounceOut",function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}),e("BounceIn",function(e){return 1/2.75>(e=1-e)?1-7.5625*e*e:2/2.75>e?1-(7.5625*(e-=1.5/2.75)*e+.75):2.5/2.75>e?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}),e("BounceInOut",function(e){var t=.5>e;return e=t?1-2*e:2*e-1,e=1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5})),o("Circ",e("CircOut",function(e){return Math.sqrt(1-(e-=1)*e)}),e("CircIn",function(e){return-(Math.sqrt(1-e*e)-1)}),e("CircInOut",function(e){return 1>(e*=2)?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)})),h=function(r,a,s){var e=n("easing."+r,function(e,t){this._p1=e||1,this._p2=t||s,this._p3=this._p2/c*(Math.asin(1/this._p1)||0)},!0),t=e.prototype=new i;return t.constructor=e,t.getRatio=a,t.config=function(t,i){return new e(t,i)},e},o("Elastic",h("ElasticOut",function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*c/this._p2)+1},.3),h("ElasticIn",function(e){return-(this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*c/this._p2))},.3),h("ElasticInOut",function(e){return 1>(e*=2)?-.5*this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*c/this._p2):.5*this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*c/this._p2)+1},.45)),o("Expo",e("ExpoOut",function(e){return 1-Math.pow(2,-10*e)}),e("ExpoIn",function(e){return Math.pow(2,10*(e-1))-.001}),e("ExpoInOut",function(e){return 1>(e*=2)?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))})),o("Sine",e("SineOut",function(e){return Math.sin(e*_)}),e("SineIn",function(e){return-Math.cos(e*_)+1}),e("SineInOut",function(e){return-.5*(Math.cos(Math.PI*e)-1)})),n("easing.EaseLookup",{find:function(e){return i.map[e]}},!0),u(f.SlowMo,"SlowMo","ease,"),u(a,"RoughEase","ease,"),u(l,"SteppedEase","ease,"),m},!0)}),r._gsDefine&&r._gsQueue.pop()(),function(i,q){"use strict";var S=i.GreenSockGlobals=i.GreenSockGlobals||i;if(!S.TweenLite){var n,a,e,r,o,N=function(r){var e,i=r.split("."),t=S;for(e=0;i.length>e;e++)t[i[e]]=t=t[i[e]]||{};return t},d=N("com.greensock"),s=1e-10,W=function(t){var e,i=[],r=t.length;for(e=0;e!==r;i.push(t[e++]));return i},H=function(){},v=function(){var e=Object.prototype.toString,t=e.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&e.call(i)===t)}}(),y={},F=function(e,r,t,a){this.sc=y[e]?y[e].sc:[],y[e]=this,this.gsClass=null,this.func=t;var n=[];this.check=function(d){for(var l,c,h,o,s=r.length,u=s;--s>-1;)(l=y[r[s]]||new F(r[s],[])).gsClass?(n[s]=l.gsClass,u--):d&&l.sc.push(this);if(0===u&&t)for(c=("com.greensock."+e).split("."),h=c.pop(),o=N(c.join("."))[h]=this.gsClass=t.apply(t,n),a&&(S[h]=o,"function"==typeof define&&define.amd?define((i.GreenSockAMDPath?i.GreenSockAMDPath+"/":"")+e.split(".").pop(),[],function(){return o}):e===q&&"undefined"!=typeof module&&module.exports&&(module.exports=o)),s=0;this.sc.length>s;s++)this.sc[s].check()},this.check(!0)},j=i._gsDefine=function(e,t,i,r){return new F(e,t,i,r)},u=d._class=function(t,e,i){return e=e||function(){},j(t,[],function(){return e},i),e};j.globals=S;var G=[0,0,1,1],M=[],c=u("easing.Ease",function(t,e,i,r){this._func=t,this._type=i||0,this._power=r||0,this._params=e?G.concat(e):G},!0),x=c.map={},O=c.register=function(i,c,h,l){for(var n,e,r,t,a=c.split(","),s=a.length,o=(h||"easeIn,easeOut,easeInOut").split(",");--s>-1;)for(e=a[s],n=l?u("easing."+e,null,!0):d.easing[e]||{},r=o.length;--r>-1;)t=o[r],x[e+"."+t]=x[t+e]=n[t]=i.getRatio?i:i[t]||new i};for(e=c.prototype,e._calcEnd=!1,e.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var i=this._type,r=this._power,e=1===i?1-t:2===i?t:.5>t?2*t:2*(1-t);return 1===r?e*=e:2===r?e*=e*e:3===r?e*=e*e*e:4===r&&(e*=e*e*e*e),1===i?1-e:2===i?e:.5>t?e/2:1-e/2},n=["Linear","Quad","Cubic","Quart","Quint,Strong"],a=n.length;--a>-1;)e=n[a]+",Power"+a,O(new c(null,null,1,a),e,"easeOut",!0),O(new c(null,null,2,a),e,"easeIn"+(0===a?",easeNone":"")),O(new c(null,null,3,a),e,"easeInOut");x.linear=d.easing.Linear.easeIn,x.swing=d.easing.Quad.easeInOut;var z=u("events.EventDispatcher",function(e){this._listeners={},this._eventTarget=e||this});e=z.prototype,e.addEventListener=function(s,l,c,h,i){i=i||0;var n,t,e=this._listeners[s],a=0;for(null==e&&(this._listeners[s]=e=[]),t=e.length;--t>-1;)n=e[t],n.c===l&&n.s===c?e.splice(t,1):0===a&&i>n.pr&&(a=t+1);e.splice(a,0,{c:l,s:c,up:h,pr:i}),this!==r||o||r.wake()},e.removeEventListener=function(i,r){var e,t=this._listeners[i];if(t)for(e=t.length;--e>-1;)if(t[e].c===r)return void t.splice(e,1)},e.dispatchEvent=function(n){var i,t,e,r=this._listeners[n];if(r)for(i=r.length,t=this._eventTarget;--i>-1;)e=r[i],e.up?e.c.call(e.s||t,{type:n,target:t}):e.c.call(e.s||t)};var T=i.requestAnimationFrame,k=i.cancelAnimationFrame,E=Date.now||function(){return(new Date).getTime()},C=E();for(n=["ms","moz","webkit","o"],a=n.length;--a>-1&&!T;)T=i[n[a]+"RequestAnimationFrame"],k=i[n[a]+"CancelAnimationFrame"]||i[n[a]+"CancelRequestAnimationFrame"];u("Ticker",function(_,f){var i,h,t,l,a,e=this,d=E(),n=f!==!1&&T,c=500,p=33,u=function(s){var r,o,n=E()-C;n>c&&(d+=n-p),C+=n,e.time=(C-d)/1e3,r=e.time-a,(!i||r>0||s===!0)&&(e.frame++,a+=r+(r>=l?.004:l-r),o=!0),s!==!0&&(t=h(u)),o&&e.dispatchEvent("tick")};z.call(e),e.time=e.frame=0,e.tick=function(){u(!0)},e.lagSmoothing=function(e,t){c=e||1/s,p=Math.min(t,c,0)},e.sleep=function(){null!=t&&(n&&k?k(t):clearTimeout(t),h=H,t=null,e===r&&(o=!1))},e.wake=function(){null!==t?e.sleep():e.frame>10&&(C=E()-c+5),h=0===i?H:n&&T?T:function(t){return setTimeout(t,0|1e3*(a-e.time)+1)},e===r&&(o=!0),u(2)},e.fps=function(t){return arguments.length?(i=t,l=1/(i||60),a=this.time+l,void e.wake()):i},e.useRAF=function(t){return arguments.length?(e.sleep(),n=t,void e.fps(i)):n},e.fps(_),setTimeout(function(){n&&(!t||5>e.frame)&&e.useRAF(!1)},1500)}),e=d.Ticker.prototype=new d.events.EventDispatcher,e.constructor=d.Ticker;var l=u("core.Animation",function(i,e){if(this.vars=e=e||{},this._duration=this._totalDuration=i||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=e.immediateRender===!0,this.data=e.data,this._reversed=e.reversed===!0,p){o||r.wake();var t=this.vars.useFrames?_:p;t.add(this,t._time),this.vars.paused&&this.paused(!0)}});r=l.ticker=new d.Ticker,e=l.prototype,e._dirty=e._gc=e._initted=e._paused=!1,e._totalTime=e._time=0,e._rawPrevTime=-1,e._next=e._last=e._onUpdate=e._timeline=e.timeline=null,e._paused=!1;var B=function(){o&&E()-C>2e3&&r.wake(),setTimeout(B,2e3)};B(),e.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},e.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},e.resume=function(e,t){return null!=e&&this.seek(e,t),this.paused(!1)},e.seek=function(e,t){return this.totalTime(Number(e),t!==!1)},e.restart=function(e,t){return this.reversed(!1).paused(!1).totalTime(e?-this._delay:0,t!==!1,!0)},e.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},e.render=function(){},e.invalidate=function(){return this},e.isActive=function(){var t,e=this._timeline,i=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime())>=i&&i+this.totalDuration()/this._timeScale>t},e._enabled=function(e,t){return o||r.wake(),this._gc=!e,this._active=this.isActive(),t!==!0&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},e._kill=function(){return this._enabled(!1,!1)},e.kill=function(e,t){return this._kill(e,t),this},e._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},e._swapSelfInParams=function(e){for(var t=e.length,i=e.concat();--t>-1;)"{self}"===e[t]&&(i[t]=this);return i},e.eventCallback=function(e,r,i,n){if("on"===(e||"").substr(0,2)){var t=this.vars;if(1===arguments.length)return t[e];null==r?delete t[e]:(t[e]=r,t[e+"Params"]=v(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,t[e+"Scope"]=n),"onUpdate"===e&&(this._onUpdate=r)}return this},e.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},e.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==e&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},e.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},e.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(e>this._duration?this._duration:e,t)):this._time},e.totalTime=function(t,a,n){if(o||r.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>t&&!n&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var i=this._totalDuration,e=this._timeline;if(t>i&&!n&&(t=i),this._startTime=(this._paused?this._pauseTime:e._time)-(this._reversed?i-t:t)/this._timeScale,e._dirty||this._uncache(!1),e._timeline)for(;e._timeline;)e._timeline._time!==(e._startTime+e._totalTime)/e._timeScale&&e.totalTime(e._totalTime,!0),e=e._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==t||0===this._duration)&&(this.render(t,a,!1),f.length&&w())}return this},e.progress=e.totalProgress=function(e,t){return arguments.length?this.totalTime(this.duration()*e,t):this._time/this.duration()},e.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},e.timeScale=function(e){if(!arguments.length)return this._timeScale;if(e=e||s,this._timeline&&this._timeline.smoothChildTiming){var t=this._pauseTime,i=t||0===t?t:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/e}return this._timeScale=e,this._uncache(!1)},e.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},e.paused=function(e){if(!arguments.length)return this._paused;if(e!=this._paused&&this._timeline){o||e||r.wake();var t=this._timeline,i=t.rawTime(),n=i-this._pauseTime;!e&&t.smoothChildTiming&&(this._startTime+=n,this._uncache(!1)),this._pauseTime=e?i:null,this._paused=e,this._active=this.isActive(),!e&&0!==n&&this._initted&&this.duration()&&this.render(t.smoothChildTiming?this._totalTime:(i-this._startTime)/this._timeScale,!0,!0)}return this._gc&&!e&&this._enabled(!0,!1),this};var A=u("core.SimpleTimeline",function(e){l.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0});e=A.prototype=new l,e.constructor=A,e.kill()._gc=!1,e._first=e._last=null,e._sortChildren=!1,e.add=e.insert=function(e,r){var t,i;if(e._startTime=Number(r||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),t=this._last,this._sortChildren)for(i=e._startTime;t&&t._startTime>i;)t=t._prev;return t?(e._next=t._next,t._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=t,this._timeline&&this._uncache(!0),this},e._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),e._next=e._prev=e.timeline=null,this._timeline&&this._uncache(!0)),this},e.render=function(t,i,r){var n,e=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;e;)n=e._next,(e._active||t>=e._startTime&&!e._paused)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(t-e._startTime)*e._timeScale,i,r):e.render((t-e._startTime)*e._timeScale,i,r)),e=n},e.rawTime=function(){return o||r.wake(),this._totalTime};var t=u("TweenLite",function(e,c,h){if(l.call(this,c,h),this.render=t.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:t.selector(e)||e;var n,r,a,u=e.jquery||e.length&&e!==i&&e[0]&&(e[0]===i||e[0].nodeType&&e[0].style&&!e.nodeType),o=this.vars.overwrite;if(this._overwrite=o=null==o?U[t.defaultOverwrite]:"number"==typeof o?o>>0:U[o],(u||e instanceof Array||e.push&&v(e))&&"number"!=typeof e[0])for(this._targets=a=W(e),this._propLookup=[],this._siblings=[],n=0;a.length>n;n++)r=a[n],r?"string"!=typeof r?r.length&&r!==i&&r[0]&&(r[0]===i||r[0].nodeType&&r[0].style&&!r.nodeType)?(a.splice(n--,1),this._targets=a=a.concat(W(r))):(this._siblings[n]=b(r,this,!1),1===o&&this._siblings[n].length>1&&L(r,this,null,1,this._siblings[n])):(r=a[n--]=t.selector(r),"string"==typeof r&&a.splice(n+1,1)):a.splice(n--,1);else this._propLookup={},this._siblings=b(e,this,!1),1===o&&this._siblings.length>1&&L(e,this,null,1,this._siblings);(this.vars.immediateRender||0===c&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-s,this.render(-this._delay))},!0),R=function(e){return e.length&&e!==i&&e[0]&&(e[0]===i||e[0].nodeType&&e[0].style&&!e.nodeType)},Y=function(t,r){var e,i={};for(e in t)D[e]||e in r&&"transform"!==e&&"x"!==e&&"y"!==e&&"width"!==e&&"height"!==e&&"className"!==e&&"border"!==e||!(!g[e]||g[e]&&g[e]._autoCSS)||(i[e]=t[e],delete t[e]);t.css=i};e=t.prototype=new l,e.constructor=t,e.kill()._gc=!1,e.ratio=0,e._firstPT=e._targets=e._overwrittenProps=e._startAt=null,e._notifyPluginsOfEnabled=e._lazy=!1,t.version="1.13.1",t.defaultEase=e._ease=new c(null,null,1,1),t.defaultOverwrite="auto",t.ticker=r,t.autoSleep=!0,t.lagSmoothing=function(e,t){r.lagSmoothing(e,t)},t.selector=i.$||i.jQuery||function(e){var r=i.$||i.jQuery;return r?(t.selector=r,r(e)):"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e)};var f=[],P={},I=t._internals={isArray:v,isSelector:R,lazyTweens:f},g=t._plugins={},m=I.tweenLookup={},X=0,D=I.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1},U={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},_=l._rootFramesTimeline=new A,p=l._rootTimeline=new A,w=I.lazyRender=function(){var e=f.length;for(P={};--e>-1;)n=f[e],n&&n._lazy!==!1&&(n.render(n._lazy,!1,!0),n._lazy=!1);f.length=0};p._startTime=r.time,_._startTime=r.frame,p._active=_._active=!0,setTimeout(w,1),l._updateRoot=t.render=function(){var n,i,e;if(f.length&&w(),p.render((r.time-p._startTime)*p._timeScale,!1,!1),_.render((r.frame-_._startTime)*_._timeScale,!1,!1),f.length&&w(),!(r.frame%120)){for(e in m){for(i=m[e].tweens,n=i.length;--n>-1;)i[n]._gc&&i.splice(n,1);0===i.length&&delete m[e]}if(e=p._first,(!e||e._paused)&&t.autoSleep&&!_._first&&1===r._listeners.tick.length){for(;e&&e._paused;)e=e._next;e||r.sleep()}}},r.addEventListener("tick",l._updateRoot);var b=function(r,n,a){var e,i,t=r._gsTweenID;if(m[t||(r._gsTweenID=t="t"+X++)]||(m[t]={target:r,tweens:[]}),n&&(e=m[t].tweens,e[i=e.length]=n,a))for(;--i>-1;)e[i]===n&&e.splice(i,1);return m[t].tweens},L=function(f,i,p,r,a){var t,n,e,d;if(1===r||r>=4){for(d=a.length,t=0;d>t;t++)if((e=a[t])!==i)e._gc||e._enabled(!1,!1)&&(n=!0);else if(5===r)break;return n}var h,u=i._startTime+s,c=[],o=0,l=0===i._duration;for(t=a.length;--t>-1;)(e=a[t])===i||e._gc||e._paused||(e._timeline!==i._timeline?(h=h||V(i,0,l),0===V(e,h,l)&&(c[o++]=e)):u>=e._startTime&&e._startTime+e.totalDuration()/e._timeScale>u&&((l||!e._initted)&&2e-10>=u-e._startTime||(c[o++]=e)));for(t=o;--t>-1;)e=c[t],2===r&&e._kill(p,f)&&(n=!0),(2!==r||!e._firstPT&&e._initted)&&e._enabled(!1,!1)&&(n=!0);return n},V=function(r,i,a){for(var t=r._timeline,n=t._timeScale,e=r._startTime;t._timeline;){if(e+=t._startTime,n*=t._timeScale,t._paused)return-100;t=t._timeline}return e/=n,e>i?e-i:a&&e===i||!r._initted&&2*s>e-i?s:(e+=r.totalDuration()/r._timeScale/n)>i+s?0:e-i-s};e._init=function(){var s,h,e,n,a,i=this.vars,l=this._overwrittenProps,u=this._duration,o=!!i.immediateRender,r=i.ease;if(i.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),a={};for(n in i.startAt)a[n]=i.startAt[n];if(a.overwrite=!1,a.immediateRender=!0,a.lazy=o&&i.lazy!==!1,a.startAt=a.delay=null,this._startAt=t.to(this.target,0,a),o)if(this._time>0)this._startAt=null;else if(0!==u)return}else if(i.runBackwards&&0!==u)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{e={};for(n in i)D[n]&&"autoCSS"!==n||(e[n]=i[n]);if(e.overwrite=0,e.data="isFromStart",e.lazy=o&&i.lazy!==!1,e.immediateRender=o,this._startAt=t.to(this.target,0,e),o){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1)}if(this._ease=r=r?r instanceof c?r:"function"==typeof r?new c(r,i.easeParams):x[r]||t.defaultEase:t.defaultEase,i.easeParams instanceof Array&&r.config&&(this._ease=r.config.apply(r,i.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(s=this._targets.length;--s>-1;)this._initProps(this._targets[s],this._propLookup[s]={},this._siblings[s],l?l[s]:null)&&(h=!0);else h=this._initProps(this.target,this._propLookup,this._siblings,l);if(h&&t._onPluginEvent("_onInitAllProps",this),l&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),i.runBackwards)for(e=this._firstPT;e;)e.s+=e.c,e.c=-e.c,e=e._next;this._onUpdate=i.onUpdate,this._initted=!0},e._initProps=function(e,s,o,l){var t,c,h,a,n,r;if(null==e)return!1;P[e._gsTweenID]&&w(),this.vars.css||e.style&&e!==i&&e.nodeType&&g.css&&this.vars.autoCSS!==!1&&Y(this.vars,e);for(t in this.vars){if(r=this.vars[t],D[t])r&&(r instanceof Array||r.push&&v(r))&&-1!==r.join("").indexOf("{self}")&&(this.vars[t]=r=this._swapSelfInParams(r,this));else if(g[t]&&(a=new g[t])._onInitTween(e,this.vars[t],this)){for(this._firstPT=n={_next:this._firstPT,t:a,p:"setRatio",s:0,c:1,f:!0,n:t,pg:!0,pr:a._priority},c=a._overwriteProps.length;--c>-1;)s[a._overwriteProps[c]]=this._firstPT;(a._priority||a._onInitAllProps)&&(h=!0),(a._onDisable||a._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=s[t]=n={_next:this._firstPT,t:e,p:t,f:"function"==typeof e[t],n:t,pg:!1,pr:0},n.s=n.f?e[t.indexOf("set")||"function"!=typeof e["get"+t.substr(3)]?t:"get"+t.substr(3)]():parseFloat(e[t]),n.c="string"==typeof r&&"="===r.charAt(1)?parseInt(r.charAt(0)+"1",10)*Number(r.substr(2)):Number(r)-n.s||0;n&&n._next&&(n._next._prev=n)}return l&&this._kill(l,e)?this._initProps(e,s,o,l):this._overwrite>1&&this._firstPT&&o.length>1&&L(e,this,s,this._overwrite,o)?(this._kill(s,e),this._initProps(e,s,o,l)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(P[e._gsTweenID]=!0),h)},e.render=function(e,l,r){var h,a,i,p,c=this._time,n=this._duration,o=this._rawPrevTime;if(e>=n)this._totalTime=this._time=n,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(h=!0,a="onComplete"),0===n&&(this._initted||!this.vars.lazy||r)&&(this._startTime===this._timeline._duration&&(e=0),(0===e||0>o||o===s)&&o!==e&&(r=!0,o>s&&(a="onReverseComplete")),this._rawPrevTime=p=!l||e||o===e?e:s);else if(1e-7>e)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==c||0===n&&o>0&&o!==s)&&(a="onReverseComplete",h=this._reversed),0>e?(this._active=!1,0===n&&(this._initted||!this.vars.lazy||r)&&(o>=0&&(r=!0),this._rawPrevTime=p=!l||e||o===e?e:s)):this._initted||(r=!0);else if(this._totalTime=this._time=e,this._easeType){var t=e/n,u=this._easeType,d=this._easePower;(1===u||3===u&&t>=.5)&&(t=1-t),3===u&&(t*=2),1===d?t*=t:2===d?t*=t*t:3===d?t*=t*t*t:4===d&&(t*=t*t*t*t),this.ratio=1===u?1-t:2===u?t:.5>e/n?t/2:1-t/2}else this.ratio=this._ease.getRatio(e/n);if(this._time!==c||r){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!r&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=c,this._rawPrevTime=o,f.push(this),void(this._lazy=e);this._time&&!h?this.ratio=this._ease.getRatio(this._time/n):h&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==c&&e>=0&&(this._active=!0),0===c&&(this._startAt&&(e>=0?this._startAt.render(e,l,r):a||(a="_dummyGS")),this.vars.onStart&&(0!==this._time||0===n)&&(l||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||M))),i=this._firstPT;i;)i.f?i.t[i.p](i.c*this.ratio+i.s):i.t[i.p]=i.c*this.ratio+i.s,i=i._next;this._onUpdate&&(0>e&&this._startAt&&this._startTime&&this._startAt.render(e,l,r),l||(this._time!==c||h)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||M)),a&&(!this._gc||r)&&(0>e&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(e,l,r),h&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!l&&this.vars[a]&&this.vars[a].apply(this.vars[a+"Scope"]||this,this.vars[a+"Params"]||M),0===n&&this._rawPrevTime===s&&p!==s&&(this._rawPrevTime=0))}},e._kill=function(r,i){if("all"===r&&(r=null),null==r&&(null==i||i===this.target))return this._lazy=!1,this._enabled(!1,!1);i="string"!=typeof i?i||this._targets||this.target:t.selector(i)||i;var n,s,o,e,a,l,c,h;if((v(i)||R(i))&&"number"!=typeof i[0])for(n=i.length;--n>-1;)this._kill(r,i[n])&&(l=!0);else{if(this._targets){for(n=this._targets.length;--n>-1;)if(i===this._targets[n]){a=this._propLookup[n]||{},this._overwrittenProps=this._overwrittenProps||[],s=this._overwrittenProps[n]=r?this._overwrittenProps[n]||{}:"all";break}}else{if(i!==this.target)return!1;a=this._propLookup,s=this._overwrittenProps=r?this._overwrittenProps||{}:"all"}if(a){c=r||a,h=r!==s&&"all"!==s&&r!==a&&("object"!=typeof r||!r._tempKill);for(o in c)(e=a[o])&&(e.pg&&e.t._kill(c)&&(l=!0),e.pg&&0!==e.t._overwriteProps.length||(e._prev?e._prev._next=e._next:e===this._firstPT&&(this._firstPT=e._next),e._next&&(e._next._prev=e._prev),e._next=e._prev=null),delete a[o]),h&&(s[o]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return l},e.invalidate=function(){return this._notifyPluginsOfEnabled&&t._onPluginEvent("_onDisable",this),this._firstPT=null,this._overwrittenProps=null,this._onUpdate=null,this._startAt=null,this._initted=this._active=this._notifyPluginsOfEnabled=this._lazy=!1,this._propLookup=this._targets?{}:[],this},e._enabled=function(i,a){if(o||r.wake(),i&&this._gc){var e,n=this._targets;if(n)for(e=n.length;--e>-1;)this._siblings[e]=b(n[e],this,!0);else this._siblings=b(this.target,this,!0)}return l.prototype._enabled.call(this,i,a),this._notifyPluginsOfEnabled&&this._firstPT?t._onPluginEvent(i?"_onEnable":"_onDisable",this):!1},t.to=function(e,i,r){return new t(e,i,r)},t.from=function(i,r,e){return e.runBackwards=!0,e.immediateRender=0!=e.immediateRender,new t(i,r,e)},t.fromTo=function(r,n,i,e){return e.startAt=i,e.immediateRender=0!=e.immediateRender&&0!=i.immediateRender,new t(r,n,e)},t.delayedCall=function(n,e,i,r,a){return new t(e,0,{delay:n,onComplete:e,onCompleteParams:i,onCompleteScope:r,onReverseComplete:e,onReverseCompleteParams:i,onReverseCompleteScope:r,immediateRender:!1,useFrames:a,overwrite:0})},t.set=function(e,i){return new t(e,0,i)},t.getTweensOf=function(r,a){if(null==r)return[];r="string"!=typeof r?r:t.selector(r)||r;var e,i,n,s;if((v(r)||R(r))&&"number"!=typeof r[0]){for(e=r.length,i=[];--e>-1;)i=i.concat(t.getTweensOf(r[e],a));for(e=i.length;--e>-1;)for(s=i[e],n=e;--n>-1;)s===i[n]&&i.splice(e,1)}else for(i=b(r).concat(),e=i.length;--e>-1;)(i[e]._gc||a&&!i[e].isActive())&&i.splice(e,1);return i},t.killTweensOf=t.killDelayedCallsTo=function(i,e,r){"object"==typeof e&&(r=e,e=!1);for(var n=t.getTweensOf(i,e),a=n.length;--a>-1;)n[a]._kill(r,i)};var h=u("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=h.prototype},!0);if(e=h.prototype,h.version="1.10.1",h.API=2,e._firstPT=null,e._addTween=function(r,i,n,e,s,o){var a,t;return null!=e&&(a="number"==typeof e||"="!==e.charAt(1)?Number(e)-n:parseInt(e.charAt(0)+"1",10)*Number(e.substr(2)))?(this._firstPT=t={_next:this._firstPT,t:r,p:i,s:n,c:a,f:"function"==typeof r[i],n:s||i,r:o},t._next&&(t._next._prev=t),t):void 0},e.setRatio=function(r){for(var t,e=this._firstPT,i=1e-6;e;)t=e.c*r+e.s,e.r?t=Math.round(t):i>t&&t>-i&&(t=0),e.f?e.t[e.p](t):e.t[e.p]=t,e=e._next},e._kill=function(i){var t,r=this._overwriteProps,e=this._firstPT;if(null!=i[this._propName])this._overwriteProps=[];else for(t=r.length;--t>-1;)null!=i[r[t]]&&r.splice(t,1);for(;e;)null!=i[e.n]&&(e._next&&(e._next._prev=e._prev),e._prev?(e._prev._next=e._next,e._prev=null):this._firstPT===e&&(this._firstPT=e._next)),e=e._next;return!1},e._roundProps=function(t,i){for(var e=this._firstPT;e;)(t[this._propName]||null!=e.n&&t[e.n.split(this._propName+"_").join("")])&&(e.r=i),e=e._next},t._onPluginEvent=function(i,n){var a,t,r,s,o,e=n._firstPT;if("_onInitAllProps"===i){for(;e;){for(o=e._next,t=r;t&&t.pr>e.pr;)t=t._next;(e._prev=t?t._prev:s)?e._prev._next=e:r=e,(e._next=t)?t._prev=e:s=e,e=o}e=n._firstPT=r}for(;e;)e.pg&&"function"==typeof e.t[i]&&e.t[i]()&&(a=!0),e=e._next;return a},h.activate=function(e){for(var t=e.length;--t>-1;)e[t].API===h.API&&(g[(new e[t])._propName]=e[t]);return!0},j.plugin=function(e){if(!(e&&e.propName&&e.init&&e.API))throw"illegal plugin definition.";var i,r=e.propName,s=e.priority||0,o=e.overwriteProps,n={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},t=u("plugins."+r.charAt(0).toUpperCase()+r.substr(1)+"Plugin",function(){h.call(this,r,s),this._overwriteProps=o||[]},e.global===!0),a=t.prototype=new h(r);a.constructor=t,t.API=e.API;for(i in n)"function"==typeof e[i]&&(a[n[i]]=e[i]);return t.version=e.version,h.activate([t]),t},n=i._gsQueue){for(a=0;n.length>a;a++)n[a]();for(e in y)y[e].func||i.console.log("GSAP encountered missing dependency: com.greensock."+e)}o=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax"),void function(t){"use strict";var l=t.GreenSockGlobals||t,f=function(r){for(var i=r.split("."),e=l,t=0;t<i.length;t++)e[i[t]]||(e[i[t]]={}),e=e[i[t]];return e},p=f("com.greensock.utils"),r=function(e){var t=e.nodeType,i="";if(3==t||4==t)return e.nodeValue;if(1==t||9==t||11==b){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=r(e)}return i},e=function(r,n,e,a){if(e||(e=t.getComputedStyle(r,null)),e){var i=e.getPropertyValue(n.replace(/([A-Z])/g,"-$1").toLowerCase());return i||e.length?i:e[n]}var i=void 0;if(r.currentStyle){e=r.currentStyle;var i=e[n]}return a?i:parseInt(i,10)||0},s=function(e){return e.length&&e[0]&&(e[0].nodeType&&e[0].style&&!e.nodeType||e[0].length&&e[0][0])?!0:!1},h=function(n){var i,e,t,r=[],a=n.length;for(i=0;a>i;i++)if(e=n[i],s(e))for(t=e.length,t=0;t<e.length;t++)r.push(e[t]);else r.push(e);return r},c=")eefec303079ad17405c",o=/(?:<br>|<br\/>|<br \/>)/gi,u=document.all&&!document.addEventListener,d="<div style='position:relative;display:inline-block;"+(u?"*display:inline;*zoom:1;'":"'"),a=function(e){e=e||"";var t=-1!==e.indexOf("++"),i=1;return function(){return d+(e?" class='"+e+(t?i++:"")+"'>":">")}},i=p.SplitText=l.SplitText=function(e,t){if("string"==typeof e&&(e=i.selector(e)),!e)throw"cannot split a null element.";this.elements=s(e)?h(e):[e],this.chars=[],this.words=[],this.lines=[],this._originals=[],this.vars=t||{},this.split(t)},_=function(i,y,j,X,F){o.test(i.innerHTML)&&(i.innerHTML=i.innerHTML.replace(o,c));var w,p,b,s,_,E,x,n,f,l,m,D,O,M=r(i),k=y.type||y.split||"chars,words,lines",g=-1!==k.indexOf("lines")?[]:null,v=-1!==k.indexOf("words"),T=-1!==k.indexOf("chars"),h="absolute"===y.position||y.absolute===!0,H=h?"&#173; ":" ",P=-999,d=t.getComputedStyle(i),I=e(i,"paddingLeft",d),N=e(i,"borderBottomWidth",d)+e(i,"borderTopWidth",d),U=e(i,"borderLeftWidth",d)+e(i,"borderRightWidth",d),G=e(i,"paddingTop",d)+e(i,"paddingBottom",d),W=e(i,"paddingLeft",d)+e(i,"paddingRight",d),B=e(i,"textAlign",d,!0),A=i.clientHeight,S=i.clientWidth,u=M.length,R="</div>",L=a(y.wordsClass),V=a(y.charsClass),z=-1!==(y.linesClass||"").indexOf("++"),C=y.linesClass;for(z&&(C=C.split("++").join("")),b=L(),s=0;u>s;s++)E=M.charAt(s),")"===E&&M.substr(s,20)===c?(b+=R+"<BR/>",s!==u-1&&(b+=" "+L()),s+=19):" "===E&&" "!==M.charAt(s-1)&&s!==u-1?(b+=R,s!==u-1&&(b+=H+L())):b+=T&&" "!==E?V()+E+"</div>":E;for(i.innerHTML=b+R,_=i.getElementsByTagName("*"),u=_.length,x=[],s=0;u>s;s++)x[s]=_[s];if(g||h)for(s=0;u>s;s++)n=x[s],p=n.parentNode===i,(p||h||T&&!v)&&(f=n.offsetTop,g&&p&&f!==P&&"BR"!==n.nodeName&&(w=[],g.push(w),P=f),h&&(n._x=n.offsetLeft,n._y=f,n._w=n.offsetWidth,n._h=n.offsetHeight),g&&(v!==p&&(T||(w.push(n),n._x-=I)),p&&s&&(x[s-1]._wordEnd=!0)));for(s=0;u>s;s++)n=x[s],p=n.parentNode===i,"BR"!==n.nodeName?(h&&(m=n.style,v||p||(n._x+=n.parentNode._x,n._y+=n.parentNode._y),m.left=n._x+"px",m.top=n._y+"px",m.position="absolute",m.display="block",m.width=n._w+1+"px",m.height=n._h+"px"),v?p?X.push(n):T&&j.push(n):p?(i.removeChild(n),x.splice(s--,1),u--):!p&&T&&(f=!g&&!h&&n.nextSibling,i.appendChild(n),f||i.appendChild(document.createTextNode(" ")),j.push(n))):g||h?(i.removeChild(n),x.splice(s--,1),u--):v||i.appendChild(n);if(g){for(h&&(l=document.createElement("div"),i.appendChild(l),D=l.offsetWidth+"px",f=l.offsetParent===i?0:i.offsetLeft,i.removeChild(l)),m=i.style.cssText,i.style.cssText="display:none;";i.firstChild;)i.removeChild(i.firstChild);for(O=!h||!v&&!T,s=0;s<g.length;s++){for(w=g[s],l=document.createElement("div"),l.style.cssText="display:block;text-align:"+B+";position:"+(h?"absolute;":"relative;"),C&&(l.className=C+(z?s+1:"")),F.push(l),u=w.length,_=0;u>_;_++)"BR"!==w[_].nodeName&&(n=w[_],l.appendChild(n),O&&(n._wordEnd||v)&&l.appendChild(document.createTextNode(" ")),h&&(0===_&&(l.style.top=n._y+"px",l.style.left=I+f+"px"),n.style.top="0px",f&&(n.style.left=n._x-f+"px")));v||T||(l.innerHTML=r(l).split(String.fromCharCode(160)).join(" ")),h&&(l.style.width=D,l.style.height=n._h+"px"),i.appendChild(l)}i.style.cssText=m}h&&(A>i.clientHeight&&(i.style.height=A-G+"px",A>i.clientHeight&&(i.style.height=A+N+"px")),S>i.clientWidth&&(i.style.width=S-W+"px",S>i.clientWidth&&(i.style.width=S+U+"px")))},n=i.prototype;n.split=function(t){this.isSplit&&this.revert(),this.vars=t||this.vars,this._originals.length=this.chars.length=this.words.length=this.lines.length=0;for(var e=0;e<this.elements.length;e++)this._originals[e]=this.elements[e].innerHTML,_(this.elements[e],this.vars,this.chars,this.words,this.lines);return this.isSplit=!0,this},n.revert=function(){if(!this._originals)throw"revert() call wasn't scoped properly.";for(var e=this._originals.length;--e>-1;)this.elements[e].innerHTML=this._originals[e];return this.chars=[],this.words=[],this.lines=[],this.isSplit=!1,this},i.selector=t.$||t.jQuery||function(){return t.$?(i.selector=t.$,t.$("")):document?document.getElementById("#"==="".charAt(0)?"".substr(1):""):""}}(window),void function(){function t(e,t){(!e||"keyup"!=e.type||"undefined"==typeof e.keyCode||0!=e.keyCode&&13==e.keyCode)&&(t.destroy_listeners(),t.parentNode&&t.parentNode.removeChild(t),t.callback_ok())}function r(e,t){(!e||"keyup"!=e.type||"undefined"==typeof e.keyCode||0!=e.keyCode&&27==e.keyCode)&&(t.destroy_listeners(),t.parentNode&&t.parentNode.removeChild(t),t.callback_cancel())}function n(i,e){if("undefined"==typeof i)var e=e.primary,i=e.secondary;var r={};for(var t in i)r[t]=i[t];for(var t in e)r[t]=e[t];return r}var e={};e.ok="Ok",e.cancel="Cancel",e.point_event="click",e.parent=document.body,e.zindex=1e4,e.reverse_buttons=!1,e.autofocus=!0,e.autoexit=!0,e.custom_css={},e.css_prefix="smoke",e.value=void 0,e.callback=void 0,e.observe_mutation=!0,e.window_opened=void 0,e.window_closed=void 0,e.build=function(c,t){("undefined"==typeof e.parent||null==e.parent)&&(e.parent=document.body);var S="undefined"!=typeof t.ok?t.ok:e.ok,C="undefined"!=typeof t.cancel?t.cancel:e.cancel,y="undefined"!=typeof t.point_event?t.point_event:e.point_event,p="undefined"!=typeof t.parent?t.parent:e.parent,E="undefined"!=typeof t.zindex?t.zindex:e.zindex,w=("undefined"!=typeof t.reverse_buttons?t.reverse_buttons:e.reverse_buttons,"undefined"!=typeof t.autoexit?t.autoexit:e.autoexit),b="undefined"!=typeof t.autofocus?t.autofocus:e.autofocus,g="undefined"!=typeof t.custom_css?t.custom_css:e.custom_css,n="undefined"!=typeof t.css_prefix?t.css_prefix:e.css_prefix,v="undefined"!=typeof t.value?t.value:e.value,x="undefined"!=typeof t.callback?t.callback:e.callback,A="undefined"!=typeof t.observe_mutation?t.observe_mutation:e.observe_mutation,l=("undefined"!=typeof t.window_opened?t.window_opened:e.window_opened,"undefined"!=typeof t.window_closed?t.window_closed:e.window_closed,!1);t.point_event=y,t.callback=x;var i=document.createElement("div");i.className=n+"-base",i.style.zIndex=E,p.appendChild(i);var h=i.dialog_wrapper=document.createElement("div");h.className=n+"-dialog_wrapper",i.appendChild(h),w&&h.addEventListener(y,function(r){"undefined"!=typeof r.changedTouches&&(r=r.changedTouches[0]),r.currentTarget==r.target&&(i.parentNode.removeChild(i),t.callback(!1,r),!l&&e.window_closed&&(e.window_closed(i,c,t),l=!0))});var s=i.dialog=document.createElement("div");s.className=n+"-dialog",h.appendChild(s);var d=i.text=i.dialog.text=document.createElement("div");if(d.className=n+"-dialog-text",d.innerHTML=c,s.appendChild(d),"prompt"==t.type){var a=i.prompt=i.dialog.prompt=document.createElement("div");a.className=n+"-prompt",a.input=document.createElement("input"),a.input.type="text",a.input.className=n+"-prompt-input","undefined"!=typeof v&&(a.input.value=v),a.appendChild(a.input),s.appendChild(a)}var r=i.buttons=i.dialog.buttons=document.createElement("div");r.className=n+"-dialog-buttons",r.ok=document.createElement("button"),r.ok.className=n+"-dialog-buttons-ok",r.ok.innerHTML=S,"alert"==t.type&&r.appendChild(r.ok),("prompt"==t.type||"confirm"==t.type)&&(r.cancel=document.createElement("button"),r.cancel.className=n+"-dialog-buttons-cancel",r.cancel.innerHTML=C,t.reverse_buttons?(r.appendChild(r.cancel),r.appendChild(r.ok)):(r.appendChild(r.ok),r.appendChild(r.cancel))),s.appendChild(r);for(var _ in g){var T=_.split("."),u=i;T.forEach(function(e){u=u[e]});var o=g[_];"string"==typeof o&&(o=[o]),o.forEach(function(e){u.classList.add(e)})}if("function"!=typeof t.callback&&(t.callback=function(){}),i.params=t,e["finishbuilding_"+t.type](i,t),"undefined"!=typeof i.prompt&&0!=b&&i.prompt.input.focus(),A){var f=window.MutationObserver||window.WebkitMutationObserver;if("undefined"!=typeof f){var m=new f(function(s){for(var r=0,o=s.length;o>r;r++){var n=s[r];if("childList"!=n.type)return;for(var a=0,h=n.removedNodes.length;h>a;a++)if(n.removedNodes[a]==i)return!l&&e.window_closed&&(e.window_closed(i,c,t),l=!0),void i.destroy_listeners(m)}});m.observe(p,{attributes:!1,childList:!0,subtree:!1})}}return e.window_opened&&e.window_opened(i,c,t),i},e.finishbuilding_alert=function(e){e.callback_ok=function(){e.params.callback()},e.destroy_listeners=function(e){e&&e.disconnect(),document.removeEventListener("keyup",i)};var i=e.ok=function(i){t(i,e)};document.addEventListener("keyup",i),e.buttons.ok.addEventListener(e.params.point_event,i),e.buttons.ok.smoke_pure_obj=e},e.finishbuilding_confirm=function(e){e.callback_ok=function(){e.params.callback(!0)},e.callback_cancel=function(){e.params.callback(!1)},e.destroy_listeners=function(e){e&&e.disconnect(),document.removeEventListener("keyup",i),document.removeEventListener("keyup",n)};var i=e.ok=function(i){t(i,e)},n=e.cancel=function(t){r(t,e)};document.addEventListener("keyup",i),e.buttons.ok.addEventListener(e.params.point_event,i),document.addEventListener("keyup",n),e.buttons.cancel.addEventListener(e.params.point_event,n),e.buttons.ok.smoke_pure_obj=e,e.buttons.cancel.smoke_pure_obj=e},e.finishbuilding_prompt=function(e){e.callback_ok=function(){e.params.callback(e.prompt.input.value)},e.callback_cancel=function(){e.params.callback(!1)},e.destroy_listeners=function(e){e&&e.disconnect(),document.removeEventListener("keyup",i),document.removeEventListener("keyup",n)};var i=e.ok=function(i){t(i,e)},n=e.cancel=function(t){r(t,e)};document.addEventListener("keyup",i),e.buttons.ok.addEventListener(e.params.point_event,i),document.addEventListener("keyup",n),e.buttons.cancel.addEventListener(e.params.point_event,n),e.buttons.ok.smoke_pure_obj=e,e.buttons.cancel.smoke_pure_obj=e},e.action_list=[{name:"alert"},{name:"confirm"},{name:"prompt"}];for(var i=0;i<e.action_list.length;i++)void function(t){e[t]=function(i,r,a){return e.build(i,n({callback:r,type:t},a))}}(e.action_list[i].name);"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define("smoke",[],function(){return e}):this.smoke=e}(),/(msie|trident)/i.test(navigator.userAgent)){var Ct=Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML").get,St=Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML").set;Object.defineProperty(HTMLElement.prototype,"innerHTML",{get:function(){return Ct.call(this)},set:function(i){for(var e=this.childNodes,r=e.length,t=r;t>0;t--)this.removeChild(e[0]);St.call(this,i)}})}["forEach"].forEach(function(e){NodeList.prototype[e]=HTMLCollection.prototype[e]=function(t,i){return Array.prototype.slice.call(this)[e](t,i)}}),/(msie|trident)/i.test(navigator.userAgent)&&Object.defineProperty(HTMLImageElement.prototype,"start",{writable:!0}),HTMLElement.prototype.isAttached=function(){for(var e=this;;){if(e=e.parentNode,e==document.documentElement)return!0;if(null==e)return!1}},HTMLElement.prototype.setTimeout=function(e,t){function i(e){for(;;){if(e=e.parentNode,e==document.documentElement)return!0;if(null==e)return!1}}function r(){var t=Array.prototype.slice.call(arguments);i(n)&&e.apply(null,t)}var n=this,a=window.setTimeout(r,t);return a},HTMLElement.prototype.setInterval=function(e,t){},Math.randInt=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},Math.randBMT=function(){var t,r,e=0,i=0;do e=2*Math.random()-1,i=2*Math.random()-1,t=e*e+i*i;while(0==t||t>1);r=Math.sqrt(-2*Math.log(t)/t);var e=(e*r+1)/2;return e>1?e=1:0>e&&(e=0),e},Math.weightedSample=function(e){var t=0;for(var i in e)t+=e[i];t*=Math.random();for(var i in e)if(t-=e[i],0>t)return i},String.prototype.capitalize=function(){function e(){return arguments[0].toUpperCase()}return this.toLowerCase().replace(/^[a-z]|\s[a-z]/g,e)},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},HTMLElement.prototype.playAudio=function(){function i(e){for(;;){if(e=e.parentNode,e==document.documentElement)return!0;if(null==e)return!1}}function t(){return i(r)?void setTimeout(t,50):(e.stop(),void("undefined"!=typeof e.release&&e.release()))}var r=this;t();var n=Array.prototype.slice.call(arguments),e=w.apply(null,n);return e},"undefined"!=typeof s&&1==s&&window.screen.lockOrientation&&window.screen.lockOrientation("landscape");var p;1==!!window.IS_READY?p=x():window.addEventListener("load",function(){return window.IS_READY=!0,"undefined"!=typeof s&&1==s?void document.addEventListener("deviceready",function(){p=x()}):void(p=x())}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined.");if("function"!=typeof t||"[object Function]"!==Object.prototype.toString.call(t))throw new TypeError("Array#findIndex: predicate must be a function.");for(var i=Object(this),r=i.length>>>0,n=arguments[1],e=0;r>e;e++){var a=i[e];if(t.call(n,a,e,i))return e}return-1}),Array.prototype.find||(Array.prototype.find=function(e){if("function"!=typeof e)throw new TypeError("Predicate must be a function.");var t=Object(this),r=t.length<0?0:t.length>>>0;if(0===r)return void 0;if("function"!=typeof e||"[object Function]"!==Object.prototype.toString.call(e))throw new TypeError("Array#find: predicate must be a function.");for(var a=arguments[1],i=0;r>i;i++){var n=t[i];if(e.call(a,n,i,t))return n}return void 0})}();